---
title: スタティック ライブラリ (C++/CX)
ms.date: 02/03/2017
ms.assetid: 7faf53c8-fa21-42cc-8246-d32533ef9dfa
ms.openlocfilehash: 3c4bfd28b805903a2e596ef6d648ff31b0b8261c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81358107"
---
# <a name="static-libraries-ccx"></a>スタティック ライブラリ (C++/CX)

ユニバーサル Windows プラットフォーム (UWP) アプリで使用される静的ライブラリには、STL の種類を含む ISO 標準の C++ コードを含めることができ、Windows ランタイム アプリ プラットフォームから除外されていない Win32 API を呼び出すこともできます。 静的ライブラリは Windows ランタイム コンポーネントを使用するため、特定の制限を持つ Windows ランタイム コンポーネントを作成する場合があります。

## <a name="creating-static-libraries"></a>スタティック ライブラリの作成

新しいプロジェクトを作成する手順は、インストールされている Visual Studio のバージョンによって異なります。 Visual Studio の優先バージョンのドキュメントを表示するには、**バージョン**セレクター コントロールを使用します。 このページの目次の上部に表示されます。

::: moniker range="vs-2019"

### <a name="to-create-a-uwp-static-library-in-visual-studio-2019"></a>UWP スタティック ライブラリを作成するには

1. メニューバーで、**[ファイル]** > **[新規作成]** > **[プロジェクト]** の順に選択して、**[新しいプロジェクトの作成]** ダイアログ ボックスを開きます。

1. ダイアログの上部で、[**言語**] を **[C++]** に設定し、[**プラットフォーム**] を **[Windows]** に設定し、[**プロジェクトの種類**] を **[UWP]** に設定します。

1. プロジェクトの種類のフィルター処理された一覧から[**静的ライブラリ (ユニバーサル Windows - C++/CX)]** を選択し、[**次へ**] を選択します。 次のページで、プロジェクトに名前を付け、必要に応じてプロジェクトの場所を指定します。

1. **[作成]** ボタンをクリックしてプロジェクトを作成します。

::: moniker-end

::: moniker range="<=vs-2017"

### <a name="to-create-a-uwp-static-library-in-visual-studio-2017-or-visual-studio-2015"></a>UWP 静的ライブラリを作成するには 2017 または Visual Studio 2015

1. メニュー バーで、[**ファイル] を** > クリックして **[新しい** > **プロジェクト**] をクリックします。 **[Visual C++** > **Windows ユニバーサル**] で 、[**静的ライブラリ (ユニバーサル ウィンドウ)]** を選択します。

1. **ソリューション エクスプローラ**で、プロジェクトのショートカット メニューを開き、[**プロパティ]** をクリックします。 [**プロパティ]** ダイアログ ボックスの [**構成プロパティ** > **C/C++]** ページで **、[Windows ランタイム拡張機能を使用する]** を **[はい ] (/ZW)** に設定します。

::: moniker-end

新しい静的ライブラリをコンパイルするときに、UWP アプリ用に除外されている Win32 API を呼び出すと、コンパイラはエラー C3861「識別子が見つかりません」が発生します。 Windows ランタイムでサポートされている代替方法を探す方法については[、「UWP アプリでの Windows API の代替方法](/uwp/win32-and-com/alternatives-to-windows-apis-uwp)」を参照してください。

UWP アプリ ソリューションに C++ スタティック ライブラリ プロジェクトを追加する場合は、UWP サポート プロパティが **[はい**] に設定されるように、ライブラリ プロジェクトのプロパティ設定を更新する必要があります。 この設定を行わない場合、コードはビルドされ、リンクされますが、Microsoft Store 用のアプリを確認しようとするとエラーが発生します。 スタティック ライブラリは、そのライブラリを利用するプロジェクトと同じコンパイラ設定でコンパイルする必要があります。

`ref` パブリック クラス、パブリック インターフェイス クラス、またはパブリック値クラスを作成するスタティック ライブラリを使用すると、リンクは次の警告を出します。

> **警告 LNK4264:** /ZW でコンパイルされたオブジェクト ファイルを静的ライブラリにアーカイブします。Windows ランタイム型を作成する場合は、Windows ランタイム メタデータを含む静的ライブラリとリンクすることは推奨されないことに注意してください。

スタティック ライブラリがライブラリ自体の外部で使用される Windows ランタイム コンポーネントを生成していない場合にのみ、この警告を無視しても問題ありません。 ライブラリが、自らが定義したコンポーネントを利用していない場合、パブリック メタデータに型情報が含まれている状況でも、リンカーは実装を最適化できます。 このことは、スタティック ライブラリ内のパブリック コンポーネントはコンパイルされるが、実行時にアクティブにならないことを意味します。 このため、他のコンポーネントやアプリで使用する Windows ランタイム コンポーネントは、ダイナミック リンク ライブラリ (DLL) に実装する必要があります。

## <a name="see-also"></a>関連項目

[スレッドとマーシャリング](../cppcx/threading-and-marshaling-c-cx.md)
