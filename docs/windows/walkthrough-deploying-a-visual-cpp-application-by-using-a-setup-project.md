---
title: 'チュートリアル: セットアップ プロジェクトを使用した Visual C++ アプリケーションの配置'
ms.date: 04/25/2019
helpviewer_keywords:
- deployment for Visual C++
ms.assetid: 66735cda-8fe3-4211-a19a-2cf717a12a3f
ms.openlocfilehash: 8a1242140154c5a0123d71b83983fae20cab5d7e
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81374354"
---
# <a name="walkthrough-deploying-a-visual-c-application-by-using-a-setup-project"></a>チュートリアル: セットアップ プロジェクトを使用した Visual C++ アプリケーションの配置

セットアップ プロジェクトを使用して、Visual C++ アプリケーションを展開する方法について説明します。

## <a name="prerequisites"></a>前提条件

このチュートリアルを実行するには、次のコンポーネントが必要です。

- Visual Studio がインストールされているコンピューター。

- Visual C++ ライブラリがない別のコンピューター。

## <a name="create-the-setup-project"></a>セットアップ プロジェクトを作成する

セットアップ プロジェクトの作成手順は、インストールされている Visual Studio のバージョンによって異なります。 Visual Studio の優先バージョンのドキュメントを表示するには、**バージョン**セレクター コントロールを使用します。 このページの目次の上部に表示されます。

::: moniker range="=vs-2019"

### <a name="to-create-the-project-in-visual-studio-2019"></a>プロジェクトを作成するには、Visual Studio 2019

1. メニューバーで、**[ファイル]** > **[新規作成]** > **[プロジェクト]** の順に選択して、**[新しいプロジェクトの作成]** ダイアログ ボックスを開きます。

   ![MFC アプリ プロジェクト](media/vs2019-mfc-app-new-project.png "新しい MFC アプリ")

1. ダイアログの上部で、検索ボックスに`MFC`入力し、結果の一覧から **[MFC アプリ**] を選択します。 表示されない場合は、Windows の [スタート] メニューから Visual Studio インストーラー プログラムを起動し **、C++ デスクトップ開発ワークロード**タイルをクリックする必要があります。 [**個々のコンポーネント]** で、MFC コンポーネントがオンになっていることを確認します。

1. 次のページで、プロジェクトの名前を入力し、必要に応じてプロジェクトの場所を指定します。

1. **[作成]** ボタンを選択してクライアント プロジェクトを作成します。 MFC**アプリケーション ウィザード**が表示されたら、すべての既定値をそのまま使用します。

1. アクティブなソリューション構成を **[リリース**] に変更します。 **[ビルド]** メニューの **[構成マネージャー]** を選択します。 **[構成マネージャー]** ダイアログ ボックスで、**[アクティブ ソリューション構成]** ドロップダウン ボックスの **[解放]** をクリックします。 **[閉じる]** をクリックします。

1. **Ctrl**+**Shift**+**B**キーを押してアプリケーションをビルドします。 または、**[ビルド]** メニューの **[ソリューションのビルド]** をクリックします。 アプリケーションをビルドすると、セットアップ プロジェクトでこの MFC アプリケーション プロジェクトの出力を使用できます。

1. まだ行っていない場合は、Visual Studio インストーラー プロジェクト拡張機能をダウンロードしてください。 この拡張機能は、Visual Studio 開発者向けの無料版であり、Visual Studio にセットアップおよび配置プロジェクト テンプレートの機能を追加するものです。 インターネットに接続したら、Visual Studio で **[拡張機能** > の**管理]** を選択します。 **[拡張機能と更新プログラム]** ダイアログ ボックスで **[オンライン]** タブを選択し、検索ボックスに「*Microsoft Visual Studio Installer Projects*」と入力します。 **Enter**キーを押して **、[Microsoft Visual Studio\<バージョン> インストーラー プロジェクト**] を選択し、[**ダウンロード**] をクリックします。 拡張機能を実行してインストールするよう選択し、Visual Studio を再起動します。

   ![セットアップ プロジェクト](media/vs2019-extension-dialog-installer-project.png "クライアント プロジェクトに名前を付ける")

1. Visual Studio のメニュー バーで **[ファイル]** > **[最近使ったプロジェクトとソリューション]** の順に選択し、プロジェクトを選択して再び開きます。

1. メニュー バーで、[**ファイル] メニューの** > **[新しい** > **プロジェクト**] を選択して、[**新しいプロジェクトの作成**] ダイアログ ボックスを開きます。 検索ボックスに「セットアップ」と入力し、結果の一覧から **[セットアップ プロジェクト]** を選択します。

1. **[名前]** ボックスにセットアップ プロジェクトの名前を入力します。 **[ソリューション]** ドロップダウン リストで **[ソリューションに追加]** をクリックします。 **[OK]** をクリックすると、セットアップ プロジェクトが作成されます。 **[File Assistant (ProjectName)]/(ファイル アシスタント (<プロジェクト名>)/)** タブがエディター ウィンドウで開きます。

::: moniker-end

::: moniker range="=vs-2017"

### <a name="to-create-the-project-in-visual-studio-2017"></a>プロジェクトを作成するには 2017

1. 新しいプロジェクトを作成します。 **[ファイル]** メニューの **[新規作成]** をポイントし、 **[プロジェクト]** をクリックします。

1. MFC**アプリケーション ウィザード**を使用して、新しい Visual Studio ソリューションを作成します。 ウィザードを見つけるには、**[新しいプロジェクト]** ダイアログ ボックスで、**Visual C++** ノードを展開し、**[MFC]**、**[MFC アプリケーション]** の順に選択して、プロジェクトの名前を入力し、**[OK]** をクリックします。 **[完了]** をクリックします。

   > [!NOTE]
   > MFC**アプリケーション**の種類が見つからない場合は、[**新しいプロジェクト**] ダイアログ ボックスの左ペインで **[Visual Studio インストーラーを開く**] を選択します。 **[省略可能]** コンポーネント セクションの **[C++ によるデスクトップ開発]** で、"**x86 用と x64 用の Visual C++ MFC**" という名前のオプションをインストールします。

1. アクティブなソリューション構成を **[リリース**] に変更します。 **[ビルド]** メニューの **[構成マネージャー]** を選択します。 **[構成マネージャー]** ダイアログ ボックスで、**[アクティブ ソリューション構成]** ドロップダウン ボックスの **[解放]** をクリックします。 **[閉じる]** をクリックします。

1. **Ctrl**+**Shift**+**B**キーを押してアプリケーションをビルドします。 または、**[ビルド]** メニューの **[ソリューションのビルド]** をクリックします。 アプリケーションをビルドすると、セットアップ プロジェクトでこの MFC アプリケーション プロジェクトの出力を使用できます。

1. まだ行っていない場合は、Visual Studio インストーラー プロジェクト拡張機能をダウンロードしてください。 この拡張機能は、Visual Studio 開発者向けの無料版であり、Visual Studio にセットアップおよび配置プロジェクト テンプレートの機能を追加するものです。 インターネットに接続したら、Visual Studio で [**ツール** > **の拡張機能と更新プログラム**] を選択します。 **[拡張機能と更新プログラム]** ダイアログ ボックスで **[オンライン]** タブを選択し、検索ボックスに「*Microsoft Visual Studio Installer Projects*」と入力します。 **Enter**キーを押して **、[Microsoft Visual Studio\<バージョン> インストーラー プロジェクト**] を選択し、[**ダウンロード**] をクリックします。 拡張機能を実行してインストールするよう選択し、Visual Studio を再起動します。

1. メニュー バーで **[ファイル]** > **[最近使ったプロジェクトとソリューション]** の順に選択し、プロジェクトを選択して再び開きます。

1. メニュー バーで、[**新** > **しい** > **プロジェクト**] を選択して[**新しいプロジェクト**]ダイアログ ボックスを開きます。 次に、ダイアログ ボックスの左側のペインで、[**インストールされている** > **その他のプロジェクトの種類]** ノードを展開し **、[Visual Studio インストーラー**] を選択します。 中央のウィンドウで、**[Setup Project]\(セットアップ プロジェクト\)** を選択します。

1. **[名前]** ボックスにセットアップ プロジェクトの名前を入力します。 **[ソリューション]** ドロップダウン リストで **[ソリューションに追加]** をクリックします。 **[OK]** をクリックすると、セットアップ プロジェクトが作成されます。 **[File Assistant (ProjectName)]/(ファイル アシスタント (<プロジェクト名>)/)** タブがエディター ウィンドウで開きます。

::: moniker-end

::: moniker range="=vs-2015"

### <a name="to-create-the-project-in-visual-studio-2015"></a>プロジェクトを作成するには、Visual Studio 2015

1. 新しいプロジェクトを作成します。 **[ファイル]** メニューの **[新規作成]** をポイントし、 **[プロジェクト]** をクリックします。

1. MFC**アプリケーション ウィザード**を使用して、新しい Visual Studio ソリューションを作成します。 ウィザードを見つけるには、**[新しいプロジェクト]** ダイアログ ボックスで、**Visual C++** ノードを展開し、**[MFC]**、**[MFC アプリケーション]** の順に選択して、プロジェクトの名前を入力し、**[OK]** をクリックします。 **[完了]** をクリックします。

   > [!NOTE]
   > MFC**アプリケーション**の種類が見つからない場合は、[Windows のスタート] ボタンをクリックし、「**プログラムの追加」** と入力します。 結果の一覧からプログラムを開き、インストールされているプログラムの一覧で、Microsoft Visual Studio 2015 のインストールを見つけます。 これをダブルクリックし、**[変更]** を選択して、**[Visual C++]** で **[Microsoft Foundation Classes]** コンポーネントを選択します。

1. アクティブなソリューション構成を **[リリース**] に変更します。 [**ビルド**] メニューの [**構成マネージャー**] をクリックします。 **[構成マネージャー]** ダイアログ ボックスで、**[アクティブ ソリューション構成]** ドロップダウン ボックスの **[解放]** をクリックします。 **[閉じる]** をクリックします。

1. **Ctrl**+**Shift**+**B**キーを押してアプリケーションをビルドします。 または、**[ビルド]** メニューの **[ソリューションのビルド]** をクリックします。 アプリケーションをビルドすると、セットアップ プロジェクトでこの MFC アプリケーション プロジェクトの出力を使用できます。

1. まだ行っていない場合は、Visual Studio インストーラー プロジェクト拡張機能をダウンロードしてください。 この拡張機能は、Visual Studio 開発者向けの無料版であり、Visual Studio にセットアップおよび配置プロジェクト テンプレートの機能を追加するものです。 インターネットに接続したら、Visual Studio で [**ツール** > **の拡張機能と更新プログラム**] を選択します。 **[拡張機能と更新プログラム]** ダイアログ ボックスで **[オンライン]** タブを選択し、検索ボックスに「*Microsoft Visual Studio Installer Projects*」と入力します。 **Enter**キーを押して **、[Microsoft Visual Studio\<バージョン> インストーラー プロジェクト**] を選択し、[**ダウンロード**] をクリックします。 拡張機能を実行してインストールするよう選択し、Visual Studio を再起動します。

1. メニュー バーで **[ファイル]** > **[最近使ったプロジェクトとソリューション]** の順に選択し、プロジェクトを選択して再び開きます。

1. メニュー バーで、[**新** > **しい** > **プロジェクト**] を選択して[**新しいプロジェクト**]ダイアログ ボックスを開きます。 次に、ダイアログ ボックスの左側のペインで、[**インストールされている** > **その他のプロジェクトの種類]** ノードを展開し **、[Visual Studio インストーラー**] を選択します。 中央のウィンドウで、**[Setup Project]\(セットアップ プロジェクト\)** を選択します。

1. **[名前]** ボックスにセットアップ プロジェクトの名前を入力します。 **[ソリューション]** ドロップダウン リストで **[ソリューションに追加]** をクリックします。 **[OK]** をクリックすると、セットアップ プロジェクトが作成されます。 **[File Assistant (ProjectName)]/(ファイル アシスタント (<プロジェクト名>)/)** タブがエディター ウィンドウで開きます。

::: moniker-end

## <a name="add-items-to-the-project"></a>プロジェクトに項目を追加する

1. **[アプリケーション フォルダー]** ノードを右クリックし、**[追加]** > **[プロジェクト出力]** を選択して、**[プロジェクト出力グループの追加]** ダイアログ ボックスを開きます。 ダイアログ ボックスで **[プライマリ出力]** を選択し、**[OK]** をクリックします。 **[Primary Output from ProjectName (Active)]\(<プロジェクト名> (アクティブ) のプライマリ出力\)** という名前の新しい項目が表示されます。

1. **[アプリケーション フォルダー]** ノードを右クリックし、**[追加]** > **[アセンブリ]** を選択して、**[コンポーネントの選択]** ダイアログボックスを開きます。 「[再配布する DLL の決定](determining-which-dlls-to-redistribute.md)」の記事で説明されているように、プログラムで必要なすべての DLL を選択して追加します。

1. **[Primary Output from ProjectName (Active)]\(<プロジェクト名> (アクティブ) のプライマリ出力\)** 項目を選択し、**[Create Shortcut to Primary Output from ProjectName (Active)]\(<プロジェクト名> (アクティブ) のプライマリ出力へのショートカットを作成\)** を右クリックします。 **[Shortcut to Primary Output from ProjectName (Active)]\(<プロジェクト名> (アクティブ) のプライマリ出力へのショートカット\)** という名前の新しい項目が表示されます。 ショートカット項目の名前を変更し、ウィンドウの左側にある **[ユーザーのプログラム メニュー]** ノードに項目をドラッグ アンド ドロップすることもできます。

1. メニュー バーで、[**ビルド** > **構成マネージャー**] を選択します。 **[プロジェクト]** テーブルの **[ビルド]** 列で、配置プロジェクトのボックスをオンにします。 **[閉じる]** をクリックします。

1. メニュー バーで、[**ビルド** > **ソリューション**] を選択して、MFC プロジェクトと配置プロジェクトをビルドします。

1. ソリューション フォルダーで、配置プロジェクトからビルドされた setup.exe プログラムを見つけます。 このファイル (および .msi ファイル) をコピーして、アプリケーションとその必要なライブラリ ファイルを別のコンピューターにインストールできます。 Visual C ++ ライブラリがない 2 台目のコンピューターで、セットアップ プログラムを実行します。

## <a name="see-also"></a>関連項目

[展開の例](deployment-examples.md)<br/>
