---
description: 詳細については、「オートメーションサーバー」を参照してください。
title: オートメーション サーバー
ms.date: 11/04/2016
helpviewer_keywords:
- Automation servers
- COM components, Automation servers
- dispatch maps [MFC], Automation servers
- servers, Automation
ms.assetid: 523fd155-51ce-4f91-b986-b74bdbdd7d92
ms.openlocfilehash: e97bcf524b96e459cd1a3caddec7cdaf0c030962
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/11/2020
ms.locfileid: "97339827"
---
# <a name="automation-servers"></a>オートメーション サーバー

オートメーションを使用すると、アプリケーションが別のアプリケーションで実装されているオブジェクトを操作したり、オブジェクトを公開して操作できるようにしたりすることができます。 オートメーションサーバーは、(オートメーションオブジェクトと呼ばれる) プログラミング可能なオブジェクトを他のアプリケーション ( [オートメーションクライアント](automation-clients.md)と呼びます) に公開するアプリケーションです。 オートメーションサーバーは、オートメーションコンポーネントと呼ばれることもあります。

オートメーションオブジェクトを公開すると、クライアントは、サーバーによって使用可能になるオブジェクトや機能に直接アクセスして、特定のプロシージャを自動化できます。 この方法でオブジェクトを公開すると、他のアプリケーションに便利な機能をアプリケーションが提供する場合に便利です。 たとえば、ワードプロセッサではスペルチェック機能が公開され、他のプログラムで使用できるようになります。 オブジェクトの公開により、ベンダーは、他のアプリケーションの既製の機能を使用して、アプリケーションの機能を向上させることができます。

これらのオートメーションオブジェクトには、プロパティとメソッドが外部インターフェイスとして含まれています。 プロパティは、オートメーションオブジェクトの名前付き属性です。 プロパティは、C++ クラスのデータメンバーに似ています。 メソッドは、オートメーションオブジェクトに対して機能する関数です。 メソッドは、C++ クラスのパブリックメンバー関数に似ています。

> [!NOTE]
> プロパティは C++ データメンバーに似ていますが、直接アクセスすることはできません。 透過的なアクセスを提供するには、get/set メンバー関数のペアを使用してオートメーションオブジェクトに内部変数を設定し、それらにアクセスします。

共通の明確に定義されたインターフェイスを使用してアプリケーションの機能を公開することにより、さまざまなアプリケーション固有のマクロ言語ではなく、Microsoft Visual Basic のような単一の汎用プログラミング言語でアプリケーションを構築できるようになります。

## <a name="support-for-automation-servers"></a><a name="_core_support_for_automation_servers"></a> オートメーションサーバーのサポート

Visual C++ と MFC フレームワークは、オートメーションサーバーの広範なサポートを提供します。 自動化サーバーの作成に伴うオーバーヘッドの多くを処理するため、アプリケーションの機能に専念することができます。

オートメーションをサポートするためのフレームワークの主要なメカニズムはディスパッチマップです。これは、OLE のメソッドとプロパティを公開するために必要な宣言と呼び出しに展開される一連のマクロです。 一般的なディスパッチマップは次のようになります。

[!code-cpp[NVC_MFCAutomation#1](codesnippet/cpp/automation-servers_1.cpp)]

[クラスウィザード](reference/mfc-class-wizard.md)とクラスビューは、ディスパッチマップを維持するのに役立ちます。 新しいメソッドまたはプロパティをクラスに追加すると、Visual Studio によって、対応するまたはマクロが追加され `DISP_FUNCTION` `DISP_PROPERTY` ます。このパラメーターには、クラス名、メソッドまたはプロパティの外部名と内部名、およびデータ型を示すパラメーターがあります。

[ **クラスの追加** ] ダイアログボックスでは、オートメーションクラスの宣言と、それらのプロパティと操作の管理も簡略化されます。 [クラスの追加] ダイアログボックスを使用してクラスをプロジェクトに追加する場合は、その基本クラスを指定します。 基底クラスでオートメーションが可能な場合、[クラスの追加] ダイアログボックスには、新しいクラスがオートメーションをサポートする必要があるかどうかを指定するために使用するコントロールが表示されます。これは、"OLE 作成可能" (つまり、クラスのオブジェクトを COM クライアントからの要求に対して作成できるかどうか)、COM クライアントが使用

次に、[ **クラスの追加** ] ダイアログボックスで、指定した OLE 機能に適したマクロを含むクラス宣言が作成されます。 また、クラスのメンバー関数の実装のスケルトンコードも追加します。

MFC アプリケーションウィザードを使用すると、オートメーションサーバーアプリケーションを開始する際に必要な手順を簡略化できます。 **[高度な機能**] ページで [**オートメーション**] チェックボックスをオンにすると、MFC アプリケーションウィザードは、 `InitInstance` オートメーションオブジェクトを登録し、アプリケーションをオートメーションサーバーとして実行するために必要な呼び出しをアプリケーションの関数に追加します。

### <a name="what-do-you-want-to-do"></a>どうしたいんですか

- [オートメーションクライアントの詳細](automation-clients.md)

- [クラスの詳細についてはこちらを参照してください。](reference/ccmdtarget-class.md)

- [クラス COleDispatchDriver の詳細情報](reference/coledispatchdriver-class.md)

## <a name="see-also"></a>関連項目

[Automation](automation.md)<br/>
[MFC アプリケーションウィザード](reference/mfc-application-wizard.md)
