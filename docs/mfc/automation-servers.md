---
title: オートメーション サーバー
ms.date: 11/04/2016
helpviewer_keywords:
- Automation servers
- COM components, Automation servers
- dispatch maps [MFC], Automation servers
- servers, Automation
ms.assetid: 523fd155-51ce-4f91-b986-b74bdbdd7d92
ms.openlocfilehash: 391cb2f6ff5673296f40e21113e3a6510f71d475
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81370835"
---
# <a name="automation-servers"></a>オートメーション サーバー

オートメーションを使用すると、アプリケーションで別のアプリケーションに実装されているオブジェクトを操作したり、オブジェクトを公開して操作できるようになります。 オートメーション サーバーは、オートメーション オブジェクトと呼ばれる、他のアプリケーション ([オートメーション クライアント](../mfc/automation-clients.md)) に対してプログラム可能なオブジェクトを公開するアプリケーションです。 オートメーション サーバーは、オートメーション コンポーネントと呼ばれることもあります。

オートメーション オブジェクトを公開すると、クライアントは、サーバーが使用できるオブジェクトや機能に直接アクセスして、特定の手順を自動化できます。 この方法でオブジェクトを公開すると、アプリケーションが他のアプリケーションに役立つ機能を提供する場合に便利です。 たとえば、ワード プロセッサはスペル チェック機能を公開して、他のプログラムで使用できるようにすることができます。 オブジェクトの公開により、他のアプリケーションの既製の機能を使用して、ベンダーはアプリケーションの機能を向上させることができます。

これらのオートメーション オブジェクトには、プロパティとメソッドが外部インターフェイスとして含まれています。 プロパティは、オートメーション オブジェクトの名前付き属性です。 プロパティは、C++ クラスのデータ メンバーと似ています。 メソッドは、オートメーション オブジェクトを操作する関数です。 メソッドは、C++ クラスのパブリック メンバー関数に似ています。

> [!NOTE]
> プロパティは C++ のデータ メンバーに似ていますが、直接アクセスすることはできません。 透過的なアクセスを提供するには、オートメーション オブジェクトに、アクセスする get/set メンバー関数のペアを使用して内部変数を設定します。

オートメーションでは、共通の明確なインターフェイスを通じてアプリケーションの機能を公開することにより、アプリケーション固有の多様なマクロ言語ではなく、Microsoft Visual Basic のような単一の一般的なプログラミング言語でアプリケーションを構築できます。

## <a name="support-for-automation-servers"></a><a name="_core_support_for_automation_servers"></a>オートメーション サーバーのサポート

Visual C++ および MFC フレームワークは、オートメーション サーバーを広範囲にサポートします。 オートメーション サーバーの作成に伴うオーバーヘッドの多くを処理するため、アプリケーションの機能に集中できます。

オートメーションをサポートするためのフレームワークの主要なメカニズムは、ディスパッチ マップ、OLE のメソッドとプロパティを公開するために必要な宣言と呼び出しに展開するマクロのセットです。 典型的なディスパッチマップは次のようになります。

[!code-cpp[NVC_MFCAutomation#1](../mfc/codesnippet/cpp/automation-servers_1.cpp)]

[クラス ウィザード](reference/mfc-class-wizard.md)とクラス ビューは、ディスパッチ マップの管理を支援します。 新しいメソッドまたはプロパティをクラスに追加すると、クラス名、メソッドまたは`DISP_FUNCTION``DISP_PROPERTY`プロパティの外部名と内部名、およびデータ型を示すパラメーターを持つ対応するマクロまたはマクロが追加されます。

[**クラスの追加**] ダイアログ ボックスでは、オートメーション クラスの宣言と、そのプロパティと操作の管理も簡略化されます。 [クラスの追加] ダイアログ ボックスを使用してプロジェクトにクラスを追加する場合は、その基本クラスを指定します。 基本クラスでオートメーションが許可されている場合は、[クラスの追加] ダイアログ ボックスに、新しいクラスがオートメーションをサポートするかどうか、オートメーションをサポートするかどうかを指定するためのコントロール、"OLE 作成可能" かどうか (つまり、クラスのオブジェクトを COM クライアントからの要求で作成できるかどうか)、および使用する COM クライアントの外部名が表示されます。

次に、[**クラスの追加**] ダイアログ ボックスで、指定した OLE 機能に対応する適切なマクロを含むクラス宣言を作成します。 また、クラスのメンバー関数を実装するためのスケルトン コードも追加します。

MFC アプリケーション ウィザードを使用すると、オートメーション サーバー アプリケーションを一元的に取り除く手順が簡略化されます。 **[拡張機能**] ページで [**オートメーション**] チェック ボックスをオンにすると、MFC アプリケーション ウィザード`InitInstance`によって、オートメーション オブジェクトを登録し、アプリケーションをオートメーション サーバーとして実行するために必要な呼び出しがアプリケーションの関数に追加されます。

### <a name="what-do-you-want-to-do"></a>どうしたいんですか

- [オートメーション クライアントについて](../mfc/automation-clients.md)

- [クラス CCmdTarget の詳細](../mfc/reference/ccmdtarget-class.md)

- [クラスの詳細については、ドライバーを呼び出します。](../mfc/reference/coledispatchdriver-class.md)

## <a name="see-also"></a>関連項目

[オートメーション](../mfc/automation.md)<br/>
[MFC アプリケーション ウィザード](../mfc/reference/mfc-application-wizard.md)
