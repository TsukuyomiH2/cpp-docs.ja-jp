---
description: '詳細情報: MFC データベースアプリケーションの [ファイル] メニュー'
title: MFC データベース アプリケーションの [ファイル] メニュー
ms.date: 11/04/2016
helpviewer_keywords:
- File menu
- database applications [MFC], File menu commands
ms.assetid: 92dafb75-c1b3-4860-80a0-87a83bfc36f2
ms.openlocfilehash: d8d229ce9c53e7a79044af2de03778574c18e5dd
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/11/2020
ms.locfileid: "97335882"
---
# <a name="file-menu-in-an-mfc-database-application"></a>MFC データベース アプリケーションの [ファイル] メニュー

MFC データベースアプリケーションを作成し、シリアル化を使用しない場合、[ファイル] メニューの [開く]、[閉じる]、[保存]、[名前を付けて保存] コマンドをどのように解釈すればよいでしょうか。この質問のスタイルのガイドラインはありませんが、いくつかの提案を次に示します。

- [ファイル] メニューの [開く] コマンドを完全に削除します。

- 開いているコマンドを "データベースを開く" として解釈し、アプリケーションで認識されるデータソースの一覧をユーザーに表示します。

- 開いているコマンドを "open profile" として解釈します。 シリアル化されたファイルを開くために開いたままにしておきますが、ファイルを使用して、ユーザーの設定などの "ユーザープロファイル" 情報を含むシリアル化されたドキュメントを格納します。これには、ログイン ID (必要に応じてパスワードを除外する) や、最近使用したデータソースが含まれます。

MFC アプリケーションウィザードでは、ドキュメント関連の [ファイル] メニューコマンドを使用しないアプリケーションの作成がサポートされています。 [**データベースサポート**] ページで、**ファイルサポートのないデータベースビュー** を選択します。

ファイルメニューコマンドを特別な方法で解釈するには、ほとんどの場合、派生クラスで1つ以上のコマンドハンドラーをオーバーライドする必要があり `CWinApp` ます。 たとえば、 `OnFileOpen` (コマンドを実装する) を完全にオーバーライドして `ID_FILE_OPEN` "データベースを開く" という意味です。

- `OnFileOpen`フレームワークのコマンドの既定の実装は完全に置き換えられるため、の基本クラスのバージョンは呼び出さないでください。

- データソースを一覧表示するダイアログボックスを表示するには、代わりにハンドラーを使用します。 このようなダイアログを表示するに `CDatabase::OpenEx` は `CDatabase::Open` 、パラメーターに **NULL** を指定してまたはを呼び出します。 これにより、ユーザーのコンピューター上の使用可能なすべてのデータソースが表示される [ODBC] ダイアログボックスが開きます。

- 通常、データベースアプリケーションはドキュメント全体を保存するわけではないため、シリアル化されたドキュメントを使用してプロファイル情報を格納しない限り、保存して保存しておくことをお勧めします。 それ以外の場合は、"commit transaction" などのように保存コマンドを実装できます。 これらのコマンドをオーバーライドする方法の詳細については、「 [テクニカルノート 22](tn022-standard-commands-implementation.md) 」を参照してください。

## <a name="see-also"></a>関連項目

[シリアル化: シリアル化とデータベースの入力/出力](serialization-serialization-vs-database-input-output.md)
