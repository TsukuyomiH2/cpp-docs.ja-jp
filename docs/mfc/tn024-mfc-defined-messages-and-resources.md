---
title: 'テクニカル ノート 24: MFC で定義されているメッセージおよびリソース'
ms.date: 11/04/2016
helpviewer_keywords:
- resources [MFC]
- Windows messages [MFC], MFC-defined
- messages [MFC], MFC
- TN024
ms.assetid: c65353ce-8096-454b-ad22-1a7a1dd9a788
ms.openlocfilehash: 24bcacd46b839babe9c9c89facb1cc56d18c0ee5
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81370349"
---
# <a name="tn024-mfc-defined-messages-and-resources"></a>テクニカル ノート 24: MFC で定義されているメッセージおよびリソース

> [!NOTE]
> 次のテクニカル ノートは、最初にオンライン ドキュメントの一部とされてから更新されていません。 結果として、一部のプロシージャおよびトピックが最新でないか、不正になります。 最新の情報について、オンライン ドキュメントのキーワードで関係のあるトピックを検索することをお勧めします。

このノートでは、MFC で使用される Windows 内部メッセージとリソース形式について説明します。 ここでは、フレームワークの実装について説明し、アプリケーションのデバッグに役立ちます。 この情報はすべて正式にサポートされていませんが、この情報の一部を高度な実装に使用できます。

このノートには、MFC プライベート実装の詳細が含まれています。すべての内容は将来変更される可能性があります。 MFC プライベート Windows メッセージは、1 つのアプリケーションのスコープでのみ意味を持ちますが、システム全体のメッセージを含む将来的に変更されます。

MFC プライベート Windows メッセージとリソースの種類の範囲は、Microsoft Windows によって確保された予約済みの "システム" 範囲にあります。 現在、範囲内のすべての数値が使用されるわけではないので、将来、範囲内の新しい数値が使用される可能性があります。 現在使用されている番号は変更できます。

MFC プライベート Windows メッセージは、0x360->0x37F の範囲内です。

MFC プライベート リソースの種類は、0xF0 から >0xFF の範囲内にあります。

**MFC プライベート ウィンドウ メッセージ**

これらの Windows メッセージは、ウィンドウ オブジェクト間で比較的疎結合が必要で、C++ 仮想関数が適切でない C++ 仮想関数の代わりに使用されます。

これらのプライベート Windows メッセージと関連するパラメーター構造体は、MFC プライベート ヘッダー 'AFXPRIV で宣言されます。H'. このヘッダーを含むコードは、文書化されていない動作に依存している可能性があり、MFC の将来のバージョンで壊れる可能性があります。

まれにこれらのメッセージのいずれかを処理する必要がある場合は、ON_MESSAGEメッセージ マップ マクロを使用して、汎用 LRESULT/WPARAM/LPARAM 形式でメッセージを処理する必要があります。

**WM_QUERYAFXWNDPROC**

このメッセージは、作成中のウィンドウに送信されます。 これは、WndProc が AfxWndProc であるかどうかを判断するメソッドとして、作成プロセスの非常に早い段階で送信**されます。AfxWndProc は**1 を返します。

|||
|-|-|
|wParam|使用されていない|
|lParam|使用されていない|
|は、次の値は返します。|**AfxWndProc**によって処理された場合は 1|

**WM_SIZEPARENT**

このメッセージは、フレームの側面の周りのコントロール バーの位置を`CFrameWnd::OnSize`変更`CFrameWnd::RecalcLayout`するサイズ`CWnd::RepositionBars`変更 ( 呼び出し ) の間に、フレーム ウィンドウによって直接の子に送信されます。 AFX_SIZEPARENTPARAMS構造体には、現在使用可能な親のクライアント四角形と、再描画を最小限に抑えるために呼び出`DeferWindowPos`す HDWP (NULL の場合があります) が含まれています。

|||
|-|-|
|wParam|使用されていない|
|lParam|AFX_SIZEPARENTPARAMS構造体のアドレス|
|は、次の値は返します。|使用しない (0)|

メッセージを無視すると、ウィンドウがレイアウトに含まれていないことを示します。

**WM_SETMESSAGESTRING**

このメッセージはフレーム ウィンドウに送信され、ステータス バーのメッセージ行を更新するように要求されます。 ストリング ID または LPCSTR のいずれかを指定できます (両方を指定することはできません)。

|||
|-|-|
|wParam|文字列 ID (またはゼロ)|
|lParam|文字列の LPCSTR (または NULL)|
|は、次の値は返します。|使用しない (0)|

**WM_IDLEUPDATECMDUI**

このメッセージは、更新コマンド UI ハンドラーのアイドル時間更新を実装するためにアイドル時間内に送信されます。 ウィンドウ (通常はコントロール バー) がメッセージを処理する場合`CCmdUI`、ウィンドウ内の各 "項目" を呼`CCmdUI::DoUpdate`び出すオブジェクト (または派生クラスのオブジェクト) が作成されます。 これにより、コマンド ハンドラー チェーン内のオブジェクトのON_UPDATE_COMMAND_UI ハンドラーがチェックされます。

|||
|-|-|
|wParam|ブール・ブ・ビディブ・ノーハンドラー|
|lParam|使用しない (0)|
|は、次の値は返します。|使用しない (0)|

*bDisableIfNoHandler*は、ON_UPDATE_COMMAND_UIもON_COMMAND ハンドラーもない場合に UI オブジェクトを無効にする 0 以外です。

**WM_EXITHELPMODE**

このメッセージは、状況依存ヘルプ`CFrameWnd`モードを終了する にポストされます。 このメッセージの受信は、 によって開始されたモーダル`CFrameWnd::OnContextHelp`ループを終了します。

|||
|-|-|
|wParam|使用しない (0)|
|lParam|使用しない (0)|
|は、次の値は返します。|使用されていない|

**WM_INITIALUPDATE**

このメッセージは、ドキュメント テンプレートによってフレーム ウィンドウのすべての子孫に送信されます。 呼び出しにマップ`CView::OnInitialUpdate`されますが、他のワンショット`CWnd`更新用の他の派生クラスで使用できます。

|||
|-|-|
|wParam|使用しない (0)|
|lParam|使用しない (0)|
|は、次の値は返します。|使用しない (0)|

**WM_RECALCPARENT**

このメッセージは、ビューによってその親ウィンドウ (を介して`GetParent`取得) に送信され、レイアウト再計算を強制的に行います`RecalcLayout`(通常、親は呼び出します)。 この値は、ビューの合計サイズが大きくなるにつれてフレームのサイズが大きくなるようにする必要がある OLE サーバー アプリケーションで使用されます。

親ウィンドウがこのメッセージを処理する場合は TRUE を返し、クライアント領域の新しいサイズで lParam で渡された RECT を埋める必要があります。 これは、サーバー`CScrollView`オブジェクトが埋め込みオブジェクトがアクティブになったときにスクロール バーを適切に処理するために使用されます (追加されたときに、ウィンドウの外側に配置します)。

|||
|-|-|
|wParam|使用しない (0)|
|lParam|LPRECT レクト クライアント、 NULL の可能性があります。|
|は、次の値は返します。|新しいクライアントの四角形が返された場合は TRUE、それ以外の場合は FALSE|

**WM_SIZECHILD**

このメッセージは、ユーザー`COleResizeBar`がサイズ変更ハンドルを使用`GetOwner`してサイズ変更バーのサイズを変更したときに、その所有者ウィンドウに (を介して) 送信されます。 `COleIPFrameWnd`ユーザーが要求したとおりにフレーム ウィンドウの位置を変更して、このメッセージに応答します。

サイズ変更バーを含むフレーム ウィンドウに対する相対的なクライアント座標で指定された新しい四角形は、lParam によって指されます。

|||
|-|-|
|wParam|使用しない (0)|
|lParam|Lプレクトレクトニュー|
|は、次の値は返します。|使用しない (0)|

**WM_DISABLEMODAL**

このメッセージは、非アクティブ化されているフレーム ウィンドウが所有するすべてのポップアップ ウィンドウに送信されます。 フレーム ウィンドウは、結果を使用して、ポップアップ ウィンドウを無効にするかどうかを決定します。

これを使用して、フレームがモーダル状態になったときにポップアップ ウィンドウで特別な処理を実行したり、特定のポップアップ ウィンドウが無効にならないようにすることができます。 ツールヒントは、フレーム ウィンドウがモーダル状態になったときなどに、このメッセージを使用して自分自身を破棄します。

|||
|-|-|
|wParam|使用しない (0)|
|lParam|使用しない (0)|
|は、次の値は返します。|0 以外の**場合**はウィンドウを無効にしますが、0 はウィンドウが無効になることを示します。|

**WM_FLOATSTATUS**

このメッセージは、フレームが別の最上位フレーム ウィンドウによってアクティブ化または非アクティブ化されたときに、フレーム ウィンドウが所有するすべてのポップアップ ウィンドウに送信されます。 これは、 の`CMiniFrameWnd`MFS_SYNCACTIVE の実装で使用され、これらのポップアップ ウィンドウのアクティブ化と最上位フレーム ウィンドウのアクティブ化との同期を維持します。

|||
|-|-|
|wParam|次のいずれかの値です。<br /><br /> FS_SHOW<br /><br /> FS_HIDE<br /><br /> FS_ACTIVATE<br /><br /> FS_DEACTIVATE<br /><br /> FS_ENABLEFS_DISABLE<br /><br /> FS_SYNCACTIVE|
|lParam|使用しない (0)|

FS_SYNCACTIVE設定されている場合、ウィンドウが親フレームとアクティブ化を同期する場合は、戻り値は 0 以外にする必要があります。 `CMiniFrameWnd`スタイルがMFS_SYNCACTIVEに設定されている場合は、ゼロ以外を返します。

詳細については、「 」の`CMiniFrameWnd`実装を参照してください。

## <a name="wm_activatetoplevel"></a>WM_ACTIVATETOPLEVEL

このメッセージは、その「最上位グループ」のウィンドウがアクティブまたは非アクティブになったときに、トップレベルウィンドウに送信されます。 トップレベル ウィンドウ (親または所有者なし) の場合、またはトップレベル ウィンドウが所有している場合、ウィンドウは最上位グループの一部です。 このメッセージは、WM_ACTIVATEAPP使用する場合と似ていますが、異なるプロセスに属するウィンドウが単一のウィンドウ階層 (OLE アプリケーションで一般的) に混在している状況で機能します。

## <a name="wm_commandhelp-wm_helphittest-wm_exithelpmode"></a>WM_COMMANDHELP、WM_HELPHITTEST、WM_EXITHELPMODE

これらのメッセージは、状況依存ヘルプの実装で使用されます。 詳細については[、テクニカル ノート 28](../mfc/tn028-context-sensitive-help-support.md)を参照してください。

## <a name="mfc-private-resource-formats"></a>MFC プライベート リソース形式

現在、MFC では、RT_TOOLBARとRT_DLGINITの 2 つのプライベート リソース形式が定義されています。

## <a name="rt_toolbar-resource-format"></a>リソースの形式RT_TOOLBAR

AppWizard によって提供される既定のツール バーは、MFC 4.0 で導入されたRT_TOOLBARカスタム リソースに基づいています。 このリソースは、ツールバーエディタを使用して編集できます。

## <a name="rt_dlginit-resource-format"></a>RT_DLGINITリソース形式

1 つの MFC プライベート リソース形式は、余分なダイアログ初期化情報を格納するために使用されます。 これには、コンボ ボックスに格納されている最初の文字列も含まれます。 このリソースの形式は、手動で編集するようには設計されていませんが、Visual C++ で処理されます。

Visual C++ およびこのRT_DLGINIT リソースは、リソース内の情報を使用する代わりに API が用意されているため、MFC の関連機能を使用する必要はありません。 Visual C++ を使用すると、アプリケーションの記述、保守、および翻訳が、長期的にはるかに簡単になります。

RT_DLGINITリソースの基本構造は次のとおりです。

```
+---------------+    \
| Control ID    |   UINT             |
+---------------+    |
| Message #     |   UINT             |
+---------------+    |
|length of data |   DWORD            |
+---------------+    |   Repeated
|   Data        |   Variable Length  |   for each control
|   ...         |   and Format       |   and message
+---------------+    /
|     0         |   BYTE
+---------------+
```

繰り返しセクションには、メッセージを送信するコントロール ID、送信するメッセージ # (通常の Windows メッセージ) と可変長のデータが含まれます。 Windows メッセージは次の形式で送信されます。

```
SendDlgItemMessage(<Control ID>, <Message #>, 0, &<Data>);
```

これは非常に一般的な形式で、Windows メッセージとデータコンテンツを許可します。 Visual C++ リソース エディターと MFC では、コンボ ボックスの初期リスト選択用の CB_ADDSTRING (データはテキスト文字列) の Windows メッセージの限定されたサブセットのみがサポートされます。

## <a name="see-also"></a>関連項目

[番号順テクニカル ノート](../mfc/technical-notes-by-number.md)<br/>
[カテゴリ別テクニカル ノート](../mfc/technical-notes-by-category.md)
