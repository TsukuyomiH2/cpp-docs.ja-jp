---
description: '詳細については、「テクニカルノート 48: MFC データベースアプリケーション用の ODBC セットアップおよび管理プログラムの作成」を参照してください。'
title: 'テクニカル ノート 48: MFC データベース アプリケーション用の ODBC セットアップおよび管理プログラムの作成'
ms.date: 11/04/2016
helpviewer_keywords:
- installing ODBC
- ODBC, installing
- setup, ODBC setup programs
- TN048
- ODBC, and MFC
- MFC, database applications
ms.assetid: d456cdd4-0513-4a51-80c0-9132b66115ce
ms.openlocfilehash: bca8616bae8f7243b9e66b2eccc980afa3865842
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/11/2020
ms.locfileid: "97215106"
---
# <a name="tn048-writing-odbc-setup-and-administration-programs-for-mfc-database-applications"></a>テクニカル ノート 48: MFC データベース アプリケーション用の ODBC セットアップおよび管理プログラムの作成

> [!NOTE]
> 次のテクニカル ノートは、最初にオンライン ドキュメントの一部とされてから更新されていません。 結果として、一部のプロシージャおよびトピックが最新でないか、不正になります。 最新の情報について、オンライン ドキュメントのキーワードで関係のあるトピックを検索することをお勧めします。

MFC データベースクラスを使用するアプリケーションには、ODBC コンポーネントをインストールするセットアッププログラムが必要です。 また、既定のドライバーを指定し、データソースを構成するために、使用可能なドライバーに関する情報を取得する ODBC 管理プログラムが必要な場合もあります。 このメモでは、ODBC インストーラー API を使用してこれらのプログラムを記述する方法について説明します。

## <a name="writing-an-odbc-setup-program"></a><a name="_mfcnotes_writing_an_odbc_setup_program"></a> ODBC セットアッププログラムの作成

MFC データベースアプリケーションでは、ODBC ドライバーマネージャー (ODBC.DLL) と ODBC ドライバーを使用してデータソースにアクセスできるようにする必要があります。 多くの ODBC ドライバーでは、追加のネットワークと通信 Dll も必要です。 ほとんどの ODBC ドライバーには、必要な ODBC コンポーネントをインストールするセットアッププログラムが付属しています。 MFC データベースクラスを使用するアプリケーション開発者は、次のことができます。

- ODBC コンポーネントをインストールするには、ドライバー固有のセットアッププログラムに依存します。 これにより開発者の作業は不要になります。ドライバーのセットアッププログラムを再配布するだけで済みます。

- または、独自のセットアッププログラムを作成することもできます。これにより、ドライバーマネージャーとドライバーがインストールされます。

ODBC インストーラー API を使用して、アプリケーション固有のセットアッププログラムを作成できます。 インストーラー API の関数は、ODBC インストーラー DLL によって実装されます。これは、16ビットの Windows では ODBCINST.DLL、Win32 では ODBCCP32.DLL です。 アプリケーションは、インストーラー DLL でを呼び出すことができます `SQLInstallODBC` 。これにより、odbc ドライバーマネージャー、odbc ドライバー、および必要な変換プログラムがインストールされます。 次に、インストールされているドライバーと翻訳者を ODBCINST.INI ファイル (またはレジストリの NT) に記録します。 `SQLInstallODBC` ODBC への完全なパスが必要です。INF ファイル。インストールするドライバーの一覧と、各ドライバーが構成されているファイルについて説明します。 また、ドライバーマネージャーおよび翻訳者に関する同様の情報も含まれています。 ドライバー.INF ファイルは、通常、ドライバーの開発者によって提供されます。

プログラムでは、個々の ODBC コンポーネントをインストールすることもできます。 ドライバーマネージャーをインストールするために、プログラムはまずインストーラー DLL を呼び出して、 `SQLInstallDriverManager` ドライバーマネージャーのターゲットディレクトリを取得します。 通常、これは Windows Dll が存在するディレクトリです。 その後、プログラムは ODBC の [ODBC Driver Manager] セクションの情報を使用します。ドライバーマネージャーと関連ファイルをインストールディスクからこのディレクトリにコピーする INF ファイル。 個々のドライバーをインストールするために、プログラムはまずインストーラー DLL を呼び出して、 `SQLInstallDriver` ドライバーの仕様を ODBCINST.INI ファイル (または NT 上のレジストリ) に追加します。 `SQLInstallDriver` ドライバーのターゲットディレクトリ (通常は Windows Dll が存在するディレクトリ) を返します。 その後、プログラムは ODBC のドライバーのセクションにある情報を使用します。ドライバー DLL および関連ファイルをインストールディスクからこのディレクトリにコピーする INF ファイル。

ODBC の詳細については、「」を参照してください。INF、ODBCINST.INI およびインストーラー API の使用方法については、「ODBC SDK *プログラマーズリファレンス、* 19 章」、「odbc ソフトウェアのインストール」を参照してください。

## <a name="writing-an-odbc-administrator"></a><a name="_mfcnotes_writing_an_odbc_administrator"></a> ODBC 管理者の作成

MFC データベースアプリケーションでは、次の2つの方法のいずれかで ODBC データソースの設定と構成を行うことができます。

- ODBC 管理者を使用します (プログラムまたはコントロールパネルの項目として使用できます)。

- 独自のプログラムを作成して、データソースを構成します。

データソースを構成するプログラムによって、インストーラー DLL の関数呼び出しが行われます。 インストーラー DLL は、セットアップ DLL を呼び出して、データソースを構成します。 ドライバーごとに1つのセットアップ DLL があります。ドライバー DLL 自体、または別の DLL を指定できます。 セットアップ DLL は、データソースに接続するためにドライバーが必要とする情報と、既定の変換元 (サポートされている場合) をユーザーに要求します。 次に、インストーラー DLL と Windows Api を呼び出して、この情報を ODBC.INI ファイル (またはレジストリ) に記録します。

ユーザーがデータソースを追加、変更、および削除できるダイアログボックスを表示するには、プログラムが `SQLManageDataSources` インストーラー DLL でを呼び出します。 この関数は、コントロールパネルからインストーラー DLL が呼び出されたときに呼び出されます。 データソースを追加、変更、または削除するには、 `SQLManageDataSources` `ConfigDSN` そのデータソースに関連付けられているドライバーのセットアップ DLL でを呼び出します。 データソースを直接追加、変更、または削除するために、プログラムは `SQLConfigDataSource` インストーラー DLL でを呼び出します。 プログラムは、データソースの名前と、実行するアクションを指定するオプションを渡します。 `SQLConfigDataSource``ConfigDSN`セットアップ DLL 内でを呼び出し、から引数を渡し `SQLConfigDataSource` ます。

詳細については、「ODBC SDK *プログラマーズリファレンス」、* 「chapter 23」、「セットアップ Dll 関数リファレンス」、および「インストーラー DLL 関数リファレンス」を参照してください。

## <a name="see-also"></a>関連項目

[番号別テクニカルノート](../mfc/technical-notes-by-number.md)<br/>
[カテゴリ別テクニカルノート](../mfc/technical-notes-by-category.md)
