---
title: 'テクニカル ノート 48: MFC データベース アプリケーション用の ODBC セットアップおよび管理プログラムの作成'
ms.date: 11/04/2016
helpviewer_keywords:
- installing ODBC
- ODBC, installing
- setup, ODBC setup programs
- TN048
- ODBC, and MFC
- MFC, database applications
ms.assetid: d456cdd4-0513-4a51-80c0-9132b66115ce
ms.openlocfilehash: d25520c4ffc805701dfe6b51192f8078e2fa300f
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81365481"
---
# <a name="tn048-writing-odbc-setup-and-administration-programs-for-mfc-database-applications"></a>テクニカル ノート 48: MFC データベース アプリケーション用の ODBC セットアップおよび管理プログラムの作成

> [!NOTE]
> 次のテクニカル ノートは、最初にオンライン ドキュメントの一部とされてから更新されていません。 結果として、一部のプロシージャおよびトピックが最新でないか、不正になります。 最新の情報について、オンライン ドキュメントのキーワードで関係のあるトピックを検索することをお勧めします。

MFC データベース クラスを使用するアプリケーションには、ODBC コンポーネントをインストールするセットアップ プログラムが必要です。 また、使用可能なドライバに関する情報を取得し、既定のドライバを指定し、データ ソースを構成する ODBC 管理プログラムが必要になる場合もあります。 このメモでは、これらのプログラムを作成する ODBC インストーラー API の使用について説明します。

## <a name="writing-an-odbc-setup-program"></a><a name="_mfcnotes_writing_an_odbc_setup_program"></a>ODBC セットアップ プログラムの作成

MFC データベース アプリケーションには、ODBC ドライバー マネージャー (ODBC.データ ソースにアクセスするための DLL) と ODBC ドライバ。 多くの ODBC ドライバでは、追加のネットワーク DLL と通信 DLL も必要です。 ほとんどの ODBC ドライバーは、必要な ODBC コンポーネントをインストールするセットアップ プログラムに付属しています。 MFC データベース クラスを使用するアプリケーション開発者は、次のことができます。

- ODBC コンポーネントをインストールする場合は、ドライバー固有のセットアップ プログラムを使用します。 これは、開発者側での作業を必要としません- ドライバーのセットアップ プログラムを再配布するだけです。

- または、独自のセットアップ プログラムを作成して、ドライバー マネージャーとドライバーをインストールすることもできます。

ODBC インストーラー API を使用して、アプリケーション固有のセットアップ プログラムを作成できます。 インストーラー API の関数は、ODBC インストーラー DLL ODBCINST によって実装されます。16 ビット Windows および ODBCCP32 の DLL。Win32 の DLL。 アプリケーションは、ODBC`SQLInstallODBC`ドライバー マネージャー、ODBC ドライバー、および必要な変換プログラムをインストールするインストーラー DLL を呼び出すことができます。 次に、インストールされているドライバと変換プログラムを ODBCINST に記録します。INI ファイル (NT 上のレジストリ) `SQLInstallODBC`には ODBC へのフル パスが必要です。INF ファイルには、インストールするドライバーの一覧と、各ドライバーを構成するファイルが記述されています。 また、ドライバー マネージャーと変換プログラムに関する同様の情報も含まれています。 Odbc。INF ファイルは、通常、ドライバーの開発者によって提供されます。

プログラムは、個々の ODBC コンポーネントをインストールすることもできます。 ドライバー マネージャーをインストールするには、プログラムは、`SQLInstallDriverManager`ドライバー マネージャーのターゲット ディレクトリを取得するインストーラー DLL で最初に呼び出します。 通常、これは Windows DLL が存在するディレクトリです。 その後、プログラムは ODBC の [ODBC ドライバー マネージャー] セクションの情報を使用します。INF ファイルを使用して、ドライバ マネージャと関連ファイルをインストール ディスクからこのディレクトリにコピーします。 個々のドライバーをインストールするには、プログラムは、`SQLInstallDriver`まず、ODBCINST にドライバーの仕様を追加するインストーラー DLL を呼び出します。INI ファイル (NT 上のレジストリ) `SQLInstallDriver`は、ドライバのターゲット ディレクトリ (通常は Windows DLL が存在するディレクトリ) を返します。 その後、プログラムは ODBC のドライバーのセクションの情報を使用します。インストール ディスクからこのディレクトリにドライバー DLL と関連ファイルをコピーする INF ファイル。

ODBC の詳細については、次の参照を参照してください。インフ、ODBCINST。INI とインストーラー API を使用して、ODBC SDK*プログラマ リファレンス、* 第 19 章、 ODBC ソフトウェアのインストールを参照してください。

## <a name="writing-an-odbc-administrator"></a><a name="_mfcnotes_writing_an_odbc_administrator"></a>ODBC アドミニストレータの作成

MFC データベース アプリケーションは、次の 2 つの方法のいずれかで ODBC データ ソースを設定および構成できます。

- ODBC アドミニストレータ (プログラムまたはコントロール パネルの項目として使用できます) を使用します。

- 独自のプログラムを作成して、データ ソースを構成します。

データ ソースを構成するプログラムは、インストーラー DLL に関数呼び出しを行います。 インストーラー DLL は、セットアップ DLL を呼び出してデータ ソースを構成します。 各ドライバに対して 1 つのセットアップ DLL があります。ドライバ DLL 自体、または別の DLL である可能性があります。 セットアップ DLL は、ドライバーがデータ ソースと、サポートされている場合は、既定のトランスレータに接続する必要がある情報をユーザーに求めます。 次に、インストーラー DLL と Windows API を呼び出して、この情報を ODBC に記録します。INI ファイル (またはレジストリ)

ユーザーがデータ ソースを追加、変更、および削除できるダイアログ ボックスを表示するには、プログラムが`SQLManageDataSources`インストーラー DLL で呼び出します。 この関数は、コントロール パネルからインストーラー DLL が呼び出されたときに呼び出されます。 データ ソースを追加、変更、または削除するには`SQLManageDataSources`、`ConfigDSN`そのデータ ソースに関連付けられているドライバーのセットアップ DLL を呼び出します。 データ ソースを直接追加、変更、または削除するには、プログラム`SQLConfigDataSource`がインストーラー DLL で呼び出します。 プログラムは、データ・ソースの名前と、実行するアクションを指定するオプションを渡します。 `SQLConfigDataSource`セットアップ`ConfigDSN`DLL を呼び出し、その`SQLConfigDataSource`DLL から引数を渡します。

詳細については、ODBC SDK*プログラマ リファレンス、* 第 23 章 DLL 関数のセットアップ リファレンス、および 24 章 の「インストーラ DLL 関数リファレンス」を参照してください。

## <a name="see-also"></a>関連項目

[番号順テクニカル ノート](../mfc/technical-notes-by-number.md)<br/>
[カテゴリ別テクニカル ノート](../mfc/technical-notes-by-category.md)
