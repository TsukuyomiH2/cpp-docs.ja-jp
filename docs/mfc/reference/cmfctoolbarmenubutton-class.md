---
title: CMFCToolBarMenuButton クラス
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CompareWith
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CopyFrom
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateFromMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::EnableQuickCustomize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetCommands
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetImageRect
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPaletteRows
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HasButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HaveHotBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsClickedOnMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsDroppedDown
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsEmptyMenuAllowed
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsExclusive
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsQuickMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsTearOffMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnAfterCreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnBeforeDrag
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCalculateSize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCancelMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnChangeParentWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClick
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClickMenuItem
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnContextHelp
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDraw
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDrawOnCustomizeList
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OpenPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::ResetImageToDefault
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SaveBarState
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::Serialize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetACCData
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuOnly
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMessageWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetRadio
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetTearOff
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::DrawDocumentIcon
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw
helpviewer_keywords:
- CMFCToolBarMenuButton [MFC], CMFCToolBarMenuButton
- CMFCToolBarMenuButton [MFC], CompareWith
- CMFCToolBarMenuButton [MFC], CopyFrom
- CMFCToolBarMenuButton [MFC], CreateFromMenu
- CMFCToolBarMenuButton [MFC], CreateMenu
- CMFCToolBarMenuButton [MFC], CreatePopupMenu
- CMFCToolBarMenuButton [MFC], EnableQuickCustomize
- CMFCToolBarMenuButton [MFC], GetCommands
- CMFCToolBarMenuButton [MFC], GetImageRect
- CMFCToolBarMenuButton [MFC], GetPaletteRows
- CMFCToolBarMenuButton [MFC], GetPopupMenu
- CMFCToolBarMenuButton [MFC], HasButton
- CMFCToolBarMenuButton [MFC], HaveHotBorder
- CMFCToolBarMenuButton [MFC], IsBorder
- CMFCToolBarMenuButton [MFC], IsClickedOnMenu
- CMFCToolBarMenuButton [MFC], IsDroppedDown
- CMFCToolBarMenuButton [MFC], IsEmptyMenuAllowed
- CMFCToolBarMenuButton [MFC], IsExclusive
- CMFCToolBarMenuButton [MFC], IsMenuPaletteMode
- CMFCToolBarMenuButton [MFC], IsQuickMode
- CMFCToolBarMenuButton [MFC], IsTearOffMenu
- CMFCToolBarMenuButton [MFC], OnAfterCreatePopupMenu
- CMFCToolBarMenuButton [MFC], OnBeforeDrag
- CMFCToolBarMenuButton [MFC], OnCalculateSize
- CMFCToolBarMenuButton [MFC], OnCancelMode
- CMFCToolBarMenuButton [MFC], OnChangeParentWnd
- CMFCToolBarMenuButton [MFC], OnClick
- CMFCToolBarMenuButton [MFC], OnClickMenuItem
- CMFCToolBarMenuButton [MFC], OnContextHelp
- CMFCToolBarMenuButton [MFC], OnDraw
- CMFCToolBarMenuButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarMenuButton [MFC], OpenPopupMenu
- CMFCToolBarMenuButton [MFC], ResetImageToDefault
- CMFCToolBarMenuButton [MFC], SaveBarState
- CMFCToolBarMenuButton [MFC], Serialize
- CMFCToolBarMenuButton [MFC], SetACCData
- CMFCToolBarMenuButton [MFC], SetMenuOnly
- CMFCToolBarMenuButton [MFC], SetMenuPaletteMode
- CMFCToolBarMenuButton [MFC], SetMessageWnd
- CMFCToolBarMenuButton [MFC], SetRadio
- CMFCToolBarMenuButton [MFC], SetTearOff
- CMFCToolBarMenuButton [MFC], DrawDocumentIcon
- CMFCToolBarMenuButton [MFC], m_bAlwaysCallOwnerDraw
ms.assetid: cfa50176-7e4b-4527-9904-86a1b48fc1bc
ms.openlocfilehash: 418ef29657271010c3a12f0f15a12f45e5351aac
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81376170"
---
# <a name="cmfctoolbarmenubutton-class"></a>CMFCToolBarMenuButton クラス

ポップアップ メニューを含むツール バー ボタンです。
詳細については、Visual Studio のインストールの**\\VC\\atlmfc\\src mfc**フォルダーにあるソース コードを参照してください。

## <a name="syntax"></a>構文

```
class CMFCToolBarMenuButton : public CMFCToolBarButton
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[メニューボタン::CMFCツールバーメニューボタン](#cmfctoolbarmenubutton)|`CMFCToolBarMenuButton` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[メニューボタン::比較と比較](#comparewith)|このインスタンスを指定された`CMFCToolBarButton`オブジェクトと比較します。 (オーバーライド[CMFCツールバーボタン::比較と共に](../../mfc/reference/cmfctoolbarbutton-class.md#comparewith).)|
|[メニューボタン::コピーから](#copyfrom)|別のツール バー ボタンのプロパティを現在のボタンにコピーします。 [(CMFCツールバーボタンをオーバーライドします。.](../../mfc/reference/cmfctoolbarbutton-class.md#copyfrom)|
|[メニューボタン::メニューから作成します。](#createfrommenu)|Windows のメニュー ハンドルからツール バー メニューを初期化します。|
|[メニューメニューボタン::メニューの作成](#createmenu)|ツール バー メニューのコマンドで構成される Windows メニューを作成します。 Windows メニューへのハンドルを返します。|
|[メニューボタン::ポップアップメニュー](#createpopupmenu)|ポップアップ メニュー オブジェクト ( [CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)) を作成して、ツール バー メニューを表示します。|
|[メニューボタン::クイックカスタマイズを有効にする](#enablequickcustomize)||
|[メニューボタン::コマンドを取得します。](#getcommands)|ツール バー メニューのコマンドの一覧に対する読み取り専用アクセスを提供します。|
|[メニューボタン::イメージレック](#getimagerect)|ボタン イメージの外接する四角形を取得します。|
|[メニューボタン::パレット行を取得します。](#getpaletterows)|メニューがパレット モードの場合に、ポップアップ メニューの行数を返します。|
|[メニューボタン::ゲットポップアップメニュー](#getpopupmenu)|ボタンに関連付けられているポップアップ メニュー オブジェクトへのポインターを返します。|
|[メニューボタン::ハズボタン](#hasbutton)||
|[メニューボタン::フトボーダー](#havehotborder)|ユーザーがボタンを選択したときにボタンの境界線を表示するかどうかを指定します。 [(CMFCツールバーボタンをオーバーライドします::フアホボーダー](../../mfc/reference/cmfctoolbarbutton-class.md#havehotborder).)|
|[メニューボタン::イズボーダー](#isborder)||
|[メニューボタン::クリックオンメニュー](#isclickedonmenu)||
|[メニューボタン::ディスドロップダウン](#isdroppeddown)|ポップアップ メニューを表示するかどうかを指定します。|
|[メニューボタン::IsEmptyメニューを許可](#isemptymenuallowed)|ユーザーが選択したメニュー項目からサブメニューを開くことができるかどうかを判断するために、フレームワークによって呼び出されます。|
|[メニューボタン::イエクスクルーシブ](#isexclusive)|ボタンが排他モードになっているかどうか、つまり、ユーザーが別のツールバーまたはボタンにポインターを移動しても、ポップアップ メニューを開いたままにするかどうかを指定します。|
|[メニューボタン::メニューパレットモード](#ismenupalettemode)|ポップアップメニューがパレットモードかどうかを指定します。|
|[メニューボタン::IsQuickモード](#isquickmode)||
|[メニューメニュー::イステアオフメニュー](#istearoffmenu)|ポップアップ メニューにティアオフ バーがあるかどうかを判断します。|
|[メニューボタン::後にポップアップメニュー](#onaftercreatepopupmenu)||
|[メニューボタン::オン・アフォアドラグ](#onbeforedrag)|ボタンをドラッグできるかどうかを指定します。 [(CMFCツールバーボタンをオーバーライドします。.](../../mfc/reference/cmfctoolbarbutton-class.md#onbeforedrag)|
|[メニューボタン::計算サイズ](#oncalculatesize)|指定したデバイス コンテキストとドッキング状態のボタンのサイズを計算するために、フレームワークによって呼び出されます。 [(CMFCツールバーボタンをオーバーライドします::計算サイズ](../../mfc/reference/cmfctoolbarbutton-class.md#oncalculatesize).)|
|[メニューボタン::キャンセルモード](#oncancelmode)|[WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode)メッセージを処理するために、フレームワークによって呼び出されます。 ([オーバーライドします。](../../mfc/reference/cmfctoolbarbutton-class.md#oncancelmode)|
|[メニューボタン::オンチェンジペアレント](#onchangeparentwnd)|ボタンが新しいツール バーに挿入されたときに、フレームワークによって呼び出されます。 (オーバーライド[CMFCツールバーボタン::オンチェンジペアレントウンド](cmfctoolbarbutton-class.md#onchangeparentwnd).)|
|[クリック時ボタン::クリック時](#onclick)|ユーザーがマウス ボタンをクリックしたときに、フレームワークによって呼び出されます。 [(CMFCツールバーボタンをオーバーライドします。:クリック時](../../mfc/reference/cmfctoolbarbutton-class.md#onclick).)|
|[メニューボタン::クリックメニューアイテム](#onclickmenuitem)|ユーザーがポップアップ メニューの項目を選択したときに、フレームワークによって呼び出されます。|
|[メニューボタン::コンテキストヘルプ](#oncontexthelp)|親ツール バーがWM_HELPHITTEST メッセージを処理するときに、フレームワークによって呼び出されます。 ([オーバーライドします。](../../mfc/reference/cmfctoolbarbutton-class.md#oncontexthelp)|
|[メニューボタン::描画時](#ondraw)|指定したスタイルとオプションを使用してボタンを描画するために、フレームワークによって呼び出されます。 (オーバーライド[CMFCツールバーボタン::OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#ondraw).)|
|[メニューボタン::オンドローオンカスタマイザ](#ondrawoncustomizelist)|[**カスタマイズ**] ダイアログ ボックスの **[コマンド**] ウィンドウにボタンを描画するために、フレームワークによって呼び出されます。 ([オーバーライドします。](../../mfc/reference/cmfctoolbarbutton-class.md#ondrawoncustomizelist)|
|[メニューボタン::メニューを開きます](#openpopupmenu)|ユーザーがポップアップ メニューを開いたときに、フレームワークによって呼び出されます。|
|[メニューボタン::デフォルトにリセット](#resetimagetodefault)|ボタンに関連付けられているイメージの既定値を設定します。 (オーバーライドします[。](../../mfc/reference/cmfctoolbarbutton-class.md#resetimagetodefault)|
|[メニューボタン::バーステートを保存します。](#savebarstate)|ツール バー ボタンの状態を保存します。 (オーバーライド[CMFCツールバーボタン::セーブバーステート](../../mfc/reference/cmfctoolbarbutton-class.md#savebarstate).)|
|[メニューボタン::シリアル化](#serialize)|このオブジェクトをアーカイブから読み取るか、アーカイブに書き込みます。 (オーバーライド[CMFCツールバーボタン::シリアル化](../../mfc/reference/cmfctoolbarbutton-class.md#serialize).)|
|[メニューボタン::セットアックデータ](#setaccdata)|ツール バー`CAccessibilityData`ボタンから、指定されたオブジェクトにアクセシビリティ データを設定します。 [(CMFCツールバーボタンをオーバーライドします。::セットアックデータ](../../mfc/reference/cmfctoolbarbutton-class.md#setaccdata).)|
|[メニューボタン::セットメニューのみ](#setmenuonly)|ボタンをツール バーに追加できるかどうかを指定します。|
|[メニューボタン::メニューパレットモード](#setmenupalettemode)|ポップアップ メニューがパレット モードかどうかを指定します。|
|[メニューボタン::メッセージの設定](#setmessagewnd)||
|[メニューボタン::セットラジオ](#setradio)|ツール バー メニュー ボタンを強制的に表示して、選択されていることを示すアイコンを表示します。|
|[メニューボタン::セットティアオフ](#settearoff)|ポップアップ メニューのティアオフ バー ID を指定します。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[メニューボタン::Dロードキュメントアイコン](#drawdocumenticon)|メニュー ボタンにアイコンを描画します。|

### <a name="data-members"></a>データ メンバー

|名前|説明|
|----------|-----------------|
|[メニューボタン:m_bAlwaysCallOwnerDraw](#m_balwayscallownerdraw)|TRUE の場合、フレームワークは常にボタンが描画されたときに[CFrameWndEx:::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)を呼び出します。|

## <a name="remarks"></a>解説

メニュー `CMFCToolBarMenuButton` 、サブメニューを持つメニュー項目、コマンドを実行するボタン、メニューを表示するボタン、またはメニューのみを表示するボタンとして表示できます。 イメージ、テキスト、メニュー ハンドル、およびコンストラクター`CMFCToolbarMenuButton::CMFCToolbarMenuButton`のボタンに関連付けられているコマンド ID などのパラメーターを指定して、メニュー ボタンの動作と外観を決定します。

クラスから派生したカスタム`CMFCToolbarMenuButton`クラスは[、DECLARE_SERIAL](run-time-object-model-services.md#declare_serial)マクロを使用する必要があります。 [DECLARE_DYNCREATE](run-time-object-model-services.md#declare_dyncreate)マクロは、アプリケーションを閉じるときにエラーを生成します。

## <a name="example"></a>例

オブジェクトを構成する方法を次の例`CMFCToolBarMenuButton`に示します。 このコードは、ドロップダウン メニューがパレット モードであることを指定し、ユーザーがメニュー ボタンをメニュー バーからドラッグしたときに作成されるティアオフ バーの ID を指定する方法を示しています。 このコード スニペットは、 [Word パッド サンプル](../../overview/visual-cpp-samples.md)の一部です。

[!code-cpp[NVC_MFC_WordPad#10](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

[CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md)

## <a name="requirements"></a>必要条件

**ヘッダー:** afxtoolbarmenubutton.h

## <a name="cmfctoolbarmenubuttoncmfctoolbarmenubutton"></a><a name="cmfctoolbarmenubutton"></a>メニューボタン::CMFCツールバーメニューボタン

`CMFCToolBarMenuButton` オブジェクトを構築します。

```
CMFCToolBarMenuButton();
CMFCToolBarMenuButton(const CMFCToolBarMenuButton& src);

CMFCToolBarMenuButton(
    UINT uiID,
    HMENU hMenu,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE);
```

### <a name="parameters"></a>パラメーター

*src*<br/>
[in]この`CMFCToolBarMenuButton`オブジェクト`CMFCToolBarMenuButton`にコピーされる既存のオブジェクト。

*Uiid*<br/>
[in]ユーザーがボタンをクリックしたときに実行するコマンドの ID。コマンドを直接実行しないメニュー ボタンの場合は (UINT)-1。

*Hmenu*<br/>
[in]メニューへのハンドル。ボタンにメニューがない場合は NULL。

*iイメージ*<br/>
[in]ボタンのイメージのインデックス。このボタンにアイコンがない場合、または*uiID*で指定されたコマンドのアイコンを使用する場合は -1 を返します。 インデックスは、アプリケーション内の各`CMFCToolBarImages`オブジェクトで同じです。

*lpszText*<br/>
[in]ツール バー メニュー ボタンのテキスト。

*bユーザーボタン*<br/>
[in]ボタンにユーザー定義のイメージが表示される場合は TRUE。ボタンが*uiID*で指定されたコマンドに関連付けられた定義済みのイメージを表示する場合は FALSE。

### <a name="remarks"></a>解説

*uiID*が有効なコマンド ID である場合、ボタンはユーザーがクリックしたときにそのコマンドを実行します。 *hMenu*が有効なメニュー ハンドルの場合、ボタンは、ツールバーに表示されるドロップダウン メニュー、またはメニューに表示されるサブメニューを提供します。 *uiID*と*hMenu*の両方が有効な場合、ボタンは分割ボタンで、ユーザーがクリックしたときにコマンドを実行する部分と、ユーザーがクリックしたときにメニューをドロップダウンする下矢印を持つ部分が表示されます。 ただし *、hMenu*が有効な場合、ユーザーはボタンがメニューに挿入されたときに、ボタンをクリックしてコマンドを実行することはできません。

### <a name="example"></a>例

クラスのオブジェクトを構築する方法を次の例に`CMFCToolBarMenuButton`示します。 このコード スニペットは、 [Word パッド サンプル](../../overview/visual-cpp-samples.md)の一部です。

[!code-cpp[NVC_MFC_WordPad#9](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_2.cpp)]

## <a name="cmfctoolbarmenubuttoncomparewith"></a><a name="comparewith"></a>メニューボタン::比較と比較

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>パラメーター

[in]*その他*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttoncopyfrom"></a><a name="copyfrom"></a>メニューボタン::コピーから

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>パラメーター

[in]*src*<br/>

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttoncreatefrommenu"></a><a name="createfrommenu"></a>メニューボタン::メニューから作成します。

Windows のメニュー ハンドルからツール バー メニューを初期化します。

```
virtual void CreateFromMenu(HMENU hMenu);
```

### <a name="parameters"></a>パラメーター

*Hmenu*<br/>
[in]メニューへのハンドル。

### <a name="remarks"></a>解説

ツールバーメニューボタンは、ドロップダウンサブメニューを表示できます。

フレームワークは、メニューからサブメニューのコマンドを初期化するために、このメソッドを呼び出します。

## <a name="cmfctoolbarmenubuttoncreatemenu"></a><a name="createmenu"></a>メニューメニューボタン::メニューの作成

ツール バー メニューのコマンドで構成されるメニューを作成します。 メニューへのハンドルを返します。

```
virtual HMENU CreateMenu() const;
```

### <a name="return-value"></a>戻り値

成功した場合のメニューへのハンドル。 ツール バー メニュー ボタンに関連付けられているコマンドの一覧が空の場合は NULL。

### <a name="remarks"></a>解説

このメソッドを派生クラスでオーバーライドして、メニューの生成方法をカスタマイズできます。

## <a name="cmfctoolbarmenubuttoncreatepopupmenu"></a><a name="createpopupmenu"></a>メニューボタン::ポップアップメニュー

ツール`CMFCPopupMenu`バー メニューを表示するオブジェクトを作成します。

```
virtual CMFCPopupMenu* CreatePopupMenu();
```

### <a name="return-value"></a>戻り値

ツール バー`CMFCPopupMenu`メニュー ボタンに関連付けられているドロップダウン メニューを表示するオブジェクトへのポインター。

### <a name="remarks"></a>解説

このメソッドは、ボタンに関連付けられているドロップダウン メニューの表示を準備するために、フレームワークによって呼び出されます。

既定の実装では、新しい`CMFCPopupMenu`オブジェクトを構築して返すだけです。 派生型の[CMFCPopupMenu クラス](cmfcpopupmenu-class.md)を使用する場合、または追加の初期化を実行する場合は、このメソッドをオーバーライドします。

## <a name="cmfctoolbarmenubuttondrawdocumenticon"></a><a name="drawdocumenticon"></a>メニューボタン::Dロードキュメントアイコン

メニュー ボタンにドキュメント アイコンを描画します。

```
void DrawDocumentIcon(
    CDC* pDC,
    const CRect& rectImage,
    HICON hIcon);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
[in]デバイス コンテキストへのポインター。

*レクトイメージ*<br/>
[in]画像の外接する四角形の座標。

*Hicon*<br/>
[in]アイコンへのハンドル。

### <a name="remarks"></a>解説

このメソッドは、ドキュメント アイコンを取得し *、rectImage*で指定された領域の中央に表示されるメニュー ボタンに描画します。

## <a name="cmfctoolbarmenubuttonenablequickcustomize"></a><a name="enablequickcustomize"></a>メニューボタン::クイックカスタマイズを有効にする

```
void EnableQuickCustomize();
```

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttonhasbutton"></a><a name="hasbutton"></a>メニューボタン::ハズボタン

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttonhavehotborder"></a><a name="havehotborder"></a>メニューボタン::フトボーダー

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttonisborder"></a><a name="isborder"></a>メニューボタン::イズボーダー

```
virtual BOOL IsBorder() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttonisclickedonmenu"></a><a name="isclickedonmenu"></a>メニューボタン::クリックオンメニュー

```
BOOL IsClickedOnMenu() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttonisquickmode"></a><a name="isquickmode"></a>メニューボタン::IsQuickモード

```
BOOL IsQuickMode();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttongetcommands"></a><a name="getcommands"></a>メニューボタン::コマンドを取得します。

ツール バー メニューのコマンドの一覧に対する読み取り専用アクセスを提供します。

```
const CObList& GetCommands() const;
```

### <a name="return-value"></a>戻り値

クラスのコレクションを含む[CObList クラス](../../mfc/reference/coblist-class.md)オブジェクトへの定数参照[。](../../mfc/reference/cmfctoolbarbutton-class.md)

### <a name="remarks"></a>解説

ツールバーのメニュー ボタンには、サブメニューを表示できます。 コマンドの一覧は、コンストラクターのサブメニューまたは[CMFC ツール バー メニュー ボタン::CreateFromMenu メニュー](#createfrommenu)へのハンドルとしてメニュー (HMENU) に指定できます。 メニューは[、CMFCToolBarButton クラス](../../mfc/reference/cmfctoolbarbutton-class.md)から派生し、内部`CObList`オブジェクトに格納されているオブジェクトのリストに変換されます。 このリストにアクセスする場合は、このメソッドを呼び出します。

## <a name="cmfctoolbarmenubuttongetimagerect"></a><a name="getimagerect"></a>メニューボタン::イメージレック

ボタン イメージの外接する四角形を取得します。

```
void GetImageRect(CRect& rectImage);
```

### <a name="parameters"></a>パラメーター

*レクトイメージ*<br/>
[アウト]四角形のイメージ`CRect`の境界の座標を受け取るオブジェクトへの参照。

## <a name="cmfctoolbarmenubuttongetpaletterows"></a><a name="getpaletterows"></a>メニューボタン::パレット行を取得します。

メニューがパレット モードの場合のドロップダウン メニューの行数を返します。

```
int GetPaletteRows() const;
```

### <a name="return-value"></a>戻り値

パレット内の行数。

### <a name="remarks"></a>解説

メニュー ボタンをパレット モードに設定すると、メニュー項目は、行数が制限された複数の列に表示されます。 行数を取得します。 パレット モードを有効または無効にしたり、行数を指定するには[、次](#setmenupalettemode)のコマンドを使用します。

## <a name="cmfctoolbarmenubuttongetpopupmenu"></a><a name="getpopupmenu"></a>メニューボタン::ゲットポップアップメニュー

ボタンのドロップダウン メニューを表す[CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)オブジェクトへのポインターを返します。

```
CMFCPopupMenu* GetPopupMenu() const;
```

### <a name="return-value"></a>戻り値

フレームワークがツール バー メニュー ボタンのサブメニューを作成したときに作成された[CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)オブジェクトへのポインター。サブメニューが表示されない場合は NULL。

### <a name="remarks"></a>解説

ツール バー メニュー ボタンにドロップダウン メニューが表示されると、メニューを表す[CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)オブジェクトが作成されます。 `CMFCPopupMenu`オブジェクトへのポインターを取得します。 返されたポインターは一時的なもので、ユーザーがドロップダウン メニューを閉じると無効になるため、格納しないでください。

## <a name="cmfctoolbarmenubuttonisdroppeddown"></a><a name="isdroppeddown"></a>メニューボタン::ディスドロップダウン

ポップアップ メニューが現在表示されているかどうかを示します。

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>戻り値

ツール バー メニュー ボタンにサブメニューが表示される場合は TRUE。それ以外の場合は FALSE。

## <a name="cmfctoolbarmenubuttonisemptymenuallowed"></a><a name="isemptymenuallowed"></a>メニューボタン::IsEmptyメニューを許可

メニュー項目に空のサブメニューを表示するかどうかを指定します。

```
virtual BOOL IsEmptyMenuAllowed() const;
```

### <a name="return-value"></a>戻り値

現在選択されているメニュー項目のサブメニューが空の場合でも、フレームワークがサブメニューを開く場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

ユーザーが現在選択されているメニュー項目からサブメニューを開こうとすると、フレームワークはこのメソッドを呼び出します。 サブメニューが空で FALSE`IsEmptyMenuAllowed`を返すと、サブメニューは開かれなくてすむ。

既定の実装では FALSE が返されます。 この動作をカスタマイズするには、このメソッドをオーバーライドします。

## <a name="cmfctoolbarmenubuttonisexclusive"></a><a name="isexclusive"></a>メニューボタン::イエクスクルーシブ

ボタンが排他モードかどうかを示します。

```
virtual BOOL IsExclusive() const;
```

### <a name="return-value"></a>戻り値

ボタンが排他モードで動作している場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

ユーザーがボタンのポップアップ メニューを開いた後、マウス ポインタを別のツールバーまたはメニュー ボタンの上に移動すると、ボタンが排他モードでない限り、ポップアップ メニューは閉じます。

既定の実装では、常に FALSE が返されます。 排他モードを有効にする場合は、派生クラスでこのメソッドをオーバーライドします。

## <a name="cmfctoolbarmenubuttonismenupalettemode"></a><a name="ismenupalettemode"></a>メニューボタン::メニューパレットモード

ドロップダウン メニューがパレット モードかどうかを判断します。

```
BOOL IsMenuPaletteMode() const;
```

### <a name="return-value"></a>戻り値

パレット モードが有効な場合は TRUE、それ以外の場合は FALSE。

### <a name="remarks"></a>解説

メニュー ボタンをパレット モードに設定すると、メニュー項目は、行数が制限された複数の列に表示されます。 行数を取得します。 パレット モードを有効または無効にするには[、CMFC ツール バー メニュー ボタン:::メニューパレット モード](#setmenupalettemode)を呼び出します。

## <a name="cmfctoolbarmenubuttonistearoffmenu"></a><a name="istearoffmenu"></a>メニューメニュー::イステアオフメニュー

ドロップダウン メニューにティアオフ バーがあるかどうかを示します。

```
virtual BOOL IsTearOffMenu() const;
```

### <a name="return-value"></a>戻り値

ツール バー メニュー ボタンにティアオフ バーがある場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

ティアオフ機能を有効にし、ティアオフ バー ID を設定するには[、CMFCToolBarMenuButton::SetTearOff](#settearoff)を呼び出します。

## <a name="cmfctoolbarmenubuttonm_balwayscallownerdraw"></a><a name="m_balwayscallownerdraw"></a>メニューボタン:m_bAlwaysCallOwnerDraw

ボタンが描画されるときに、フレームワークが常に[CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)を呼び出すかどうかを指定します。

```
static BOOL m_bAlwaysCallOwnerDraw;
```

### <a name="remarks"></a>解説

このメンバー変数が TRUE に設定されている場合、ボタンは常に[CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)メソッドを呼び出して、ボタンにイメージを表示します。 FALSE`m_bAlwaysCallOwnerDraw`の場合、イメージが事前定義されている場合、ボタン自体がイメージを描画します。 それ以外の場合`OnDrawMenuImage`は、 を呼び出します。

## <a name="cmfctoolbarmenubuttononaftercreatepopupmenu"></a><a name="onaftercreatepopupmenu"></a>メニューボタン::後にポップアップメニュー

```
virtual void OnAfterCreatePopupMenu();
```

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttononbeforedrag"></a><a name="onbeforedrag"></a>メニューボタン::オン・アフォアドラグ

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttononcalculatesize"></a><a name="oncalculatesize"></a>メニューボタン::計算サイズ

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>パラメーター

[in]*pDC*<br/>
[in]*サイズデフォルト*<br/>
[in]*bHorz*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttononcancelmode"></a><a name="oncancelmode"></a>メニューボタン::キャンセルモード

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttononchangeparentwnd"></a><a name="onchangeparentwnd"></a>メニューボタン::オンチェンジペアレント

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>パラメーター

[in]*親の子*<br/>

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttononclick"></a><a name="onclick"></a>クリック時ボタン::クリック時

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay = TRUE);
```

### <a name="parameters"></a>パラメーター

[in]*pWnd*<br/>
[in]*bディレイ*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttononclickmenuitem"></a><a name="onclickmenuitem"></a>メニューボタン::クリックメニューアイテム

ユーザーがドロップダウン メニューの項目を選択したときに、フレームワークによって呼び出されます。

```
virtual BOOL OnClickMenuItem();
```

### <a name="return-value"></a>戻り値

フレームワークが既定のメニュー項目の処理を続行する必要がある場合は FALSE。それ以外の場合は TRUE。 既定の実装では、常に FALSE が返されます。

### <a name="remarks"></a>解説

ユーザーがメニュー項目をクリックすると、フレームワークはその項目に関連付けられたコマンドを実行します。

メニュー項目の処理をカスタマイズするには、`OnClickMenuItem`クラスから`CMFCToolBarMenuButton`派生したクラスでオーバーライドします。 また[、CFrameWndEx::OnShowPopupMenu](../../mfc/reference/cframewndex-class.md#onshowpopupmenu)をオーバーライドし、特別な処理を必要とするメニュー ボタンを派生クラスのインスタンスに置き換える必要があります。

## <a name="cmfctoolbarmenubuttononcontexthelp"></a><a name="oncontexthelp"></a>メニューボタン::コンテキストヘルプ

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>パラメーター

[in]*pWnd*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttonondraw"></a><a name="ondraw"></a>メニューボタン::描画時

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz = TRUE,
    BOOL bCustomizeMode = FALSE,
    BOOL bHighlight = FALSE,
    BOOL bDrawBorder = TRUE,
    BOOL bGrayDisabledButtons = TRUE);
```

### <a name="parameters"></a>パラメーター

[in]*pDC*<br/>
[in]*レクト*<br/>
[in]*pイメージズ*<br/>
[in]*bHorz*<br/>
[in]*モードをカスタマイズする*<br/>
[in]*bハイライト*<br/>
[in]*ボーダーを描く*<br/>
[in]*ボタン*<br/>

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttonondrawoncustomizelist"></a><a name="ondrawoncustomizelist"></a>メニューボタン::オンドローオンカスタマイザ

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>パラメーター

[in]*pDC*<br/>
[in]*レクト*<br/>
[in]*b選択済み*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttonopenpopupmenu"></a><a name="openpopupmenu"></a>メニューボタン::メニューを開きます

ユーザーがツール バー メニュー ボタンのドロップダウン メニューを開いたときに、フレームワークによって呼び出されます。

```
virtual BOOL OpenPopupMenu(CWnd* pWnd=NULL);
```

### <a name="parameters"></a>パラメーター

*Pwnd*<br/>
[in]ドロップダウン メニュー コマンドを受け取るウィンドウを指定します。 ツール バー メニュー ボタンに親ウィンドウがある場合にのみ NULL を指定できます。

### <a name="return-value"></a>戻り値

True は[、CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)オブジェクトが作成され、正常に開かれた場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

この関数は、ユーザーがツール バー メニュー ボタンからドロップダウン メニューを開いたときに、フレームワークによって呼び出されます。

## <a name="cmfctoolbarmenubuttonresetimagetodefault"></a><a name="resetimagetodefault"></a>メニューボタン::デフォルトにリセット

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttonsavebarstate"></a><a name="savebarstate"></a>メニューボタン::バーステートを保存します。

```
virtual void SaveBarState();
```

### <a name="remarks"></a>解説

フレームワークは、ドラッグ アンド ドロップ操作の結果としてツール バー ボタンを作成するときに、このメソッドを呼び出します。 このメソッドは、最上位のポップアップ メニューの[CMFCPopupMenu::SaveState](../../mfc/reference/cmfcpopupmenu-class.md#savestate)メソッドを呼び出します。

## <a name="cmfctoolbarmenubuttonserialize"></a><a name="serialize"></a>メニューボタン::シリアル化

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>パラメーター

[in]*ar*<br/>

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttonsetaccdata"></a><a name="setaccdata"></a>メニューボタン::セットアックデータ

リボン要素のアクセシビリティ データを設定します。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>パラメーター

*親*<br/>
リボン要素の親ウィンドウ。

*データ*<br/>
リボン要素のアクセシビリティ データ。

### <a name="return-value"></a>戻り値

常に TRUE を返します。

### <a name="remarks"></a>解説

既定では、このメソッドはリボン要素のアクセシビリティ データを設定し、常に TRUE を返します。 アクセシビリティ データを設定し、成功または失敗を示す値を返すようにするには、このメソッドをオーバーライドします。

## <a name="cmfctoolbarmenubuttonsetmenuonly"></a><a name="setmenuonly"></a>メニューボタン::セットメニューのみ

有効なコマンド ID とサブメニューの両方を持つボタンをメニュー ボタンまたは分割ボタンとして描画するかどうかを指定します。

```
void SetMenuOnly(BOOL bMenuOnly);
```

### <a name="parameters"></a>パラメーター

*メニューのみ*<br/>
[in]有効なコマンド ID とサブメニューの両方を持つ場合にこのボタンをメニュー ボタンとして表示する場合は TRUE、有効なコマンド ID とサブメニューの両方を持つ場合に分割ボタンとして表示するには FALSE。

### <a name="remarks"></a>解説

通常、ツールバーのメニュー ボタンにサブメニューとコマンド ID の両方がある場合、メニューは、メイン ボタンと下矢印ボタンが付いた分割ボタンとして表示されます。 このメソッドを呼び出し *、bMenuOnly*が TRUE の場合、ボタンはボタン内に下矢印が付いた単一のメニュー ボタンとして表示されます。 ユーザーがいずれかのモードで矢印をクリックすると、サブメニューが開き、どちらのモードでもボタンの矢印以外の部分をクリックすると、フレームワークはコマンドを実行します。

## <a name="cmfctoolbarmenubuttonsetmenupalettemode"></a><a name="setmenupalettemode"></a>メニューボタン::メニューパレットモード

ドロップダウン メニューがパレット モードかどうかを指定します。

```
void SetMenuPaletteMode(
    BOOL bMenuPaletteMode=TRUE,
    int nPaletteRows=1);
```

### <a name="parameters"></a>パラメーター

*ウィンドウモード*<br/>
[in]ドロップダウン メニューがパレット モードかどうかを指定します。

*nパレット行*<br/>
[in]パレット内の行数。

### <a name="remarks"></a>解説

パレット モードでは、すべてのメニュー項目が複数列パレットとして表示されます。 行数を指定するには *、nPaletteRows*を使用します。

## <a name="cmfctoolbarmenubuttonsetmessagewnd"></a><a name="setmessagewnd"></a>メニューボタン::メッセージの設定

```
void SetMessageWnd(CWnd* pWndMessage);
```

### <a name="parameters"></a>パラメーター

[in]*メッセージ*<br/>

### <a name="remarks"></a>解説

## <a name="cmfctoolbarmenubuttonsetradio"></a><a name="setradio"></a>メニューボタン::セットラジオ

チェックボックスをオンにしたときに、オプション ボタンのスタイル アイコンを表示するようにツール バー メニュー ボタンを設定します。

```
virtual void SetRadio();
```

### <a name="remarks"></a>解説

メニュー ボタンがチェックされている間に描画されると、チェックマーク アイコンを描画するために[CMFCVisualManager::OnDrawMenuCheck](../../mfc/reference/cmfcvisualmanager-class.md#ondrawmenucheck)を呼び出します。 既定では、`OnDrawMenuCheck`現在のビジュアル マネージャーがメニュー ボタンにチェック ボックス のスタイルチェック マークを描画することを要求します。 このメソッドを呼び出した後、現在のビジュアル マネージャーは、代わりにメニュー ボタンにラジオ ボタン スタイルのチェック マークを描画します。 この変更は元に戻せません。

このメソッドを呼び出したときに、メニュー ボタンが現在表示されているときに、更新されます。

## <a name="cmfctoolbarmenubuttonsettearoff"></a><a name="settearoff"></a>メニューボタン::セットティアオフ

ドロップダウン メニューのティアオフ バーの ID を指定します。

```
virtual void SetTearOff(UINT uiBarID);
```

### <a name="parameters"></a>パラメーター

*uiBarID*<br/>
[in]新しいティアオフ バー ID を指定します。

### <a name="remarks"></a>解説

ユーザーがメニュー ボタンをメニュー バーからドラッグしたときに作成されるティアオフ バーの ID を指定します。 *uiBarID*パラメーターが 0 の場合、ユーザーはメニュー ボタンを引き裂くことはできません。

[CWinAppEx::EnableTearOffMenus](../../mfc/reference/cwinappex-class.md#enabletearoffmenus)を呼び出して、アプリケーションでティアオフメニュー機能を有効にします。

## <a name="see-also"></a>関連項目

[階層グラフ](../../mfc/hierarchy-chart.md)<br/>
[クラス](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBarButton クラス](../../mfc/reference/cmfctoolbarbutton-class.md)<br/>
[クラス](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)
