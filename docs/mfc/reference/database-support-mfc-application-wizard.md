---
description: 詳細については、「データベースサポート」、「MFC アプリケーションウィザード」を参照してください。
title: '[データベース サポート] (MFC アプリケーション ウィザード)'
ms.date: 11/04/2016
f1_keywords:
- vc.appwiz.mfc.exe.database
helpviewer_keywords:
- MFC Application Wizard, database support
ms.assetid: 9ddf4558-fd41-4ac7-8d9b-c93d9c68ab59
ms.openlocfilehash: 4c6f980155e980c772b5ee78f83c80a236998b91
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/11/2020
ms.locfileid: "97220306"
---
# <a name="database-support-mfc-application-wizard"></a>[データベース サポート] (MFC アプリケーション ウィザード)

このページでは、プロジェクトのサポートレベル (必要に応じてデータソースを加えたもの) を指定できるオプションを提供します。

- **データベースのサポート**

   プロジェクトのデータベースサポートのレベルを設定します。

   |オプション|説明|
   |------------|-----------------|
   |**なし**|では、データベースのサポートは提供されません。 既定のオプションです。|
   |**ヘッダーファイルのみ**|アプリケーションのデータベースサポートの基本レベルを提供します。 [ **クライアントの種類**] で [ODBC サポート] を選択すると、MFC アプリケーションウィザードによって、ヘッダーファイル afxdb.h がプロジェクトに追加されます。 リンクライブラリを追加しますが、データベース固有のクラスは作成しません。 後でレコードセットを作成し、それらを使用してレコードを検査および更新することができます。 [ **クライアントの種類**] で OLE DB サポートを選択した場合は、次のヘッダーファイルが含まれます: atlbase。H AFXOLEDB。H ATLPLUS。始め|
   |**ファイルサポートのないデータベースビュー**|には、データベースヘッダーファイル、リンクライブラリ、レコードビュー、レコードセットが含まれています。 ([[アプリケーションの種類](../../mfc/reference/application-type-mfc-application-wizard.md)] ページで [**ドキュメント/ビューアーキテクチャのサポート**] オプションが選択されているアプリケーションでのみ使用できます。)このオプションにはドキュメントサポートが含まれますが、シリアル化はサポートされていません。 データベースビューを含めることを選択した場合は、データのソースを指定する必要があります。|
   |**ファイルサポートのあるデータベースビュー**|には、データベースヘッダーファイル、リンクライブラリ、レコードビュー、レコードセットが含まれています。 ([**アプリケーションの種類**] ページで [**ドキュメント/ビューアーキテクチャのサポート**] オプションが選択されているアプリケーションでのみ使用できます。)このオプションは、ドキュメントのシリアル化をサポートします。たとえば、ユーザープロファイルファイルを更新するために使用できます。 データベースアプリケーションは、通常、ファイル単位ではなくレコード単位で処理されるため、シリアル化は必要ありません。 ただし、シリアル化に特別な用途がある場合もあります。 データベースビューを含めることを選択した場合は、データのソースを指定する必要があります。|

   > [!NOTE]
   > [ **データベースサポート**] で、ファイルサポート **なしのデータベースビュー** または **ファイルサポート付きのデータベース** ビューのいずれかを選択した場合、 **クライアントの種類** の選択に応じて、ビュークラスの派生は次のように異なります。

  - [**クライアントの種類**] で [ **ODBC** ] を選択した場合、アプリケーションのビュークラスは [CRecordView](../../mfc/reference/crecordview-class.md)から派生します。 このクラスは、MFC アプリケーションウィザードによっても作成される [CRecordset](../../mfc/reference/crecordset-class.md)の派生クラスに関連付けられています。 このオプションを使用すると、レコードビューを使用してレコードセットを通じてレコードを表示および更新するためのフォームベースのアプリケーションが提供されます。

  - [**クライアントの種類**] で [ **OLE DB** ] を選択した場合、ビュークラスは [coCTable brecordview](../../mfc/reference/coledbrecordview-class.md)から派生します。これは、 [](../../data/oledb/ctable-class.md)または [CCommand](../../data/oledb/ccommand-class.md)の派生クラスに関連付けられています。

- **クライアントの種類**

   プロジェクトで OLE DB または ODBC クラスを使用するかどうかを示します。

   |オプション|説明|
   |------------|-----------------|
   |**OLE DB**|このオプションが選択されている場合、[データ **ソース** ] ボタンをクリックすると、データ **リンクプロパティ** ウィザードが呼び出され、OLE DB データソースへの接続を作成できます。|
   |**ODBC**|このオプションを選択すると、[ **データ** ソース] ボタンをクリックすると、 **データソースの選択** ウィザードが起動し、ODBC データソースへの接続を作成できます。|

- **データ ソース**

   > [!NOTE]
   > ATL OLE DB コンシューマーウィザードと MFC ODBC コンシューマーウィザードは、Visual Studio 2019 以降では使用できません。 ただし、この機能を手動で追加することは可能です。 詳細については、「[ウィザードを使用しないコンシューマーの作成](../../data/oledb/creating-a-consumer-without-using-a-wizard.md)」をご覧ください。

   [ **データソース** ] ボタンをクリックして、指定したドライバーまたはプロバイダーとデータベースを使用してデータソースを設定します。 [ **クライアントの種類** ] オプションで [OLE DB] を選択した場合、このボタンをクリックすると、[ **データリンクプロパティ** ] ダイアログボックスが表示されます。 [ **クライアントの種類** ] オプションで [ODBC] を選択した場合、このボタンをクリックすると **[データソースの選択** ] ダイアログボックスが表示されます。 このオプションは、アプリケーションにデータベースビューを含めることを選択した場合にのみ使用できます。

   |オプション|説明|
   |------------|-----------------|
   |**データリンクプロパティ** (OLE DB)|指定された OLE DB プロバイダーを使用して、指定されたデータソースを確立します。 OLE DB プロバイダー、データの場所、データソース、ログオン ID、および (必要に応じて) パスワードを指定する必要があります。 このダイアログボックスの詳細については、「 [ATL OLE DB コンシューマーウィザード](../../atl/reference/atl-ole-db-consumer-wizard.md)の **データソース**」を参照してください。|
   |**データソースの選択** (ODBC)|指定された ODBC ドライバーを使用して、指定されたデータソースを確立します。 データソースのテーブルを選択するには、データソース名を選択する必要があります。 ウィザードにより、テーブルのすべての列が、から派生したクラスのメンバー変数にバインドされ `CRecordset` ます。 このダイアログボックスの詳細については、「 [MFC ODBC コンシューマーウィザード](../../mfc/reference/mfc-odbc-consumer-wizard.md)の **データソース**」を参照してください。|

- **属性付きデータベースクラスの生成**

   OLE DB クライアントのみで使用できます。 生成されたプロジェクトのデータベースクラスで属性を使用するかどうかを指定します。

- **すべての列をバインドする**

   ODBC クライアントでのみ使用できます。 選択したテーブル内のすべての列がバインドされているかどうかを指定します。 このボックスをオンにすると、すべての列がバインドされます。このチェックボックスをオンにしない場合は、バインドされている列がないため、レコードセットクラスでそれらを手動でバインドする必要があります。

- **Type**

   ODBC クライアントでのみ使用できます。 次の表に示すように、レコードセットがダイナセットまたはスナップショットのどちらであるかを指定します。

   |オプション|説明|
   |------------|-----------------|
   |**ダイナセット**|レコードセットがダイナセットであることを指定します。 ダイナセットは、クエリを実行した結果、クエリを実行したデータベースのデータにインデックス付きビューを提供します。 ダイナセットは、元のデータに対して整数のインデックスのみをキャッシュするため、スナップショットに対するパフォーマンスの向上を実現します。 インデックスは、クエリの結果として検出された各レコードを直接指し、レコードが削除されたかどうかを示します。 また、クエリされたレコードの更新された情報にアクセスすることもできます。|
   |**スナップショット**|レコードセットがスナップショットであることを指定します。 スナップショットは、クエリの結果であり、ある時点のデータベースのビューです。 クエリの結果として検出されたすべてのレコードがキャッシュされるため、元のレコードに対する変更は表示されません。|

## <a name="see-also"></a>関連項目

[MFC アプリケーションウィザード](../../mfc/reference/mfc-application-wizard.md)
