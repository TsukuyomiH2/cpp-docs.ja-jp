---
title: '[データベース サポート] (MFC アプリケーション ウィザード)'
ms.date: 11/04/2016
f1_keywords:
- vc.appwiz.mfc.exe.database
helpviewer_keywords:
- MFC Application Wizard, database support
ms.assetid: 9ddf4558-fd41-4ac7-8d9b-c93d9c68ab59
ms.openlocfilehash: c13d56d2fee45e130aba81168188bec6d8828d51
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81365887"
---
# <a name="database-support-mfc-application-wizard"></a>[データベース サポート] (MFC アプリケーション ウィザード)

このページには、プロジェクトのデータベース サポートのレベル (および必要に応じてデータ ソース) を指定するためのオプションが用意されています。

- **データベースのサポート**

   プロジェクトのデータベース サポートのレベルを設定します。

   |オプション|説明|
   |------------|-----------------|
   |**なし**|データベースサポートはありません。 既定のオプションです。|
   |**ヘッダー ファイルのみ**|アプリケーションのデータベース サポートの基本レベルを提供します。 **[クライアントの種類**] で [ODBC サポート] を選択した場合、MFC アプリケーション ウィザードは、ヘッダー ファイル AFXDB をプロジェクトに含めます。H。 リンク ライブラリは追加されますが、データベース固有のクラスは作成されません。 レコードセットは後で作成し、レコードの調査や更新に使用できます。 **[クライアントの種類**] で [OLE DB サポート] を選択した場合は、次のヘッダー ファイルが含まれます。H AFXOLEDB。H ATLPLUS.H|
   |**ファイルサポートなしのデータベース ビュー**|データベース ヘッダー ファイル、リンク ライブラリ、レコード ビュー、およびレコードセットが含まれます。 ([アプリケーションの[種類]](../../mfc/reference/application-type-mfc-application-wizard.md)ページで **[ドキュメント/ビュー アーキテクチャ のサポート**] オプションが選択されているアプリケーションでのみ使用できます)。このオプションにはドキュメントサポートが含まれますが、シリアル化はサポートされません。 データベース ビューを含める場合は、データのソースを指定する必要があります。|
   |**ファイルサポートを含むデータベース ビュー**|データベース ヘッダー ファイル、リンク ライブラリ、レコード ビュー、およびレコードセットが含まれます。 ([アプリケーションの**種類]** ページで **[ドキュメント/ビュー アーキテクチャ のサポート**] オプションが選択されているアプリケーションでのみ使用できます)。このオプションは、ユーザー プロファイル ファイルを更新する場合などに使用できるドキュメントのシリアル化をサポートします。 データベース アプリケーションは、通常、ファイル単位ではなくレコード単位で動作するため、シリアル化は不要です。 ただし、シリアル化には特別な用途があります。 データベース ビューを含める場合は、データのソースを指定する必要があります。|

   > [!NOTE]
   > [**データベース サポート**] で、[ ファイル**サポートなしデータベース ビュー** ] または [ ファイル**サポートを含むデータベース ビュー**] を選択した場合、ビュー クラス派生は **、クライアントの種類**の選択によって次のように異なります。

  - [**クライアントの種類]** で **[ODBC]** を選択した場合、アプリケーションのビュー クラスは[CRecordView](../../mfc/reference/crecordview-class.md)から派生します。 このクラスは、MFC アプリケーション ウィザードも作成する[CRecordset](../../mfc/reference/crecordset-class.md)派生クラスに関連付けられます。 このオプションを使用すると、レコード ビューを使用してレコードセットを通じてレコードを表示および更新するフォーム ベースのアプリケーションが提供されます。

  - **[クライアントの種類**] で **[OLE DB]** を選択した場合、ビュー クラスは[COleDBRecordView](../../mfc/reference/coledbrecordview-class.md)から派生し[、CTable](../../data/oledb/ctable-class.md)または[CCommand](../../data/oledb/ccommand-class.md)派生クラスに関連付けられます。

- **クライアントの種類**

   プロジェクトで OLE DB クラスと ODBC クラスのどちらを使用するかを示します。

   |オプション|説明|
   |------------|-----------------|
   |**OLE DB (OLE DB)**|このオプションを選択すると、[データ**ソース**] ボタンをクリックすると **、OLE** DB データ ソースへの接続を作成するためにデータ リンク プロパティ ウィザードが起動します。|
   |**ODBC**|このオプションを選択すると、[データ**ソース**] ボタンをクリックすると **、ODBC データ ソース**への接続を作成するためにデータ ソースの選択ウィザードが起動します。|

- **データ ソース**

   > [!NOTE]
   > ATL OLE DB コンシューマー ウィザードと MFC ODBC コンシューマー ウィザードは、Visual Studio 2019 以降では使用できません。 ただし、この機能を手動で追加することは可能です。 詳細については、「[ウィザードを使用しないコンシューマーの作成](../../data/oledb/creating-a-consumer-without-using-a-wizard.md)」をご覧ください。

   [**データ ソース**] ボタンをクリックして、指定したドライバまたはプロバイダとデータベースを使用してデータ ソースを設定します。 **[クライアントの種類]** オプションで [OLE DB] を選択した場合、このボタンをクリックすると **[データ リンク プロパティ]** ダイアログ ボックスが表示されます。 **[クライアントの種類]** オプションで [ODBC] を選択した場合、このボタンをクリックすると [**データ ソースの選択**] ダイアログ ボックスが表示されます。 このオプションは、アプリケーションにデータベース ビューを含める場合にのみ使用できます。

   |オプション|説明|
   |------------|-----------------|
   |**データ リンク プロパティ**(OLE DB)|指定した OLE DB プロバイダを使用して、指定されたデータ ソースを設定します。 OLE DB プロバイダ、データの場所、データ ソース、ログオン ID、およびパスワード (オプション) を指定する必要があります。 このダイアログ ボックスの詳細については[、「ATL OLE DB コンシューマー ウィザード](../../atl/reference/atl-ole-db-consumer-wizard.md)のデータ**ソース**」を参照してください。|
   |**データ ソースの選択**(ODBC)|指定した ODBC ドライバーを使用して、指定したデータ ソースを確立します。 データ ソースのテーブルを選択するには、データ ソース名を選択する必要があります。 ウィザードは、テーブルのすべての列を-derived クラスのメンバー変数に`CRecordset`バインドします。 このダイアログ ボックスの詳細については[、「MFC ODBC コンシューマー ウィザード](../../mfc/reference/mfc-odbc-consumer-wizard.md)の**データ ソース**」を参照してください。|

- **属性付きデータベース クラスの生成**

   OLE DB クライアントでのみ使用できます。 生成されたプロジェクトのデータベース クラスで属性を使用するかどうかを指定します。

- **すべての列をバインドする**

   ODBC クライアントでのみ使用可能です。 選択したテーブルのすべての列をバインドするかどうかを指定します。 このボックスを選択すると、すべての列がバインドされます。このボックスを選択しない場合、列はバインドされません。

- **Type**

   ODBC クライアントでのみ使用可能です。 次の表に示すように、レコードセットがダイナセットであるかスナップショットであるかを指定します。

   |オプション|説明|
   |------------|-----------------|
   |**ダイナセット**|レコードセットがダイナセットであることを指定します。 ダイナセットは、クエリを実行したデータベースのデータにインデックス付きビューを提供するクエリの結果です。 ダイナセットは、元のデータに対する整数インデックスのみをキャッシュし、スナップショットに対するパフォーマンス向上を提供します。 インデックスは、クエリの結果として見つかった各レコードを直接指し示し、レコードが削除されるかどうかを示します。 また、照会されたレコードの更新情報にアクセスすることもできます。|
   |**スナップショット**|レコードセットがスナップショットであることを指定します。 スナップショットはクエリの結果であり、ある時点でデータベースに対するビューです。 クエリの結果として見つかったすべてのレコードがキャッシュされるため、元のレコードに対する変更は表示されません。|

## <a name="see-also"></a>関連項目

[MFC アプリケーション ウィザード](../../mfc/reference/mfc-application-wizard.md)
