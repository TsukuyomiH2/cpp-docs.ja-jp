---
title: CToolBarCtrl クラス
ms.date: 11/04/2016
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
ms.openlocfilehash: 50d3174d4569392be72efdad338eeaac3154ec56
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/22/2020
ms.locfileid: "81752224"
---
# <a name="ctoolbarctrl-class"></a>CToolBarCtrl クラス

Windows ツール バー コモン コントロールの機能が用意されています。

## <a name="syntax"></a>構文

```
class CToolBarCtrl : public CWnd
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[CツールバーCtrl::CツールバーCtrl](#ctoolbarctrl)|`CToolBarCtrl` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[をクリックします。](#addbitmap)|ツール バー コントロールで使用できるボタン イメージの一覧に、1 つまたは複数のビットマップ ボタン イメージを追加します。|
|[ボタンの追加](#addbuttons)|ツール バー コントロールに 1 つ以上のボタンを追加します。|
|[次の文字列を追加します。](#addstring)|リソース ID として渡される新しい文字列を、ツール バーの文字列の内部リストに追加します。|
|[次の文字列を追加します。](#addstrings)|null で区切られた文字列のバッファーへのポインターとして渡される新しい文字列を、ツール バーの文字列の内部リストに追加します。|
|[CToolBarCtrl::自動サイズ](#autosize)|ツール バー コントロールのサイズを変更します。|
|[をクリックします。](#changebitmap)|現在のツール バー コントロールのボタンのビットマップを変更します。|
|[チェックボタン](#checkbutton)|ツール バー コントロール内の特定のボタンをオンまたはオフにします。|
|[コマンドバーCtrl::コマンドをインデックスに追加します。](#commandtoindex)|指定したコマンド識別子に関連付けられたボタンの 0 から始まるインデックスを取得します。|
|[CToolBarCtrl::作成](#create)|ツール バー コントロールを作成し、`CToolBarCtrl`オブジェクトにアタッチします。|
|[CツールバーCtrl::作成します。](#createex)|指定した Windows 拡張スタイルを持つツール バー コントロールを`CToolBarCtrl`作成し、オブジェクトにアタッチします。|
|[CToolBarCtrl::カスタマイズ](#customize)|[ツールバーのカスタマイズ] ダイアログ ボックスを表示します。|
|[:Dエレテボタン](#deletebutton)|ツール バー コントロールからボタンを削除します。|
|[ボタンを有効にします。](#enablebutton)|ツール バー コントロールで指定したボタンを有効または無効にします。|
|[キーバーCtrl::アンカーハイライトを取得します。](#getanchorhighlight)|ツール バーのアンカーの強調表示設定を取得します。|
|[をクリックします。](#getbitmap)|ツール バーのボタンに関連付けられているビットマップのインデックスを取得します。|
|[をクリックします。](#getbitmapflags)|ツール バーのビットマップに関連付けられているフラグを取得します。|
|[をクリックします。](#getbutton)|ツール バー コントロール内の指定されたボタンに関する情報を取得します。|
|[をクリックします。](#getbuttoncount)|ツール バー コントロールに現在含まれるボタンの数を取得します。|
|[をクリックします。](#getbuttoninfo)|ツール バーのボタンの情報を取得します。|
|[コントロールバーCtrl::ボタンのサイズを取得します。](#getbuttonsize)|ツール バー ボタンの現在の幅と高さをピクセル単位で取得します。|
|[をクリックします。](#getcolorscheme)|現在のツール バー コントロールの配色を取得します。|
|[を使用します。](#getdisabledimagelist)|ツール バー コントロールが無効なボタンを表示するために使用するイメージ リストを取得します。|
|[をクリックします。](#getdroptarget)|ツール バー コントロールの[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)インターフェイスを取得します。|
|[を使用します。](#getextendedstyle)|ツール バー コントロールの拡張スタイルを取得します。|
|[をクリックします。](#gethotimagelist)|ツール バー コントロールが "ホット" ボタンを表示するために使用するイメージ リストを取得します。 ホット ボタンは、マウス ポインタがその上にあるときに強調表示されます。|
|[をクリックします。](#gethotitem)|ツール バーのホット アイテムのインデックスを取得します。|
|[をクリックします。](#getimagelist)|ツール バー コントロールが既定の状態のボタンを表示するために使用するイメージ リストを取得します。|
|[をクリックします。](#getinsertmark)|ツール バーの現在の挿入マークを取得します。|
|[をクリックします。](#getinsertmarkcolor)|ツール バーの挿入マークの描画に使用する色を取得します。|
|[をクリックします。](#getitemrect)|ツール バー コントロール内のボタンの外接する四角形を取得します。|
|[をクリックします。](#getmaxsize)|ツール バーに表示されているすべてのボタンと区切り記号の合計サイズを取得します。|
|[をクリックします。](#getmaxtextrows)|ツール バー ボタンに表示されるテキスト行の最大数を取得します。|
|[をクリックします。](#getmetrics)|ツール バー コントロールのメトリックを取得します。|
|[次の行](#getpadding)|現在のツール バー コントロールの水平および垂直の埋め込みを取得します。|
|[をクリックします。](#getpressedimagelist)|現在のツール バー コントロールが押された状態のボタンを表すために使用するイメージ リストを取得します。|
|[CToolBarCtrl::ゲットレック](#getrect)|指定したツール バー ボタンの外接する四角形を取得します。|
|[を行う](#getrows)|ツール バーに現在表示されているボタンの行数を取得します。|
|[をクリックします。](#getstate)|ツール バー コントロール内の指定されたボタンの状態 (有効、押し、チェックの有無など) に関する情報を取得します。|
|[を返します。](#getstring)|ツール バー文字列を取得します。|
|[をクリックします。](#getstyle)|ツール バー コントロールで現在使用されているスタイルを取得します。|
|[ツールバーCtrl::ヒントを取得します。](#gettooltips)|ツール バー コントロールに関連付けられているツール ヒント コントロールがある場合は、ハンドルを取得します。|
|[コントロールを非表示にします。](#hidebutton)|ツール バー コントロールで指定したボタンの表示と非表示を切り替えます。|
|[CToolBarCtrl::ヒットテスト](#hittest)|ツール バー コントロール内のポイントの位置を指定します。|
|[CToolBarCtrl::不確定](#indeterminate)|ツール バー コントロール内の指定されたボタンの不確定 (灰色) 状態を設定またはクリアします。|
|[ボタンを押します。](#insertbutton)|ツール バー コントロールにボタンを挿入します。|
|[をクリックします。](#insertmarkhittest)|ツール バーのポイントの挿入マーク情報を取得します。|
|[チェックされたボタン](#isbuttonchecked)|ツール バー コントロール内の指定されたボタンがオンになっているかどうかを示します。|
|[ボタンを押します。](#isbuttonenabled)|ツール バー コントロール内の指定されたボタンが有効かどうかを示します。|
|[コントロールバーCtrl::ボタン隠し](#isbuttonhidden)|ツール バー コントロール内の指定されたボタンが非表示かどうかを示します。|
|[ボタンが強調表示されました。](#isbuttonhighlighted)|ツール バー ボタンの強調表示状態を確認します。|
|[CToolBarCtrl::IsButtonindeterminate](#isbuttonindeterminate)|ツール バー コントロール内の指定されたボタンの状態が不確定 (灰色) であるかどうかを示します。|
|[CToolBarCtrl::イボタン押下](#isbuttonpressed)|ツール バー コントロール内の指定されたボタンが押されているかどうかを示します。|
|[をクリックします。](#loadimages)|ビットマップをツール バー コントロールのイメージ リストに読み込みます。|
|[CToolBarCtrl::マップアクセラレータ](#mapaccelerator)|アクセラレータ文字をツール バー ボタンに割り当てます。|
|[CツールバーCtrl::マークボタン](#markbutton)|ツール バー コントロール内の特定のボタンの強調表示状態を設定します。|
|[ボタンの移動](#movebutton)|ボタンをインデックス間で移動します。|
|[:Pレスボタン](#pressbutton)|ツール バー コントロールで指定したボタンを押すか、または離します。|
|[を置き換える](#replacebitmap)|現在のツール バー コントロールの既存のビットマップを新しいビットマップで置き換えます。|
|[状態を復元します。](#restorestate)|ツール バー コントロールの状態を復元します。|
|[をクリックします。](#savestate)|ツール バー コントロールの状態を保存します。|
|[キーバーCtrl::アンカーハイライトを設定します。](#setanchorhighlight)|ツールバーのアンカーハイライト設定を設定します。|
|[をクリックします。](#setbitmapsize)|ツール バー コントロールに追加するビットマップ イメージのサイズを設定します。|
|[をクリックします。](#setbuttoninfo)|ツールバーの既存のボタンの情報を設定します。|
|[コントロール::セットボタンサイズ](#setbuttonsize)|ツール バー コントロールに追加するボタンのサイズを設定します。|
|[コントロールコントロール::セットボタン構造体のサイズ](#setbuttonstructsize)|構造体のサイズを指定`TBBUTTON`します。|
|[コントロール::ボタン幅の設定](#setbuttonwidth)|ツール バー コントロールのボタンの最小幅と最大幅を設定します。|
|[をクリックします。](#setcmdid)|指定したボタンが押されたときにオーナー ウィンドウに送信されるコマンド識別子を設定します。|
|[コントロール::カラースキームの設定](#setcolorscheme)|現在のツール バー コントロールの配色を設定します。|
|[を使用します。](#setdisabledimagelist)|ツール バー コントロールが無効なボタンを表示するために使用するイメージ リストを設定します。|
|[をクリックします。](#setdrawtextflags)|指定された四角形のテキストを描画するために使用される、Win32 関数[DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)のフラグを設定します。|
|[コントロール::セットエクステンドスタイル](#setextendedstyle)|ツール バー コントロールの拡張スタイルを設定します。|
|[をクリックします。](#sethotimagelist)|ツール バー コントロールが "ホット" ボタンを表示するために使用するイメージ リストを設定します。|
|[をクリックします。](#sethotitem)|ホットアイテムをツールバーに設定します。|
|[をクリックします。](#setimagelist)|ツール バーが既定の状態にあるボタンを表示するために使用するイメージ リストを設定します。|
|[をクリックします。](#setindent)|ツール バー コントロールの最初のボタンのインデントを設定します。|
|[を挿入します。](#setinsertmark)|ツール バーの現在の挿入マークを設定します。|
|[をクリックします。](#setinsertmarkcolor)|ツール バーの挿入マークの描画に使用する色を設定します。|
|[をクリックします。](#setmaxtextrows)|ツール バー ボタンに表示されるテキスト行の最大数を設定します。|
|[をクリックします。](#setmetrics)|ツール バー コントロールのメトリックを設定します。|
|[CツールバーCtrl::セットオーナー](#setowner)|ツール バー コントロールから通知メッセージを受け取るウィンドウを設定します。|
|[をクリックします。](#setpadding)|現在のツール バー コントロールの水平および垂直のパディングを設定します。|
|[一覧をクリックします。](#setpressedimagelist)|現在のツール バー コントロールが押された状態のボタンを表すために使用するイメージ リストを設定します。|
|[CToolBarCtrl::セットロウ](#setrows)|ツール バーに表示されるボタンの行数を設定します。|
|[をクリックします。](#setstate)|ツール バー コントロール内の指定したボタンの状態を設定します。|
|[コントロール::セットスタイル](#setstyle)|ツール バー コントロールのスタイルを設定します。|
|[ツールバーCtrl::ヒントの設定](#settooltips)|ツール ヒント コントロールをツール バー コントロールに関連付けます。|
|[コントロールウィンドウの設定](#setwindowtheme)|ツール バー コントロールの表示スタイルを設定します。|

## <a name="remarks"></a>解説

このコントロール (および`CToolBarCtrl`クラス) は、Windows 95/98 および Windows NT バージョン 3.51 以降で実行されているプログラムでのみ使用できます。

Windows ツール バーコモン コントロールは、1 つ以上のボタンを含む四角形の子ウィンドウです。 これらのボタンは、ビットマップ イメージ、文字列、またはその両方を表示できます。 ユーザーがボタンを選択すると、ツール バーのオーナー ウィンドウにコマンド メッセージが送信されます。 通常、ツールバーのボタンはアプリケーションのメニューの項目に対応します。これらのコマンドは、ユーザーがアプリケーションのコマンドにアクセスするためのより直接的な方法を提供します。

`CToolBarCtrl`オブジェクトには、ボタンイメージビットマップまたはイメージリストのリスト、ボタンラベル文字列のリスト、イメージや文字列をボタンの位置、スタイル、状態、およびコマンド`TBBUTTON`IDに関連付ける構造体のリストなど、いくつかの重要な内部データ構造が含まれています。 これらのデータ構造の各要素は、0 から始まるインデックスによって参照されます。 オブジェクトを使用する前`CToolBarCtrl`に、これらのデータ構造を設定する必要があります。 文字列のリストはボタンラベルにのみ使用できます。ツールバーから文字列を取得することはできません。

オブジェクトを`CToolBarCtrl`使用するには、通常、次の手順に従います。

1. オブジェクトを`CToolBarCtrl`構築します。

1. [Create](#create)を呼び出して、Windows ツール バー`CToolBarCtrl`コモン コントロールを作成し、オブジェクトにアタッチします。 透明なツールバーのTBSTYLE_TRANSPARENTや、ドロップダウン スタイル ボタンをサポートするツールバーのTBSTYLE_DROPDOWNなどのスタイルを使用して、ツールバーのスタイルを指定します。

1. ツールバーのボタンの表示方法を指定します。

   - ボタンにビットマップ イメージを使用するには[、AddBitmap](#addbitmap)を呼び出してボタン ビットマップをツール バーに追加します。

   - ボタンのイメージ リストから表示されるイメージを使用するには、イメージ リストを指定するには[、SetImageList](#setimagelist) [、SetHotImageList、](#sethotimagelist)または[SetDisabledImageList](#setdisabledimagelist)を呼び出します。

   - ボタンに文字列ラベルを使用するには[、AddString](#addstring)または[AddStrings](#addstrings)を呼び出して、ツール バーに文字列を追加します。

1. AddButtons を呼び出して、ツールバーにボタン構造[を追加します](#addbuttons)。

1. 所有者ウィンドウでツール バー ボタンのツール ヒントが`CFrameWnd`必要な場合は、「ツール[ヒント通知の処理](../../mfc/handling-tool-tip-notifications.md)」の説明に従って、ツール バーのオーナー ウィンドウでTTN_NEEDTEXT メッセージを処理する必要があります。 ツール バーの親ウィンドウが から`CFrameWnd`派生している場合、ツール ヒントは、既定のハンドラーを`CFrameWnd`提供するため、余分な手間をかけずに表示されます。

1. ユーザーがツール バーをカスタマイズできるようにする場合は、「カスタマイズ通知の処理」の説明に従って、オーナー ウィンドウで[カスタマイズ通知メッセージを処理します](../../mfc/handling-customization-notifications.md)。

[SaveState](#savestate)を使用すると、レジストリ内のツール バー コントロールの現在の状態を保存し[、RestoreState](#restorestate)を使用して、レジストリに以前に格納された情報に基づいて状態を復元できます。 アプリケーションの使用間にツール バーの状態を保存するだけでなく、アプリケーションは通常、ユーザーが後でツール バーを元の状態に復元する場合に備えて、ユーザーがツール バーのカスタマイズを開始する前に状態を保存します。

## <a name="support-for-internet-explorer-version-40-and-later"></a>インターネット エクスプローラ バージョン 4.0 以降のサポート

バージョン 4.0 以降の Internet Explorer で導入された機能をサポートするために、MFC では、ツール バー コントロールのイメージ リストのサポートと透明なスタイルとフラット スタイルが提供されています。

透明なツール バーを使用すると、ツール バーの下のクライアントが表示されます。 透明なツールバーを作成するには、TBSTYLE_FLATスタイルとTBSTYLE_TRANSPARENTスタイルの両方を使用します。 透明なツールバーはホットトラッキングを備えています。つまり、マウス ポインターがツール バーのホット ボタンの上に移動すると、ボタンの外観が変わります。 TBSTYLE_FLATスタイルだけで作成されたツールバーには、透明でないボタンが含まれます。

イメージ リストのサポートにより、コントロールの既定の動作、ホット イメージ、および無効なイメージに対する柔軟性が向上します。 透明なツール[バーで](#getdisabledimagelist)[、次](#getimagelist)の状態に従ってイメージを操作[するには、次](#gethotimagelist)の手順を実行します。

の詳細`CToolBarCtrl`については、「[コントロール](../../mfc/controls-mfc.md)と[CToolBarCtrl](../../mfc/using-ctoolbarctrl.md)を使用する 」を参照してください。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CToolBarCtrl`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxcmn.h

## <a name="ctoolbarctrladdbitmap"></a><a name="addbitmap"></a>をクリックします。

ツール バー コントロールに格納されているボタン イメージの一覧に、1 つまたは複数のボタン イメージを追加します。

```
int AddBitmap(
    int nNumButtons,
    UINT nBitmapID);

int AddBitmap(
    int nNumButtons,
    CBitmap* pBitmap);
```

### <a name="parameters"></a>パラメーター

*NNumボタン*<br/>
ビットマップ内のボタン イメージの数。

*を示す*<br/>
追加するボタン イメージを含むビットマップのリソース識別子。

*ビットマップ*<br/>
追加する`CBitmap`ボタン イメージを含むオブジェクトへのポインター。

### <a name="return-value"></a>戻り値

成功した場合は、最初の新しいイメージの 0 から始まるインデックス。それ以外の場合 - 1。

### <a name="remarks"></a>解説

ビットマップをツール バーに追加する前に、Windows API [CreateMappedBitmap](/windows/win32/api/commctrl/nf-commctrl-createmappedbitmap)を使用して色をマップできます。 `CBitMap`オブジェクトへのポインターを渡す場合は、ツール バーが破棄されるまでビットマップが破棄されないようにする必要があります。

## <a name="ctoolbarctrladdbuttons"></a><a name="addbuttons"></a>ボタンの追加

ツール バー コントロールに 1 つ以上のボタンを追加します。

```
BOOL AddButtons(
    int nNumButtons,
    LPTBBUTTON lpButtons);
```

### <a name="parameters"></a>パラメーター

*NNumボタン*<br/>
追加するボタンの数。

*lp ボタン*<br/>
追加するボタンに`TBBUTTON`関する情報を含む構造体の配列のアドレス。 配列内の要素の数は*nNumButtons*で指定されたボタンと同じである必要があります。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

*lpButtons*ポインタは構造体の`TBBUTTON`配列を指します。 各`TBBUTTON`構造体は、ボタンのスタイル、イメージ、文字列、コマンド ID、状態、およびユーザー定義データに追加されるボタンを関連付けます。

```cpp
typedef struct _TBBUTTON {
    int iBitmap;    // zero-based index of button image
    int idCommand;  // command to be sent when button pressed
    BYTE fsState;   // button state--see below
    BYTE fsStyle;   // button style--see below
    DWORD dwData;   // application-defined value
    int iString;    // zero-based index of button label string
} TBBUTTON;
```

メンバーは次のとおりです。

- `iBitmap`

   ボタン イメージの 0 から始まるインデックスです。

- `idCommand`

   ボタンに関連付けられているコマンド識別子。 この識別子は、ボタンが選択されるとWM_COMMANDメッセージで送信されます。 メンバーに`fsStyle`TBSTYLE_SEP値がある場合、このメンバーはゼロでなければなりません。

- `fsState`

   ボタンの状態フラグ。 以下に示す値を組み合わせることができます。

  - TBSTATE_CHECKED ボタンはTBSTYLE_CHECKEDスタイルを持ち、押されています。

  - TBSTATE_ENABLED ボタンはユーザー入力を受け入れます。 この状態ではないボタンは、ユーザー入力を受け付け、灰色表示になります。

  - TBSTATE_HIDDEN ボタンは表示されず、ユーザー入力を受け取ることができません。

  - TBSTATE_INDETERMINATE ボタンがグレー表示されます。

  - TBSTATE_PRESSED ボタンが押されています。

  - TBSTATE_WRAP ボタンの後に改行が表示されます。 ボタンには、TBSTATE_ENABLED状態も必要です。

- `fsStyle`

   ボタンのスタイル。 以下に示す値を組み合わせることができます。

  - TBSTYLE_BUTTON 標準のプッシュ ボタンを作成します。

  - TBSTYLE_CHECK ユーザーがクリックするたびに押された状態と押されていない状態を切り替えるボタンを作成します。 ボタンが押された状態のとき、背景色が異なります。

  - TBSTYLE_CHECKGROUP グループ内の別のボタンが押されるまで押されたままのチェック ボタンを作成します。

  - TBSTYLE_GROUP グループ内の別のボタンが押されるまで押されたままのボタンを作成します。

  - TBSTYLE_SEP ボタン グループ間に小さな間隔を設け、区切り記号を作成します。 このスタイルのボタンは、ユーザー入力を受け取りません。

- `dwData`

   ユーザー定義データ。

- `iString`

   ボタンのラベルとして使用する文字列の 0 から始まるインデックスです。

インデックスを指定するイメージまたは文字列は[、AddBitmap](#addbitmap) [、AddString](#addstring)、または[AddStrings](#addstrings)を使用して、ツール バー コントロールのリストに追加されている必要があります。

## <a name="ctoolbarctrladdstring"></a><a name="addstring"></a>次の文字列を追加します。

リソース ID として渡される新しい文字列を、ツール バーの文字列の内部リストに追加します。

```
int AddString(UINT nStringID);
```

### <a name="parameters"></a>パラメーター

*文字列 ID*<br/>
ツール バー コントロールの文字列リストに追加する文字列リソースのリソース識別子。

### <a name="return-value"></a>戻り値

成功した場合は、最初の新しい文字列の 0 から始まるインデックスを追加します。それ以外の場合は -1。

## <a name="ctoolbarctrladdstrings"></a><a name="addstrings"></a>次の文字列を追加します。

ツール バー コントロールで使用できる文字列の一覧に新しい文字列を追加します。

```
int AddStrings(LPCTSTR lpszStrings);
```

### <a name="parameters"></a>パラメーター

*文字列*<br/>
ツール バーの文字列リストに追加する 1 つ以上の null で終わる文字列を含むバッファーのアドレス。 最後の文字列は、2 つの NULL 文字で終了する必要があります。

### <a name="return-value"></a>戻り値

成功した場合は、最初の新しい文字列の 0 から始まるインデックスを追加します。それ以外の場合は -1。

### <a name="remarks"></a>解説

バッファー内の文字列は、NULL 文字で区切る必要があります。 最後の文字列に 2 つの null 終端文字があることを確認する必要があります。 定数文字列を適切にフォーマットするには、次のように記述します。

[!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]

または

[!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]

では複数の NULL`CString`文字を使用することはできないため、この関数にオブジェクトを`CString`渡す必要はありません。

## <a name="ctoolbarctrlautosize"></a><a name="autosize"></a>CToolBarCtrl::自動サイズ

ツール バー コントロール全体のサイズを変更します。

```cpp
void AutoSize();
```

### <a name="remarks"></a>解説

親ウィンドウのサイズが変更された場合、またはツール バーのサイズが変更された場合 (ボタンやビットマップのサイズを設定したり、文字列を追加したりする場合など) に、この関数を呼び出す必要があります。

## <a name="ctoolbarctrlchangebitmap"></a><a name="changebitmap"></a>をクリックします。

現在のツール バー コントロールのボタンのビットマップを変更します。

```
BOOL ChangeBitmap(
    int idButton,
    int iBitmap);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*idボタン*|[in]新しいビットマップを受け取るボタンのコマンド識別子。|
|*i ビットマップ*|[in]現在のツール バー コントロールのイメージ リスト内のイメージのインデックスが 0 から始まります。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドが成功すると、指定されたイメージが指定されたボタンに表示されます。

このメソッドは、Windows SDK に記載されている[TB_CHANGEBITMAP](/windows/win32/Controls/tb-changebitmap)メッセージを送信します。

### <a name="example"></a>例

次のコード例では、[**ファイルの保存**] ボタンのビットマップを **[About]** ボタンのビットマップに変更します。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]

## <a name="ctoolbarctrlcheckbutton"></a><a name="checkbutton"></a>チェックボタン

ツール バー コントロール内の特定のボタンをオンまたはオフにします。

```
BOOL CheckButton(
    int nID,
    BOOL bCheck = TRUE);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
チェックまたはクリアするボタンのコマンド識別子。

*bチェック*<br/>
TRUE ボタンをチェックする場合は FALSE、クリアするには FALSE。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

ボタンがチェックされているときは、押されたように見えます。 複数のボタンの状態を変更する場合は、代わりに[SetState を](#setstate)呼び出すことを検討してください。

## <a name="ctoolbarctrlcommandtoindex"></a><a name="commandtoindex"></a>コマンドバーCtrl::コマンドをインデックスに追加します。

指定したコマンド識別子に関連付けられたボタンの 0 から始まるインデックスを取得します。

```
UINT CommandToIndex(UINT nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ボタンインデックスを検索するコマンド ID です。

### <a name="return-value"></a>戻り値

コマンド ID に関連付けられたボタンの 0 から始まるインデックス。

### <a name="remarks"></a>解説

## <a name="ctoolbarctrlcreate"></a><a name="create"></a>CToolBarCtrl::作成

ツール バー コントロールを作成し、`CToolBarCtrl`オブジェクトにアタッチします。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*Dwstyle*<br/>
ツール バー コントロールのスタイルを指定します。 ツールバーには常にWS_CHILDスタイルが必要です。 また、ツールバースタイルとウィンドウスタイルの任意の組み合わせを指定**することもできます。**

*Rect*<br/>
オプションで、ツール バー コントロールのサイズと位置を指定します。 [CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは[RECT](/windows/win32/api/windef/ns-windef-rect)構造体を指定できます。

*pParentWnd*<br/>
ツール バー コントロールの親ウィンドウを指定します。 NULL にすることはできません。

*nID*<br/>
ツール バー コントロールの ID を指定します。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

を`CToolBarCtrl`2 つの手順で作成します。 まず、コンストラクターを呼び出し、`Create`ツール バー コントロールを作成して`CToolBarCtrl`オブジェクトにアタッチする を呼び出します。 ツールバー コントロールに次のウィンドウ スタイルを適用します。

- WS_CHILD常に

- WS_VISIBLE通常

- WS_DISABLEDまれ

ウィンドウ スタイルの詳細については、Windows SDK の[「ウィンドウの作成](/windows/win32/api/winuser/nf-winuser-createwindoww)」を参照してください。

必要に応じて、Windows SDK で説明されているように、[共通のコントロール スタイル](/windows/win32/Controls/common-control-styles)の組み合わせを適用します。

コントロールまたはボタン自体に、ツール バー スタイルの組み合わせを適用します。 これらのスタイルについては、Windows SDK の[ツールバー コントロールとボタン スタイル](/windows/win32/Controls/toolbar-control-and-button-styles)のトピックで説明します。

拡張ツール バー スタイルを使用するには、呼び出`Create`した後[に SetExtendedStyle](#setextendedstyle)を呼び出します。 拡張ウィンドウ スタイルを持つツール バーを作成するには、代わりに[CToolBarCtrl::CreateEx](#createex)を呼び出`Create`します。

ツール バー コントロールは、ツール バー ウィンドウのサイズと位置を自動的に設定します。 高さは、ツールバーのボタンの高さに基づいています。 幅は、親ウィンドウのクライアント領域の幅と同じです。 CCS_TOPおよびCCS_BOTTOMスタイルによって、ツールバーがクライアント領域の上部または下部のどちらに配置されるかが決まります。 既定では、ツールバーにはCCS_TOPスタイルがあります。

## <a name="ctoolbarctrlcreateex"></a><a name="createex"></a>CツールバーCtrl::作成します。

コントロール (子ウィンドウ) を作成し、オブジェクトに関連`CToolBarCtrl`付けます。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*ドウェエクススタイル*<br/>
作成するコントロールの拡張スタイルを指定します。 拡張 Windows スタイルの一覧については、Windows SDK の*DwExStyle*パラメーター[を](/windows/win32/api/winuser/nf-winuser-createwindowexw)参照してください。

*Dwstyle*<br/>
ツール バー コントロールのスタイルを指定します。 ツールバーには常にWS_CHILDスタイルが必要です。 また、ツールバースタイルとウィンドウスタイルの任意の組み合わせを[指定できます。](#create) **Remarks**

*Rect*<br/>
作成するウィンドウのサイズと位置を記述する[RECT](/windows/win32/api/windef/ns-windef-rect)構造体への参照を *、 pParentWnd*のクライアント座標で指定します。

*pParentWnd*<br/>
コントロールの親であるウィンドウへのポインター。

*nID*<br/>
コントロールの子ウィンドウ ID。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

[`CreateEx`[作成]](#create)の代わりに、Windows 拡張スタイルの序文で指定された拡張 Windows スタイル**を適用WS_EX_。** `CreateEx`によって指定された拡張 Windows スタイルを持つコントロール*が作成されます*。 コントロールに固有の拡張スタイルを設定するには、[次の操作を行います](#setextendedstyle)。 たとえば、WS_EX_CONTEXTHELPなどの`CreateEx`スタイルを設定するのには、TBSTYLE_EX_DRAWDDARROWSなどのスタイル`SetExtendedStyle`を設定するために使用します。 詳細については、「Windows SDK の[ツール バー拡張スタイル](/windows/win32/Controls/toolbar-extended-styles)」で説明されているスタイルを参照してください。

## <a name="ctoolbarctrlctoolbarctrl"></a><a name="ctoolbarctrl"></a>CツールバーCtrl::CツールバーCtrl

`CToolBarCtrl` オブジェクトを構築します。

```
CToolBarCtrl();
```

### <a name="remarks"></a>解説

ツール バーを使用できるようにするには[、Create](#create)を呼び出す必要があります。

## <a name="ctoolbarctrlcustomize"></a><a name="customize"></a>CToolBarCtrl::カスタマイズ

[ツールバーのカスタマイズ] ダイアログ ボックスを表示します。

```cpp
void Customize();
```

### <a name="remarks"></a>解説

このダイアログ ボックスでは、ユーザーはボタンを追加および削除して、ツール バーをカスタマイズできます。 カスタマイズをサポートするには、ツールバーの親ウィンドウがカスタマイズ通知メッセージを処理[する](../../mfc/handling-customization-notifications.md)必要があります。 ツールバーは[、cToolBarCtrl::Create](#create)で説明されているように、CCS_ADJUSTABLEスタイルで作成されている必要もあります。

## <a name="ctoolbarctrldeletebutton"></a><a name="deletebutton"></a>:Dエレテボタン

ツール バー コントロールからボタンを削除します。

```
BOOL DeleteButton(int nIndex);
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
削除するボタンの 0 から始まるインデックス。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

## <a name="ctoolbarctrlenablebutton"></a><a name="enablebutton"></a>ボタンを有効にします。

ツール バー コントロールで指定したボタンを有効または無効にします。

```
BOOL EnableButton(
    int nID,
    BOOL bEnable = TRUE);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
有効または無効にするボタンのコマンド識別子。

*b 有効にする*<br/>
ボタンを有効にする場合は TRUE。FALSE を指定すると、ボタンが無効になります。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

ボタンが有効になっている場合は、ボタンを押してチェックすることができます。 複数のボタンの状態を変更する場合は、代わりに[SetState を](#setstate)呼び出すことを検討してください。

## <a name="ctoolbarctrlgetanchorhighlight"></a><a name="getanchorhighlight"></a>キーバーCtrl::アンカーハイライトを取得します。

ツール バーのアンカーの強調表示設定を取得します。

```
BOOL GetAnchorHighlight() const;
```

### <a name="return-value"></a>戻り値

0 以外の場合は、アンカーの強調表示が有効になります。 0 の場合、アンカーの強調表示は無効になります。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETANCHORHIGHLIGHT](/windows/win32/Controls/tb-getanchorhighlight)の動作を実装します。

## <a name="ctoolbarctrlgetbitmap"></a><a name="getbitmap"></a>をクリックします。

ツール バーのボタンに関連付けられているビットマップのインデックスを取得します。

```
int GetBitmap(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ビットマップ インデックスを取得するボタンのコマンド識別子。

### <a name="return-value"></a>戻り値

正常終了した場合はビットマップのインデックスを返し、それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

Windows SDK で[TB_GETBITMAP](/windows/win32/Controls/tb-getbitmap)の機能を実装します。

## <a name="ctoolbarctrlgetbitmapflags"></a><a name="getbitmapflags"></a>をクリックします。

ツール バーからビットマップ フラグを取得します。

```
UINT GetBitmapFlags() const;
```

### <a name="return-value"></a>戻り値

表示が大きなツール バー ビットマップをサポートできる場合は、TBBF_LARGE フラグが設定されている UINT。

### <a name="remarks"></a>解説

ツール バーを作成した後、ツール バーにビットマップを追加する前に、このツール バーを呼び出す必要があります。 戻り値は、ディスプレイが大きなビットマップをサポートするかどうかを示します。 大きなビットマップをサポートする場合、そのビットマップを使用する場合は[、AddBitmap](#addbitmap)を使用して大きなビットマップを追加する前に[SetBitmapSize](#setbitmapsize)と[SetButtonSize](#setbuttonsize)を呼び出します。

## <a name="ctoolbarctrlgetbutton"></a><a name="getbutton"></a>をクリックします。

ツール バー コントロール内の指定されたボタンに関する情報を取得します。

```
BOOL GetButton(
    int nIndex,
    LPTBBUTTON lpButton) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
情報を取得するボタンの 0 から始まるインデックス。

*lpボタン*<br/>
ボタン情報の`TBBUTTON`コピーを受け取る構造体のアドレス。 構造体[の](#addbuttons)詳細については、「ボタンの追加」を参照してください。 `TBBUTTON`

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

## <a name="ctoolbarctrlgetbuttoncount"></a><a name="getbuttoncount"></a>をクリックします。

ツール バー コントロールに現在含まれるボタンの数を取得します。

```
int GetButtonCount() const;
```

### <a name="return-value"></a>戻り値

ボタンの数。

## <a name="ctoolbarctrlgetbuttoninfo"></a><a name="getbuttoninfo"></a>をクリックします。

ツール バーのボタンの情報を取得します。

```
int GetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ボタン識別子。

*プトッビ*<br/>
ボタン情報を受け取る[TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow)構造体へのポインター。

### <a name="return-value"></a>戻り値

成功した場合は、ボタンの 0 から始まるインデックス。それ以外の場合は -1。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETBUTTONINFO](/windows/win32/Controls/tb-getbuttoninfo)の動作を実装します。

## <a name="ctoolbarctrlgetbuttonsize"></a><a name="getbuttonsize"></a>コントロールバーCtrl::ボタンのサイズを取得します。

ツール バー ボタンのサイズを取得します。

```
DWORD GetButtonSize() const;
```

### <a name="return-value"></a>戻り値

LOWORD と HIWORD の幅と高さの値をそれぞれ含む DWORD 値。

## <a name="ctoolbarctrlgetbuttontext"></a><a name="getbuttontext"></a>コントロールバーCtrl::テキストを取得します。

現在のツール バー コントロールの指定したボタンの表示テキストを取得します。

```
CString GetButtonText(int idButton) const;
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*idボタン*|[in]表示テキストが取得されるボタンの識別子。|

### <a name="return-value"></a>戻り値

指定したボタンの表示テキストを含む[CString です](../../atl-mfc-shared/using-cstring.md)。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK で説明されている[TB_GETBUTTONTEXT](/windows/win32/Controls/tb-getbuttontext)メッセージを送信します。

## <a name="ctoolbarctrlgetcolorscheme"></a><a name="getcolorscheme"></a>をクリックします。

現在のツール バー コントロールの配色を取得します。

```
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*スキーム*|[アウト]配色情報を受け取る[COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme)構造体へのポインター。 このメソッドが返されるときに、構造は、ツール バー コントロールの強調表示色と影の色を記述します。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK に記載されている[TB_GETCOLORSCHEME](/windows/win32/Controls/tb-getcolorscheme)メッセージを送信します。

## <a name="ctoolbarctrlgetdisabledimagelist"></a><a name="getdisabledimagelist"></a>を使用します。

ツール バー コントロールが無効なボタンを表示するために使用するイメージ リストを取得します。

```
CImageList* GetDisabledImageList() const;
```

### <a name="return-value"></a>戻り値

[CImageList](../../mfc/reference/cimagelist-class.md)オブジェクトへのポインター、または無効なイメージ リストが設定されていない場合は NULL。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETDISABLEDIMAGELIST](/windows/win32/Controls/tb-getdisabledimagelist)の動作を実装します。 MFC の`GetDisabledImageList`実装では、`CImageList`イメージ リストへのハンドルではなく、ツール バー コントロールのボタン イメージを含むオブジェクトを使用します。

## <a name="ctoolbarctrlgetdroptarget"></a><a name="getdroptarget"></a>をクリックします。

ツール バー コントロールの[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)インターフェイスを取得します。

```
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;
```

### <a name="parameters"></a>パラメーター

*ターゲット*<br/>
[インターフェイス](/windows/win32/api/oleidl/nn-oleidl-idroptarget)ポインターへのポインター。 エラーが発生した場合、このアドレスに NULL ポインターが置かれます。

### <a name="return-value"></a>戻り値

操作の成功または失敗を示す HRESULT 値を返します。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETOBJECT](/windows/win32/Controls/tb-getobject)の動作を実装します。

## <a name="ctoolbarctrlgetextendedstyle"></a><a name="getextendedstyle"></a>を使用します。

ツール バー コントロールの拡張スタイルを取得します。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>戻り値

ツール バー コントロールで現在使用されている拡張スタイルを表す DWORD。 スタイルの一覧については、Windows SDK の[「ツールバー拡張スタイル](/windows/win32/Controls/toolbar-extended-styles)」を参照してください。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETEXTENDEDSTYLE](/windows/win32/Controls/tb-getextendedstyle)の動作を実装します。

## <a name="ctoolbarctrlgethotimagelist"></a><a name="gethotimagelist"></a>をクリックします。

ツール バー コントロールが "ホット" ボタンを表示するために使用するイメージ リストを取得します。 ホット ボタンは、マウス ポインタがその上にあるときに強調表示されます。

```
CImageList* GetHotImageList() const;
```

### <a name="return-value"></a>戻り値

[CImageList](../../mfc/reference/cimagelist-class.md)オブジェクトへのポインター、または無効なイメージ リストが設定されていない場合は NULL。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETHOTIMAGELIST](/windows/win32/Controls/tb-gethotimagelist)の動作を実装します。 ホット ボタンは、マウス ポインタがその上にあるときに強調表示されます。

## <a name="ctoolbarctrlgethotitem"></a><a name="gethotitem"></a>をクリックします。

ツール バーのホット アイテムのインデックスを取得します。

```
int GetHotItem() const;
```

### <a name="return-value"></a>戻り値

ツール バーのホット アイテムの 0 から始まるインデックス。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETHOTITEM](/windows/win32/Controls/tb-gethotitem)の動作を実装します。

## <a name="ctoolbarctrlgetimagelist"></a><a name="getimagelist"></a>をクリックします。

ツール バー コントロールが既定の状態のボタンを表示するために使用するイメージ リストを取得します。

```
CImageList* GetImageList() const;
```

### <a name="return-value"></a>戻り値

[イメージ](../../mfc/reference/cimagelist-class.md)リストが設定されていない場合は Null を指定します。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETIMAGELIST](/windows/win32/Controls/tb-getimagelist)の動作を実装します。

## <a name="ctoolbarctrlgetinsertmark"></a><a name="getinsertmark"></a>をクリックします。

ツール バーの現在の挿入マークを取得します。

```cpp
void GetInsertMark(TBINSERTMARK* ptbim) const;
```

### <a name="parameters"></a>パラメーター

*プトビム*<br/>
挿入マークを受け取る[TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)構造体へのポインター。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETINSERTMARK](/windows/win32/Controls/tb-getinsertmark)の動作を実装します。

## <a name="ctoolbarctrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a>をクリックします。

ツール バーの挿入マークの描画に使用する色を取得します。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>戻り値

現在の挿入マークの色を含む COLORREF 値。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETINSERTMARKCOLOR](/windows/win32/Controls/tb-getinsertmarkcolor)の動作を実装します。

## <a name="ctoolbarctrlgetitemrect"></a><a name="getitemrect"></a>をクリックします。

ツール バー コントロール内のボタンの外接する四角形を取得します。

```
BOOL GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
情報を取得するボタンの 0 から始まるインデックス。

*Lprect*<br/>
外接する四角形の座標を受け取る[RECT](/windows/win32/api/windef/ns-windef-rect)構造体または[CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトのアドレス。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

この関数は、状態がTBSTATE_HIDDENに設定されているボタンの外接する四角形を取得しません。

## <a name="ctoolbarctrlgetmaxsize"></a><a name="getmaxsize"></a>をクリックします。

ツール バーに表示されているすべてのボタンと区切り記号の合計サイズを取得します。

```
BOOL GetMaxSize(LPSIZE pSize) const;
```

### <a name="parameters"></a>パラメーター

*Psize*<br/>
項目のサイズを受け取る[SIZE](/windows/win32/api/windef/ns-windef-size)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETMAXSIZE](/windows/win32/Controls/tb-getmaxsize)の動作を実装します。

## <a name="ctoolbarctrlgetmaxtextrows"></a><a name="getmaxtextrows"></a>をクリックします。

ツール バー ボタンに表示されるテキスト行の最大数を取得します。

```
int GetMaxTextRows() const;
```

### <a name="return-value"></a>戻り値

ツール バー ボタンに表示されるテキスト行の最大数。

## <a name="ctoolbarctrlgetmetrics"></a><a name="getmetrics"></a>をクリックします。

オブジェクトのメトリックを`CToolBarCtrl`取得します。

```cpp
void GetMetrics(LPTBMETRICS ptbm) const;
```

### <a name="parameters"></a>パラメーター

*ptbm*<br/>
オブジェクトの[TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics)構造体への`CToolBarCtrl`ポインター。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように[、TB_GETMETRICS](/windows/win32/Controls/tb-getmetrics)メッセージの機能をエミュレートします。

## <a name="ctoolbarctrlgetpadding"></a><a name="getpadding"></a>次の行

現在のツール バー コントロールの水平および垂直の埋め込みを取得します。

```
BOOL GetPadding(
    int* pnHorzPadding,
    int* pnVertPadding) const;
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*プホルズパディング*|[アウト]ツール バー コントロールの水平方向の埋め込みをピクセル単位で受け取る整数。|
|*を埋め合じておく*|[アウト]ツール バー コントロールの垂直方向の埋め込みをピクセル単位で受け取る整数。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK に記載されている[TB_GETPADDING](/windows/win32/Controls/tb-getpadding)メッセージを送信します。

## <a name="ctoolbarctrlgetpressedimagelist"></a><a name="getpressedimagelist"></a>をクリックします。

現在のツール バー コントロールが押された状態のボタンを表すために使用するイメージ リストを取得します。

```
CImageList* GetPressedImageList();
```

### <a name="return-value"></a>戻り値

現在のコントロールのイメージ リストを含む[CImageList](../../mfc/reference/cimagelist-class.md)へのポインター。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK で説明されている[TB_GETPRESSEDIMAGELIST](/windows/win32/Controls/tb-getpressedimagelist)メッセージを送信します。

## <a name="ctoolbarctrlgetrect"></a><a name="getrect"></a>CToolBarCtrl::ゲットレック

指定したツール バー ボタンの外接する四角形を取得します。

```
BOOL GetRect(
    int nID,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ボタン識別子。

*Lprect*<br/>
外接する四角形の情報を受け取る[RECT](/windows/win32/api/windef/ns-windef-rect)構造体へのポインター。

### <a name="return-value"></a>戻り値

成功した場合は TRUE、それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETRECT](/windows/win32/Controls/tb-getrect)の動作を実装します。

## <a name="ctoolbarctrlgetrows"></a><a name="getrows"></a>を行う

ツール バー コントロールによって現在表示されているボタンの行数を取得します。

```
int GetRows() const;
```

### <a name="return-value"></a>戻り値

現在ツールバーに表示されているボタンの行数。

### <a name="remarks"></a>解説

ツールバーがTBSTYLE_WRAPABLEスタイルで作成されていない限り、行数は常に 1 になります。

## <a name="ctoolbarctrlgetstate"></a><a name="getstate"></a>をクリックします。

ツール バー コントロール内の指定されたボタンの状態 (有効、押し、チェックの有無など) に関する情報を取得します。

```
int GetState(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
情報を取得するボタンのコマンド識別子。

### <a name="return-value"></a>戻り値

成功した場合はボタンの状態情報、または - 1 以外の場合は 1。 ボタンの状態情報は[、CToolBarCtrl::AddButtons](#addbuttons)に示されている値の組み合わせにすることができます。

### <a name="remarks"></a>解説

この関数は、ボタンの状態を複数取得する場合に特に便利です。 1 つの状態を取得するには、[次](#isbuttonenabled)のいずれかのメンバー関数を使用[します。](#isbuttonindeterminate) [IsButtonChecked](#isbuttonchecked) [IsButtonPressed](#isbuttonpressed) [IsButtonHidden](#isbuttonhidden) ただし、`GetState`メンバー関数は、TBSTATE_WRAPボタンの状態を検出する唯一の方法です。

## <a name="ctoolbarctrlgetstring"></a><a name="getstring"></a>を返します。

ツール バー文字列を取得します。

```
int GetString(
    int nString,
    LPTSTR lpstrString,
    int cchMaxLen) const;

int GetString(
    int nString,
    CString& str) const;
```

### <a name="parameters"></a>パラメーター

*nString*<br/>
文字列のインデックス。

*文字列*<br/>
文字列を返すために使用されるバッファーへのポインター。

*cchマックスレン*<br/>
バッファーの長さ (バイト単位)。

*Str*<br/>
文字列。

### <a name="return-value"></a>戻り値

成功した場合は文字列の長さ 。.1.

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_GETSTRING](/windows/win32/Controls/tb-getstring)の動作を実装します。

## <a name="ctoolbarctrlgetstyle"></a><a name="getstyle"></a>をクリックします。

ツール バー コントロールに現在適用されているスタイルを取得します。

```
DWORD GetStyle() const;
```

### <a name="return-value"></a>戻り値

Windows SDK で説明されているように、[ツール バー コントロール スタイル](/windows/win32/Controls/toolbar-control-and-button-styles)の組み合わせを含む DWORD。

## <a name="ctoolbarctrlgettooltips"></a><a name="gettooltips"></a>ツールバーCtrl::ヒントを取得します。

ツール バー コントロールに関連付けられているツール ヒント コントロールがある場合は、ハンドルを取得します。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>戻り値

このツール バーに関連付けられている[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)オブジェクトへのポインターを返します。

### <a name="remarks"></a>解説

ツール バー コントロールは通常、独自のツール ヒント コントロールを作成および維持するため、ほとんどのプログラムはこの関数を呼び出す必要はありません。

## <a name="ctoolbarctrlhittest"></a><a name="hittest"></a>CToolBarCtrl::ヒットテスト

ツール バー コントロール内のポイントの位置を指定します。

```
int HitTest(LPPOINT ppt) const;
```

### <a name="parameters"></a>パラメーター

*Ppt*<br/>
メンバ内のヒット テストの x 座標と、メンバ内のヒット テストの y 座標を含む POINT`y`構造体へのポインター。 [POINT](/windows/win32/api/windef/ns-windef-point) `x` 座標は、ツール バーのクライアント領域を基準にしています。

### <a name="return-value"></a>戻り値

ツール バー上のポイントの位置を示す整数値。 値が 0 または正の値の場合、この戻り値は、ポイントがある非区切り記号項目の 0 から始まるインデックスです。

戻り値が負の場合、ポイントはボタン内に存在しません。 戻り値の絶対値は、区切り記号項目または最も近い区切り記号項目のインデックスです。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_HITTEST](/windows/win32/Controls/tb-hittest)の動作を実装します。

## <a name="ctoolbarctrlhidebutton"></a><a name="hidebutton"></a>コントロールを非表示にします。

ツール バー コントロールで指定したボタンの表示と非表示を切り替えます。

```
BOOL HideButton(
    int nID,
    BOOL bHide = TRUE);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
表示または非表示にするボタンのコマンド識別子。

*bHide*<br/>
TRUE ボタンを非表示にする場合は FALSE、表示するには FALSE。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

複数のボタンの状態を変更する場合は、代わりに[SetState を](#setstate)呼び出すことを検討してください。

## <a name="ctoolbarctrlindeterminate"></a><a name="indeterminate"></a>CToolBarCtrl::不確定

ツール バー コントロール内の指定されたボタンの不定状態を設定またはクリアします。

```
BOOL Indeterminate(
    int nID,
    BOOL bIndeterminate = TRUE);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
不確定状態を設定またはクリアするボタンのコマンド識別子。

*bインデミター*<br/>
TRUE を指定すると、指定したボタンの不確定状態が設定され、クリアする場合は FALSE になります。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

選択したテキストに太字と標準文字の両方が含まれている場合に、ワード プロセッサのツールバーの太字ボタンが表示されるなど、不確定なボタンが灰色で表示されます。 複数のボタンの状態を変更する場合は、代わりに[SetState を](#setstate)呼び出すことを検討してください。

## <a name="ctoolbarctrlinsertbutton"></a><a name="insertbutton"></a>ボタンを押します。

ツール バー コントロールにボタンを挿入します。

```
BOOL InsertButton(
    int nIndex,
    LPTBBUTTON lpButton);
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
ボタンの 0 から始まるインデックス。 この関数は、このボタンの左側に新しいボタンを挿入します。

*lpボタン*<br/>
挿入するボタン`TBBUTTON`に関する情報を含む構造体のアドレス。 構造体[の説明については、CToolBarCtrl::ボタン](#addbuttons)の追加`TBBUTTON`を参照してください。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

インデックスを指定するイメージまたは文字列は[、AddBitmap](#addbitmap) [、AddString](#addstring)、または[AddStrings](#addstrings)を使用して、ツール バー コントロールのリストに追加されている必要があります。

## <a name="ctoolbarctrlinsertmarkhittest"></a><a name="insertmarkhittest"></a>をクリックします。

ツール バーのポイントの挿入マーク情報を取得します。

```
BOOL InsertMarkHitTest(
    LPPOINT ppt,
    LPTBINSERTMARK ptbim) const;
```

### <a name="parameters"></a>パラメーター

*Ppt*<br/>
ツール バーのクライアント領域を基準としたヒット テスト座標を含む[POINT](/windows/win32/api/windef/ns-windef-point)構造体へのポインター。

*プトビム*<br/>
挿入マーク情報を受け取る[TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)構造体へのポインター。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_INSERTMARKHITTEST](/windows/win32/Controls/tb-insertmarkhittest)の動作を実装します。

## <a name="ctoolbarctrlisbuttonchecked"></a><a name="isbuttonchecked"></a>チェックされたボタン

ツール バー コントロール内の指定されたボタンがオンになっているかどうかを判断します。

```
BOOL IsButtonChecked(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ツール バーのボタンのコマンド識別子です。

### <a name="return-value"></a>戻り値

ボタンがオンの場合は 0 以外の値を指定します。それ以外の場合は 0。

### <a name="remarks"></a>解説

複数のボタンの状態を取得する場合は[、GetState](#getstate)を呼び出すことを検討してください。

## <a name="ctoolbarctrlisbuttonenabled"></a><a name="isbuttonenabled"></a>ボタンを押します。

ツール バー コントロール内の指定されたボタンが有効かどうかを判断します。

```
BOOL IsButtonEnabled(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ツール バーのボタンのコマンド識別子です。

### <a name="return-value"></a>戻り値

ボタンが有効な場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

複数のボタンの状態を取得する場合は[、GetState](#getstate)を呼び出すことを検討してください。

## <a name="ctoolbarctrlisbuttonhidden"></a><a name="isbuttonhidden"></a>コントロールバーCtrl::ボタン隠し

ツール バー コントロール内の指定したボタンが非表示かどうかを判断します。

```
BOOL IsButtonHidden(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ツール バーのボタンのコマンド識別子です。

### <a name="return-value"></a>戻り値

ボタンが非表示の場合は 0 以外の値を指定します。それ以外の場合は 0。

### <a name="remarks"></a>解説

複数のボタンの状態を取得する場合は[、GetState](#getstate)を呼び出すことを検討してください。

## <a name="ctoolbarctrlisbuttonhighlighted"></a><a name="isbuttonhighlighted"></a>ボタンが強調表示されました。

ツール バー ボタンの強調表示状態をチェックします。

```
BOOL IsButtonHighlighted(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
[in]ツール バー ボタンのコマンド ID。

### <a name="return-value"></a>戻り値

ボタンが強調表示されている場合は正の整数、ボタンが強調表示されていない場合は 0、エラーが発生した場合は -1。

## <a name="ctoolbarctrlisbuttonindeterminate"></a><a name="isbuttonindeterminate"></a>CToolBarCtrl::IsButtonindeterminate

ツール バー コントロール内の指定されたボタンが不確定かどうかを判断します。

```
BOOL IsButtonIndeterminate(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
[in]ツール バーのボタンのコマンド識別子です。

### <a name="return-value"></a>戻り値

ボタンが不確定な場合は正の整数、ボタンが不確定の場合は 0、エラーが発生した場合は -1。

### <a name="remarks"></a>解説

選択したテキストに太字と標準文字の両方が含まれている場合に、ワード プロセッサのツールバーの太字ボタンが表示されるなど、不確定なボタンが淡色表示されます。 複数のボタンの状態を取得する場合は[、GetState](#getstate)を呼び出すことを検討してください。

## <a name="ctoolbarctrlisbuttonpressed"></a><a name="isbuttonpressed"></a>CToolBarCtrl::イボタン押下

ツール バー コントロール内の指定されたボタンが押されているかどうかを判断します。

```
BOOL IsButtonPressed(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ツール バーのボタンのコマンド識別子です。

### <a name="return-value"></a>戻り値

ボタンが押された場合は 0 以外の値を返します。

### <a name="remarks"></a>解説

複数のボタンの状態を取得する場合は[、GetState](#getstate)を呼び出すことを検討してください。

## <a name="ctoolbarctrlloadimages"></a><a name="loadimages"></a>をクリックします。

ビットマップをツール バー コントロールのイメージ リストに読み込みます。

```cpp
void LoadImages(
    int iBitmapID,
    HINSTANCE hinst);
```

### <a name="parameters"></a>パラメーター

*i ビットマップID*<br/>
読み込むイメージを含むビットマップの ID。 独自のビットマップ リソースを指定するには、このパラメーターをビットマップ リソースの ID に設定し *、hInst*を NULL に設定します。 ビットマップ リソースは、単一のイメージとしてイメージ リストに追加されます。 標準のシステム定義ビットマップを追加するには *、hinst*を HINST_COMMCTRL に設定し、このパラメーターを次の ID のいずれかに設定します。

|ビットマップ ID|説明|
|---------------|-----------------|
|IDB_HIST_LARGE_COLOR|大きなサイズのエクスプ ローラー ビットマップ|
|IDB_HIST_SMALL_COLOR|小さいサイズのエクスプ ローラー ビットマップ|
|IDB_STD_LARGE_COLOR|大きなサイズの標準ビットマップ|
|IDB_STD_SMALL_COLOR|小さいサイズの標準ビットマップ|
|IDB_VIEW_LARGE_COLOR|ビットマップを大きなサイズで表示する|
|IDB_VIEW_SMALL_COLOR|ビットマップを小さいサイズで表示する|

*ヒンスト*<br/>
呼び出し元アプリケーションへのプログラム インスタンス ハンドル。 このパラメーターは、標準イメージ リストを読み込むためにHINST_COMMCTRLできます。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_LOADIMAGES](/windows/win32/Controls/tb-loadimages)の動作を実装します。

## <a name="ctoolbarctrlmapaccelerator"></a><a name="mapaccelerator"></a>CToolBarCtrl::マップアクセラレータ

アクセラレータ文字をツール バー ボタンに割り当てます。

```
BOOL MapAccelerator(
    TCHAR chAccel,
    UINT* pIDBtn);
```

### <a name="parameters"></a>パラメーター

*チャッセル*<br/>
マップするアクセラレータ文字。 この文字は、ボタンのテキストに下線が引かれている文字と同じです。

*プイドブタン*<br/>
*chAccel*で指定されたアクセラレーターに対応するボタンのコマンド ID を受け取る UINT へのポインター。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_MAPACCELERATOR](/windows/win32/Controls/tb-mapaccelerator)の動作を実装します。

## <a name="ctoolbarctrlmarkbutton"></a><a name="markbutton"></a>CツールバーCtrl::マークボタン

ツール バー コントロール内の特定のボタンの強調表示状態を設定します。

```
BOOL MarkButton(
    int nID,
    BOOL fHighlight = TRUE);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ボタン識別子。

*fハイライト*<br/>
設定するハイライト状態を指定します。 既定では、TRUE。 FALSE に設定すると、ボタンは既定の状態に設定されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_MARKBUTTON](/windows/win32/Controls/tb-markbutton)の動作を実装します。

## <a name="ctoolbarctrlmovebutton"></a><a name="movebutton"></a>ボタンの移動

ボタンをインデックス間で移動します。

```
BOOL MoveButton(
    UINT nOldPos,
    UINT nNewPos);
```

### <a name="parameters"></a>パラメーター

*をクリックしてください。*<br/>
移動するボタンの 0 から始まるインデックス。

*ネニューポス*<br/>
ボタンの移動先の 0 から始まるインデックス。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_MOVEBUTTON](/windows/win32/Controls/tb-movebutton)の動作を実装します。

## <a name="ctoolbarctrlpressbutton"></a><a name="pressbutton"></a>:Pレスボタン

ツール バー コントロールで指定したボタンを押すか、または離します。

```
BOOL PressButton(int nID, BOOL bPress = TRUE);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
[in]押すか離すボタンのコマンド識別子。

*bプレス*<br/>
[in]指定したボタンを押す場合は TRUE。指定したボタンを解放する場合は FALSE。 既定値は TRUE です。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

複数のボタンの状態を変更する場合は、代わりに[SetState を](#setstate)呼び出すことを検討してください。

このメソッドは、Windows SDK で説明されている[TB_PRESSBUTTON](/windows/win32/Controls/tb-pressbutton)メッセージを送信します。

## <a name="ctoolbarctrlreplacebitmap"></a><a name="replacebitmap"></a>を置き換える

現在のツール バー コントロールの既存のビットマップを新しいビットマップで置き換えます。

```
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*を置換します。*|[in]置き換えるビットマップと新しいビットマップを記述する[TBREPLACEBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbreplacebitmap)構造体へのポインター。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK で説明されている[TB_REPLACEBITMAP](/windows/win32/Controls/tb-replacebitmap)メッセージを送信します。

### <a name="example"></a>例

標準ツール バーのビットマップを別のビットマップに置き換えるコード例を次に示します。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]

## <a name="ctoolbarctrlrestorestate"></a><a name="restorestate"></a>状態を復元します。

パラメーターで指定されたレジストリ内の場所からツール バー コントロールの状態を復元します。

```cpp
void RestoreState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>パラメーター

*hキールート*<br/>
レジストリ内で現在開いているキー、または次の定義済みの予約済みハンドル値を識別します。

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*サブキー*<br/>
値が関連付けられているサブキーの名前を含む null で終わる文字列へのポイント。 このパラメーターには、null または空の文字列へのポインターを指定できます。 パラメーターが NULL の場合、値は*hKeyRoot*パラメーターで識別されるキーに追加されます。

*名前を変更します。*<br/>
取得する値の名前を含む文字列へのポイント。 この名前の値がキーにまだ存在しない場合、このキーをキーに追加します。

## <a name="ctoolbarctrlsavestate"></a><a name="savestate"></a>をクリックします。

パラメーターで指定されたレジストリの場所にツール バー コントロールの状態を保存します。

```cpp
void SaveState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>パラメーター

*hキールート*<br/>
レジストリ内で現在開いているキー、または次の定義済みの予約済みハンドル値を識別します。

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*サブキー*<br/>
値が関連付けられているサブキーの名前を含む null で終わる文字列へのポイント。 このパラメーターには、null または空の文字列へのポインターを指定できます。 パラメーターが NULL の場合、値は*hKeyRoot*パラメーターで識別されるキーに追加されます。

*名前を変更します。*<br/>
設定する値の名前を含む文字列へのポイント。 この名前の値がキーにまだ存在しない場合、このキーをキーに追加します。

## <a name="ctoolbarctrlsetanchorhighlight"></a><a name="setanchorhighlight"></a>キーバーCtrl::アンカーハイライトを設定します。

ツールバーのアンカーハイライト設定を設定します。

```
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```

### <a name="parameters"></a>パラメーター

*fアンカー*<br/>
[in]アンカーの強調表示を有効にするか無効にするかを指定します。 この値が 0 以外の場合は、アンカーの強調表示が有効になります。 この値が 0 の場合、アンカーの強調表示は無効になります。

### <a name="return-value"></a>戻り値

直前のアンカー設定。 強調表示が有効になっている場合、この値は 0 以外になります。 強調表示が有効になっていない場合、この値はゼロです。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK で説明されているように、Win32 メッセージ[TB_SETANCHORHIGHLIGHT](/windows/win32/Controls/tb-setanchorhighlight)の動作を実装します。

## <a name="ctoolbarctrlsetbitmapsize"></a><a name="setbitmapsize"></a>をクリックします。

ツール バー コントロールに追加する実際のビットマップ イメージのサイズを設定します。

```
BOOL SetBitmapSize(CSize size);
```

### <a name="parameters"></a>パラメーター

*size*<br/>
ビットマップ イメージの幅と高さ (ピクセル単位)。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

この関数は、ツール バーにビットマップを追加する前にのみ呼び出す必要があります。 アプリケーションがビットマップサイズを明示的に設定しない場合、デフォルトは 16 x 15 ピクセルになります。

## <a name="ctoolbarctrlsetbuttoninfo"></a><a name="setbuttoninfo"></a>をクリックします。

ツールバーの既存のボタンの情報を設定します。

```
BOOL SetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ボタン識別子。

*プトッビ*<br/>
ボタン情報を受け取る[TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

メンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_SETBUTTONINFO](/windows/win32/Controls/tb-setbuttoninfo)の動作を実装します。

## <a name="ctoolbarctrlsetbuttonsize"></a><a name="setbuttonsize"></a>コントロール::セットボタンサイズ

ツール バー コントロールのボタンのサイズを設定します。

```
BOOL SetButtonSize(CSize size);
```

### <a name="parameters"></a>パラメーター

*size*<br/>
ボタンの幅と高さ (ピクセル単位)。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

ボタンのサイズは、常に、そのボタンが囲むビットマップサイズと同じ大きさである必要があります。 この関数は、ツール バーにビットマップを追加する前にのみ呼び出す必要があります。 アプリケーションがボタンサイズを明示的に設定しない場合、デフォルトは 24 x 22 ピクセルになります。

### <a name="example"></a>例

  [の](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl)例を参照してください。

## <a name="ctoolbarctrlsetbuttonstructsize"></a><a name="setbuttonstructsize"></a>コントロールコントロール::セットボタン構造体のサイズ

構造体のサイズを指定`TBBUTTON`します。

```cpp
void SetButtonStructSize(int nSize);
```

### <a name="parameters"></a>パラメーター

*Nsize*<br/>
`TBBUTTON`構造体のサイズ (バイト単位)。

### <a name="remarks"></a>解説

構造体に余分なデータを格納する場合`TBBUTTON`は、 から`TBBUTTON`新しい構造体を派生させるか、構造体を最初のメンバーとして含む新しい構造体を`TBBUTTON`作成します。 次に、この関数を呼び出して、新しい構造体のサイズをツール バーコントロールに指示します。

構造体[の](#addbuttons)詳細については、「ボタンの追加」を参照してください。 `TBBUTTON`

## <a name="ctoolbarctrlsetbuttonwidth"></a><a name="setbuttonwidth"></a>コントロール::ボタン幅の設定

ツール バー コントロールのボタンの最小幅と最大幅を設定します。

```
BOOL SetButtonWidth(
    int cxMin,
    int cxMax);
```

### <a name="parameters"></a>パラメーター

*cxMin*<br/>
最小ボタン幅 (ピクセル単位)。 ツール バー のボタンは、この値より狭くすることはできません。

*cxマックス*<br/>
ボタンの最大幅 (ピクセル単位)。 ボタンテキストが広すぎる場合、コントロールは省略記号付きのテキストを表示します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_SETBUTTONWIDTH](/windows/win32/Controls/tb-setbuttonwidth)の動作を実装します。

## <a name="ctoolbarctrlsetcmdid"></a><a name="setcmdid"></a>をクリックします。

指定したボタンが押されたときにオーナー ウィンドウに送信されるコマンド識別子を設定します。

```
BOOL SetCmdID(
    int nIndex,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
コマンド ID を設定するボタンの 0 から始まるインデックス。

*nID*<br/>
選択したボタンを設定するコマンド ID。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0。

## <a name="ctoolbarctrlsetcolorscheme"></a><a name="setcolorscheme"></a>コントロール::カラースキームの設定

現在のツール バー コントロールの配色を設定します。

```cpp
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*スキーム*|[in]ツール バー コントロールの強調表示色と影の色を記述する[COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme)構造体へのポインター。|

### <a name="remarks"></a>解説

Windows Vista のビジュアル テーマが設定されている場合、このメソッドは無効です。

このメソッドは、Windows SDK で説明されている[TB_SETCOLORSCHEME](/windows/win32/Controls/tb-setcolorscheme)メッセージを送信します。

### <a name="example"></a>例

次のコード例では、現在のツール バー コントロールの配色を設定します。 このコード例では、各ツール ボタンの左端と上端を赤、右と下の端を青にします。 ユーザーがボタンを押すと、ボタンの赤いエッジが青に変わり、青のエッジが赤に変わります。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]

## <a name="ctoolbarctrlsetdisabledimagelist"></a><a name="setdisabledimagelist"></a>を使用します。

ツール バー コントロールが無効なボタンを表示するために使用するイメージ リストを設定します。

```
CImageList* SetDisabledImageList(CImageList* pImageList);
```

### <a name="parameters"></a>パラメーター

*一覧*<br/>
無効なボタン`CImageList`イメージを表示するためにツール バー コントロールで使用されるイメージを含むオブジェクトへのポインター。

### <a name="return-value"></a>戻り値

無効なボタン イメージを表示するためにツール バー コントロールで以前に使用されていた[CImageList](../../mfc/reference/cimagelist-class.md)オブジェクトへのポインター。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_SETDISABLEDIMAGELIST](/windows/win32/Controls/tb-setdisabledimagelist)の動作を実装します。 MFC の`SetDisabledImageList`実装では、`CImageList`イメージ リストへのハンドルではなく、ツール バー コントロールの無効なボタン イメージを含むオブジェクトを使用します。

## <a name="ctoolbarctrlsetdrawtextflags"></a><a name="setdrawtextflags"></a>をクリックします。

指定された四角形のテキストを描画するために使用される、Win32 関数[DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)のフラグを設定します。

```
DWORD SetDrawTextFlags(
    DWORD dwMask,
    DWORD dwDTFlags);
```

### <a name="parameters"></a>パラメーター

*Dwmask*<br/>
Win32 関数[DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)で指定された 1 つ以上のDT_ フラグの組み合わせ*dwDTFlags*。

*dwDT フラグ*<br/>
ボタン テキストの描画方法を示す、Win32 関数`DrawText`で指定された 1 つまたは複数のDT_ フラグの組み合わせ。 この値は、ボタン`DrawText`テキストが描画されるときにに渡されます。

### <a name="return-value"></a>戻り値

前のテキスト描画フラグを含む DWORD。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_SETDRAWTEXTFLAGS](/windows/win32/Controls/tb-setdrawtextflags)の動作を実装します。 このメンバー関数は、指定された四角形のテキストを`DrawText`描画する Win32 関数のフラグを設定します。

## <a name="ctoolbarctrlsetextendedstyle"></a><a name="setextendedstyle"></a>コントロール::セットエクステンドスタイル

ツール バー コントロールの拡張スタイルを設定します。

```
DWORD SetExtendedStyle(DWORD dwExStyle);
```

### <a name="parameters"></a>パラメーター

*ドウェエクススタイル*<br/>
新しい拡張スタイルを指定する値。 このパラメーターは、ツールバーの拡張スタイルの組み合わせにすることができます。

### <a name="return-value"></a>戻り値

以前の拡張スタイルを表す DWORD。 スタイルの一覧については、Windows SDK の[「ツールバー拡張スタイル](/windows/win32/Controls/toolbar-extended-styles)」を参照してください。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_SETEXTENDEDSTYLE](/windows/win32/Controls/tb-setextendedstyle)の動作を実装します。

## <a name="ctoolbarctrlsethotimagelist"></a><a name="sethotimagelist"></a>をクリックします。

ツール バー コントロールが "ホット" ボタンを表示するために使用するイメージ リストを設定します。

```
CImageList* SetHotImageList(CImageList* pImageList);
```

### <a name="parameters"></a>パラメーター

*一覧*<br/>
ホット ボタン`CImageList`イメージを表示するためにツール バー コントロールで使用されるイメージを含むオブジェクトへのポインター。

### <a name="return-value"></a>戻り値

ホット ボタン イメージを表示するためにツール バー コントロールで以前に使用されていた[CImageList](../../mfc/reference/cimagelist-class.md)オブジェクトへのポインター。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_SETHOTIMAGELIST](/windows/win32/Controls/tb-sethotimagelist)の動作を実装します。

MFC の`SetHotImageList`実装では、`CImageList`イメージ リストへのハンドルではなく、ツール バー コントロールのホット ボタン イメージを含むオブジェクトを使用します。 ホット ボタンは、ポインタがその上にあるときに強調表示されます。

## <a name="ctoolbarctrlsethotitem"></a><a name="sethotitem"></a>をクリックします。

ホットアイテムをツールバーに設定します。

```
int SetHotItem(int nHot);
```

### <a name="parameters"></a>パラメーター

*nホット*<br/>
ホットにする項目の 0 から始まるインデックス番号。 この値が -1 の場合、どの項目もホットになります。

### <a name="return-value"></a>戻り値

前のホット項目のインデックス。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_SETHOTITEM](/windows/win32/Controls/tb-sethotitem)の動作を実装します。

## <a name="ctoolbarctrlsetimagelist"></a><a name="setimagelist"></a>をクリックします。

ツール バーが既定の状態にあるボタンを表示するために使用するイメージ リストを設定します。

```
CImageList* SetImageList(CImageList* pImageList);
```

### <a name="parameters"></a>パラメーター

*一覧*<br/>
ツール バー`CImageList`コントロールが既定の状態でボタン イメージを表示するために使用するイメージを含むオブジェクトへのポインター。

### <a name="return-value"></a>戻り値

既定の状態でボタン イメージを表示するためにツール バー コントロールで以前に使用されていた[CImageList](../../mfc/reference/cimagelist-class.md)オブジェクトへのポインター。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_SETIMAGELIST](/windows/win32/Controls/tb-setimagelist)の動作を実装します。

MFC の`SetImageList`実装では、`CImageList`イメージ リストへのハンドルではなく、ツール バー コントロールのボタン イメージを含むオブジェクトを使用します。

## <a name="ctoolbarctrlsetindent"></a><a name="setindent"></a>をクリックします。

ツール バー コントロールの最初のボタンのインデントを設定します。

```
BOOL SetIndent(int iIndent);
```

### <a name="parameters"></a>パラメーター

*i インデント*<br/>
インデントをピクセル単位で指定する値。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

## <a name="ctoolbarctrlsetinsertmark"></a><a name="setinsertmark"></a>を挿入します。

ツール バーの現在の挿入マークを設定します。

```cpp
void SetInsertMark(TBINSERTMARK* ptbim);
```

### <a name="parameters"></a>パラメーター

*プトビム*<br/>
挿入マークを含む[TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)構造体へのポインター。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_SETINSERTMARK](/windows/win32/Controls/tb-setinsertmark)の動作を実装します。

## <a name="ctoolbarctrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a>をクリックします。

ツール バーの挿入マークの描画に使用する色を設定します。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>パラメーター

*clrNew*<br/>
新しい挿入マークの色を含む COLORREF 値。

### <a name="return-value"></a>戻り値

前の挿入マークの色を含む COLORREF 値。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TB_SETINSERTMARKCOLOR](/windows/win32/Controls/tb-setinsertmarkcolor)の動作を実装します。

## <a name="ctoolbarctrlsetmaxtextrows"></a><a name="setmaxtextrows"></a>をクリックします。

ツール バー ボタンに表示されるテキスト行の最大数を設定します。

```
BOOL SetMaxTextRows(int iMaxRows);
```

### <a name="parameters"></a>パラメーター

*を行う*<br/>
設定する行の最大数。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

## <a name="ctoolbarctrlsetmetrics"></a><a name="setmetrics"></a>をクリックします。

オブジェクトのメトリックを`CToolBarCtrl`設定します。

```cpp
void SetMetrics(LPTBMETRICS ptbm);
```

### <a name="parameters"></a>パラメーター

*ptbm*<br/>
オブジェクトの[TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics)構造体への`CToolBarCtrl`ポインター。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように[、TB_SETMETRICS](/windows/win32/Controls/tb-setmetrics)メッセージの機能をエミュレートします。

## <a name="ctoolbarctrlsetowner"></a><a name="setowner"></a>CツールバーCtrl::セットオーナー

ツール バー コントロールの所有者ウィンドウを設定します。

```cpp
void SetOwner(CWnd* pWnd);
```

### <a name="parameters"></a>パラメーター

*Pwnd*<br/>
ツール バー `CWnd` `CWnd`コントロールの新しいオーナー ウィンドウとなるまたは派生オブジェクトへのポインター。

### <a name="remarks"></a>解説

オーナー ウィンドウは、ツール バーから通知を受け取るウィンドウです。

## <a name="ctoolbarctrlsetpadding"></a><a name="setpadding"></a>をクリックします。

現在のツール バー コントロールの水平および垂直のパディングを設定します。

```
DWORD SetPadding(
    int nHorzPadding,
    int nVertPadding);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*を行う*|[in]ツール バー コントロールの水平方向のパディングをピクセル単位で指定します。|
|*をクリックします。*|[in]ツール バー コントロールの垂直方向のパディングをピクセル単位で指定します。|

### <a name="return-value"></a>戻り値

下位ワードに前の水平パディング値が含まれ、上位ワードに前の垂直パディング値が含まれている DWORD。 埋め込み値はピクセル単位で測定されます。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK に記載されている[TB_SETPADDING](/windows/win32/Controls/tb-setpadding)メッセージを送信します。

### <a name="example"></a>例

次のコード例では、現在のツール バー コントロールの水平方向と垂直方向のパディングを 20 ピクセルに設定します。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]

## <a name="ctoolbarctrlsetpressedimagelist"></a><a name="setpressedimagelist"></a>一覧をクリックします。

現在のツール バー コントロールが押された状態のボタンを表すために使用するイメージ リストを設定します。

```
CImagelist* SetPressedImageList(
    int iImageID,
    CImageList* pImageList);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*イメージID*|[in]イメージ リストの 0 から始まるインデックス。 イメージ リストを 1 つだけ使用する場合は、このパラメーターを 0 に設定します。|
|*一覧*|[in]新しいイメージ リストを含む[CImageList](../../mfc/reference/cimagelist-class.md)へのポインター。|

### <a name="return-value"></a>戻り値

現在のコントロールの前のイメージ リストを含む[CImageList](../../mfc/reference/cimagelist-class.md)へのポインター。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK に記載されている[TB_SETPRESSEDIMAGELIST](/windows/win32/Controls/tb-setpressedimagelist)メッセージを送信します。

### <a name="example"></a>例

次のコード例では、押されたイメージ リストを既定のイメージ リストと同じに設定します。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]

## <a name="ctoolbarctrlsetrows"></a><a name="setrows"></a>CToolBarCtrl::セットロウ

ツール バー コントロールに、要求された行数に合わせてサイズを変更するように要求します。

```cpp
void SetRows(
    int nRows,
    BOOL bLarger,
    LPRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*nRows*<br/>
要求された行数。

*大きく*<br/>
ツール バーのサイズを要求された行数に変更できない場合に、使用する行数を増やすか、または少ない行を使用するかを指定します。

*Lprect*<br/>
ツール バーの新しい外接する四角形を受け取る[CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは[RECT](/windows/win32/api/windef/ns-windef-rect)構造体へのポインター。

### <a name="remarks"></a>解説

ツール バーのサイズが要求された数または行に合わせてサイズ変更できない場合は *、bSize*の値に応じて、次に大きいサイズまたは次に小さい有効なサイズにサイズが変更されます。 *b大きい*場合は TRUE、新しい行数は要求された数よりも大きくなります。 *b大きい*場合は FALSE、新しい行数は要求された数よりも小さくなります。

すべての行が同じ数のボタン (おそらく最後の行を除く) になるようにボタンを配置できる場合、指定された行数はツールバーに対して有効です。 たとえば、4 つのボタンを含むツールバーは、最後の 2 行を短くする必要があるため、3 行にサイズを変更できませんでした。 3 行にサイズを設定しようとすると *、bSize*が TRUE の場合は 4 行 *、bSize*が FALSE の場合は 2 行を取得します。

ツールバーに区切り文字がある場合、指定された行数が有効な場合のルールはより複雑です。 レイアウトは、ボタン グループ (最初のボタンと最後のボタンの前に区切り記号が付いたボタン) が、グループが 1 行に収まらない場合に複数の行で分割されないように計算されます。

グループが 1 つの行に収まらない場合、次のグループは、大きなグループが終了した行に収まる場合でも、次の行から開始されます。 この規則の目的は、大きなグループ間の分離をより顕著にすることです。 結果として得られる縦の区切り記号は行としてカウントされます。

また、`SetRows`メンバー関数は常に、最小のツール バー サイズになるレイアウトを選択します。 TBSTYLE_WRAPABLEスタイルでツールバーを作成し、コントロールのサイズを変更すると、コントロールの幅を指定して上記で説明したメソッドが適用されます。

この関数は、TBSTYLE_WRAPABLE スタイルで作成されたツールバーに対してのみ呼び出すことができます。

## <a name="ctoolbarctrlsetstate"></a><a name="setstate"></a>をクリックします。

ツール バー コントロール内の指定したボタンの状態を設定します。

```
BOOL SetState(
    int nID,
    UINT nState);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ボタンのコマンド識別子。

*nステート*<br/>
状態フラグ。 これは、[ボタン](#addbuttons)の状態に表示される値の組み合わせにすることができます。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

この機能は、ボタンの状態を複数設定する場合に特に便利です。 1 つの状態を設定するには、次のいずれかのメンバー関数を使用[します。](#enablebutton) [CheckButton](#checkbutton) [HideButton](#hidebutton) [Indeterminate](#indeterminate) [PressButton](#pressbutton)

## <a name="ctoolbarctrlsetstyle"></a><a name="setstyle"></a>コントロール::セットスタイル

ツール バー コントロールのスタイルを設定します。

```cpp
void SetStyle(DWORD dwStyle);
```

### <a name="parameters"></a>パラメーター

*Dwstyle*<br/>
Windows SDK で説明されているように、[ツール バー コントロール スタイル](/windows/win32/Controls/toolbar-control-and-button-styles)の組み合わせを含む DWORD。

## <a name="ctoolbarctrlsettooltips"></a><a name="settooltips"></a>ツールバーCtrl::ヒントの設定

ツール ヒント コントロールをツール バー コントロールに関連付けます。

```cpp
void SetToolTips(CToolTipCtrl* pTip);
```

### <a name="parameters"></a>パラメーター

*pTip*<br/>
[オブジェクトへの](../../mfc/reference/ctooltipctrl-class.md)ポインター。

## <a name="ctoolbarctrlsetwindowtheme"></a><a name="setwindowtheme"></a>コントロールウィンドウの設定

オブジェクトの表示スタイルを`CToolBarCtrl`設定します。

```
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```

### <a name="parameters"></a>パラメーター

*を使用します。*<br/>
設定するツール バーの表示スタイルを含む Unicode 文字列へのポインター。

### <a name="return-value"></a>戻り値

戻り値は使用されません。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように[、TB_SETWINDOWTHEME](/windows/win32/Controls/tb-setwindowtheme)メッセージの機能をエミュレートします。

## <a name="see-also"></a>関連項目

[サンプル CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[MFC サンプル MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CWnd クラス](../../mfc/reference/cwnd-class.md)<br/>
[階層グラフ](../../mfc/hierarchy-chart.md)<br/>
[CToolBar クラス](../../mfc/reference/ctoolbar-class.md)
