---
title: クラス
ms.date: 10/18/2018
f1_keywords:
- CMFCMenuBar
- AFXMENUBAR/CMFCMenuBar
- AFXMENUBAR/CMFCMenuBar::AdjustLocations
- AFXMENUBAR/CMFCMenuBar::AllowChangeTextLabels
- AFXMENUBAR/CMFCMenuBar::AllowShowOnPaneMenu
- AFXMENUBAR/CMFCMenuBar::CalcFixedLayout
- AFXMENUBAR/CMFCMenuBar::CalcLayout
- AFXMENUBAR/CMFCMenuBar::CalcMaxButtonHeight
- AFXMENUBAR/CMFCMenuBar::CanBeClosed
- AFXMENUBAR/CMFCMenuBar::CanBeRestored
- AFXMENUBAR/CMFCMenuBar::Create
- AFXMENUBAR/CMFCMenuBar::CreateEx
- AFXMENUBAR/CMFCMenuBar::CreateFromMenu
- AFXMENUBAR/CMFCMenuBar::EnableHelpCombobox
- AFXMENUBAR/CMFCMenuBar::EnableMenuShadows
- AFXMENUBAR/CMFCMenuBar::GetAvailableExpandSize
- AFXMENUBAR/CMFCMenuBar::GetColumnWidth
- AFXMENUBAR/CMFCMenuBar::GetDefaultMenu
- AFXMENUBAR/CMFCMenuBar::GetDefaultMenuResId
- AFXMENUBAR/CMFCMenuBar::GetFloatPopupDirection
- AFXMENUBAR/CMFCMenuBar::GetForceDownArrows
- AFXMENUBAR/CMFCMenuBar::GetHelpCombobox
- AFXMENUBAR/CMFCMenuBar::GetHMenu
- AFXMENUBAR/CMFCMenuBar::GetMenuFont
- AFXMENUBAR/CMFCMenuBar::GetMenuItem
- AFXMENUBAR/CMFCMenuBar::GetRowHeight
- AFXMENUBAR/CMFCMenuBar::GetSystemButton
- AFXMENUBAR/CMFCMenuBar::GetSystemButtonsCount
- AFXMENUBAR/CMFCMenuBar::GetSystemMenu
- AFXMENUBAR/CMFCMenuBar::HighlightDisabledItems
- AFXMENUBAR/CMFCMenuBar::IsButtonExtraSizeAvailable
- AFXMENUBAR/CMFCMenuBar::IsHighlightDisabledItems
- AFXMENUBAR/CMFCMenuBar::IsMenuShadows
- AFXMENUBAR/CMFCMenuBar::IsRecentlyUsedMenus
- AFXMENUBAR/CMFCMenuBar::IsShowAllCommands
- AFXMENUBAR/CMFCMenuBar::IsShowAllCommandsDelay
- AFXMENUBAR/CMFCMenuBar::LoadState
- AFXMENUBAR/CMFCMenuBar::OnChangeHot
- AFXMENUBAR/CMFCMenuBar::OnDefaultMenuLoaded
- AFXMENUBAR/CMFCMenuBar::OnSendCommand
- AFXMENUBAR/CMFCMenuBar::OnSetDefaultButtonText
- AFXMENUBAR/CMFCMenuBar::OnToolHitTest
- AFXMENUBAR/CMFCMenuBar::PreTranslateMessage
- AFXMENUBAR/CMFCMenuBar::RestoreOriginalstate
- AFXMENUBAR/CMFCMenuBar::SaveState
- AFXMENUBAR/CMFCMenuBar::SetDefaultMenuResId
- AFXMENUBAR/CMFCMenuBar::SetForceDownArrows
- AFXMENUBAR/CMFCMenuBar::SetMaximizeMode
- AFXMENUBAR/CMFCMenuBar::SetMenuButtonRTC
- AFXMENUBAR/CMFCMenuBar::SetMenuFont
- AFXMENUBAR/CMFCMenuBar::SetRecentlyUsedMenus
- AFXMENUBAR/CMFCMenuBar::SetShowAllCommands
helpviewer_keywords:
- CMFCMenuBar [MFC], AdjustLocations
- CMFCMenuBar [MFC], AllowChangeTextLabels
- CMFCMenuBar [MFC], AllowShowOnPaneMenu
- CMFCMenuBar [MFC], CalcFixedLayout
- CMFCMenuBar [MFC], CalcLayout
- CMFCMenuBar [MFC], CalcMaxButtonHeight
- CMFCMenuBar [MFC], CanBeClosed
- CMFCMenuBar [MFC], CanBeRestored
- CMFCMenuBar [MFC], Create
- CMFCMenuBar [MFC], CreateEx
- CMFCMenuBar [MFC], CreateFromMenu
- CMFCMenuBar [MFC], EnableHelpCombobox
- CMFCMenuBar [MFC], EnableMenuShadows
- CMFCMenuBar [MFC], GetAvailableExpandSize
- CMFCMenuBar [MFC], GetColumnWidth
- CMFCMenuBar [MFC], GetDefaultMenu
- CMFCMenuBar [MFC], GetDefaultMenuResId
- CMFCMenuBar [MFC], GetFloatPopupDirection
- CMFCMenuBar [MFC], GetForceDownArrows
- CMFCMenuBar [MFC], GetHelpCombobox
- CMFCMenuBar [MFC], GetHMenu
- CMFCMenuBar [MFC], GetMenuFont
- CMFCMenuBar [MFC], GetMenuItem
- CMFCMenuBar [MFC], GetRowHeight
- CMFCMenuBar [MFC], GetSystemButton
- CMFCMenuBar [MFC], GetSystemButtonsCount
- CMFCMenuBar [MFC], GetSystemMenu
- CMFCMenuBar [MFC], HighlightDisabledItems
- CMFCMenuBar [MFC], IsButtonExtraSizeAvailable
- CMFCMenuBar [MFC], IsHighlightDisabledItems
- CMFCMenuBar [MFC], IsMenuShadows
- CMFCMenuBar [MFC], IsRecentlyUsedMenus
- CMFCMenuBar [MFC], IsShowAllCommands
- CMFCMenuBar [MFC], IsShowAllCommandsDelay
- CMFCMenuBar [MFC], LoadState
- CMFCMenuBar [MFC], OnChangeHot
- CMFCMenuBar [MFC], OnDefaultMenuLoaded
- CMFCMenuBar [MFC], OnSendCommand
- CMFCMenuBar [MFC], OnSetDefaultButtonText
- CMFCMenuBar [MFC], OnToolHitTest
- CMFCMenuBar [MFC], PreTranslateMessage
- CMFCMenuBar [MFC], RestoreOriginalstate
- CMFCMenuBar [MFC], SaveState
- CMFCMenuBar [MFC], SetDefaultMenuResId
- CMFCMenuBar [MFC], SetForceDownArrows
- CMFCMenuBar [MFC], SetMaximizeMode
- CMFCMenuBar [MFC], SetMenuButtonRTC
- CMFCMenuBar [MFC], SetMenuFont
- CMFCMenuBar [MFC], SetRecentlyUsedMenus
- CMFCMenuBar [MFC], SetShowAllCommands
ms.assetid: 8a3ce4c7-b012-4dc0-b4f8-53c10b4b86b8
ms.openlocfilehash: f25bff9564eb7a4290f958f0b7810cac8ef7e238
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/22/2020
ms.locfileid: "81749624"
---
# <a name="cmfcmenubar-class"></a>クラス

ドッキングを実装するメニュー バーです。
詳細については、Visual Studio のインストールの**\\VC\\atlmfc\\src mfc**フォルダーにあるソース コードを参照してください。

## <a name="syntax"></a>構文

```
class CMFCMenuBar : public CMFCToolbar
```

## <a name="members"></a>メンバー

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[CMFCMenuBar::AdjustLocations](#adjustlocations)|( `CMFCToolBar::AdjustLocations`をオーバーライドします)。|
|[CMFCMenuBar::AllowChangeTextLabels](#allowchangetextlabels)|テキスト ラベルをツール バー ボタンのイメージの下に表示できるかどうかを指定します。 [(CMFC ツールバー](../../mfc/reference/cmfctoolbar-class.md#allowchangetextlabels)をオーバーライドします。)|
|[メニューバー::ウィンドウオンペインを表示する](#allowshowonpanemenu)|( `CPane::AllowShowOnPaneMenu`をオーバーライドします)。|
|[CMFC メニューバー::計算固定レイアウト](#calcfixedlayout)|ツール バーの水平方向のサイズを計算します。 (CMFC ツールバーをオーバーライド[します::計算固定レイアウト](../../mfc/reference/cmfctoolbar-class.md#calcfixedlayout).)|
|[CMFC メニューバー::計算レイアウト](#calclayout)|( `CMFCToolBar::CalcLayout`をオーバーライドします)。|
|[CMFC メニューバー::カルクマックスボタンの高さ](#calcmaxbuttonheight)|ツール バーのボタンの最大高さを計算します。 [(CMFC ツールバーをオーバーライドします。::カルクマックスボタンの高さ](../../mfc/reference/cmfctoolbar-class.md#calcmaxbuttonheight).)|
|[CMFCメニューバー::缶詰閉](#canbeclosed)|ユーザーがツール バーを閉じることができるかどうかを指定します。 [(CMFCツールバーをオーバーライドします::CanBe閉じた](../../mfc/reference/cmfctoolbar-class.md#canbeclosed).)|
|[CMFCメニューバー::缶詰](#canberestored)|カスタマイズ後に、システムがツール バーを元の状態に復元できるかどうかを決定します。 [(CMFCツールバーをオーバーライドします::缶詰復元](../../mfc/reference/cmfctoolbar-class.md#canberestored).)|
|[CMFC メニューバー::作成](#create)|メニュー コントロールを作成し、`CMFCMenuBar`オブジェクトにアタッチします。|
|[CMFC メニューバー::作成します。](#createex)|追加の`CMFCMenuBar`スタイル オプションを持つオブジェクトを作成します。|
|[メニューバー::メニューから作成します。](#createfrommenu)|オブジェクトを`CMFCMenuBar`初期化します。 設定された`CMFCMenuBar`.|
|[メニューバー::ヘルプコンボボックスを有効にします。](#enablehelpcombobox)|メニュー バーの右側にある **[ヘルプ**] コンボ ボックスを有効にします。|
|[メニューバー::メニューシャドウを有効にする](#enablemenushadows)|ポップアップ メニューの影を表示するかどうかを指定します。|
|[メニュー バー::利用可能な拡張サイズ](#getavailableexpandsize)|(CPane をオーバーライド[します。:GetAvailableExpandSize](../../mfc/reference/cpane-class.md#getavailableexpandsize).)|
|[メニュー バー::列幅を取得します。](#getcolumnwidth)|ツール バー ボタンの幅を返します。 [(CMFC ツールバーをオーバーライドします。.](../../mfc/reference/cmfctoolbar-class.md#getcolumnwidth)|
|[メニューバー::既定のメニューを取得します。](#getdefaultmenu)|リソース ファイル内の元のメニューへのハンドルを返します。|
|[をクリックします。](#getdefaultmenuresid)|リソース ファイル内の元のメニューのリソース識別子を返します。|
|[メニューバー::ゲットフロートポップアップディレクション](#getfloatpopupdirection)||
|[メニューバー::ゲットフォースダウンアローズ](#getforcedownarrows)||
|[コンボボックスを表示します。](#gethelpcombobox)|**[ヘルプ**] コンボ ボックスへのポインターを返します。|
|[メニューバー::ゲットメニュー](#gethmenu)|オブジェクトにアタッチされているメニューへのハンドルを`CMFCMenuBar`返します。|
|[メニューバー::メニューフォント](#getmenufont)|メニュー オブジェクトの現在のグローバル フォントを返します。|
|[メニューバー::メニューアイテムを取得します。](#getmenuitem)|指定された項目のインデックスに関連付けられているツール バー ボタンを返します。|
|[メニューバー::ゲットロウハイト](#getrowheight)|ツール バー ボタンの高さを返します。 (CMFC ツールバーをオーバーライド[します。::ゲットローハイト](../../mfc/reference/cmfctoolbar-class.md#getrowheight).)|
|[メニューバー::システムボタンを取得します。](#getsystembutton)||
|[メニューバー::システムボタン数を取得します。](#getsystembuttonscount)||
|[メニューバー::システムメニューを取得します。](#getsystemmenu)||
|[CMFCメニューバー::ハイライト無効アイテム](#highlightdisableditems)|無効なメニュー項目を強調表示するかどうかを示します。|
|[CMFC メニューバー::イボタンエクストラサイズ利用可能](#isbuttonextrasizeavailable)|ツール バーに、拡張枠線を持つボタンを表示できるかどうかを指定します。 (CMFC ツールバーをオーバーライド[します。)](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable)|
|[CMFC メニュー バー::イハイライト無効なアイテム](#ishighlightdisableditems)|無効な項目が強調表示されているかどうかを示します。|
|[メニューバー::イズメニューシャドウ](#ismenushadows)|ポップアップ メニューに影を描画するかどうかを示します。|
|[メニューバー::最近使用済みメニュー](#isrecentlyusedmenus)|最近使用したメニュー コマンドをメニュー バーに表示するかどうかを示します。|
|[メニューバー::イズショーオールコマンド](#isshowallcommands)|ポップアップ メニューにすべてのコマンドを表示するかどうかを示します。|
|[メニューバー::イズショーオールコマンドディレイ](#isshowallcommandsdelay)|少し遅延した後に、メニューにすべてのコマンドを表示するかどうかを示します。|
|[CMFC メニュー バー::ロードステート](#loadstate)|レジストリからオブジェクトの状態`CMFCMenuBar`を読み込みます。|
|[メニューバー::オンチェンジホット](#onchangehot)|ユーザーがツール バーのボタンを選択したときに、フレームワークによって呼び出されます。 [(CMFCツールバーをオーバーライドします。:オンチェンジホット](../../mfc/reference/cmfctoolbar-class.md#onchangehot).)|
|[メニューバー::既定のメニューが読み込まれました](#ondefaultmenuloaded)|フレーム ウィンドウがリソース ファイルから既定のメニューを読み込むときに、フレームワークによって呼び出されます。|
|[メニューバー::オンセンドコマンド](#onsendcommand)|( `CMFCToolBar::OnSendCommand`をオーバーライドします)。|
|[コントロール バー::既定のボタンテキスト](#onsetdefaultbuttontext)|メニューがカスタマイズ モードで、ユーザーがメニュー項目のテキストを変更するときに、フレームワークによって呼び出されます。|
|[CMFCメニューバー::オンツールヒットテスト](#ontoolhittest)|( `CMFCToolBar::OnToolHitTest`をオーバーライドします)。|
|[メッセージを再変換:P](#pretranslatemessage)|( `CMFCToolBar::PreTranslateMessage`をオーバーライドします)。|
|[元の状態に戻す](#restoreoriginalstate)|メニューがカスタマイズ モードで、ユーザーがメニュー バーに対して **[リセット]** を選択したときに、フレームワークによって呼び出されます。|
|[CMFC メニューバー::セーブステート](#savestate)|オブジェクトの状態を`CMFCMenuBar`レジストリに保存します。|
|[をクリックします。](#setdefaultmenuresid)|リソース ファイルの元のメニューを設定します。|
|[CMFCメニューバー::セットフォースダウンアローズ](#setforcedownarrows)||
|[メニューバー::設定最大化モード](#setmaximizemode)|MDI 子ウィンドウの表示モードが変更されたときに、フレームワークによって呼び出されます。 MDI 子ウィンドウが新しく最大化されているか、または最大化されなくなった場合、このメソッドはメニュー バーを更新します。|
|[メニューバー::セットメニューボタンRTC](#setmenubuttonrtc)|ユーザーがメニュー ボタンを動的に作成するときに生成されるランタイム クラス情報を設定します。|
|[メニューバー::セットメニューフォント](#setmenufont)|アプリケーションのすべてのメニューのフォントを設定します。|
|[メニューバー::セット最近使用済みメニュー](#setrecentlyusedmenus)|最近使用したメニュー コマンドをメニュー バーに表示するかどうかを指定します。|
|[メニューバー::セットショーオールコマンド](#setshowallcommands)|メニュー バーにすべてのコマンドを表示するかどうかを指定します。|

## <a name="remarks"></a>解説

この`CMFCMenuBar`クラスは、ドッキング機能を実装するメニュー バーです。 ツールバーに似ていますが、閉じることはできませんが、常に表示されます。

`CMFCMenuBar`では、最近使用したメニュー項目オブジェクトを表示するオプションをサポートしています。 このオプションが有効になっている場合、`CMFCMenuBar`最初に表示する場合は、使用可能なコマンドのサブセットのみが表示されます。 その後、最近使用したコマンドは、元のコマンドのサブセットと共に表示されます。 また、ユーザーはいつでもメニューを展開して、使用可能なすべてのコマンドを表示できます。 したがって、使用可能な各コマンドは、常に表示するか、最近選択された場合にのみ表示するように構成されています。

オブジェクトを`CMFCMenuBar`使用するには、メイン ウィンドウ フレーム オブジェクトにオブジェクトを埋め込みます。 メッセージを処理`WM_CREATE`する場合は`CMFCMenuBar::Create`、`CMFCMenuBar::CreateEx`または を呼び出します。 使用する作成関数に関係なく、メイン フレーム ウィンドウへのポインターを渡します。 次に[、CFrameWndEx::有効化](../../mfc/reference/cframewndex-class.md#enabledocking)ドッキングを呼び出してドッキングを有効にします。 このメニューをドッキングするには[、CFrameWndEx::DockPane](../../mfc/reference/cframewndex-class.md#dockpane)を呼び出します。

## <a name="example"></a>例

`CMFCMenuBar` クラスのさまざまなメソッドの使用方法を次の例に示します。 この例では、ペインのスタイルの設定、カスタマイズ ボタンの有効化、ヘルプ ボックスの有効化、ポップアップ メニューの影の有効化、およびメニュー バーの更新方法を示します。 このコード スニペットは、 [IE デモ のサンプル](../../overview/visual-cpp-samples.md)の一部です。

[!code-cpp[NVC_MFC_IEDemo#1](../../mfc/reference/codesnippet/cpp/cmfcmenubar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#3](../../mfc/reference/codesnippet/cpp/cmfcmenubar-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[ツールバー](../../mfc/reference/cmfcbasetoolbar-class.md)

[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)

`CMFCMenuBar`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxmenubar.h

## <a name="cmfcmenubaradjustlocations"></a><a name="adjustlocations"></a>CMFCメニューバー::アジャスタロケーション

メニュー バーのメニュー項目の位置を調整します。

```
virtual void AdjustLocations();
```

### <a name="remarks"></a>解説

## <a name="cmfcmenubarallowchangetextlabels"></a><a name="allowchangetextlabels"></a>CMFC メニュー バー::テキスト ラベルを許可します。

メニュー バーのイメージの下にテキスト ラベルを使用できるかどうかを指定します。

```
virtual BOOL AllowChangeTextLabels() const;
```

### <a name="return-value"></a>戻り値

ユーザーがイメージの下にテキスト ラベルを表示することを選択できる場合は TRUE を返します。

### <a name="remarks"></a>解説

## <a name="cmfcmenubarallowshowonpanemenu"></a><a name="allowshowonpanemenu"></a>メニューバー::ウィンドウオンペインを表示する

```
virtual BOOL AllowShowOnPaneMenu() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubarcalcfixedlayout"></a><a name="calcfixedlayout"></a>CMFC メニューバー::計算固定レイアウト

```
virtual CSize CalcFixedLayout(
    BOOL bStretch,
    BOOL bHorz);
```

### <a name="parameters"></a>パラメーター

[in]*bストレッチ*<br/>

[in]*bHorz*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubarcalclayout"></a><a name="calclayout"></a>CMFC メニューバー::計算レイアウト

```
virtual CSize CalcLayout(
    DWORD dwMode,
    int nLength = -1);
```

### <a name="parameters"></a>パラメーター

[in]*dw モード*<br/>

[in]*nレングス*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubarcalcmaxbuttonheight"></a><a name="calcmaxbuttonheight"></a>CMFC メニューバー::カルクマックスボタンの高さ

```
virtual int CalcMaxButtonHeight();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubarcanbeclosed"></a><a name="canbeclosed"></a>CMFCメニューバー::缶詰閉

```
virtual BOOL CanBeClosed() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubarcanberestored"></a><a name="canberestored"></a>CMFCメニューバー::缶詰

```
virtual BOOL CanBeRestored() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubarcreate"></a><a name="create"></a>CMFC メニューバー::作成

メニュー コントロールを作成し[、CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md)オブジェクトにアタッチします。

```
virtual BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle = AFX_DEFAULT_TOOLBAR_STYLE,
    UINT nID = AFX_IDW_MENUBAR);
```

### <a name="parameters"></a>パラメーター

*pParentWnd*<br/>
[in]新しい`CMFCMenuBar`オブジェクトの親ウィンドウへのポインター。

*Dwstyle*<br/>
[in]新しいメニュー バーのスタイル。

*nID*<br/>
[in]メニュー バーの子ウィンドウの ID。

### <a name="return-value"></a>戻り値

成功した場合は TRUE、それ以外の場合は FALSE。

### <a name="remarks"></a>解説

オブジェクトを構築したら`CMFCMenuBar`、 を呼び`Create`出す必要があります。 このメソッドは、`CMFCMenuBar`コントロールを作成し、オブジェクトに`CMFCMenuBar`アタッチします。

ツールバー スタイルの詳細については[、「CBasePane::SetPaneStyle](../../mfc/reference/cbasepane-class.md#setpanestyle)」を参照してください。

## <a name="cmfcmenubarcreateex"></a><a name="createex"></a>CMFC メニューバー::作成します。

指定した拡張スタイルを使用して[CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md)オブジェクトを作成します。

```
virtual BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle = TBSTYLE_FLAT,
    DWORD dwStyle = AFX_DEFAULT_TOOLBAR_STYLE,
    CRect rcBorders = CRect(1,
    1,
    1,
    1),
    UINT nID =AFX_IDW_MENUBAR);
```

### <a name="parameters"></a>パラメーター

*pParentWnd*<br/>
[in]新しい`CMFCMenuBar`オブジェクトの親ウィンドウへのポインター。

*スタイル*<br/>
[in]新しいメニュー バーの追加スタイル。

*Dwstyle*<br/>
[in]新しいメニュー バーのメイン スタイル。

*rcボーダー*<br/>
[in]`CMFCMenuBar`オブジェクトの`CRect`境界線のサイズを指定するパラメーター。

*nID*<br/>
[in]メニュー バーの子ウィンドウの ID。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

ツール バー スタイルに加えてスタイルを指定する場合は[、CMFCMenuBar::Create](#create)の代わりにこの関数を使用する必要があります。 頻繁に使用される追加のスタイルには、TBSTYLE_TRANSPARENTとCBRS_TOPがあります。

その他のスタイルの一覧については、「[ツールバー コントロールとボタン スタイル](/windows/win32/Controls/toolbar-control-and-button-styles)」、コモン コントロール スタイル、および[共通ウィンドウ](/windows/win32/winmsg/window-styles)[スタイル](/windows/win32/Controls/common-control-styles)を参照してください。

### <a name="example"></a>例

クラスのメソッドの使用方法を`CreateEx`次の例に示します`CMFCMenuBar`。 このコード スニペットは、 [IE デモ のサンプル](../../overview/visual-cpp-samples.md)の一部です。

[!code-cpp[NVC_MFC_IEDemo#1](../../mfc/reference/codesnippet/cpp/cmfcmenubar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#2](../../mfc/reference/codesnippet/cpp/cmfcmenubar-class_3.cpp)]

## <a name="cmfcmenubarcreatefrommenu"></a><a name="createfrommenu"></a>メニューバー::メニューから作成します。

[オブジェクトを](../../mfc/reference/cmfcmenubar-class.md)初期化します。 このメソッドは、HMENU パラメーターの`CMFCMenuBar`後にオブジェクトをモデル化します。

```
virtual void CreateFromMenu(
    HMENU hMenu,
    BOOL bDefaultMenu = FALSE,
    BOOL bForceUpdate = FALSE);
```

### <a name="parameters"></a>パラメーター

*Hmenu*<br/>
[in]メニュー リソースへのハンドル。 `CreateFromMenu`このリソースを のテンプレートとして使用`CMFCMenuBar`します。

*メニューの既定値*<br/>
[in]新しいメニューが既定のメニューかどうかを示すブール値。

*を更新する*<br/>
[in]このメソッドが強制的にメニューを更新するかどうかを示すブール値。

### <a name="remarks"></a>解説

メニュー コントロールをメニュー リソースと同じメニュー項目にする場合は、このメソッドを使用します。 このメソッドを呼び出した後[、CMFCMenuBar::作成](#create)または[CMFCMenuBar::CreateEx](#createex)を呼び出します。

## <a name="cmfcmenubarenablehelpcombobox"></a><a name="enablehelpcombobox"></a>メニューバー::ヘルプコンボボックスを有効にします。

メニュー バーの右側にある **[ヘルプ**] コンボ ボックスを有効にします。

```cpp
void EnableHelpCombobox(
    UINT uiID,
    LPCTSTR lpszPrompt = NULL,
    int nComboBoxWidth = 150);
```

### <a name="parameters"></a>パラメーター

*Uiid*<br/>
[in]**[ヘルプ**] コンボ ボックスのボタンのコマンド ID。

*プロンプトを表示します。*<br/>
[in]フレームワークが空でアクティブでない場合にコンボ ボックスに表示されるテキストを含む文字列。 たとえば、「ここにテキストを入力」とします。

*コンボボックス幅*<br/>
[in]コンボ ボックスのボタンの幅 (ピクセル単位)。

### <a name="remarks"></a>解説

**[ヘルプ]** コンボ ボックスは、Word のメニュー バーの **[ヘルプ**] コンボ ボックスと似ています。

*uiID*を 0 に設定してこのメソッドを呼び出すと、このメソッドはコンボ ボックスを非表示にします。 それ以外の場合、このメソッドは、メニュー バーの右側にコンボ ボックスを自動的に表示します。 このメソッドを呼び出した後、挿入された CMFC ツール バーコンボ ボックス ボタンオブジェクトへのポインターを取得するには[、CMFCMenuBar::GetHelp](#gethelpcombobox) [コンボ ボックス](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md)を呼び出します。

## <a name="cmfcmenubarenablemenushadows"></a><a name="enablemenushadows"></a>メニューバー::メニューシャドウを有効にする

ポップアップ メニューの影を有効にします。

```
static void EnableMenuShadows(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>パラメーター

*b 有効にする*<br/>
[in]ポップアップ メニューに影を有効にするかどうかを示すブール値パラメーター。

### <a name="remarks"></a>解説

この方法で使用するアルゴリズムは複雑であり、低速なシステムでのアプリケーションのパフォーマンスが低下する可能性があります。

## <a name="cmfcmenubargetavailableexpandsize"></a><a name="getavailableexpandsize"></a>メニュー バー::利用可能な拡張サイズ

```
virtual int GetAvailableExpandSize() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubargetcolumnwidth"></a><a name="getcolumnwidth"></a>メニュー バー::列幅を取得します。

```
virtual int GetColumnWidth() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubargetdefaultmenu"></a><a name="getdefaultmenu"></a>メニューバー::既定のメニューを取得します。

元のメニューへのハンドルを取得します。 フレームワークは、リソース ファイルから元のメニューを読み込みます。

```
HMENU GetDefaultMenu() const;
```

### <a name="return-value"></a>戻り値

メニュー リソースへのハンドル。

### <a name="remarks"></a>解説

アプリケーションでメニューをカスタマイズする場合は、このメソッドを使用して元のメニューへのハンドルを取得できます。

## <a name="cmfcmenubargetdefaultmenuresid"></a><a name="getdefaultmenuresid"></a>をクリックします。

既定のメニューのリソース識別子を取得します。

```
UINT GetDefaultMenuResId() const;
```

### <a name="return-value"></a>戻り値

メニュー リソース識別子。

### <a name="remarks"></a>解説

フレームワークは、リソース ファイルからオブジェクト`CMFCMenuBar`の既定のメニューを読み込みます。

## <a name="cmfcmenubargetfloatpopupdirection"></a><a name="getfloatpopupdirection"></a>メニューバー::ゲットフロートポップアップディレクション

```
int GetFloatPopupDirection(CMFCToolBarMenuButton* pButton);
```

### <a name="parameters"></a>パラメーター

[in]*ボタン*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubargetforcedownarrows"></a><a name="getforcedownarrows"></a>メニューバー::ゲットフォースダウンアローズ

```
BOOL GetForceDownArrows();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubargethelpcombobox"></a><a name="gethelpcombobox"></a>コンボボックスを表示します。

**[ヘルプ**] コンボ ボックスへのポインターを返します。

```
CMFCToolBarComboBoxButton* GetHelpCombobox();
```

### <a name="return-value"></a>戻り値

**[ヘルプ**] コンボ ボックスへのポインター。 **[ヘルプ**] コンボ ボックスが非表示または無効になっている場合は、NULL を返します。

### <a name="remarks"></a>解説

**[ヘルプ]** コンボ ボックスは、メニュー バーの右側にあります。 このコンボ ボックスを有効にするには、メソッド[CMFCMenuBar::EnableHelp コンボ ボックス](#enablehelpcombobox)を呼び出します。

## <a name="cmfcmenubargethmenu"></a><a name="gethmenu"></a>メニューバー::ゲットメニュー

[オブジェクトに](../../mfc/reference/cmfcmenubar-class.md)アタッチされているメニューのハンドルを取得します。

```
HMENU GetHMenu() const;
```

## <a name="cmfcmenubargetmenufont"></a><a name="getmenufont"></a>メニューバー::メニューフォント

現在のメニュー フォントを取得します。

```
static const CFont& GetMenuFont(BOOL bHorz = TRUE);
```

### <a name="parameters"></a>パラメーター

*bHorz*<br/>
[in]水平フォントと垂直フォントのどちらを返すかを指定するブール値パラメーター。 TRUE は水平フォントを示します。

### <a name="return-value"></a>戻り値

現在のメニュー バーのフォントを含む[CFont](../../mfc/reference/cfont-class.md)パラメーターへのポインター。

### <a name="remarks"></a>解説

返されるフォントは、アプリケーションのグローバル パラメータです。 すべての`CMFCMenuBar`オブジェクトに対して 2 つのグローバル フォントが保持されます。 これらのフォントは、水平メニュー バーと垂直メニュー バーに使用されます。

## <a name="cmfcmenubargetmenuitem"></a><a name="getmenuitem"></a>メニューバー::メニューアイテムを取得します。

項目インデックスに基づいて、メニュー バーの[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)オブジェクトを取得します。

```
CMFCToolBarButton* GetMenuItem(int iItem) const;
```

### <a name="parameters"></a>パラメーター

*iItem*<br/>
[in]返すメニュー項目のインデックス。

### <a name="return-value"></a>戻り値

*iItem*で`CMFCToolBarButton`指定されたインデックスに一致するオブジェクトへのポインター。 インデックスが無効な場合は NULL。

## <a name="cmfcmenubargetrowheight"></a><a name="getrowheight"></a>メニューバー::ゲットロウハイト

```
virtual int GetRowHeight() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubargetsystembutton"></a><a name="getsystembutton"></a>メニューバー::システムボタンを取得します。

```
CMFCToolBarMenuButtonsButton* GetSystemButton(
    UINT uiBtn,
    BOOL bByCommand = TRUE) const;
```

### <a name="parameters"></a>パラメーター

[in]*uiBtn*<br/>

[in]*bバイコマンド*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubargetsystembuttonscount"></a><a name="getsystembuttonscount"></a>メニューバー::システムボタン数を取得します。

```
int GetSystemButtonsCount() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubargetsystemmenu"></a><a name="getsystemmenu"></a>メニューバー::システムメニューを取得します。

```
CMFCToolBarSystemMenuButton* GetSystemMenu() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubarhighlightdisableditems"></a><a name="highlightdisableditems"></a>CMFCメニューバー::ハイライト無効アイテム

フレームワークが無効なメニュー項目を強調表示するかどうかを制御します。

```
static void HighlightDisabledItems(BOOL bHighlight = TRUE);
```

### <a name="parameters"></a>パラメーター

*bハイライト*<br/>
[in]フレームワークが使用できないメニュー項目を強調表示するかどうかを示すブール値パラメーター。

### <a name="remarks"></a>解説

既定では、ユーザーがマウス ポインターを上に置いたときに、フレームワークは使用できないメニュー項目を強調表示しません。

## <a name="cmfcmenubarisbuttonextrasizeavailable"></a><a name="isbuttonextrasizeavailable"></a>CMFC メニューバー::イボタンエクストラサイズ利用可能

```
virtual BOOL IsButtonExtraSizeAvailable() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubarishighlightdisableditems"></a><a name="ishighlightdisableditems"></a>CMFC メニュー バー::イハイライト無効なアイテム

フレームワークが使用できないメニュー項目を強調表示するかどうかを示します。

```
static BOOL IsHighlightDisabledItems();
```

### <a name="return-value"></a>戻り値

使用できないメニュー項目が強調表示されている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

既定では、ユーザーがマウス ポインターを上に置いたときに、フレームワークは使用できないメニュー項目を強調表示しません。 この機能を有効にするには[、CMFCMenuBar::HighlightDisabledItems](#highlightdisableditems)メソッドを使用します。

## <a name="cmfcmenubarismenushadows"></a><a name="ismenushadows"></a>メニューバー::イズメニューシャドウ

フレームワークがポップアップ メニューのシャドウを描画するかどうかを示します。

```
static BOOL IsMenuShadows();
```

### <a name="return-value"></a>戻り値

フレームワークがメニュー シャドウを描画する場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

この機能を有効または無効にするには、メソッドを使用[します](#enablemenushadows)。

## <a name="cmfcmenubarisrecentlyusedmenus"></a><a name="isrecentlyusedmenus"></a>メニューバー::最近使用済みメニュー

最近使用したメニュー コマンドをメニュー バーに表示するかどうかを示します。

```
static BOOL IsRecentlyUsedMenus();
```

### <a name="return-value"></a>戻り値

オブジェクトが最近使用`CMFCMenuBar`したメニュー コマンドを表示する場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

関数[CMFCMenuBar::Set最近使用済みメニューを](#setrecentlyusedmenus)使用して、メニュー バーに最近使用したメニュー コマンドを表示するかどうかを制御します。

## <a name="cmfcmenubarisshowallcommands"></a><a name="isshowallcommands"></a>メニューバー::イズショーオールコマンド

メニューにすべてのコマンドを表示するかどうかを示します。

```
static BOOL IsShowAllCommands();
```

### <a name="return-value"></a>戻り値

すべてのコマンドを表示`CMFCMenuBar`する場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

オブジェクト`CMFCMenuBar`は、すべてのコマンドを表示するか、またはコマンドのサブセットのみを表示するように構成できます。 この機能の詳細については、「 [CMFCMenuBar クラス](../../mfc/reference/cmfcmenubar-class.md)」を参照してください。

`IsShowAllCommands`この機能がオブジェクトに対してどのように構成されているか`CMFCMenuBar`がわかります。 表示されるメニュー コマンドを制御するには、メソッド[CMFCMenuBar:::セットビューオールコマンド](#setshowallcommands)と[CMFC メニューバー:::セット最近使用済みメニューを使用します](#setrecentlyusedmenus)。

## <a name="cmfcmenubarisshowallcommandsdelay"></a><a name="isshowallcommandsdelay"></a>メニューバー::イズショーオールコマンドディレイ

[CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md)オブジェクトが、短い遅延の後にすべてのコマンドを表示するかどうかを示します。

```
static BOOL IsShowAllCommandsDelay();
```

### <a name="return-value"></a>戻り値

メニュー バーに短い遅延の後にメニュー全体が表示される場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

最近使用した項目を表示するようにメニュー バーを構成すると、メニュー バーには次の 2 つの方法のいずれかで完全なメニューが表示されます。

- ユーザーがメニューの下部にある矢印の上にカーソルを置いたときから、プログラムによる遅延の後に、完全なメニューを表示します。

- ユーザーがメニューの下部にある矢印をクリックした後に、完全なメニューを表示します。

既定では、すべての`CMFCMenuBar`オブジェクトは、短い遅延の後にメニュー全体を表示するオプションを使用します。 このオプションは`CMFCMenuBar`、クラス内でプログラムによって変更することはできません。 ただし、ユーザーは[**カスタマイズ**]ダイアログ ボックスを使用して、ツールバーのカスタマイズ時に動作を変更できます。

## <a name="cmfcmenubarloadstate"></a><a name="loadstate"></a>CMFC メニュー バー::ロードステート

Windows レジストリからメニュー バーの状態を読み込みます。

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName = NULL,
    int nIndex = -1,
    UINT uiID = (UINT)-1);
```

### <a name="parameters"></a>パラメーター

*名前を指定します。*<br/>
[in]Windows レジストリ キーのパスを含む文字列。

*nIndex*<br/>
[in]メニュー バーのコントロール ID。

*Uiid*<br/>
[in]予約値。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

メニュー バーの状態をレジストリに保存するには[、CMFCMenuBar::SaveState](#savestate)メソッドを使用します。 保存される情報には、メニュー項目、ドッキング状態、メニュー バーの位置が含まれます。

ほとんどの場合、アプリケーションは を呼`LoadState`び出しません。 フレームワークは、ワークスペースを初期化するときにこのメソッドを呼び出します。

## <a name="cmfcmenubaronchangehot"></a><a name="onchangehot"></a>メニューバー::オンチェンジホット

```
virtual void OnChangeHot(int iHot);
```

### <a name="parameters"></a>パラメーター

[in]*アイホット*<br/>

### <a name="remarks"></a>解説

## <a name="cmfcmenubarondefaultmenuloaded"></a><a name="ondefaultmenuloaded"></a>メニューバー::既定のメニューが読み込まれました

フレームワークは、リソース ファイルからメニュー リソースを読み込むときに、このメソッドを呼び出します。

```
virtual void OnDefaultMenuLoaded(HMENU hMenu);
```

### <a name="parameters"></a>パラメーター

*Hmenu*<br/>
[in]オブジェクトにアタッチされたメニューの`CMFCMenuBar`ハンドル。

### <a name="remarks"></a>解説

この関数の既定の実装は、何も行いません。 フレームワークがリソース ファイルからメニュー リソースを読み込んだ後にカスタム コードを実行するには、この関数をオーバーライドします。

## <a name="cmfcmenubaronsendcommand"></a><a name="onsendcommand"></a>メニューバー::オンセンドコマンド

```
virtual BOOL OnSendCommand(const CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>パラメーター

[in]*ボタン*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubaronsetdefaultbuttontext"></a><a name="onsetdefaultbuttontext"></a>コントロール バー::既定のボタンテキスト

ユーザーがメニュー バーの項目のテキストを変更すると、フレームワークはこのメソッドを呼び出します。

```
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>パラメーター

*ボタン*<br/>
[in]ユーザーがカスタマイズする[必要がある CMFC ツール バー ボタン](../../mfc/reference/cmfctoolbarbutton-class.md)オブジェクトへのポインター。

### <a name="return-value"></a>戻り値

フレームワークがユーザーの変更をメニュー バーに適用する場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドの既定の実装では、ボタンのテキストがユーザーが指定したテキストに変更されます。

## <a name="cmfcmenubarontoolhittest"></a><a name="ontoolhittest"></a>CMFCメニューバー::オンツールヒットテスト

```
virtual INT_PTR OnToolHitTest(
    CPoint point,
    TOOLINFO* pTI) const;
```

### <a name="parameters"></a>パラメーター

[in]*ポイント*<br/>

[in]*pTI*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubarpretranslatemessage"></a><a name="pretranslatemessage"></a>メッセージを再変換:P

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>パラメーター

[in]*をクリックします。*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfcmenubarrestoreoriginalstate"></a><a name="restoreoriginalstate"></a>元の状態に戻す

ユーザーが [**カスタマイズ**] ダイアログ ボックスから **[リセット]** を選択したときに、フレームワークによって呼び出されます。

```
virtual BOOL RestoreOriginalstate();
```

### <a name="return-value"></a>戻り値

メソッドが成功した場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

このメソッドは、ユーザーがカスタマイズ メニューから **[リセット]** を選択したときに呼び出されます。 このメソッドを手動で呼び出して、プログラムによってメニュー バーの状態をリセットすることもできます。 このメソッドは、リソース ファイルから元の状態を読み込みます。

ユーザーが**Reset**オプションを選択したときに処理を行う場合は、このメソッドをオーバーライドします。

## <a name="cmfcmenubarsavestate"></a><a name="savestate"></a>CMFC メニューバー::セーブステート

[オブジェクト](../../mfc/reference/cmfcmenubar-class.md)の状態を Windows レジストリに保存します。

```
virtual BOOL SaveState (
    LPCTSTR lpszProfileName = NULL,
    int nIndex = -1,
    UINT uiID = (UINT)-1);
```

### <a name="parameters"></a>パラメーター

*名前を指定します。*<br/>
[in]Windows レジストリ キーのパスを含む文字列。

*nIndex*<br/>
[in]メニュー バーのコントロール ID。

*Uiid*<br/>
[in]予約値。

### <a name="return-value"></a>戻り値

成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

通常、アプリケーションは を呼`SaveState`び出しません。 フレームワークは、ワークスペースがシリアル化されるときにこのメソッドを呼び出します。 詳細については[、「CWinAppEx::SaveState 」を参照してください。](../../mfc/reference/cwinappex-class.md#savestate)

保存される情報には、メニュー項目、ドッキング状態、メニュー バーの位置が含まれます。

## <a name="cmfcmenubarsetdefaultmenuresid"></a><a name="setdefaultmenuresid"></a>をクリックします。

リソース ID に基づいて[、CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md)オブジェクトの既定のメニューを設定します。

```cpp
void SetDefaultMenuResId(UINT uiResId);
```

### <a name="parameters"></a>パラメーター

*uiResId*<br/>
[in]新しい既定のメニューのリソース ID。

### <a name="remarks"></a>解説

メソッドは[、](#restoreoriginalstate)リソース ファイルから既定のメニューを復元します。

既定のメニューを復元せずに取得するには[、CMFCMenuBar::GetDefaultMenuResId](#getdefaultmenuresid)メソッドを使用します。

## <a name="cmfcmenubarsetforcedownarrows"></a><a name="setforcedownarrows"></a>CMFCメニューバー::セットフォースダウンアローズ

```cpp
void SetForceDownArrows(BOOL bValue);
```

### <a name="parameters"></a>パラメーター

[in]*b値*<br/>

### <a name="remarks"></a>解説

## <a name="cmfcmenubarsetmaximizemode"></a><a name="setmaximizemode"></a>メニューバー::設定最大化モード

MDI が表示モードを変更し、メニュー バーを更新する必要がある場合、フレームワークはこのメソッドを呼び出します。

```cpp
void SetMaximizeMode(
    BOOL bMax,
    CWnd* pWnd = NULL,
    BOOL bRecalcLayout = TRUE);
```

### <a name="parameters"></a>パラメーター

*bマックス*<br/>
[in]モードを指定するブール値。 詳細については、「解説」を参照してください。

*Pwnd*<br/>
[in]変更中の MDI 子ウィンドウへのポインター。

*ブレカルクレイアウト*<br/>
[in]メニュー バーのレイアウトを直ちに再計算するかどうかを指定するブール値。

### <a name="remarks"></a>解説

MDI 子ウィンドウを最大化すると、MDI メイン フレーム ウィンドウに接続されているメニュー バーに、システム メニューと**最小化**、**最大化**、**および閉じる**ボタンが表示されます。 *bMax*が TRUE で *、pWnd*が NULL でない場合、MDI 子ウィンドウが最大化され、メニュー バーに追加のコントロールが組み込まれる必要があります。 それ以外の場合、メニュー バーは通常の状態に戻ります。

## <a name="cmfcmenubarsetmenubuttonrtc"></a><a name="setmenubuttonrtc"></a>メニューバー::セットメニューボタンRTC

ユーザーがメニュー ボタンを作成するときにフレームワークが使用するランタイム クラス情報を設定します。

```cpp
void SetMenuButtonRTC(CRuntimeClass* pMenuButtonRTC);
```

### <a name="parameters"></a>パラメーター

*ボタンを押す*<br/>
[in]から[CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md)派生したクラスの[情報を CMFCMenuButton クラス](../../mfc/reference/cmfcmenubutton-class.md)。

### <a name="remarks"></a>解説

ユーザーがメニュー バーに新しいボタンを追加すると、フレームワークはボタンを動的に作成します。 既定では、オブジェクトが`CMFCMenuButton`作成されます。 フレームワークが作成するボタン オブジェクトの型を変更するには、このメソッドをオーバーライドします。

## <a name="cmfcmenubarsetmenufont"></a><a name="setmenufont"></a>メニューバー::セットメニューフォント

アプリケーション内のすべてのメニュー バーのフォントを設定します。

```
static BOOL SetMenuFont(
    LPLOGFONT lpLogFont,
    BOOL bHorz = TRUE);
```

### <a name="parameters"></a>パラメーター

*フォント*<br/>
[in]設定するフォントを定義する[LOGFONT](/windows/win32/api/dimm/ns-dimm-logfonta)構造体へのポインター。

*bHorz*<br/>
[in]縦書きフォントに*lpLogFont*パラメーターを使用する場合は TRUE を返します。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

すべての`CMFCMenuBar`オブジェクトに 2 つのフォントが使用されます。 これらのフォントは、水平メニュー バーと垂直メニュー バーに使用されます。

フォント設定はグローバル変数であり、すべてのオブジェクト`CMFCMenuBar`に影響します。

## <a name="cmfcmenubarsetrecentlyusedmenus"></a><a name="setrecentlyusedmenus"></a>メニューバー::セット最近使用済みメニュー

メニュー バーに最近使用したメニュー コマンドを表示するかどうかを制御します。

```
static void SetRecentlyUsedMenus (BOOL bOn = TRUE);
```

### <a name="parameters"></a>パラメーター

*ボン*<br/>
[in]最近使用したメニュー コマンドを表示するかどうかを制御するブール値。

## <a name="cmfcmenubarsetshowallcommands"></a><a name="setshowallcommands"></a>メニューバー::セットショーオールコマンド

メニューに使用可能なすべてのコマンドを表示するかどうかを制御します。

```
static void SetShowAllCommands(BOOL bShowAllCommands = TRUE);
```

### <a name="parameters"></a>パラメーター

*コマンドを表示します。*<br/>
[in]ポップアップ メニューにすべてのメニュー コマンドを表示するかどうかを指定するブール値パラメーター。

### <a name="remarks"></a>解説

メニューにはすべてのメニュー コマンドが表示されない場合、ほとんど使用されないコマンドは非表示になります。 メニュー コマンドの表示の詳細については、「 [CMFCMenuBar クラス](../../mfc/reference/cmfcmenubar-class.md)」を参照してください。

## <a name="see-also"></a>関連項目

[階層グラフ](../../mfc/hierarchy-chart.md)<br/>
[クラス](../../mfc/reference/mfc-classes.md)<br/>
[クラス](../../mfc/reference/cmfctoolbar-class.md)
