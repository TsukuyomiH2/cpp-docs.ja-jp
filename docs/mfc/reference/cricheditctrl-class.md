---
title: クラス
ms.date: 11/04/2016
f1_keywords:
- CRichEditCtrl
- AFXCMN/CRichEditCtrl
- AFXCMN/CRichEditCtrl::CRichEditCtrl
- AFXCMN/CRichEditCtrl::CanPaste
- AFXCMN/CRichEditCtrl::CanRedo
- AFXCMN/CRichEditCtrl::CanUndo
- AFXCMN/CRichEditCtrl::CharFromPos
- AFXCMN/CRichEditCtrl::Clear
- AFXCMN/CRichEditCtrl::Copy
- AFXCMN/CRichEditCtrl::Create
- AFXCMN/CRichEditCtrl::CreateEx
- AFXCMN/CRichEditCtrl::Cut
- AFXCMN/CRichEditCtrl::DisplayBand
- AFXCMN/CRichEditCtrl::EmptyUndoBuffer
- AFXCMN/CRichEditCtrl::FindText
- AFXCMN/CRichEditCtrl::FindWordBreak
- AFXCMN/CRichEditCtrl::FormatRange
- AFXCMN/CRichEditCtrl::GetCharPos
- AFXCMN/CRichEditCtrl::GetDefaultCharFormat
- AFXCMN/CRichEditCtrl::GetEventMask
- AFXCMN/CRichEditCtrl::GetFirstVisibleLine
- AFXCMN/CRichEditCtrl::GetIRichEditOle
- AFXCMN/CRichEditCtrl::GetLimitText
- AFXCMN/CRichEditCtrl::GetLine
- AFXCMN/CRichEditCtrl::GetLineCount
- AFXCMN/CRichEditCtrl::GetModify
- AFXCMN/CRichEditCtrl::GetOptions
- AFXCMN/CRichEditCtrl::GetParaFormat
- AFXCMN/CRichEditCtrl::GetPunctuation
- AFXCMN/CRichEditCtrl::GetRect
- AFXCMN/CRichEditCtrl::GetRedoName
- AFXCMN/CRichEditCtrl::GetSel
- AFXCMN/CRichEditCtrl::GetSelectionCharFormat
- AFXCMN/CRichEditCtrl::GetSelectionType
- AFXCMN/CRichEditCtrl::GetSelText
- AFXCMN/CRichEditCtrl::GetTextLength
- AFXCMN/CRichEditCtrl::GetTextLengthEx
- AFXCMN/CRichEditCtrl::GetTextMode
- AFXCMN/CRichEditCtrl::GetTextRange
- AFXCMN/CRichEditCtrl::GetUndoName
- AFXCMN/CRichEditCtrl::GetWordWrapMode
- AFXCMN/CRichEditCtrl::HideSelection
- AFXCMN/CRichEditCtrl::LimitText
- AFXCMN/CRichEditCtrl::LineFromChar
- AFXCMN/CRichEditCtrl::LineIndex
- AFXCMN/CRichEditCtrl::LineLength
- AFXCMN/CRichEditCtrl::LineScroll
- AFXCMN/CRichEditCtrl::Paste
- AFXCMN/CRichEditCtrl::PasteSpecial
- AFXCMN/CRichEditCtrl::PosFromChar
- AFXCMN/CRichEditCtrl::Redo
- AFXCMN/CRichEditCtrl::ReplaceSel
- AFXCMN/CRichEditCtrl::RequestResize
- AFXCMN/CRichEditCtrl::SetAutoURLDetect
- AFXCMN/CRichEditCtrl::SetBackgroundColor
- AFXCMN/CRichEditCtrl::SetDefaultCharFormat
- AFXCMN/CRichEditCtrl::SetEventMask
- AFXCMN/CRichEditCtrl::SetModify
- AFXCMN/CRichEditCtrl::SetOLECallback
- AFXCMN/CRichEditCtrl::SetOptions
- AFXCMN/CRichEditCtrl::SetParaFormat
- AFXCMN/CRichEditCtrl::SetPunctuation
- AFXCMN/CRichEditCtrl::SetReadOnly
- AFXCMN/CRichEditCtrl::SetRect
- AFXCMN/CRichEditCtrl::SetSel
- AFXCMN/CRichEditCtrl::SetSelectionCharFormat
- AFXCMN/CRichEditCtrl::SetTargetDevice
- AFXCMN/CRichEditCtrl::SetTextMode
- AFXCMN/CRichEditCtrl::SetUndoLimit
- AFXCMN/CRichEditCtrl::SetWordCharFormat
- AFXCMN/CRichEditCtrl::SetWordWrapMode
- AFXCMN/CRichEditCtrl::StopGroupTyping
- AFXCMN/CRichEditCtrl::StreamIn
- AFXCMN/CRichEditCtrl::StreamOut
- AFXCMN/CRichEditCtrl::Undo
helpviewer_keywords:
- CRichEditCtrl [MFC], CRichEditCtrl
- CRichEditCtrl [MFC], CanPaste
- CRichEditCtrl [MFC], CanRedo
- CRichEditCtrl [MFC], CanUndo
- CRichEditCtrl [MFC], CharFromPos
- CRichEditCtrl [MFC], Clear
- CRichEditCtrl [MFC], Copy
- CRichEditCtrl [MFC], Create
- CRichEditCtrl [MFC], CreateEx
- CRichEditCtrl [MFC], Cut
- CRichEditCtrl [MFC], DisplayBand
- CRichEditCtrl [MFC], EmptyUndoBuffer
- CRichEditCtrl [MFC], FindText
- CRichEditCtrl [MFC], FindWordBreak
- CRichEditCtrl [MFC], FormatRange
- CRichEditCtrl [MFC], GetCharPos
- CRichEditCtrl [MFC], GetDefaultCharFormat
- CRichEditCtrl [MFC], GetEventMask
- CRichEditCtrl [MFC], GetFirstVisibleLine
- CRichEditCtrl [MFC], GetIRichEditOle
- CRichEditCtrl [MFC], GetLimitText
- CRichEditCtrl [MFC], GetLine
- CRichEditCtrl [MFC], GetLineCount
- CRichEditCtrl [MFC], GetModify
- CRichEditCtrl [MFC], GetOptions
- CRichEditCtrl [MFC], GetParaFormat
- CRichEditCtrl [MFC], GetPunctuation
- CRichEditCtrl [MFC], GetRect
- CRichEditCtrl [MFC], GetRedoName
- CRichEditCtrl [MFC], GetSel
- CRichEditCtrl [MFC], GetSelectionCharFormat
- CRichEditCtrl [MFC], GetSelectionType
- CRichEditCtrl [MFC], GetSelText
- CRichEditCtrl [MFC], GetTextLength
- CRichEditCtrl [MFC], GetTextLengthEx
- CRichEditCtrl [MFC], GetTextMode
- CRichEditCtrl [MFC], GetTextRange
- CRichEditCtrl [MFC], GetUndoName
- CRichEditCtrl [MFC], GetWordWrapMode
- CRichEditCtrl [MFC], HideSelection
- CRichEditCtrl [MFC], LimitText
- CRichEditCtrl [MFC], LineFromChar
- CRichEditCtrl [MFC], LineIndex
- CRichEditCtrl [MFC], LineLength
- CRichEditCtrl [MFC], LineScroll
- CRichEditCtrl [MFC], Paste
- CRichEditCtrl [MFC], PasteSpecial
- CRichEditCtrl [MFC], PosFromChar
- CRichEditCtrl [MFC], Redo
- CRichEditCtrl [MFC], ReplaceSel
- CRichEditCtrl [MFC], RequestResize
- CRichEditCtrl [MFC], SetAutoURLDetect
- CRichEditCtrl [MFC], SetBackgroundColor
- CRichEditCtrl [MFC], SetDefaultCharFormat
- CRichEditCtrl [MFC], SetEventMask
- CRichEditCtrl [MFC], SetModify
- CRichEditCtrl [MFC], SetOLECallback
- CRichEditCtrl [MFC], SetOptions
- CRichEditCtrl [MFC], SetParaFormat
- CRichEditCtrl [MFC], SetPunctuation
- CRichEditCtrl [MFC], SetReadOnly
- CRichEditCtrl [MFC], SetRect
- CRichEditCtrl [MFC], SetSel
- CRichEditCtrl [MFC], SetSelectionCharFormat
- CRichEditCtrl [MFC], SetTargetDevice
- CRichEditCtrl [MFC], SetTextMode
- CRichEditCtrl [MFC], SetUndoLimit
- CRichEditCtrl [MFC], SetWordCharFormat
- CRichEditCtrl [MFC], SetWordWrapMode
- CRichEditCtrl [MFC], StopGroupTyping
- CRichEditCtrl [MFC], StreamIn
- CRichEditCtrl [MFC], StreamOut
- CRichEditCtrl [MFC], Undo
ms.assetid: 2be52788-822c-4c27-aafd-2471231e74eb
ms.openlocfilehash: 1c601d036d05048bff9b60f837140e8f7a873964
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/22/2020
ms.locfileid: "81754434"
---
# <a name="cricheditctrl-class"></a>クラス

リッチ エディット コントロールの機能を提供します。

## <a name="syntax"></a>構文

```
class CRichEditCtrl : public CWnd
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[CリッチエディットCtrl::CリッチエディットCtrl](#cricheditctrl)|`CRichEditCtrl` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[CリッチエディットCtrl::缶ペースト](#canpaste)|クリップボードの内容をリッチ エディット コントロールに貼り付けできるかどうかを指定します。|
|[クリッチエディットCtrl::缶詰](#canredo)|コントロールの再実行キューにアクションがあるかどうかを判断します。|
|[クリックエディットCtrl::カンドゥンド](#canundo)|編集操作を元に戻すことができるかどうかを決定します。|
|[次のスライド::キャラフロズポス](#charfrompos)|エディット コントロールのクライアント領域内の指定した位置に最も近い文字に関する情報を取得します。|
|[クリッチエディットCtrl::クリア](#clear)|現在の選択を解除します。|
|[CリッチエディットCtrl::コピー](#copy)|現在の選択範囲をクリップボードにコピーします。|
|[CリッチエディットCtrl::作成](#create)|Windows リッチ エディット コントロールを作成し、`CRichEditCtrl`このオブジェクトに関連付けます。|
|[CリッチエディットCtrl::作成します。](#createex)|指定した拡張 Windows スタイルを使用して Windows リッチ エディット`CRichEditCtrl`コントロールを作成し、このオブジェクトに関連付けます。|
|[クリッチエディットCtrl::カット](#cut)|現在の選択範囲をクリップボードに切り取ります。|
|[:Dプレイバンド](#displayband)|この`CRichEditCtrl`オブジェクトの内容の一部を表示します。|
|[次の文字列を処理します。](#emptyundobuffer)|この`CRichEditCtrl`オブジェクトの元に戻すフラグをリセット (クリア) します。|
|[テキストを検索します。](#findtext)|この`CRichEditCtrl`オブジェクト内のテキストを検索します。|
|[クリッチエディットCtrl::ワードブレイクを検索](#findwordbreak)|指定した文字位置の前後に次の単語区切りを検索するか、その位置にある文字に関する情報を取得します。|
|[コントロール::フォーマットレンジ](#formatrange)|ターゲット出力デバイスのテキスト範囲をフォーマットします。|
|[クリッチエディットCtrl::ゲットチャルポス](#getcharpos)|このオブジェクト内の指定された文字の位置`CRichEditCtrl`を決定します。|
|[コントロール::デフォルトの文字書式を取得します。](#getdefaultcharformat)|この`CRichEditCtrl`オブジェクトの現在の既定の文字書式属性を取得します。|
|[イベントマスク](#geteventmask)|この`CRichEditCtrl`オブジェクトのイベント マスクを取得します。|
|[クリッチエディットCtrl::最初に見える行を取得します。](#getfirstvisibleline)|この`CRichEditCtrl`オブジェクトの一番上に表示される行を決定します。|
|[コリッチエディットCtrl::ゲットイリッチエディットオール](#getiricheditole)|このリッチ エディット`IRichEditOle`コントロールのインターフェイスへのポインターを取得します。|
|[テキストを取得します。](#getlimittext)|ユーザーがこの`CRichEditCtrl`オブジェクトに入力できるテキストの量の制限を取得します。|
|[クリッチエディットCtrl::ゲットライン](#getline)|この`CRichEditCtrl`オブジェクトからテキスト行を取得します。|
|[次の行数](#getlinecount)|この`CRichEditCtrl`オブジェクトの行数を取得します。|
|[次の項目を変更します。](#getmodify)|この`CRichEditCtrl`オブジェクトの内容が最後に保存された後に変更されているかどうかを判断します。|
|[次の項目を取得します。](#getoptions)|リッチ エディット コントロール オプションを取得します。|
|[コントロール::取得パラフォーマット](#getparaformat)|この`CRichEditCtrl`オブジェクトの現在の選択範囲の段落書式属性を取得します。|
|[CリッチエディットCtrl::ゲット句読点](#getpunctuation)|リッチ エディット コントロールの現在の句読点文字を取得します。 このメッセージは、オペレーティング システムのアジア言語版でのみ使用できます。|
|[クリッチエディットCtrl::ゲットレック](#getrect)|この`CRichEditCtrl`オブジェクトの書式設定四角形を取得します。|
|[次の行](#getredoname)|コントロールの再実行キュー内に次のアクションがある場合は、その種類を取得します。|
|[クリッチエディットCtrl::ゲットセル](#getsel)|この`CRichEditCtrl`オブジェクトの現在の選択範囲の開始位置と終了位置を取得します。|
|[コントロール::選択文字書式](#getselectioncharformat)|この`CRichEditCtrl`オブジェクトの現在の選択範囲の文字書式属性を取得します。|
|[次の項目を選択します。](#getselectiontype)|この`CRichEditCtrl`オブジェクトの現在の選択範囲の内容の種類を取得します。|
|[クリックエディットCtrl::ゲットセルテキスト](#getseltext)|この`CRichEditCtrl`オブジェクトの現在の選択範囲のテキストを取得します。|
|[次の文字列を取得します。](#gettextlength)|この`CRichEditCtrl`オブジェクトのテキストの長さを文字数で取得します。 終端の NULL 文字は含まれません。|
|[次のテキストを取得します。](#gettextlengthex)|リッチ エディット ビューの文字数またはバイト数を取得します。 リッチ エディット コントロール内のテキストの長さを決定する方法を示すフラグの一覧を受け入れます。|
|[次のテキスト モード](#gettextmode)|リッチ エディット コントロールの現在のテキスト モードと元に戻すレベルを取得します。|
|[次のテキストの範囲](#gettextrange)|指定したテキスト範囲を取得します。|
|[次の操作を行います。](#getundoname)|次の元に戻す操作がある場合は、その種類を取得します。|
|[次の単語の折り返しモード](#getwordwrapmode)|リッチ エディット コントロールの現在のワード ラップオプションとワード ブレーク オプションを取得します。 このメッセージは、オペレーティング システムのアジア言語版でのみ使用できます。|
|[選択を隠す](#hideselection)|現在の選択範囲を表示または非表示にします。|
|[リミットテキスト](#limittext)|ユーザーがオブジェクトに入力できるテキストの量を`CRichEditCtrl`制限します。|
|[クリッチエディットCtrl::ラインフロルチャー](#linefromchar)|指定した文字を含む行を決定します。|
|[次の行数](#lineindex)|この`CRichEditCtrl`オブジェクト内の指定された行の文字インデックスを取得します。|
|[ラインレンス](#linelength)|この`CRichEditCtrl`オブジェクトの指定された行の長さを取得します。|
|[行スクロール](#linescroll)|この`CRichEditCtrl`オブジェクトのテキストをスクロールします。|
|[クリッチエディットCtrl::Pアステ](#paste)|クリップボードの内容をリッチ エディット コントロールに挿入します。|
|[クリッチエディットCtrl::Pアステスペシャル](#pastespecial)|クリップボードの内容を、指定したデータ形式でこのリッチ エディット コントロールに挿入します。|
|[クリッチエディットCtrl::PosFromChar](#posfromchar)|エディット コントロール内の指定した文字のクライアント領域座標を取得します。|
|[リエディットCtrl::やり直し](#redo)|コントロールの再実行キューの次のアクションを再実行します。|
|[クリッチエディットCtrl::リセプゼル](#replacesel)|この`CRichEditCtrl`オブジェクトの現在の選択範囲を指定したテキストで置き換えます。|
|[要求のサイズ変更](#requestresize)|この`CRichEditCtrl`オブジェクトに要求サイズ変更通知を強制的に送信します。|
|[クリッチエディットCtrl::セットオートURL検出](#setautourldetect)|自動 URL 検出がリッチ エディット コントロールでアクティブかどうかを示します。|
|[コントロール::設定の背景色](#setbackgroundcolor)|この`CRichEditCtrl`オブジェクトの背景色を設定します。|
|[コントロール::セットデフォルトの文字フォーマット](#setdefaultcharformat)|この`CRichEditCtrl`オブジェクトの現在の既定の文字書式属性を設定します。|
|[イベントマスク](#seteventmask)|この`CRichEditCtrl`オブジェクトのイベント マスクを設定します。|
|[次の項目を変更します。](#setmodify)|この`CRichEditCtrl`オブジェクトの変更フラグを設定またはクリアします。|
|[コントロール::セットOLEコールバック](#setolecallback)|このリッチ`IRichEditOleCallback`エディット コントロールの COM オブジェクトを設定します。|
|[クリックメニュー::オプションの設定](#setoptions)|この`CRichEditCtrl`オブジェクトのオプションを設定します。|
|[コントロール::セットパラフォーマット](#setparaformat)|この`CRichEditCtrl`オブジェクトの現在の選択範囲の段落書式属性を設定します。|
|[CリッチエディットCtrl::セット句読点](#setpunctuation)|リッチ エディット コントロールの区切り記号を設定します。 このメッセージは、オペレーティング システムのアジア言語版でのみ使用できます。|
|[次の項目を使用します。](#setreadonly)|この`CRichEditCtrl`オブジェクトの読み取り専用オプションを設定します。|
|[クリッチエディットCtrl::セットレック](#setrect)|この`CRichEditCtrl`オブジェクトの書式設定四角形を設定します。|
|[クリッチエディットCtrl::セットセル](#setsel)|この`CRichEditCtrl`オブジェクトの選択範囲を設定します。|
|[コントロール::セットセレクション文字フォーマット](#setselectioncharformat)|この`CRichEditCtrl`オブジェクトの現在の選択範囲の文字書式属性を設定します。|
|[次の項目を使用します。](#settargetdevice)|この`CRichEditCtrl`オブジェクトのターゲット出力デバイスを設定します。|
|[次のテキストモード](#settextmode)|リッチ エディット コントロールのテキスト モードまたは元に戻すレベルを設定します。 コントロールにテキストが含まれている場合、メッセージは失敗します。|
|[リエディットCtrl::セット元に戻すリミット](#setundolimit)|元に戻すキューに格納できる操作の最大数を設定します。|
|[コントロール::セットワード文字フォーマット](#setwordcharformat)|この`CRichEditCtrl`オブジェクトの現在の単語の文字書式属性を設定します。|
|[コントロールモード::セットワードラップモード](#setwordwrapmode)|リッチ エディット コントロールのワード ラップオプションとワード ブレーク オプションを設定します。 このメッセージは、オペレーティング システムのアジア言語版でのみ使用できます。|
|[グループ化の取り組み](#stopgrouptyping)|コントロールが現在の元に戻す操作に追加の入力操作を収集しないようにします。 コントロールは、次の入力操作がある場合は、元に戻すキューの新しいアクションに格納します。|
|[クリッチエディットCtrl::ストリームイン](#streamin)|入力ストリームからこの`CRichEditCtrl`オブジェクトにテキストを挿入します。|
|[CリッチエディットCtrl::ストリームアウト](#streamout)|このオブジェクトのテキスト`CRichEditCtrl`を出力ストリームに格納します。|
|[CリッチエディットCtrl::元に戻す](#undo)|最後の編集操作を元に戻します。|

## <a name="remarks"></a>解説

"リッチ エディット コントロール" とは、ユーザーがテキストを入力および編集できるウィンドウです。 テキストには、文字および段落の書式を割り当てることができ、埋め込み OLE オブジェクトを含めることができます。 リッチ エディット コントロールは、テキストを書式設定するためのプログラミング インターフェイスを提供します。 ただし、アプリケーションは、ユーザーが書式設定操作を使用できるようにするために必要なユーザー インターフェイス コンポーネントを実装する必要があります。

この Windows コモン コントロール`CRichEditCtrl`(およびクラス) は、Windows 95/98 および Windows NT バージョン 3.51 以降で実行されているプログラムでのみ使用できます。 この`CRichEditCtrl`クラスは、Windows SDK リッチ エディット コントロールのバージョン 2.0 および 3.0 をサポートします。

> [!CAUTION]
> アプリケーションが SDI、MDI、またはダイアログ ベースのいずれであっても、ダイアログ ボックスでリッチ エディット コントロールを使用している場合は、ダイアログ ボックスが表示される前に[AfxInitRichEdit](application-information-and-management.md#afxinitrichedit)を呼び出す必要があります。 この関数を呼び出す一般的な場所は、`InitInstance`プログラムのメンバー関数です。 ダイアログ ボックスを表示するたびに呼び出す必要はありません。 で作業している場合は、`AfxInitRichEdit`電話をかける必要はありません`CRichEditView`。

の使用`CRichEditCtrl`の詳細については、以下を参照してください。

- [コントロール](../../mfc/controls-mfc.md)

- [CRichEditCtrl の使い方](../../mfc/using-cricheditctrl.md)

MFC アプリケーションでリッチ エディット コントロールを使用する例については[、WORDPAD](../../overview/visual-cpp-samples.md)サンプル アプリケーションを参照してください。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CRichEditCtrl`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxcmn.h

## <a name="cricheditctrlcanpaste"></a><a name="canpaste"></a>CリッチエディットCtrl::缶ペースト

リッチ エディット コントロールが指定したクリップボード形式を貼り付けることができるかどうかを判断します。

```
BOOL CanPaste(UINT nFormat = 0) const;
```

### <a name="parameters"></a>パラメーター

*nフォーマット*<br/>
クエリを実行するクリップボード データ形式。 このパラメーターには、定義済みのクリップボード形式の 1 つ、または[RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw)によって返される値を指定できます。

### <a name="return-value"></a>戻り値

クリップボード形式を貼り付けることができる場合は 0 以外の値を指定します。それ以外の場合は 0。

### <a name="remarks"></a>解説

*nFormat が*0`CanPaste`の場合、クリップボードに現在表示されている形式を試します。

詳細については、メッセージ[EM_CANPASTE](/windows/win32/Controls/em-canpaste)と Windows SDK の[クリップボード形式の登録](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw)関数を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#1](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_1.cpp)]

## <a name="cricheditctrlcanredo"></a><a name="canredo"></a>クリッチエディットCtrl::缶詰

やり直しキューにアクションが含まれているかどうかを判断します。

```
BOOL CanRedo() const;
```

### <a name="return-value"></a>戻り値

REDO キューにアクションが含まれている場合は 0 以外の値を返します。

### <a name="remarks"></a>解説

やり直しキュー内の操作の名前を検出するには[、CRichEditCtrl::GetRedoName](#getredoname)を呼び出します。 直前の取り消し操作をやり直すには[、Redo](#redo)を呼び出します。

詳細については、「Windows SDK の[EM_CANREDO」](/windows/win32/Controls/em-canredo)を参照してください。

## <a name="cricheditctrlcanundo"></a><a name="canundo"></a>クリックエディットCtrl::カンドゥンド

最後の編集操作を元に戻すことができるかどうかを判断します。

```
BOOL CanUndo() const;
```

### <a name="return-value"></a>戻り値

Undo メンバー関数の呼び出しによって最後の編集操作を元に戻すことができる場合は 0 以外の値を[返](#undo)します。取り消すことができない場合は 0。

### <a name="remarks"></a>解説

詳細については、Windows SDK の[EM_CANUNDO](/windows/win32/Controls/em-canundo)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#2](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_2.cpp)]

## <a name="cricheditctrlcharfrompos"></a><a name="charfrompos"></a>次のスライド::キャラフロズポス

パラメータ*pt*で指定された位置にある文字に関する情報を取得します。

```
int CharFromPos(CPoint pt) const;
```

### <a name="parameters"></a>パラメーター

*Pt*<br/>
指定した点の座標を含む[CPoint](../../atl-mfc-shared/reference/cpoint-class.md)オブジェクト。

### <a name="return-value"></a>戻り値

指定したポイントに最も近い文字の 0 から始まる文字インデックス。 指定したポイントがコントロールの最後の文字を超えている場合、戻り値はコントロールの最後の文字を示します。

### <a name="remarks"></a>解説

このメンバー関数は、リッチ エディット コントロールと連携します。 エディット コントロールの情報を取得するには[、CEdit::CharFromPos](../../mfc/reference/cedit-class.md#charfrompos)を呼び出します。

詳細については、Windows SDK の[EM_CHARFROMPOS](/windows/win32/Controls/em-charfrompos)を参照してください。

## <a name="cricheditctrlclear"></a><a name="clear"></a>クリッチエディットCtrl::クリア

リッチ エディット コントロールの現在の選択範囲 (存在する場合) を削除します (クリアします)。

```cpp
void Clear();
```

### <a name="remarks"></a>解説

によって実行された`Clear`削除は[、元に戻す](#undo)メンバー関数を呼び出すことによって元に戻すことができます。

現在の選択範囲を削除し、削除した内容をクリップボードに配置するには[、Cut](#cut)メンバー関数を呼び出します。

詳細については、Windows SDK の[WM_CLEAR](/windows/win32/dataxchg/wm-clear)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#3](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_3.cpp)]

## <a name="cricheditctrlcopy"></a><a name="copy"></a>CリッチエディットCtrl::コピー

リッチ エディット コントロールの現在の選択範囲 (存在する場合) をクリップボードにコピーします。

```cpp
void Copy();
```

### <a name="remarks"></a>解説

詳細については、「Windows SDK の[WM_COPY」](/windows/win32/dataxchg/wm-copy)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#4](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_4.cpp)]

## <a name="cricheditctrlcreate"></a><a name="create"></a>CリッチエディットCtrl::作成

Windows リッチ エディット コントロールを作成し、`CRichEditCtrl`このオブジェクトに関連付けます。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*Dwstyle*<br/>
エディット コントロールのスタイルを指定します。 Windows SDK で説明されている **「解説」** に記載されているウィンドウ スタイルと編集[コントロール スタイル](/windows/win32/Controls/edit-control-styles)の組み合わせを適用します。

*Rect*<br/>
エディット コントロールのサイズと位置を指定します。 [CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは[RECT](/windows/win32/api/windef/ns-windef-rect)構造体を指定できます。

*pParentWnd*<br/>
エディット コントロールの親ウィンドウ (通常[は CDialog](../../mfc/reference/cdialog-class.md)) を指定します。 NULL にすることはできません。

*nID*<br/>
エディット コントロールの ID を指定します。

### <a name="return-value"></a>戻り値

初期化が成功した場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

オブジェクトは`CRichEditCtrl`2 つの手順で作成します。 まず[、CRichEditCtrl](#cricheditctrl)コンストラクターを呼び出`Create`し、次に`CRichEditCtrl`を呼び出します。

この関数を使用してリッチ エディット コントロールを作成する場合は、まず必要なコモン コントロール ライブラリを読み込む必要があります。 ライブラリを読み込むには、グローバル関数[AfxInitRichEdit](application-information-and-management.md#afxinitrichedit)を呼び出し、コモン コントロール ライブラリを初期化します。 プロセス内で一`AfxInitRichEdit`度だけ呼び出す必要があります。

Windows`Create`が実行されると[、WM_NCCREATE](../../mfc/reference/cwnd-class.md#onnccreate)、 [WM_NCCALCSIZE](../../mfc/reference/cwnd-class.md#onnccalcsize)、 [WM_CREATE](../../mfc/reference/cwnd-class.md#oncreate)、および[WM_GETMINMAXINFO](../../mfc/reference/cwnd-class.md#ongetminmaxinfo)メッセージがエディット コントロールに送信されます。

これらのメッセージは、`CWnd`既定では、基本クラスの[OnNcCreate、OnNcCalcSize、OnCreate](../../mfc/reference/cwnd-class.md#onnccreate)、および[OnGetMinMaxInfo](../../mfc/reference/cwnd-class.md#ongetminmaxinfo)メンバー関数によって処理されます。 [OnNcCalcSize](../../mfc/reference/cwnd-class.md#onnccalcsize) [OnCreate](../../mfc/reference/cwnd-class.md#oncreate) 既定のメッセージ処理を拡張するには、 から`CRichEditCtrl`クラスを派生し、新しいクラスにメッセージ マップを追加し、上記のメッセージ ハンドラー メンバー関数をオーバーライドします。 オーバーライド`OnCreate`(たとえば、新しいクラスに必要な初期化を実行する場合)。

エディット コントロールに次の[ウィンドウ スタイル](../../mfc/reference/styles-used-by-mfc.md#window-styles)を適用します。

- WS_CHILD 常に。

- WS_VISIBLE 通常。

- WS_DISABLEDめったにない。

- WS_GROUP コントロールをグループ化します。

- WS_TABSTOP タブ順序にエディット コントロールを含めるには

ウィンドウ スタイルの詳細については、「Windows SDK の[ウィンドウ作成](/windows/win32/api/winuser/nf-winuser-createwindoww)」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#5](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_5.cpp)]

## <a name="cricheditctrlcreateex"></a><a name="createex"></a>CリッチエディットCtrl::作成します。

コントロール (子ウィンドウ) を作成し、オブジェクトに関連`CRichEditCtrl`付けます。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*ドウェエクススタイル*<br/>
作成するコントロールの拡張スタイルを指定します。 拡張 Windows スタイルの一覧については、Windows SDK の*DwExStyle*パラメーター[を](/windows/win32/api/winuser/nf-winuser-createwindowexw)参照してください。

*Dwstyle*<br/>
エディット コントロールのスタイルを指定します。 Windows SDK で説明されている「コントロール スタイルの[作成](#create)と編集」の **「解説」** セクションに記載されているウィンドウ[スタイル](/windows/win32/Controls/edit-control-styles)の組み合わせを適用します。

*Rect*<br/>
作成するウィンドウのサイズと位置を記述する[RECT](/windows/win32/api/windef/ns-windef-rect)構造体への参照を *、 pParentWnd*のクライアント座標で指定します。

*pParentWnd*<br/>
コントロールの親であるウィンドウへのポインター。

*nID*<br/>
コントロールの子ウィンドウ ID。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

Windows`CreateEx`拡張`Create`スタイルの序文で指定された拡張 Windows スタイルを適用**する代わりに使用WS_EX_。**

## <a name="cricheditctrlcricheditctrl"></a><a name="cricheditctrl"></a>CリッチエディットCtrl::CリッチエディットCtrl

`CRichEditCtrl` オブジェクトを構築します。

```
CRichEditCtrl();
```

### <a name="remarks"></a>解説

[作成](#create)を使用して、Windows リッチ エディット コントロールを構築します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#6](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_6.cpp)]

## <a name="cricheditctrlcut"></a><a name="cut"></a>クリッチエディットCtrl::カット

リッチ エディット コントロールの現在の選択範囲 (存在する場合) を削除 (カット) し、削除されたテキストをクリップボードにコピーします。

```cpp
void Cut();
```

### <a name="remarks"></a>解説

によって実行された`Cut`削除は[、元に戻す](#undo)メンバー関数を呼び出すことによって元に戻すことができます。

削除したテキストをクリップボードに入れずに現在の選択を削除するには[、Clear](#clear)メンバー関数を呼び出します。

詳細については、Windows SDK の[WM_CUT](/windows/win32/dataxchg/wm-cut)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#7](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_7.cpp)]

## <a name="cricheditctrldisplayband"></a><a name="displayband"></a>:Dプレイバンド

以前に[FormatRange](#formatrange)で書式設定されたリッチ エディット コントロールの内容 (テキストおよび OLE アイテム) の一部を表示します。

```
BOOL DisplayBand(LPRECT pDisplayRect);
```

### <a name="parameters"></a>パラメーター

*を表示する*<br/>
テキストを表示するデバイスの領域を指定する[RECT](/windows/win32/api/windef/ns-windef-rect)オブジェクトまたは[CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトへのポインター。

### <a name="return-value"></a>戻り値

書式設定されたテキストの表示に成功した場合は 0 以外の値を返します。

### <a name="remarks"></a>解説

テキストと OLE アイテムは、ポインター *pDisplayRect*で指定された領域にクリップされます。

詳細については、「Windows SDK の[EM_DISPLAYBAND」](/windows/win32/Controls/em-displayband)を参照してください。

### <a name="example"></a>例

  [の](#formatrange)例を参照してください。

## <a name="cricheditctrlemptyundobuffer"></a><a name="emptyundobuffer"></a>次の文字列を処理します。

リッチ エディット コントロールの元に戻すフラグをリセット (クリア) します。

```cpp
void EmptyUndoBuffer();
```

### <a name="remarks"></a>解説

コントロールは、最後の編集操作を元に戻すことができなくなります。 Undo フラグは、リッチ エディット コントロール内の操作を元に戻すことができる場合に必ず設定されます。

元に戻すフラグは[、CWnd](../../mfc/reference/cwnd-class.md)メンバー関数[SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)を呼び出すと、自動的にクリアされます。

詳細については、「Windows SDK の[EM_EMPTYUNDOBUFFER」](/windows/win32/Controls/em-emptyundobuffer)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#8](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_8.cpp)]

## <a name="cricheditctrlfindtext"></a><a name="findtext"></a>テキストを検索します。

リッチ エディット コントロール内のテキストを検索します。

```
long FindText(
    DWORD dwFlags,
    FINDTEXTEX* pFindText) const;
```

### <a name="parameters"></a>パラメーター

*dwFlags*<br/>
使用可能な値の一覧については、Windows SDK の[EM_FINDTEXTEXT](/windows/win32/Controls/em-findtextex)の*wParam*を参照してください。

*テキストを検索します。*<br/>
検索用のパラメーターを与え、一致した範囲を返す[FINDTEXTEX](/windows/win32/api/richedit/ns-richedit-findtextexw)構造体へのポインター。

### <a name="return-value"></a>戻り値

次の一致の 0 から始まる文字位置。- 一致する項目がなくなった場合は 1。

### <a name="remarks"></a>解説

構造体内`FINDTEXTEX`の[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)構造体に適切な範囲パラメータを設定することで、上下に検索できます。

詳細については、Windows [SDKEM_FINDTEXTEX](/windows/win32/Controls/em-findtextex)メッセージと[FINDTEXTEX](/windows/win32/api/richedit/ns-richedit-findtextexw)構造体を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#9](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_9.cpp)]

## <a name="cricheditctrlfindwordbreak"></a><a name="findwordbreak"></a>クリッチエディットCtrl::ワードブレイクを検索

*nStart*で指定された位置の前後に次の単語区切りを検索します。

```
DWORD FindWordBreak(
    UINT nCode,
    DWORD nStart) const;
```

### <a name="parameters"></a>パラメーター

*nコード*<br/>
実行するアクションを示します。 使用可能な値の一覧については、Windows SDK のEM_FINDWORDBREAKのパラメーター*コード*の説明を参照してください。

*n開始*<br/>
開始する 0 から始まる文字位置。

### <a name="return-value"></a>戻り値

パラメータ*nCode*に基づいて。 詳細については、Windows SDK の[EM_FINDWORDBREAK](/windows/win32/Controls/em-findwordbreak)を参照してください。

### <a name="remarks"></a>解説

このメンバー関数を使用して、指定した位置にある文字に関する情報を取得できます。

## <a name="cricheditctrlformatrange"></a><a name="formatrange"></a>コントロール::フォーマットレンジ

特定のデバイスのリッチ エディット コントロール内のテキスト範囲を書式設定します。

```
long FormatRange(
    FORMATRANGE* pfr,
    BOOL bDisplay = TRUE);
```

### <a name="parameters"></a>パラメーター

*pfr*<br/>
出力装置に関する情報を含む[FORMATRANGE](/windows/win32/api/richedit/ns-richedit-formatrange)構造体へのポインター。 NULL は、リッチ エディット コントロール内のキャッシュされた情報を解放できることを示します。

*b表示*<br/>
テキストをレンダリングする必要があるかどうかを示します。 FALSE の場合、テキストは単に測定されます。

### <a name="return-value"></a>戻り値

領域に収まる最後の文字のインデックスに 1 を足した値。

### <a name="remarks"></a>解説

通常、この呼び出しの後に[DisplayBand](#displayband)の呼び出しが続きます。

詳細については、Windows SDK のメッセージと[フォーマット範囲](/windows/win32/api/richedit/ns-richedit-formatrange)の構造[をEM_FORMATRANGE](/windows/win32/Controls/em-formatrange)するを参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#10](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_10.cpp)]

## <a name="cricheditctrlgetcharpos"></a><a name="getcharpos"></a>クリッチエディットCtrl::ゲットチャルポス

この`CRichEditCtrl`オブジェクト内の指定した文字の位置 (左上隅) を取得します。

```
CPoint GetCharPos(long lChar) const;
```

### <a name="parameters"></a>パラメーター

*lChar*<br/>
文字の 0 から始まるインデックス。

### <a name="return-value"></a>戻り値

*lChar*で指定された文字の左上隅の位置。

### <a name="remarks"></a>解説

文字は、0 から始まるインデックス値を指定して指定します。 *lChar*がこの`CRichEditCtrl`オブジェクトの最後の文字のインデックスより大きい場合、戻り値はこの`CRichEditCtrl`オブジェクトの最後の文字を過ぎた文字位置の座標を指定します。

詳細については、Windows SDK の[EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar)を参照してください。

## <a name="cricheditctrlgetdefaultcharformat"></a><a name="getdefaultcharformat"></a>コントロール::デフォルトの文字書式を取得します。

この`CRichEditCtrl`オブジェクトの既定の文字書式属性を取得します。

```
DWORD GetDefaultCharFormat(CHARFORMAT& cf) const;  DWORD GetDefaultCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>パラメーター

*Cf*<br/>
最初のバージョンでは、既定の文字書式`CHARFORMAT`属性を保持する構造体へのポインター。

2 番目のバージョンでは、`CHARFORMAT2`構造体へのポインター (構造体への`CHARFORMAT`リッチ エディット 2.0 拡張であり、既定の文字書式属性を保持します)。

### <a name="return-value"></a>戻り値

cf`dwMask`のデータ*cf*メンバー。既定の文字書式属性を指定しました。

### <a name="remarks"></a>解説

詳細については、メッセージEM_GETCHARFORMATと Windows SDK `CHARFORMAT` `CHARFORMAT2`の と の構造を参照してください。

### <a name="example"></a>例

  「[デフォルトの文字フォーマット](#setdefaultcharformat)」の例を参照してください。

## <a name="cricheditctrlgeteventmask"></a><a name="geteventmask"></a>イベントマスク

この`CRichEditCtrl`オブジェクトのイベント マスクを取得します。

```
long GetEventMask() const;
```

### <a name="return-value"></a>戻り値

この`CRichEditCtrl`オブジェクトのイベント マスク。

### <a name="remarks"></a>解説

イベント マスクは、オブジェクトが親`CRichEditCtrl`ウィンドウに送信する通知メッセージを指定します。

詳細については、Windows SDK の[EM_GETEVENTMASK](/windows/win32/Controls/em-geteventmask)を参照してください。

### <a name="example"></a>例

  [の](#seteventmask)例を参照してください。

## <a name="cricheditctrlgetfirstvisibleline"></a><a name="getfirstvisibleline"></a>クリッチエディットCtrl::最初に見える行を取得します。

この`CRichEditCtrl`オブジェクトの一番上に表示される行を決定します。

```
int GetFirstVisibleLine() const;
```

### <a name="return-value"></a>戻り値

この`CRichEditCtrl`オブジェクトの最上部に表示される行の 0 から始まるインデックス。

### <a name="remarks"></a>解説

詳細については、Windows SDK の[EM_GETFIRSTVISIBLELINE](/windows/win32/Controls/em-getfirstvisibleline)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#11](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_11.cpp)]

## <a name="cricheditctrlgetiricheditole"></a><a name="getiricheditole"></a>コリッチエディットCtrl::ゲットイリッチエディットオール

この`CRichEditCtrl`オブジェクトの`IRichEditOle`インターフェイスにアクセスします。

```
IRichEditOle* GetIRichEditOle() const;
```

### <a name="return-value"></a>戻り値

この`CRichEditCtrl`オブジェクトの[OLE](/windows/win32/api/richole/nn-richole-iricheditole)機能へのアクセスに使用できるインターフェイスへのポインター。インターフェイスにアクセスできない場合は NULL。

### <a name="remarks"></a>解説

このインターフェイスを使用して、`CRichEditCtrl`このオブジェクトの OLE 機能にアクセスします。

詳細については、Windows [SDKEM_GETOLEINTERFACE](/windows/win32/Controls/em-getoleinterface)メッセージと[IRichEditOle](/windows/win32/api/richole/nn-richole-iricheditole)インターフェイスを参照してください。

## <a name="cricheditctrlgetlimittext"></a><a name="getlimittext"></a>テキストを取得します。

この`CRichEditCtrl`オブジェクトのテキスト制限を取得します。

```
long GetLimitText() const;
```

### <a name="return-value"></a>戻り値

この`CRichEditCtrl`オブジェクトの現在のテキスト制限 (バイト単位)。

### <a name="remarks"></a>解説

テキスト制限は、リッチ エディット コントロールが受け入れることのできるテキストの最大量 (バイト単位) です。

詳細については、Windows SDK の[EM_GETLIMITTEXT](/windows/win32/Controls/em-getlimittext)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#12](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_12.cpp)]

## <a name="cricheditctrlgetline"></a><a name="getline"></a>クリッチエディットCtrl::ゲットライン

この`CRichEditCtrl`オブジェクトからテキスト行を取得します。

```
int GetLine(
    int nIndex,
    LPTSTR lpszBuffer) const;

int GetLine(
    int nIndex,
    LPTSTR lpszBuffer,
    int nMaxLength) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
取得する行の 0 から始まるインデックス。

*バッファ*<br/>
テキストを受け取るバッファーへのポイント。 バッファーの最初のワードは、バッファーにコピーできる最大バイト数を指定する必要があります。

*長さ*<br/>
*lpszBuffer*にコピーできる最大文字数。 2 番目の`GetLine`形式の場合、この値は *、lpszBuffer*で指定されたバッファーの最初のワードに入れられます。

### <a name="return-value"></a>戻り値

*lpszBuffer*にコピーされた文字数。

### <a name="remarks"></a>解説

コピーされた行に終端の NULL 文字が含まれていません。

> [!NOTE]
> バッファーの最初のワードにはコピーする文字数が格納されるため、バッファーの長さは 4 バイト以上にしてください。

詳細については、「Windows SDK の[EM_GETLINE」](/windows/win32/Controls/em-getline)を参照してください。

### <a name="example"></a>例

  [「GetLineCount」](#getlinecount)の例を参照してください。

## <a name="cricheditctrlgetlinecount"></a><a name="getlinecount"></a>次の行数

オブジェクト内の行数を`CRichEditCtrl`取得します。

```
int GetLineCount() const;
```

### <a name="return-value"></a>戻り値

この`CRichEditCtrl`オブジェクトの行数。

### <a name="remarks"></a>解説

詳細については、「Windows SDK の[EM_GETLINECOUNT」](/windows/win32/Controls/em-getlinecount)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#13](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_13.cpp)]

## <a name="cricheditctrlgetmodify"></a><a name="getmodify"></a>次の項目を変更します。

この`CRichEditCtrl`オブジェクトの内容が変更されているかどうかを判断します。

```
BOOL GetModify() const;
```

### <a name="return-value"></a>戻り値

この`CRichEditCtrl`オブジェクトのテキストが変更されている場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

Windows では、リッチ エディット コントロールの内容が変更されたかどうかを示す内部フラグが保持されます。 このフラグは、エディット コントロールが最初に作成されたときにクリアされ[、SetModify](#setmodify)メンバー関数を呼び出すことによってもクリアできます。

詳細については、「Windows SDK の[EM_GETMODIFY」](/windows/win32/Controls/em-getmodify)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#14](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_14.cpp)]

## <a name="cricheditctrlgetoptions"></a><a name="getoptions"></a>次の項目を取得します。

リッチ エディット コントロールに現在設定されているオプションを取得します。

```
UINT GetOptions() const;
```

### <a name="return-value"></a>戻り値

現在のオプション フラグ値の組み合わせ。 これらの値の一覧については、Windows SDK で説明されているように[、EM_SETOPTIONS](/windows/win32/Controls/em-setoptions)メッセージの*fOptions*パラメーターを参照してください。

## <a name="cricheditctrlgetparaformat"></a><a name="getparaformat"></a>コントロール::取得パラフォーマット

現在の選択範囲の段落書式属性を取得します。

```
DWORD GetParaFormat(PARAFORMAT& pf) const;  DWORD GetParaFormat(PARAFORMAT2& pf) const;
```

### <a name="parameters"></a>パラメーター

*Pf*<br/>
最初のバージョンでは、現在の選択範囲の段落書式属性を保持する[PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat)構造体へのポインター。

2 番目のバージョンでは[、PARAFORMAT2](/windows/win32/api/richedit/ns-richedit-paraformat2)構造体へのポインターは、既定の`PARAFORMAT`文字書式属性を保持する、構造体に対するリッチ エディット 2.0 拡張です。

### <a name="return-value"></a>戻り値

pf`dwMask`のデータ*pf*メンバ。 現在の選択範囲全体で一貫した段落書式属性を指定します。

### <a name="remarks"></a>解説

複数の段落を選択した場合 *、pf*は最初に選択した段落の属性を受け取ります。 戻り値は、選択全体で一貫している属性を指定します。

詳細については[、Windows](/windows/win32/Controls/em-getparaformat) SDK のEM_GETPARAFORMATメッセージ`PARAFORMAT`と`PARAFORMAT2`のと構造体を参照してください。

### <a name="example"></a>例

  [の](#setparaformat)例を参照してください。

## <a name="cricheditctrlgetpunctuation"></a><a name="getpunctuation"></a>CリッチエディットCtrl::ゲット句読点

リッチ エディット コントロールの現在の句読点文字を取得します。

```
BOOL GetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc) const;
```

### <a name="parameters"></a>パラメーター

*fタイプ*<br/>
Windows SDK の[EM_GETPUNCTUATION](/windows/win32/Controls/em-getpunctuation)の*fType*パラメーターで説明されているように、句読点の種類フラグ。

*lpPunc*<br/>
Windows SDK で説明されているように、[句読点](/windows/win32/api/richedit/ns-richedit-punctuation)構造体へのポインター。

### <a name="return-value"></a>戻り値

操作が成功した場合は 0 以外の値を返します。

### <a name="remarks"></a>解説

このメンバー関数は、オペレーティング システムのアジア言語バージョンでのみ使用できます。

## <a name="cricheditctrlgetrect"></a><a name="getrect"></a>クリッチエディットCtrl::ゲットレック

この`CRichEditCtrl`オブジェクトの書式設定四角形を取得します。

```cpp
void GetRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>パラメーター

*Lprect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md)または[RECT](/windows/win32/api/windef/ns-windef-rect)へのポインターを使用して、この`CRichEditCtrl`オブジェクトの書式設定四角形を受け取ります。

### <a name="remarks"></a>解説

書式設定用の四角形は、テキストの外接する四角形です。 この値は、オブジェクトのサイズとは`CRichEditCtrl`無関係です。

詳細については、Windows SDK の[EM_GETRECT](/windows/win32/Controls/em-getrect)を参照してください。

### <a name="example"></a>例

  [LimitText](#limittext)の例を参照してください。

## <a name="cricheditctrlgetredoname"></a><a name="getredoname"></a>次の行

再実行キューで次に使用可能なアクションの種類を取得します (存在する場合)。

```
UNDONAMEID GetRedoName() const;
```

### <a name="return-value"></a>戻り値

正常に実行`GetRedoName`された場合は、コントロールの再実行キュー内の次のアクションの種類を示す[UNDONAMEID](/windows/win32/api/richedit/ne-richedit-undonameid)列挙型を返します。 再実行キューが空の場合、またはキュー内の再実行アクションの種類が不明な場合は、0`GetRedoName`を返します。

### <a name="remarks"></a>解説

元に戻したりやり直したりできる操作の種類には、入力、削除、ドラッグ アンド ドロップ、切り取り、貼り付けなどがあります。 この情報は、やり直し可能な操作のドロップダウン リスト ボックスなど、元に戻す操作ややり直し操作の拡張ユーザー インターフェイスを提供するアプリケーションに役立ちます。

## <a name="cricheditctrlgetsel"></a><a name="getsel"></a>クリッチエディットCtrl::ゲットセル

この`CRichEditCtrl`オブジェクトの現在の選択範囲の境界を取得します。

```cpp
void GetSel(CHARRANGE& cr) const;

void GetSel(
    long& nStartChar,
    long& nEndChar) const;
```

### <a name="parameters"></a>パラメーター

*Cr*<br/>
現在の選択範囲の境界を受け取る[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)構造体への参照。

*nStartChar*<br/>
現在の選択範囲の先頭文字の 0 から始まるインデックス。

*エンドチャー*<br/>
現在の選択範囲の最後の文字の 0 から始まるインデックス。

### <a name="remarks"></a>解説

この関数の 2 つの形式は、選択範囲の境界を取得する別の方法を提供します。 これらのフォームの簡単な説明は次のとおりです。

- **ゲッセル(** `cr` **)** このフォームは、`CHARRANGE`その`cpMin``cpMax`とメンバーを持つ構造体を使用して、境界を返します。

- **ゲッセル(** `nStartChar` **,** `nEndChar` **)** このフォームは、*パラメータ nStartChar*および*nEndChar*の境界を返します。

先頭 ( または nStartChar ) が 0 で、終了`cpMax`(`cpMin`または*nEndChar*) が - 1 の場合、選択範囲にはすべてが含まれます。 *nEndChar*

詳細については、Windows SDK の「メッセージと[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)構造体[EM_EXGETSEL」](/windows/win32/Controls/em-exgetsel)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#15](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_15.cpp)]

## <a name="cricheditctrlgetselectioncharformat"></a><a name="getselectioncharformat"></a>コントロール::選択文字書式

現在の選択範囲の文字書式属性を取得します。

```
DWORD GetSelectionCharFormat(CHARFORMAT& cf) const;  DWORD GetSelectionCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>パラメーター

*Cf*<br/>
最初のバージョンでは、現在の選択範囲の文字書式属性を受け取る[CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata)構造体へのポインター。

2 番目のバージョンでは、現在の選択範囲の文字書式属性を受け取る`CHARFORMAT`構造体に対する Rich Edit 2.0 拡張である[CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w)構造体へのポインター。

### <a name="return-value"></a>戻り値

cf`dwMask`のデータ*cf*メンバー。これは、現在の選択範囲全体で一貫した文字書式属性を指定します。

### <a name="remarks"></a>解説

*cf*パラメーターは、現在の選択項目の最初の文字の属性を受け取ります。 戻り値は、選択全体で一貫している属性を指定します。

詳細については[、Windows](/windows/win32/Controls/em-getcharformat) SDK のEM_GETCHARFORMATメッセージ`CHARFORMAT`と`CHARFORMAT2`のと構造体を参照してください。

### <a name="example"></a>例

  [「選択の文字書式](#setselectioncharformat)」の例を参照してください。

## <a name="cricheditctrlgetselectiontype"></a><a name="getselectiontype"></a>次の項目を選択します。

この`CRichEditCtrl`オブジェクトの選択の種類を決定します。

```
WORD GetSelectionType() const;
```

### <a name="return-value"></a>戻り値

現在の選択項目の内容を示すフラグ。 次のフラグの組み合わせ。

- SEL_EMPTY 現在の選択がないことを示します。

- SEL_TEXT現在の選択範囲にテキストが含まれていることを示します。

- SEL_OBJECT現在の選択項目に少なくとも 1 つの OLE アイテムが含まれていることを示します。

- SEL_MULTICHAR現在の選択範囲に複数の文字のテキストが含まれていることを示します。

- SEL_MULTIOBJECT現在の選択内容に複数の OLE オブジェクトが含まれていることを示します。

### <a name="remarks"></a>解説

詳細については、「Windows SDK の[EM_SELECTIONTYPE」](/windows/win32/Controls/em-selectiontype)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#16](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_16.cpp)]

## <a name="cricheditctrlgetseltext"></a><a name="getseltext"></a>クリックエディットCtrl::ゲットセルテキスト

この`CRichEditCtrl`オブジェクトの現在の選択範囲からテキストを取得します。

```
long GetSelText(LPSTR lpBuf) const;  CString GetSelText() const;
```

### <a name="parameters"></a>パラメーター

*lpBuf*<br/>
現在の選択範囲内のテキストを受け取るバッファーへのポインター。

### <a name="return-value"></a>戻り値

フォームによって異なります。

- **ゲットセルテキスト(** `lpBuf` **)** null 終了を含まない *、lpBuf*にコピーされた文字数。

- **ゲットセルテキスト( )** 現在の選択範囲を含む文字列。

### <a name="remarks"></a>解説

最初のフォーム**GetSelText(** `lpBuf` **)** を使用する場合は、受信するテキストに対してバッファが十分な大きさであることを確認する必要があります。 [GetSel](#getsel)を呼び出して、現在の選択範囲の文字数を確認します。

詳細については、Windows SDK の[EM_GETSELTEXT](/windows/win32/Controls/em-getseltext)を参照してください。

### <a name="example"></a>例

  [の](#getselectiontype)例を参照してください。

## <a name="cricheditctrlgettextlength"></a><a name="gettextlength"></a>次の文字列を取得します。

この`CRichEditCtrl`オブジェクト内のテキストの長さを、終端の NULL 文字を含まない文字で取得します。

```
long GetTextLength() const;
```

### <a name="return-value"></a>戻り値

この`CRichEditCtrl`オブジェクト内のテキストの長さ。

### <a name="remarks"></a>解説

詳細については、Windows SDK の[WM_GETTEXTLENGTH](/windows/win32/winmsg/wm-gettextlength)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#17](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_17.cpp)]

## <a name="cricheditctrlgettextlengthex"></a><a name="gettextlengthex"></a>次のテキストを取得します。

リッチ エディット コントロール内のテキストの長さを計算します。

```
long GetTextLengthEx(
    DWORD dwFlags,
    UINT uCodePage = -1) const;
```

### <a name="parameters"></a>パラメーター

*dwFlags*<br/>
テキストの長さを決定する際に使用する方法を指定する値。 このメンバーは、Windows SDK で説明されている[GETTEXTLENGTHEX](/windows/win32/api/richedit/ns-richedit-gettextlengthex)のフラグ メンバーにリストされている値の 1 つ以上を指定できます。

*コードページ*<br/>
翻訳用のコード ページ (ANSI コード ページの場合はCP_ACP、Unicode の場合は 1200)。

### <a name="return-value"></a>戻り値

エディット コントロール内の文字数またはバイト数。 *dwFlags*に互換性のないフラグが設定されている場合、このメンバー関数はE_INVALIDARG返します。

### <a name="remarks"></a>解説

`GetTextLengthEx`では、テキストの長さを決定する追加の方法が提供されます。 リッチ エディット 2.0 の機能をサポートしています。 詳細については、Windows SDK の[「リッチ エディット コントロールについて](/windows/win32/Controls/about-rich-edit-controls)」を参照してください。

## <a name="cricheditctrlgettextmode"></a><a name="gettextmode"></a>次のテキスト モード

リッチ エディット コントロールの現在のテキスト モードと元に戻すレベルを取得します。

```
UINT GetTextMode() const;
```

### <a name="return-value"></a>戻り値

Windows SDK で説明されているように[、TEXTMODE](/windows/win32/api/richedit/ne-richedit-textmode)列挙型からのビット フラグのセット。 フラグは、コントロールの現在のテキスト モードと元に戻すレベルを示します。

## <a name="cricheditctrlgettextrange"></a><a name="gettextrange"></a>次のテキストの範囲

指定した範囲の文字を取得します。

```
int GetTextRange(
    int nFirst,
    int nLast,
    CString& refString) const;
```

### <a name="parameters"></a>パラメーター

*n最初の*<br/>
範囲内の最初の文字の直前にある文字位置インデックス。

*nラスト*<br/>
範囲内の最後の文字の直後の文字位置。

*文字列*<br/>
テキストを受け取る[CString](../../atl-mfc-shared/reference/cstringt-class.md)オブジェクトへの参照。

### <a name="return-value"></a>戻り値

コピーされた文字数 (終端の NULL 文字を含まない)。

### <a name="remarks"></a>解説

詳細については、Windows SDK の[EM_GETTEXTRANGE](/windows/win32/Controls/em-gettextrange)を参照してください。

`GetTextRange`は、リッチ エディット 2.0 機能をサポートしています。 詳細については、Windows SDK の[「リッチ エディット コントロールについて](/windows/win32/Controls/about-rich-edit-controls)」を参照してください。

## <a name="cricheditctrlgetundoname"></a><a name="getundoname"></a>次の操作を行います。

元に戻すキューで次に使用可能なアクションの種類を取得します (存在する場合)。

```
UNDONAMEID GetUndoName() const;
```

### <a name="return-value"></a>戻り値

元に戻す操作がコントロールの元に戻すキュー`GetUndoName`にある場合は、キュー内の次のアクションの種類を示す[UNDONAMEID](/windows/win32/api/richedit/ne-richedit-undonameid)列挙型を返します。 元に戻すキューが空の場合、またはキュー内の undo アクションが不明な`GetUndoName`場合は、0 を返します。

### <a name="remarks"></a>解説

元に戻したりやり直したりできる操作の種類には、入力、削除、ドラッグ アンド ドロップ、切り取り、貼り付けなどがあります。 この情報は、元に戻すことができる操作のドロップダウン リスト ボックスなど、元に戻す操作とやり直し操作の拡張ユーザー インターフェイスを提供するアプリケーションに役立ちます。

## <a name="cricheditctrlgetwordwrapmode"></a><a name="getwordwrapmode"></a>次の単語の折り返しモード

リッチ エディット コントロールの現在のワード ラップオプションとワード ブレーク オプションを取得します。

```
UINT GetWordWrapMode() const;
```

### <a name="return-value"></a>戻り値

現在のワード ラップとワードブレークオプション。 これらのオプションについては、Windows SDK の[EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode)で説明します。

### <a name="remarks"></a>解説

このメンバー関数は、オペレーティング システムのアジア言語バージョンでのみ使用できます。

## <a name="cricheditctrlhideselection"></a><a name="hideselection"></a>選択を隠す

選択範囲の表示設定を変更します。

```cpp
void HideSelection(
    BOOL bHide,
    BOOL bPerm);
```

### <a name="parameters"></a>パラメーター

*bHide*<br/>
選択範囲を表示するか非表示にするかを示します。

*bパーム*<br/>
選択の可視性のこの変更を永続的にする必要があるかどうかを示します。

### <a name="remarks"></a>解説

*bPerm*が TRUE の場合、この`CRichEditCtrl`オブジェクトのECO_NOHIDESELオプションが変更されます。 このオプションの簡単な説明については、「 [SetOptions](#setoptions)」を参照してください。 この関数を使用して、この`CRichEditCtrl`オブジェクトのすべてのオプションを設定できます。

詳細については、Windows SDK[のEM_HIDESELECTION](/windows/win32/Controls/em-hideselection)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#18](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_18.cpp)]

## <a name="cricheditctrllimittext"></a><a name="limittext"></a>リミットテキスト

ユーザーがエディット コントロールに入力できるテキストの長さを制限します。

```cpp
void LimitText(long nChars = 0);
```

### <a name="parameters"></a>パラメーター

*nChars*<br/>
ユーザーが入力できるテキストの長さ (バイト単位) を指定します。 このパラメーターが 0 (デフォルト値) の場合、テキストの長さは 64K バイトに設定されます。

### <a name="remarks"></a>解説

テキスト制限を変更すると、ユーザーが入力できるテキストのみが制限されます。 エディット コントロールに既に含まれるテキストには影響しません。 [SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext) `CWnd` アプリケーションが、この関数`SetWindowText`を使用して、 の`LimitText`呼び出しで指定されているテキストよりも多くのテキストをエディット コントロールに配置する場合、ユーザーはエディット コントロール内の任意のテキストを削除できます。 ただし、テキスト制限を使用すると、現在の選択項目を削除するとテキストがテキストの制限を下回らない限り、既存のテキストを新しいテキストに置き換えることはできません。

> [!NOTE]
> テキストの制限では、各 OLE アイテムは 1 文字としてカウントされます。

詳細については、「Windows SDK の[EM_EXLIMITTEXT」](/windows/win32/Controls/em-exlimittext)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#19](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_19.cpp)]

## <a name="cricheditctrllinefromchar"></a><a name="linefromchar"></a>クリッチエディットCtrl::ラインフロルチャー

指定した文字インデックスを含む行の行番号を取得します。

```
long LineFromChar(long nIndex) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
エディット コントロールのテキスト内の目的の文字のインデックス値を 0 から始まる値で指定します。 *nIndex*が -1 の場合、現在の行、つまりキャレットを含む行を指定します。

### <a name="return-value"></a>戻り値

*nIndex*で指定された文字インデックスを含む行の 0 から始まる行番号。 *nIndex が*-1 の場合、選択範囲の最初の文字を含む行の番号が返されます。 選択項目がない場合は、現在の行番号が返されます。

### <a name="remarks"></a>解説

文字インデックスは、リッチ エディット コントロールの先頭からの文字数です。 文字カウントの場合、OLE アイテムは 1 文字としてカウントされます。

詳細については、Windows SDK の[EM_EXLINEFROMCHAR](/windows/win32/Controls/em-exlinefromchar)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#20](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_20.cpp)]

## <a name="cricheditctrllineindex"></a><a name="lineindex"></a>次の行数

この`CRichEditCtrl`オブジェクト内の行の文字インデックスを取得します。

```
int LineIndex(int nLine = -1) const;
```

### <a name="parameters"></a>パラメーター

*nライン*<br/>
エディット コントロールのテキスト内の目的の行のインデックス値を含むか、-1 を含みます。 *nLine*が -1 の場合、現在の行、つまりキャレットを含む行を指定します。

### <a name="return-value"></a>戻り値

*nLine*または -1 で指定された行の文字インデックス (指定した行番号がエディット コントロールの行数より大きい場合)。

### <a name="remarks"></a>解説

文字インデックスは、リッチ エディット コントロールの先頭から指定した行までの文字数です。

詳細については、Windows SDK の[EM_LINEINDEX](/windows/win32/controls/em-lineindex)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#21](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_21.cpp)]

## <a name="cricheditctrllinelength"></a><a name="linelength"></a>ラインレンス

リッチ エディット コントロールの行の長さを取得します。

```
int LineLength(int nLine = -1) const;
```

### <a name="parameters"></a>パラメーター

*nライン*<br/>
長さを取得する行の文字の文字インデックスを指定します。 このパラメーターが -1 の場合、現在の行 (キャレットを含む行) の長さは返され、行内で選択したテキストの長さは含まれません。 単`LineLength`一行エディット コントロールに対して呼び出されると、このパラメーターは無視されます。

### <a name="return-value"></a>戻り値

複数`LineLength`行エディット コントロールに対して呼び出された場合、戻り値は*nLine*で指定された行の長さ (TCHAR 単位) です。  行の末尾に復帰文字は含まれません。 単`LineLength`一行エディット コントロールに対して呼び出された場合、戻り値はエディット コントロール内のテキストの長さ (TCHAR) です。 nLine がコントロールの文字数より大きい場合、戻り値は 0 になります。

### <a name="remarks"></a>解説

[LineIndex](#lineindex)メンバー関数を使用して、この`CRichEditCtrl`オブジェクト内の特定の行番号の文字インデックスを取得します。

詳細については、Windows SDK の[EM_LINELENGTH](/windows/win32/Controls/em-linelength)を参照してください。

### <a name="example"></a>例

  [「ラインインデックス](#lineindex)」の例を参照してください。

## <a name="cricheditctrllinescroll"></a><a name="linescroll"></a>行スクロール

複数行のエディット コントロールのテキストをスクロールします。

```cpp
void LineScroll(
    int nLines,
    int nChars = 0);
```

### <a name="parameters"></a>パラメーター

*nライン*<br/>
垂直方向にスクロールする行数を指定します。

*nChars*<br/>
水平方向にスクロールする文字の位置の数を指定します。 リッチ エディット コントロールにES_RIGHTまたはES_CENTERスタイルが設定されている場合、この値は無視されます。 [編集スタイル](../../mfc/reference/styles-used-by-mfc.md#edit-styles)は、[[作成 ]](#create)で指定します。

### <a name="remarks"></a>解説

エディット コントロールの最後の行のテキストを縦方向にスクロールしません。 現在の行に*nLines*で指定された行数を加えた値がエディット コントロールの行の合計数を超えた場合、エディット コントロールの最後の行がエディット コントロール ウィンドウの先頭までスクロールされるように値が調整されます。

`LineScroll`を使用して、行の最後の文字を横方向にスクロールできます。

詳細については、Windows SDK の[EM_LINESCROLL](/windows/win32/Controls/em-linescroll)を参照してください。

### <a name="example"></a>例

  [「最初の可視線](#getfirstvisibleline)」の例を参照してください。

## <a name="cricheditctrlpaste"></a><a name="paste"></a>クリッチエディットCtrl::Pアステ

クリップボードのデータを、キャレットの位置`CRichEditCtrl`の位置に挿入します。

```cpp
void Paste();
```

### <a name="remarks"></a>解説

クリップボードに認識された形式のデータが含まれている場合にのみ、データが挿入されます。

詳細については、Windows SDK の[WM_PASTE](/windows/win32/dataxchg/wm-paste)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#22](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_22.cpp)]

## <a name="cricheditctrlpastespecial"></a><a name="pastespecial"></a>クリッチエディットCtrl::Pアステスペシャル

特定のクリップボード形式のデータをこの`CRichEditCtrl`オブジェクトに貼り付けます。

```cpp
void PasteSpecial(
    UINT nClipFormat,
    DWORD dvAspect = 0,
    HMETAFILE hMF = 0);
```

### <a name="parameters"></a>パラメーター

*クリップフォーマット*<br/>
この`CRichEditCtrl`オブジェクトに貼り付けるクリップボード形式。

*dvAspect*<br/>
クリップボードから取得するデータのデバイスの側面。

*hMF*<br/>
貼り付けるオブジェクトのアイコンビューを含むメタファイルへのハンドル。

### <a name="remarks"></a>解説

新しいマテリアルは、キャレットの位置である挿入ポイントに挿入されます。

詳細については、Windows SDK の[EM_PASTESPECIAL](/windows/win32/Controls/em-pastespecial)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#23](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_23.cpp)]

## <a name="cricheditctrlposfromchar"></a><a name="posfromchar"></a>クリッチエディットCtrl::PosFromChar

エディット コントロール内の指定した文字のクライアント領域座標を取得します。

```
CPoint PosFromChar(UINT nChar) const;
```

### <a name="parameters"></a>パラメーター

*Nchar*<br/>
文字の 0 から始まるインデックス。

### <a name="return-value"></a>戻り値

文字の位置 (x, y)。 単一行エディット コントロールの場合、y 座標は常に 0 です。

### <a name="remarks"></a>解説

詳細については、Windows SDK の[EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar)を参照してください。

## <a name="cricheditctrlredo"></a><a name="redo"></a>リエディットCtrl::やり直し

コントロールの再実行キューの次のアクションを再実行します。

```
BOOL Redo();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

詳細については、Windows SDK の[EM_REDO](/windows/win32/Controls/em-redo)を参照してください。

## <a name="cricheditctrlreplacesel"></a><a name="replacesel"></a>クリッチエディットCtrl::リセプゼル

この`CRichEditCtrl`オブジェクトの現在の選択範囲を指定したテキストで置き換えます。

```cpp
void ReplaceSel(
    LPCTSTR lpszNewText,
    BOOL bCanUndo = FALSE);
```

### <a name="parameters"></a>パラメーター

*テキスト*<br/>
置換テキストを含む null で終わる文字列へのポインター。

*b元に戻す*<br/>
この関数を元に戻すことができるように指定するには、このパラメーターの値を TRUE に設定します。 既定値は FALSE です。

### <a name="remarks"></a>解説

この`CRichEditCtrl`オブジェクト内のすべてのテキストを置き換えるには[、CWnd::SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)を使用します。

現在の選択がない場合、置換テキストはカーソル位置、つまり現在のキャレット位置に挿入されます。

この関数は、挿入されたテキストに既存の文字書式を設定します。 (0,-1) を呼び`SetSel`出`ReplaceSel`す前にテキストの範囲全体を置き換える場合、前の段落の書式を保持する段落の最後の文字が、新しく挿入されたテキストに継承されます。

詳細については、Windows SDK の[EM_REPLACESEL](/windows/win32/Controls/em-replacesel)を参照してください。

### <a name="example"></a>例

  [「ラインインデックス](#lineindex)」の例を参照してください。

## <a name="cricheditctrlrequestresize"></a><a name="requestresize"></a>要求のサイズ変更

この`CRichEditCtrl`オブジェクトは、親ウィンドウに通知メッセージEN_REQUESTRESIZE送信するように強制します。

```cpp
void RequestResize();
```

### <a name="remarks"></a>解説

この関数は、底なし`CRichEditCtrl`オブジェクトの[CWnd::OnSize](../../mfc/reference/cwnd-class.md#onsize)処理時に便利です。

詳細については、「Windows SDK のリッチ エディット コントロールについて」の[EM_REQUESTRESIZE](/windows/win32/Controls/em-requestresize)メッセージと「リッチ[エディット コントロール](/windows/win32/Controls/about-rich-edit-controls)の**底なし**」セクションを参照してください。

## <a name="cricheditctrlsetautourldetect"></a><a name="setautourldetect"></a>クリッチエディットCtrl::セットオートURL検出

URL を自動的に検出するようにリッチ エディット コントロールを設定します。

```
BOOL SetAutoURLDetect(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>パラメーター

*b 有効にする*<br/>
コントロールが URL を自動的に検出するように設定されているかどうかを指定します。 TRUE の場合は有効です。 FALSE の場合は無効になります。

### <a name="return-value"></a>戻り値

成功した場合は 0、それ以外の場合は 0 以外の場合。 たとえば、メモリ不足のためメッセージが失敗する可能性があります。

### <a name="remarks"></a>解説

有効にすると、リッチ エディット コントロールはテキストをスキャンして、標準の URL 形式と一致するかどうかを判断します。 これらの URL 形式の一覧については、Windows SDK の[EM_AUTOURLDETECT](/windows/win32/Controls/em-autourldetect)を参照してください。

> [!NOTE]
> 編集コントロールで`SetAutoURLDetect`URL 以外のテキストにCFE_LINK効果が使用されている場合は、TRUE に設定しないでください。 `SetAutoURLDetect`このエフェクトは URL に対して有効になり、他のすべてのテキストに対して無効になります。 CFE_LINK効果の詳細については[、「EN_LINK」](/windows/win32/Controls/en-link)を参照してください。

## <a name="cricheditctrlsetbackgroundcolor"></a><a name="setbackgroundcolor"></a>コントロール::設定の背景色

この`CRichEditCtrl`オブジェクトの背景色を設定します。

```
COLORREF SetBackgroundColor(
    BOOL bSysColor,
    COLORREF cr);
```

### <a name="parameters"></a>パラメーター

*カラー*<br/>
背景色をシステム値に設定する必要があるかどうかを示します。 この値が TRUE の場合 *、cr*は無視されます。

*Cr*<br/>
要求された背景色。 *bSysColor*が FALSE の場合にのみ使用されます。

### <a name="return-value"></a>戻り値

この`CRichEditCtrl`オブジェクトの前の背景色。

### <a name="remarks"></a>解説

背景色は、システム値または指定した[COLORREF](/windows/win32/gdi/colorref)値に設定できます。

詳細については、Windows SDK[のメッセージ](/windows/win32/Controls/em-setbkgndcolor)と[COLORREF](/windows/win32/gdi/colorref)構造体EM_SETBKGNDCOLORを参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#24](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_24.cpp)]

## <a name="cricheditctrlsetdefaultcharformat"></a><a name="setdefaultcharformat"></a>コントロール::セットデフォルトの文字フォーマット

この`CRichEditCtrl`オブジェクトの新しいテキストの文字書式属性を設定します。

```
BOOL SetDefaultCharFormat(CHARFORMAT& cf);
BOOL SetDefaultCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>パラメーター

*Cf*<br/>
最初のバージョンでは、新しいデフォルトの文字書式属性を含む[CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata)構造体へのポインタ。

2 番目のバージョンでは、既定の文字書式属性を含む、`CHARFORMAT`構造体に対する Rich Edit 2.0 拡張である[CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

cf の`dwMask`メンバーによって指定された属性*のみがこの関数*によって変更されます。

詳細については[、windows](/windows/win32/Controls/em-setcharformat) SDK のEM_SETCHARFORMATメッセージ`CHARFORMAT`と`CHARFORMAT2`のと構造体を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#25](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_25.cpp)]

## <a name="cricheditctrlseteventmask"></a><a name="seteventmask"></a>イベントマスク

この`CRichEditCtrl`オブジェクトのイベント マスクを設定します。

```
DWORD SetEventMask(DWORD dwEventMask);
```

### <a name="parameters"></a>パラメーター

*ドヴイベントマスク*<br/>
この`CRichEditCtrl`オブジェクトの新しいイベント マスク。

### <a name="return-value"></a>戻り値

前のイベント マスク。

### <a name="remarks"></a>解説

イベント マスクは、オブジェクトが親`CRichEditCtrl`ウィンドウに送信する通知メッセージを指定します。

詳細については、Windows SDK の[EM_SETEVENTMASK](/windows/win32/Controls/em-seteventmask)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#26](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_26.cpp)]

## <a name="cricheditctrlsetmodify"></a><a name="setmodify"></a>次の項目を変更します。

エディット コントロールの変更フラグを設定またはクリアします。

```cpp
void SetModify(BOOL bModified = TRUE);
```

### <a name="parameters"></a>パラメーター

*bModified*<br/>
TRUE の値は、テキストが変更されたことを示し、FALSE の値は、それが変更されていないことを示します。 デフォルトでは、変更されたフラグが設定されます。

### <a name="remarks"></a>解説

変更されたフラグは、エディット コントロール内のテキストが変更されたかどうかを示します。 ユーザーがテキストを変更するたびに自動的に設定されます。 その値は[、GetModify](#getmodify)メンバー関数を使用して取得できます。

詳細については、「Windows SDK の[EM_SETMODIFY」](/windows/win32/Controls/em-setmodify)を参照してください。

### <a name="example"></a>例

  [「GetModify」](#getmodify)の例を参照してください。

## <a name="cricheditctrlsetolecallback"></a><a name="setolecallback"></a>コントロール::セットOLEコールバック

OLE`CRichEditCtrl`関連の`IRichEditOleCallback`リソースや情報にアクセスするために使用するオブジェクトをこのオブジェクトに与えます。

```
BOOL SetOLECallback(IRichEditOleCallback* pCallback);
```

### <a name="parameters"></a>パラメーター

*pCallback*<br/>
この`CRichEditCtrl`[オブジェクトが](/windows/win32/api/richole/nn-richole-iricheditolecallback)OLE 関連のリソースと情報を取得するために使用するオブジェクトへのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

この`CRichEditCtrl`オブジェクトは *、pCallback*で指定された COM オブジェクトの使用カウントをインクリメントするために[IUnknown::AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref)を呼び出します。

詳細については、メッセージ[と](/windows/win32/Controls/em-setolecallback)Windows SDK の[「EM_SETOLECALLBACK](/windows/win32/api/richole/nn-richole-iricheditolecallback)のインターフェイス」を参照してください。

## <a name="cricheditctrlsetoptions"></a><a name="setoptions"></a>クリックメニュー::オプションの設定

この`CRichEditCtrl`オブジェクトのオプションを設定します。

```cpp
void SetOptions(
    WORD wOp,
    DWORD dwFlags);
```

### <a name="parameters"></a>パラメーター

*wOp*<br/>
操作の種類を示します。 次のいずれかの値:

- ECOOP_SET オプションを*dwFlags*で指定したオプションに設定します。

- ECOOP_OR 現在のオプションを*dwFlags*で指定されたオプションと結合します。

- ECOOP_AND *dwFlags*でも指定されている現在のオプションだけを保持します。

- ECOOP_XOR dwFlags で指定されたオプションを使用して、論理的に排他的または現在のオプション*を指定します*。

*dwFlags*<br/>
リッチ編集オプション。 フラグの値は、「解説」セクションにリストされています。

### <a name="remarks"></a>解説

オプションは、次の値の組み合わせにすることができます。

- ECO_AUTOWORDSELECTIONダブルクリック時に単語の自動選択を行います。

- ECO_AUTOVSCROLL 行末に文字を入力すると、自動的にテキストが 10 文字ずつ右にスクロールされます。 ユーザーが Enter キーを押すと、コントロールはすべてのテキストをスクロールして 0 の位置に戻します。

- ECO_AUTOHSCROLL ユーザーが最後の行の Enter キーを押したときに、自動的にテキストを 1 ページ上にスクロールします。

- ECO_NOHIDESELエディット コントロールの既定の動作を否定します。 既定の動作では、コントロールが入力フォーカスを失うと選択が非表示になり、コントロールが入力フォーカスを受け取ったときに選択項目が表示されます。 ECO_NOHIDESELを指定すると、コントロールにフォーカスがない場合でも、選択したテキストは反転されます。

- ECO_READONLY エディット コントロールでテキストを入力または編集できないようにします。

- ECO_WANTRETURNユーザーがダイアログ ボックスで複数行のリッチ エディット コントロールにテキストを入力しているときに Enter キーを押したときに、復帰改行を挿入することを指定します。 このスタイルを指定しない場合、Enter キーを押すと、リッチ エディット コントロールの親ウィンドウにコマンドが送信されます。 このスタイルは、単一行エディット コントロールには影響しません。

- ECO_SAVESEL コントロールがフォーカスを失ったときに選択範囲を保持します。 既定では、フォーカスを取り戻すと、コントロールの内容全体が選択されます。

- ECO_VERTICAL テキストとオブジェクトを垂直方向に描画します。 アジア言語でのみ使用できます。

詳細については、「Windows SDK の[EM_SETOPTIONS」](/windows/win32/Controls/em-setoptions)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#27](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_27.cpp)]

## <a name="cricheditctrlsetparaformat"></a><a name="setparaformat"></a>コントロール::セットパラフォーマット

この`CRichEditCtrl`オブジェクトの現在の選択範囲の段落書式属性を設定します。

```
BOOL SetParaFormat(PARAFORMAT& pf);
BOOL SetParaFormat(PARAFORMAT2& pf);
```

### <a name="parameters"></a>パラメーター

*Pf*<br/>
最初のバージョンでは、新しいデフォルトの段落書式属性を含む[PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat)構造体へのポインタ。

2 番目のバージョンでは[、PARAFORMAT2](/windows/win32/api/richedit/ns-richedit-paraformat2)構造体へのポインターは、既定の`PARAFORMAT`文字書式属性を保持する、構造体に対するリッチ エディット 2.0 拡張です。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

この関数によって変更されるのは`dwMask`*、pf*のメンバーによって指定された属性だけです。

詳細については[、EM_SETPARAFORMAT](/windows/win32/Controls/em-setparaformat)メッセージと Windows SDK `PARAFORMAT` `PARAFORMAT2`の と の構造を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#28](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_28.cpp)]

## <a name="cricheditctrlsetpunctuation"></a><a name="setpunctuation"></a>CリッチエディットCtrl::セット句読点

リッチ エディット コントロールの句読点を設定します。

```
BOOL SetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc);
```

### <a name="parameters"></a>パラメーター

*fタイプ*<br/>
句読点フラグ。 使用可能な値の一覧については、Windows SDK の[EM_SETPUNCTUATION](/windows/win32/Controls/em-setpunctuation)の*fType*パラメーターを参照してください。

*lpPunc*<br/>
Windows SDK で説明されているように、[句読点](/windows/win32/api/richedit/ns-richedit-punctuation)構造体へのポインター。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外の値を返します。

### <a name="remarks"></a>解説

このメンバー関数は、オペレーティング システムのアジア言語バージョンでのみ使用できます。

## <a name="cricheditctrlsetreadonly"></a><a name="setreadonly"></a>次の項目を使用します。

この`CRichEditCtrl`オブジェクトのECO_READONLY オプションを変更します。

```
BOOL SetReadOnly(BOOL bReadOnly = TRUE);
```

### <a name="parameters"></a>パラメーター

*読み取り専用*<br/>
この`CRichEditCtrl`オブジェクトを読み取り専用にする必要があるかどうかを示します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

このオプションの簡単な説明については、「 [SetOptions](#setoptions)」を参照してください。 この関数を使用して、この`CRichEditCtrl`オブジェクトのすべてのオプションを設定できます。

詳細については、Windows SDK の[EM_SETREADONLY](/windows/win32/Controls/em-setreadonly)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#29](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_29.cpp)]

## <a name="cricheditctrlsetrect"></a><a name="setrect"></a>クリッチエディットCtrl::セットレック

この`CRichEditCtrl`オブジェクトの書式設定四角形を設定します。

```cpp
void SetRect(LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*Lprect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md)または、書式設定用の四角形の新しい境界を示す[RECT](/windows/win32/api/windef/ns-windef-rect)へのポインター。

### <a name="remarks"></a>解説

書式設定の四角形は、テキストの制限の四角形です。 制限付きの四角形は、リッチ エディット コントロール ウィンドウのサイズに依存しません。 この`CRichEditCtrl`オブジェクトが最初に作成されたとき、書式設定の四角形はウィンドウのクライアント領域と同じサイズになります。 書式設定`SetRect`用の四角形をリッチ エディット ウィンドウよりも大きくまたは小さくするために使用します。

詳細については、Windows SDK の[EM_SETRECT](/windows/win32/Controls/em-setrect)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#30](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_30.cpp)]

## <a name="cricheditctrlsetsel"></a><a name="setsel"></a>クリッチエディットCtrl::セットセル

この`CRichEditCtrl`オブジェクト内の選択を設定します。

```cpp
void SetSel(
    long nStartChar,
    long nEndChar);

void SetSel(CHARRANGE& cr);
```

### <a name="parameters"></a>パラメーター

*nStartChar*<br/>
選択範囲の最初の文字の 0 から始まるインデックス。

*エンドチャー*<br/>
選択範囲の最後の文字の 0 から始まるインデックス。

*Cr*<br/>
現在の選択範囲の境界を保持する[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)構造体。

### <a name="remarks"></a>解説

この関数の 2 つの形式は、選択範囲の境界を設定する別の方法を提供します。 これらのフォームの簡単な説明は次のとおりです。

- **セットセル(** `cr` **)** このフォームは、`CHARRANGE`その`cpMin``cpMax`およびメンバーを持つ構造体を使用して、境界を設定します。

- **セットセル(** `nStartChar` **,** `nEndChar` **)** このフォームでは、パラメータ*nStartChar*と*nEndChar*を使用して境界を設定します。

`cpMin`キャレットは、開始インデックス (または*nStartChar)* の方が指定した選択範囲の末尾に配置され、`cpMax`インデックスの末尾 ( または*nEndChar*) が指定されます。 この関数は、キャレットが表示`CRichEditCtrl`されるようにの内容をスクロールします。

この`CRichEditCtrl`オブジェクト内のすべてのテキストを選択するには、開始`SetSel`インデックス 0 と終了インデックスを -1 で呼び出します。

詳細については、Windows SDK の「メッセージと[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)構造体[」EM_EXSETSEL](/windows/win32/Controls/em-exsetsel)参照してください。

### <a name="example"></a>例

  [GetSel](#getsel)の例を参照してください。

## <a name="cricheditctrlsetselectioncharformat"></a><a name="setselectioncharformat"></a>コントロール::セットセレクション文字フォーマット

この`CRichEditCtrl`オブジェクトの現在の選択範囲内の文字書式属性を設定します。

```
BOOL SetSelectionCharFormat(CHARFORMAT& cf);
BOOL SetSelectionCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>パラメーター

*Cf*<br/>
最初のバージョンでは、現在の選択範囲の新しい文字書式属性を含む[CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata)構造体へのポインター。

2 番目のバージョンでは、現在の選択範囲の新しい文字書式属性を含む、`CHARFORMAT`構造体に対するリッチ エディット 2.0 の拡張機能である[CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

cf の`dwMask`メンバーによって指定された属性*のみがこの関数*によって変更されます。

詳細については、Windows SDK[EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat)のEM_SETCHARFORMAT`CHARFORMAT`と`CHARFORMAT2`の構造を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#31](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_31.cpp)]

## <a name="cricheditctrlsettargetdevice"></a><a name="settargetdevice"></a>次の項目を使用します。

この`CRichEditCtrl`オブジェクトの WYSIWYG (表示される内容) の書式設定に使用されるターゲット デバイスとライン幅を設定します。

```
BOOL SetTargetDevice(
    HDC hDC,
    long lLineWidth);

BOOL SetTargetDevice(
    CDC& dc,
    long lLineWidth);
```

### <a name="parameters"></a>パラメーター

*Hdc*<br/>
新しいターゲット デバイスのデバイス コンテキストへのハンドル。

*線幅*<br/>
書式設定に使用する線の幅。

*Dc*<br/>
新しいターゲット デバイスの[CDC。](../../mfc/reference/cdc-class.md)

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

この関数が正常に実行されると、リッチ エディット コントロールは、パラメーターとして渡されたデバイス コンテキストを所有します。 その場合、呼び出し元の関数はデバイス コンテキストを破棄しないでください。

詳細については、Windows SDK の[EM_SETTARGETDEVICE](/windows/win32/Controls/em-settargetdevice)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#32](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_32.cpp)]

## <a name="cricheditctrlsettextmode"></a><a name="settextmode"></a>次のテキストモード

リッチ エディット コントロールのテキスト モードまたは元に戻すレベルとやり直しレベルを設定します。

```
BOOL SetTextMode(UINT fMode);
```

### <a name="parameters"></a>パラメーター

*fモード*<br/>
コントロールのテキスト モードパラメータと元に戻すレベル パラメータの新しい設定を指定します。 使用可能な値の一覧については、Windows SDK の[EM_SETTEXTMODE](/windows/win32/Controls/em-settextmode)のモード パラメーターを参照してください。

### <a name="return-value"></a>戻り値

成功した場合は 0、それ以外の場合は 0 以外の場合。

### <a name="remarks"></a>解説

テキスト モードの詳細については、Windows SDK のEM_SETTEXTMODEを参照してください。

コントロールにテキストが含まれている場合、このメンバー関数は失敗します。 コントロールが空であることを確認するには、空の文字列を含む[WM_SETTEXT](/windows/win32/winmsg/wm-settext)メッセージを送信します。

## <a name="cricheditctrlsetundolimit"></a><a name="setundolimit"></a>リエディットCtrl::セット元に戻すリミット

元に戻すキューに格納できる操作の最大数を設定します。

```
UINT SetUndoLimit(UINT nLimit);
```

### <a name="parameters"></a>パラメーター

*n制限*<br/>
取り消しキューに格納できる操作の最大数を指定します。 元に戻すを無効にするには、ゼロに設定します。

### <a name="return-value"></a>戻り値

リッチ エディット コントロールの元に戻す操作の新しい最大数。

### <a name="remarks"></a>解説

既定では、元に戻すキュー内の操作の最大数は 100 です。 この数を増やす場合は、新しい数を収容するのに十分なメモリが必要です。 パフォーマンスを向上させるには、制限を可能な限り小さい値に設定します。

## <a name="cricheditctrlsetwordcharformat"></a><a name="setwordcharformat"></a>コントロール::セットワード文字フォーマット

この`CRichEditCtrl`オブジェクトで現在選択されている単語の文字書式属性を設定します。

```
BOOL SetWordCharFormat(CHARFORMAT& cf);
BOOL SetWordCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>パラメーター

*Cf*<br/>
最初のバージョンでは、現在選択されている単語の新しい文字書式属性を含む[CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata)構造体へのポインタ。

2 番目のバージョンでは、現在選択されている単語の新しい文字書式属性を含む、`CHARFORMAT`構造体に対するリッチ エディット 2.0 の拡張機能である[CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

cf の`dwMask`メンバーによって指定された属性*のみがこの関数*によって変更されます。

詳細については[、windows](/windows/win32/Controls/em-setcharformat) SDK のEM_SETCHARFORMATメッセージ`CHARFORMAT`と`CHARFORMAT2`のと構造体を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#33](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_33.cpp)]

## <a name="cricheditctrlsetwordwrapmode"></a><a name="setwordwrapmode"></a>コントロールモード::セットワードラップモード

リッチ エディット コントロールのワード ラップオプションとワード ブレーク オプションを設定します。

```
UINT SetWordWrapMode(UINT uFlags) const;
```

### <a name="parameters"></a>パラメーター

*uフラグ*<br/>
ワードラップとワード改行に設定するオプション。 使用可能なオプションの一覧については、Windows SDK の[EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode)を参照してください。

### <a name="return-value"></a>戻り値

現在のワード ラップオプションとワードブレークオプション。

### <a name="remarks"></a>解説

このメッセージは、オペレーティング システムのアジア言語版でのみ使用できます。

## <a name="cricheditctrlstopgrouptyping"></a><a name="stopgrouptyping"></a>グループ化の取り組み

コントロールが現在の元に戻す操作に追加の入力操作を収集しないようにします。

```cpp
void StopGroupTyping();
```

### <a name="remarks"></a>解説

コントロールは、次の入力操作がある場合は、元に戻すキューの新しいアクションに格納します。

詳細については、「Windows SDK の[EM_STOPGROUPTYPING」](/windows/win32/Controls/em-stopgrouptyping)を参照してください。

## <a name="cricheditctrlstreamin"></a><a name="streamin"></a>クリッチエディットCtrl::ストリームイン

この`CRichEditCtrl`オブジェクトのテキストを、指定した入力ストリームのテキストに置き換えます。

```
long StreamIn(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>パラメーター

*nフォーマット*<br/>
入力データ形式を指定するフラグ。 詳細については、「解説」を参照してください。

*es*<br/>
入力ストリームを指定する[EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream)構造体。 詳細については、「解説」を参照してください。

### <a name="return-value"></a>戻り値

入力ストリームから読み取られた文字数。

### <a name="remarks"></a>解説

*nFormat*の値は、次のいずれかでなければなりません。

- SF_TEXT テキストの読み取りのみを示します。

- SF_RTF テキストの読み上げと書式設定を示します。

これらの値は、SFF_SELECTIONと組み合わせることができます。 SFF_SELECTIONを指定すると、`StreamIn`現在選択されている選択範囲が入力ストリームの内容に置き換えられます。 指定しない場合は、`StreamIn`この`CRichEditCtrl`オブジェクトの内容全体を置き換えます。

`EDITSTREAM`パラメーター *es*では、バッファーにテキストを格納するコールバック関数を指定します。 このコールバック関数は、入力ストリームが使い果たされるまで繰り返し呼び出されます。

詳細については、Windows SDK[の](/windows/win32/Controls/em-streamin)「EM_STREAMINメッセージと[EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream)構造体」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#34](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_34.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#35](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_35.cpp)]

## <a name="cricheditctrlstreamout"></a><a name="streamout"></a>CリッチエディットCtrl::ストリームアウト

この`CRichEditCtrl`オブジェクトの内容を指定した出力ストリームに書き込みます。

```
long StreamOut(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>パラメーター

*nフォーマット*<br/>
出力データ形式を指定するフラグ。 詳細については、「解説」を参照してください。

*es*<br/>
出力ストリームを指定する[EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream)構造体。 詳細については、「解説」を参照してください。

### <a name="return-value"></a>戻り値

出力ストリームに書き込まれた文字数。

### <a name="remarks"></a>解説

*nFormat*の値は、次のいずれかでなければなりません。

- SF_TEXT テキストのみを書き込みます。

- SF_RTF テキストと書式を書き込みます。

- SF_RTFNOOBJS テキストと書式を書き込み、OLE アイテムをスペースに置き換えることを示します。

- SF_TEXTIZED OLE アイテムのテキスト表現を使用して、テキストと書式を書き込みます。

これらの値はいずれもSFF_SELECTIONと組み合わせることができます。 SFF_SELECTIONを指定した場合`StreamOut`は、現在の選択内容を出力ストリームに書き出します。 指定しない場合は、`StreamOut`この`CRichEditCtrl`オブジェクトの内容全体を書き出します。

`EDITSTREAM`パラメーター *es*では、バッファーにテキストを格納するコールバック関数を指定します。 このコールバック関数は、出力ストリームが使い果たされるまで繰り返し呼び出されます。

詳細については、Windows SDK のメッセージと[EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream)構造体[のEM_STREAMOUT](/windows/win32/Controls/em-streamout)を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#36](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_36.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#37](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_37.cpp)]

## <a name="cricheditctrlundo"></a><a name="undo"></a>CリッチエディットCtrl::元に戻す

リッチ エディット コントロールの最後の操作を元に変更します。

```
BOOL Undo();
```

### <a name="return-value"></a>戻り値

元に戻す操作が成功した場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

元に戻す操作を元に戻すこともできます。 たとえば、削除したテキストを復元するには、 を最初に呼`Undo`び出します。 間に編集操作がない限り、2 回目の呼び出しでテキストを削除できます`Undo`。

詳細については、Windows SDK の[EM_UNDO](/windows/win32/Controls/em-undo)を参照してください。

### <a name="example"></a>例

  [「CanUndo」](#canundo)の例を参照してください。

## <a name="see-also"></a>関連項目

[MFC サンプル ワードパッド](../../overview/visual-cpp-samples.md)<br/>
[CWnd クラス](../../mfc/reference/cwnd-class.md)<br/>
[階層グラフ](../../mfc/hierarchy-chart.md)<br/>
[CEdit Class](../../mfc/reference/cedit-class.md)<br/>
[クラスを表示します。](../../mfc/reference/cricheditview-class.md)
