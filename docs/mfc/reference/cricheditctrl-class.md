---
description: '詳細情報: CRichEditCtrl クラス'
title: CRichEditCtrl クラス
ms.date: 11/04/2016
f1_keywords:
- CRichEditCtrl
- AFXCMN/CRichEditCtrl
- AFXCMN/CRichEditCtrl::CRichEditCtrl
- AFXCMN/CRichEditCtrl::CanPaste
- AFXCMN/CRichEditCtrl::CanRedo
- AFXCMN/CRichEditCtrl::CanUndo
- AFXCMN/CRichEditCtrl::CharFromPos
- AFXCMN/CRichEditCtrl::Clear
- AFXCMN/CRichEditCtrl::Copy
- AFXCMN/CRichEditCtrl::Create
- AFXCMN/CRichEditCtrl::CreateEx
- AFXCMN/CRichEditCtrl::Cut
- AFXCMN/CRichEditCtrl::DisplayBand
- AFXCMN/CRichEditCtrl::EmptyUndoBuffer
- AFXCMN/CRichEditCtrl::FindText
- AFXCMN/CRichEditCtrl::FindWordBreak
- AFXCMN/CRichEditCtrl::FormatRange
- AFXCMN/CRichEditCtrl::GetCharPos
- AFXCMN/CRichEditCtrl::GetDefaultCharFormat
- AFXCMN/CRichEditCtrl::GetEventMask
- AFXCMN/CRichEditCtrl::GetFirstVisibleLine
- AFXCMN/CRichEditCtrl::GetIRichEditOle
- AFXCMN/CRichEditCtrl::GetLimitText
- AFXCMN/CRichEditCtrl::GetLine
- AFXCMN/CRichEditCtrl::GetLineCount
- AFXCMN/CRichEditCtrl::GetModify
- AFXCMN/CRichEditCtrl::GetOptions
- AFXCMN/CRichEditCtrl::GetParaFormat
- AFXCMN/CRichEditCtrl::GetPunctuation
- AFXCMN/CRichEditCtrl::GetRect
- AFXCMN/CRichEditCtrl::GetRedoName
- AFXCMN/CRichEditCtrl::GetSel
- AFXCMN/CRichEditCtrl::GetSelectionCharFormat
- AFXCMN/CRichEditCtrl::GetSelectionType
- AFXCMN/CRichEditCtrl::GetSelText
- AFXCMN/CRichEditCtrl::GetTextLength
- AFXCMN/CRichEditCtrl::GetTextLengthEx
- AFXCMN/CRichEditCtrl::GetTextMode
- AFXCMN/CRichEditCtrl::GetTextRange
- AFXCMN/CRichEditCtrl::GetUndoName
- AFXCMN/CRichEditCtrl::GetWordWrapMode
- AFXCMN/CRichEditCtrl::HideSelection
- AFXCMN/CRichEditCtrl::LimitText
- AFXCMN/CRichEditCtrl::LineFromChar
- AFXCMN/CRichEditCtrl::LineIndex
- AFXCMN/CRichEditCtrl::LineLength
- AFXCMN/CRichEditCtrl::LineScroll
- AFXCMN/CRichEditCtrl::Paste
- AFXCMN/CRichEditCtrl::PasteSpecial
- AFXCMN/CRichEditCtrl::PosFromChar
- AFXCMN/CRichEditCtrl::Redo
- AFXCMN/CRichEditCtrl::ReplaceSel
- AFXCMN/CRichEditCtrl::RequestResize
- AFXCMN/CRichEditCtrl::SetAutoURLDetect
- AFXCMN/CRichEditCtrl::SetBackgroundColor
- AFXCMN/CRichEditCtrl::SetDefaultCharFormat
- AFXCMN/CRichEditCtrl::SetEventMask
- AFXCMN/CRichEditCtrl::SetModify
- AFXCMN/CRichEditCtrl::SetOLECallback
- AFXCMN/CRichEditCtrl::SetOptions
- AFXCMN/CRichEditCtrl::SetParaFormat
- AFXCMN/CRichEditCtrl::SetPunctuation
- AFXCMN/CRichEditCtrl::SetReadOnly
- AFXCMN/CRichEditCtrl::SetRect
- AFXCMN/CRichEditCtrl::SetSel
- AFXCMN/CRichEditCtrl::SetSelectionCharFormat
- AFXCMN/CRichEditCtrl::SetTargetDevice
- AFXCMN/CRichEditCtrl::SetTextMode
- AFXCMN/CRichEditCtrl::SetUndoLimit
- AFXCMN/CRichEditCtrl::SetWordCharFormat
- AFXCMN/CRichEditCtrl::SetWordWrapMode
- AFXCMN/CRichEditCtrl::StopGroupTyping
- AFXCMN/CRichEditCtrl::StreamIn
- AFXCMN/CRichEditCtrl::StreamOut
- AFXCMN/CRichEditCtrl::Undo
helpviewer_keywords:
- CRichEditCtrl [MFC], CRichEditCtrl
- CRichEditCtrl [MFC], CanPaste
- CRichEditCtrl [MFC], CanRedo
- CRichEditCtrl [MFC], CanUndo
- CRichEditCtrl [MFC], CharFromPos
- CRichEditCtrl [MFC], Clear
- CRichEditCtrl [MFC], Copy
- CRichEditCtrl [MFC], Create
- CRichEditCtrl [MFC], CreateEx
- CRichEditCtrl [MFC], Cut
- CRichEditCtrl [MFC], DisplayBand
- CRichEditCtrl [MFC], EmptyUndoBuffer
- CRichEditCtrl [MFC], FindText
- CRichEditCtrl [MFC], FindWordBreak
- CRichEditCtrl [MFC], FormatRange
- CRichEditCtrl [MFC], GetCharPos
- CRichEditCtrl [MFC], GetDefaultCharFormat
- CRichEditCtrl [MFC], GetEventMask
- CRichEditCtrl [MFC], GetFirstVisibleLine
- CRichEditCtrl [MFC], GetIRichEditOle
- CRichEditCtrl [MFC], GetLimitText
- CRichEditCtrl [MFC], GetLine
- CRichEditCtrl [MFC], GetLineCount
- CRichEditCtrl [MFC], GetModify
- CRichEditCtrl [MFC], GetOptions
- CRichEditCtrl [MFC], GetParaFormat
- CRichEditCtrl [MFC], GetPunctuation
- CRichEditCtrl [MFC], GetRect
- CRichEditCtrl [MFC], GetRedoName
- CRichEditCtrl [MFC], GetSel
- CRichEditCtrl [MFC], GetSelectionCharFormat
- CRichEditCtrl [MFC], GetSelectionType
- CRichEditCtrl [MFC], GetSelText
- CRichEditCtrl [MFC], GetTextLength
- CRichEditCtrl [MFC], GetTextLengthEx
- CRichEditCtrl [MFC], GetTextMode
- CRichEditCtrl [MFC], GetTextRange
- CRichEditCtrl [MFC], GetUndoName
- CRichEditCtrl [MFC], GetWordWrapMode
- CRichEditCtrl [MFC], HideSelection
- CRichEditCtrl [MFC], LimitText
- CRichEditCtrl [MFC], LineFromChar
- CRichEditCtrl [MFC], LineIndex
- CRichEditCtrl [MFC], LineLength
- CRichEditCtrl [MFC], LineScroll
- CRichEditCtrl [MFC], Paste
- CRichEditCtrl [MFC], PasteSpecial
- CRichEditCtrl [MFC], PosFromChar
- CRichEditCtrl [MFC], Redo
- CRichEditCtrl [MFC], ReplaceSel
- CRichEditCtrl [MFC], RequestResize
- CRichEditCtrl [MFC], SetAutoURLDetect
- CRichEditCtrl [MFC], SetBackgroundColor
- CRichEditCtrl [MFC], SetDefaultCharFormat
- CRichEditCtrl [MFC], SetEventMask
- CRichEditCtrl [MFC], SetModify
- CRichEditCtrl [MFC], SetOLECallback
- CRichEditCtrl [MFC], SetOptions
- CRichEditCtrl [MFC], SetParaFormat
- CRichEditCtrl [MFC], SetPunctuation
- CRichEditCtrl [MFC], SetReadOnly
- CRichEditCtrl [MFC], SetRect
- CRichEditCtrl [MFC], SetSel
- CRichEditCtrl [MFC], SetSelectionCharFormat
- CRichEditCtrl [MFC], SetTargetDevice
- CRichEditCtrl [MFC], SetTextMode
- CRichEditCtrl [MFC], SetUndoLimit
- CRichEditCtrl [MFC], SetWordCharFormat
- CRichEditCtrl [MFC], SetWordWrapMode
- CRichEditCtrl [MFC], StopGroupTyping
- CRichEditCtrl [MFC], StreamIn
- CRichEditCtrl [MFC], StreamOut
- CRichEditCtrl [MFC], Undo
ms.assetid: 2be52788-822c-4c27-aafd-2471231e74eb
ms.openlocfilehash: 597f8c8b9a90dc9bc44f408558bc6ab3aa5c2779
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/11/2020
ms.locfileid: "97264792"
---
# <a name="cricheditctrl-class"></a>CRichEditCtrl クラス

リッチ エディット コントロールの機能を提供します。

## <a name="syntax"></a>構文

```
class CRichEditCtrl : public CWnd
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[CRichEditCtrl:: CRichEditCtrl](#cricheditctrl)|`CRichEditCtrl` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[CRichEditCtrl:: CanPaste](#canpaste)|クリップボードの内容をこのリッチエディットコントロールに貼り付けることができるかどうかを決定します。|
|[CRichEditCtrl:: CanRedo](#canredo)|コントロールのやり直しキューにアクションがあるかどうかを判断します。|
|[CRichEditCtrl:: CanUndo](#canundo)|編集操作を元に戻すことができるかどうかを判断します。|
|[CRichEditCtrl:: CharFromPos](#charfrompos)|エディットコントロールのクライアント領域の指定したポイントに最も近い文字に関する情報を取得します。|
|[CRichEditCtrl:: Clear](#clear)|現在の選択範囲をクリアします。|
|[CRichEditCtrl:: Copy](#copy)|現在の選択項目をクリップボードにコピーします。|
|[CRichEditCtrl:: Create](#create)|Windows リッチエディットコントロールを作成し、このオブジェクトに関連付け `CRichEditCtrl` ます。|
|[CRichEditCtrl:: CreateEx](#createex)|指定した拡張 Windows スタイルを使用して Windows リッチエディットコントロールを作成し、このコントロールをこのオブジェクトに関連付け `CRichEditCtrl` ます。|
|[CRichEditCtrl:: Cut](#cut)|現在の選択範囲をクリップボードに切り取ります。|
|[CRichEditCtrl::D isplayBand](#displayband)|このオブジェクトの内容の一部を表示 `CRichEditCtrl` します。|
|[CRichEditCtrl:: EmptyUndoBuffer](#emptyundobuffer)|このオブジェクトの元に戻すフラグをリセット (クリア) `CRichEditCtrl` します。|
|[CRichEditCtrl:: FindText](#findtext)|このオブジェクト内のテキスト `CRichEditCtrl` を検索します。|
|[CRichEditCtrl:: FindWordBreak](#findwordbreak)|指定した文字位置の前または後の次の改行を検索します。または、その位置にある文字に関する情報を取得します。|
|[CRichEditCtrl:: FormatRange](#formatrange)|ターゲット出力デバイスのテキスト範囲を書式設定します。|
|[CRichEditCtrl:: GetCharPos](#getcharpos)|このオブジェクト内の特定の文字の位置を確認し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: GetDefaultCharFormat](#getdefaultcharformat)|このオブジェクトの現在の既定の文字書式属性を取得し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: GetEventMask](#geteventmask)|このオブジェクトのイベントマスクを取得し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: GetFirstVisibleLine](#getfirstvisibleline)|このオブジェクトの最上位に表示される行を決定し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: GetIRichEditOle](#getiricheditole)|`IRichEditOle`このリッチエディットコントロールのインターフェイスへのポインターを取得します。|
|[CRichEditCtrl:: GetLimitText](#getlimittext)|ユーザーがこのオブジェクトに入力できるテキストの量の制限を取得し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: GetLine](#getline)|このオブジェクトからテキストの行を取得 `CRichEditCtrl` します。|
|[CRichEditCtrl:: GetLineCount](#getlinecount)|このオブジェクトの行数を取得し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: GetModify](#getmodify)|このオブジェクトの内容が `CRichEditCtrl` 最後の保存以降に変更されたかどうかを判断します。|
|[CRichEditCtrl:: GetOptions](#getoptions)|リッチエディットコントロールオプションを取得します。|
|[CRichEditCtrl:: GetParaFormat](#getparaformat)|このオブジェクトの現在の選択範囲に含まれる段落書式属性を取得し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: GetPunctuation 点](#getpunctuation)|リッチエディットコントロールの現在の区切り文字を取得します。 このメッセージは、アジア言語バージョンのオペレーティングシステムでのみ使用できます。|
|[CRichEditCtrl:: GetRect](#getrect)|このオブジェクトの書式設定の四角形を取得 `CRichEditCtrl` します。|
|[CRichEditCtrl:: GetRedoName](#getredoname)|コントロールのやり直しキューにある場合、次のアクションの種類を取得します (存在する場合)。|
|[CRichEditCtrl:: GetSel](#getsel)|このオブジェクト内の現在の選択範囲の開始位置と終了位置を取得し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: GetSelectionCharFormat](#getselectioncharformat)|このオブジェクトの現在の選択範囲に含まれる文字書式属性を取得し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: GetSelectionType](#getselectiontype)|このオブジェクトの現在の選択範囲に含まれるコンテンツの種類を取得し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: GetSelText](#getseltext)|このオブジェクト内の現在の選択範囲のテキストを取得します。 `CRichEditCtrl`|
|[CRichEditCtrl:: GetTextLength](#gettextlength)|このオブジェクトのテキストの長さを文字数で取得し `CRichEditCtrl` ます。 には、終端の null 文字は含まれません。|
|[CRichEditCtrl:: GetTextLengthEx](#gettextlengthex)|リッチエディットビューの文字数またはバイト数を取得します。 リッチエディットコントロールのテキストの長さを決定する方法を示すフラグの一覧を受け取ります。|
|[CRichEditCtrl:: GetTextMode](#gettextmode)|リッチエディットコントロールの現在のテキストモードと元に戻すレベルを取得します。|
|[CRichEditCtrl:: GetTextRange](#gettextrange)|指定したテキスト範囲を取得します。|
|[CRichEditCtrl:: GetUndoName](#getundoname)|次に元に戻す操作 (存在する場合) の型を取得します。|
|[CRichEditCtrl:: GetWordWrapMode](#getwordwrapmode)|リッチエディットコントロールの現在のワードラップおよび単語区切りのオプションを取得します。 このメッセージは、アジア言語バージョンのオペレーティングシステムでのみ使用できます。|
|[CRichEditCtrl:: HideSelection](#hideselection)|現在の選択範囲の表示と非表示を切り替えます。|
|[CRichEditCtrl:: LimitText](#limittext)|ユーザーがオブジェクトに入力できるテキストの量を制限し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: LineFromChar](#linefromchar)|指定された文字を含む行を決定します。|
|[CRichEditCtrl:: LineIndex](#lineindex)|このオブジェクト内の指定された行の文字インデックスを取得し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: LineLength](#linelength)|このオブジェクトの指定された行の長さを取得し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: LineScroll](#linescroll)|このオブジェクト内のテキストをスクロールし `CRichEditCtrl` ます。|
|[CRichEditCtrl::P aste](#paste)|このリッチエディットコントロールにクリップボードの内容を挿入します。|
|[CRichEditCtrl::P Ast-Al](#pastespecial)|クリップボードの内容を、指定したデータ形式でこのリッチエディットコントロールに挿入します。|
|[CRichEditCtrl::P osFromChar](#posfromchar)|エディットコントロール内の指定した文字のクライアント領域の座標を取得します。|
|[CRichEditCtrl:: Redo](#redo)|コントロールの再実行キューの次のアクションをやり直します。|
|[CRichEditCtrl:: ReplaceSel](#replacesel)|このオブジェクトの現在の選択項目を `CRichEditCtrl` 指定したテキストで置き換えます。|
|[CRichEditCtrl:: RequestResize](#requestresize)|この `CRichEditCtrl` オブジェクトに対して、要求のサイズ変更通知を強制的に送信します。|
|[CRichEditCtrl:: SetAutoURLDetect](#setautourldetect)|リッチエディットコントロールで自動 URL 検出がアクティブかどうかを示します。|
|[CRichEditCtrl:: SetBackgroundColor](#setbackgroundcolor)|このオブジェクトの背景色を設定 `CRichEditCtrl` します。|
|[CRichEditCtrl:: SetDefaultCharFormat](#setdefaultcharformat)|このオブジェクトの現在の既定の文字書式属性を設定し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: SetEventMask](#seteventmask)|このオブジェクトのイベントマスクを設定 `CRichEditCtrl` します。|
|[CRichEditCtrl:: SetModify](#setmodify)|このオブジェクトの変更フラグを設定または解除 `CRichEditCtrl` します。|
|[CRichEditCtrl:: SetOLECallback](#setolecallback)|`IRichEditOleCallback`このリッチエディットコントロールの COM オブジェクトを設定します。|
|[CRichEditCtrl:: SetOptions](#setoptions)|このオブジェクトのオプションを設定し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: SetParaFormat](#setparaformat)|このオブジェクトの現在の選択範囲にある段落書式属性を設定し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: SetPunctuation 点](#setpunctuation)|リッチエディットコントロールの区切り文字を設定します。 このメッセージは、アジア言語バージョンのオペレーティングシステムでのみ使用できます。|
|[CRichEditCtrl:: SetReadOnly](#setreadonly)|このオブジェクトの読み取り専用オプションを設定し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: SetRect](#setrect)|このオブジェクトの書式設定の四角形を設定 `CRichEditCtrl` します。|
|[CRichEditCtrl:: SetSel](#setsel)|このオブジェクトの選択を設定し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: SetSelectionCharFormat](#setselectioncharformat)|このオブジェクトの現在の選択範囲にある文字書式属性を設定し `CRichEditCtrl` ます。|
|[CRichEditCtrl:: SetTargetDevice](#settargetdevice)|このオブジェクトのターゲット出力デバイスを設定 `CRichEditCtrl` します。|
|[CRichEditCtrl:: SetTextMode](#settextmode)|リッチエディットコントロールのテキストモードまたは元に戻すレベルを設定します。 コントロールにテキストが含まれている場合、メッセージは失敗します。|
|[CRichEditCtrl:: SetUndoLimit](#setundolimit)|元に戻すキューに格納できるアクションの最大数を設定します。|
|[CRichEditCtrl:: SetWordCharFormat](#setwordcharformat)|このオブジェクトの現在の単語の文字書式属性を設定 `CRichEditCtrl` します。|
|[CRichEditCtrl:: SetWordWrapMode](#setwordwrapmode)|リッチエディットコントロールのワードラップおよび単語区切りのオプションを設定します。 このメッセージは、アジア言語バージョンのオペレーティングシステムでのみ使用できます。|
|[CRichEditCtrl:: StopGroupTyping](#stopgrouptyping)|コントロールが、現在の元に戻す操作に追加の入力操作を収集できないようにします。 コントロールは、次の入力アクション (存在する場合) を、元に戻すキューの新しいアクションに格納します。|
|[CRichEditCtrl:: StreamIn](#streamin)|入力ストリームからこのオブジェクトにテキストを挿入 `CRichEditCtrl` します。|
|[CRichEditCtrl:: StreamOut](#streamout)|このオブジェクトのテキストを `CRichEditCtrl` 出力ストリームに格納します。|
|[CRichEditCtrl:: Undo](#undo)|最後の編集操作を元に戻します。|

## <a name="remarks"></a>解説

"リッチエディットコントロール" は、ユーザーがテキストを入力して編集できるウィンドウです。 テキストには、文字や段落の書式を割り当てることができ、埋め込み OLE オブジェクトを含めることができます。 リッチエディットコントロールは、テキストを書式設定するためのプログラミングインターフェイスを提供します。 ただし、アプリケーションは、ユーザーが書式設定操作を使用できるようにするために必要なユーザーインターフェイスコンポーネントを実装する必要があります。

この Windows コモンコントロール (および `CRichEditCtrl` クラス) は、windows 95/98 および WINDOWS NT バージョン3.51 以降で実行されているプログラムに対してのみ使用できます。 `CRichEditCtrl`クラスは Windows SDK リッチエディットコントロールのバージョン2.0 および3.0 をサポートしています。

> [!CAUTION]
> アプリケーションが SDI、MDI、ダイアログベースのいずれであるかに関係なく、ダイアログボックスでリッチエディットコントロールを使用している場合は、ダイアログボックスが表示される前に [AfxInitRichEdit](application-information-and-management.md#afxinitrichedit) を1回呼び出す必要があります。 この関数を呼び出す一般的な場所は、プログラムの `InitInstance` メンバー関数です。 ダイアログボックスを初めて表示するたびに、このメソッドを呼び出す必要はありません。 を使用する場合は、を呼び出す必要はありません `AfxInitRichEdit` `CRichEditView` 。

の使用方法の詳細については `CRichEditCtrl` 、以下を参照してください。

- [コントロール](../../mfc/controls-mfc.md)

- [CRichEditCtrl の使い方](../../mfc/using-cricheditctrl.md)

MFC アプリケーションでのリッチエディットコントロールの使用例については、「 [ワードパッド](../../overview/visual-cpp-samples.md) サンプルアプリケーション」を参照してください。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CRichEditCtrl`

## <a name="requirements"></a>要件

**ヘッダー:** afxcmn.h

## <a name="cricheditctrlcanpaste"></a><a name="canpaste"></a> CRichEditCtrl:: CanPaste

リッチエディットコントロールが、指定されたクリップボード形式を貼り付けることができるかどうかを決定します。

```
BOOL CanPaste(UINT nFormat = 0) const;
```

### <a name="parameters"></a>パラメーター

*nFormat*<br/>
クエリを実行するクリップボードデータ形式。 このパラメーターには、定義済みのクリップボード形式、または [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw)によって返される値のいずれかを指定できます。

### <a name="return-value"></a>戻り値

クリップボードの形式を貼り付けることができる場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>解説

*Nformat* が0の場合、 `CanPaste` は現在クリップボードにあるすべての形式を試行します。

詳細については、Windows SDK の「 [EM_CANPASTE](/windows/win32/Controls/em-canpaste) Message and [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw) 関数」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#1](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_1.cpp)]

## <a name="cricheditctrlcanredo"></a><a name="canredo"></a> CRichEditCtrl:: CanRedo

再実行キューにアクションが含まれているかどうかを判断します。

```
BOOL CanRedo() const;
```

### <a name="return-value"></a>戻り値

再実行キューにアクションが含まれている場合は0以外。それ以外の場合は0。

### <a name="remarks"></a>解説

再実行キュー内の操作の名前を検出するには、 [CRichEditCtrl:: GetRedoName](#getredoname)を呼び出します。 最新の元に戻す操作をやり直すには、 [redo](#redo)を呼び出します。

詳細については、Windows SDK の「 [EM_CANREDO](/windows/win32/Controls/em-canredo) 」を参照してください。

## <a name="cricheditctrlcanundo"></a><a name="canundo"></a> CRichEditCtrl:: CanUndo

最後の編集操作を元に戻すことができるかどうかを決定します。

```
BOOL CanUndo() const;
```

### <a name="return-value"></a>戻り値

[Undo](#undo)メンバー関数の呼び出しによって最後の編集操作を元に戻すことができる場合は0以外の。元に戻すことができない場合は0。

### <a name="remarks"></a>解説

詳細については、Windows SDK の「 [EM_CANUNDO](/windows/win32/Controls/em-canundo) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#2](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_2.cpp)]

## <a name="cricheditctrlcharfrompos"></a><a name="charfrompos"></a> CRichEditCtrl:: CharFromPos

パラメーター *pt* で指定した位置にある文字に関する情報を取得します。

```
int CharFromPos(CPoint pt) const;
```

### <a name="parameters"></a>パラメーター

*pt*<br/>
指定した点の座標を格納している [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) オブジェクト。

### <a name="return-value"></a>戻り値

指定したポイントに最も近い文字の0から始まる文字インデックス。 指定したポイントがコントロールの最後の文字を超えている場合、戻り値はコントロールの最後の文字を示します。

### <a name="remarks"></a>解説

このメンバー関数は、リッチエディットコントロールで動作します。 エディットコントロールの情報を取得するには、 [CEdit:: CharFromPos](../../mfc/reference/cedit-class.md#charfrompos)を呼び出します。

詳細については、Windows SDK の「 [EM_CHARFROMPOS](/windows/win32/Controls/em-charfrompos) 」を参照してください。

## <a name="cricheditctrlclear"></a><a name="clear"></a> CRichEditCtrl:: Clear

リッチエディットコントロール内の現在の選択項目 (存在する場合) を削除 (クリア) します。

```cpp
void Clear();
```

### <a name="remarks"></a>解説

によって実行される削除は、 `Clear` [Undo](#undo) メンバー関数を呼び出すことによって元に戻すことができます。

現在の選択範囲を削除し、削除された内容をクリップボードに配置するには、 [Cut](#cut) メンバー関数を呼び出します。

詳細については、Windows SDK の「 [WM_CLEAR](/windows/win32/dataxchg/wm-clear) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#3](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_3.cpp)]

## <a name="cricheditctrlcopy"></a><a name="copy"></a> CRichEditCtrl:: Copy

リッチエディットコントロール内の現在の選択項目 (存在する場合) をクリップボードにコピーします。

```cpp
void Copy();
```

### <a name="remarks"></a>解説

詳細については、Windows SDK の「 [WM_COPY](/windows/win32/dataxchg/wm-copy) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#4](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_4.cpp)]

## <a name="cricheditctrlcreate"></a><a name="create"></a> CRichEditCtrl:: Create

Windows リッチエディットコントロールを作成し、このオブジェクトに関連付け `CRichEditCtrl` ます。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*dwStyle*<br/>
エディットコントロールのスタイルを指定します。 次の「 **解説** 」に記載されているウィンドウスタイルの組み合わせと、Windows SDK で説明されている [編集コントロールスタイル](/windows/win32/Controls/edit-control-styles)を適用します。

*rect*<br/>
エディットコントロールのサイズと位置を指定します。 は、 [CRect](../../atl-mfc-shared/reference/crect-class.md) オブジェクトまたは [RECT](/windows/win32/api/windef/ns-windef-rect) 構造体にすることができます。

*pParentWnd*<br/>
エディットコントロールの親ウィンドウ (多くの場合、 [CDialog](../../mfc/reference/cdialog-class.md)) を指定します。 NULL にすることはできません。

*nID*<br/>
エディットコントロールの ID を指定します。

### <a name="return-value"></a>戻り値

初期化が成功した場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>解説

オブジェクトを構築するには、 `CRichEditCtrl` 2 つの手順を実行します。 まず、 [CRichEditCtrl](#cricheditctrl) コンストラクターを呼び出し、次に `Create` を呼び出します。これにより、Windows のエディットコントロールが作成され、オブジェクトにアタッチさ `CRichEditCtrl` れます。

この関数を使用してリッチエディットコントロールを作成する場合は、まず、必要なコモンコントロールライブラリを読み込む必要があります。 ライブラリを読み込むには、グローバル関数 [AfxInitRichEdit](application-information-and-management.md#afxinitrichedit)を呼び出します。これにより、コモンコントロールライブラリが初期化されます。 `AfxInitRichEdit`プロセスでを1回だけ呼び出す必要があります。

を実行すると、 `Create` Windows は [WM_NCCREATE](../../mfc/reference/cwnd-class.md#onnccreate)、 [WM_NCCALCSIZE](../../mfc/reference/cwnd-class.md#onnccalcsize)、 [WM_CREATE](../../mfc/reference/cwnd-class.md#oncreate)、および [WM_GETMINMAXINFO](../../mfc/reference/cwnd-class.md#ongetminmaxinfo) のメッセージを編集コントロールに送信します。

これらのメッセージは、既定では、基本クラスの [OnNcCreate](../../mfc/reference/cwnd-class.md#onnccreate)、 [OnNcCalcSize](../../mfc/reference/cwnd-class.md#onnccalcsize)、 [OnCreate](../../mfc/reference/cwnd-class.md#oncreate)、および [OnGetMinMaxInfo](../../mfc/reference/cwnd-class.md#ongetminmaxinfo) の各メンバー関数によって処理され `CWnd` ます。 既定のメッセージ処理を拡張するには、からクラスを派生させ、 `CRichEditCtrl` 新しいクラスにメッセージマップを追加して、上記のメッセージハンドラーメンバー関数をオーバーライドします。 `OnCreate`たとえば、新しいクラスに必要な初期化を実行する場合は、をオーバーライドします。

次の [ウィンドウスタイル](../../mfc/reference/styles-used-by-mfc.md#window-styles) を編集コントロールに適用します。

- 常に WS_CHILD ます。

- 通常は WS_VISIBLE ます。

- WS_DISABLED はまれです。

- グループコントロールに WS_GROUP します。

- タブオーダーに編集コントロールを含める WS_TABSTOP ます。

ウィンドウスタイルの詳細については、Windows SDK の「 [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#5](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_5.cpp)]

## <a name="cricheditctrlcreateex"></a><a name="createex"></a> CRichEditCtrl:: CreateEx

コントロール (子ウィンドウ) を作成し、オブジェクトに関連付け `CRichEditCtrl` ます。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*dwExStyle*<br/>
作成するコントロールの拡張スタイルを指定します。 拡張 Windows スタイルの一覧については、Windows SDK の [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)の *dwexstyle* パラメーターを参照してください。

*dwStyle*<br/>
エディットコントロールのスタイルを指定します。 「Windows SDK」で説明されている [[作成](#create)] および [[編集] コントロールスタイル](/windows/win32/Controls/edit-control-styles)の [**コメント**] セクションに示されているウィンドウスタイルの組み合わせを適用します。

*rect*<br/>
*PParentWnd* のクライアント座標で、作成されるウィンドウのサイズと位置を記述する [RECT](/windows/win32/api/windef/ns-windef-rect)構造体への参照。

*pParentWnd*<br/>
コントロールの親であるウィンドウへのポインター。

*nID*<br/>
コントロールの子ウィンドウ ID。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

`CreateEx` `Create` Windows 拡張スタイルの先頭 **WS_EX_** によって指定された拡張 windows スタイルを適用するには、の代わりにを使用します。

## <a name="cricheditctrlcricheditctrl"></a><a name="cricheditctrl"></a> CRichEditCtrl:: CRichEditCtrl

`CRichEditCtrl` オブジェクトを構築します。

```
CRichEditCtrl();
```

### <a name="remarks"></a>解説

Windows リッチエディットコントロールを構築するには、 [Create](#create) を使用します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#6](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_6.cpp)]

## <a name="cricheditctrlcut"></a><a name="cut"></a> CRichEditCtrl:: Cut

リッチエディットコントロール内の現在の選択項目 (存在する場合) を削除 (切り取り) し、削除されたテキストをクリップボードにコピーします。

```cpp
void Cut();
```

### <a name="remarks"></a>解説

によって実行される削除は、 `Cut` [Undo](#undo) メンバー関数を呼び出すことによって元に戻すことができます。

削除されたテキストをクリップボードに配置せずに現在の選択項目を削除するには、 [Clear](#clear) メンバー関数を呼び出します。

詳細については、Windows SDK の「 [WM_CUT](/windows/win32/dataxchg/wm-cut) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#7](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_7.cpp)]

## <a name="cricheditctrldisplayband"></a><a name="displayband"></a> CRichEditCtrl::D isplayBand

以前に [Formatrange](#formatrange)によって書式設定された、リッチエディットコントロール (テキストおよび OLE 項目) の内容の一部を表示します。

```
BOOL DisplayBand(LPRECT pDisplayRect);
```

### <a name="parameters"></a>パラメーター

*pDisplayRect*<br/>
テキストを表示するデバイスの領域を指定する [RECT](/windows/win32/api/windef/ns-windef-rect) オブジェクトまたは [CRect](../../atl-mfc-shared/reference/crect-class.md) オブジェクトへのポインター。

### <a name="return-value"></a>戻り値

書式設定されたテキストの表示が成功した場合は0以外の場合は。それ以外の場合は0。

### <a name="remarks"></a>解説

テキストおよび OLE 項目は、ポインター *Pdisplayrect* によって指定された領域にクリップされます。

詳細については、Windows SDK の「 [EM_DISPLAYBAND](/windows/win32/Controls/em-displayband) 」を参照してください。

### <a name="example"></a>例

  [CRichEditCtrl:: FormatRange](#formatrange)の例を参照してください。

## <a name="cricheditctrlemptyundobuffer"></a><a name="emptyundobuffer"></a> CRichEditCtrl:: EmptyUndoBuffer

このリッチエディットコントロールの元に戻すフラグをリセットします。

```cpp
void EmptyUndoBuffer();
```

### <a name="remarks"></a>解説

これで、コントロールは最後の編集操作を元に戻すことができなくなります。 元に戻すフラグは、リッチエディットコントロール内の操作を元に戻すことができる場合に設定されます。

[CWnd](../../mfc/reference/cwnd-class.md)メンバー関数[SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)を呼び出すたびに、元に戻すフラグが自動的にクリアされます。

詳細については、Windows SDK の「 [EM_EMPTYUNDOBUFFER](/windows/win32/Controls/em-emptyundobuffer) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#8](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_8.cpp)]

## <a name="cricheditctrlfindtext"></a><a name="findtext"></a> CRichEditCtrl:: FindText

リッチエディットコントロール内でテキストを検索します。

```
long FindText(
    DWORD dwFlags,
    FINDTEXTEX* pFindText) const;
```

### <a name="parameters"></a>パラメーター

*dwFlags*<br/>
使用可能な値の一覧については、Windows SDK の「 [EM_FINDTEXTEXT](/windows/win32/Controls/em-findtextex)の *wParam* 」を参照してください。

*pFindText*<br/>
検索のパラメーターを指定し、一致が見つかった範囲を返す [Findtextex](/windows/win32/api/richedit/ns-richedit-findtextexw) 構造体へのポインター。

### <a name="return-value"></a>戻り値

次の一致の0から始まる文字位置。一致する項目がない場合は-1。

### <a name="remarks"></a>解説

構造内の [Charrange](/windows/win32/api/richedit/ns-richedit-charrange) 構造体に適切な範囲パラメーターを設定することにより、上下に検索でき `FINDTEXTEX` ます。

詳細については、Windows SDK の「 [EM_FINDTEXTEX](/windows/win32/Controls/em-findtextex) Message And [findtextex](/windows/win32/api/richedit/ns-richedit-findtextexw) 構造体」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#9](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_9.cpp)]

## <a name="cricheditctrlfindwordbreak"></a><a name="findwordbreak"></a> CRichEditCtrl:: FindWordBreak

*NStart* によって指定された位置の前または後の次の単語区切りを検索します。

```
DWORD FindWordBreak(
    UINT nCode,
    DWORD nStart) const;
```

### <a name="parameters"></a>パラメーター

*nCode*<br/>
実行するアクションを示します。 使用可能な値の一覧については、Windows SDK の EM_FINDWORDBREAK にあるパラメーター *コード* の説明を参照してください。

*nStart*<br/>
開始位置を示す0から始まる文字位置。

### <a name="return-value"></a>戻り値

パラメーター *nCode* に基づいています。 詳細については、Windows SDK の「 [EM_FINDWORDBREAK](/windows/win32/Controls/em-findwordbreak) 」を参照してください。

### <a name="remarks"></a>解説

このメンバー関数を使用すると、特定の位置にある文字に関する情報を取得できます。

## <a name="cricheditctrlformatrange"></a><a name="formatrange"></a> CRichEditCtrl:: FormatRange

特定のデバイスのリッチエディットコントロールのテキスト範囲を書式設定します。

```
long FormatRange(
    FORMATRANGE* pfr,
    BOOL bDisplay = TRUE);
```

### <a name="parameters"></a>パラメーター

*pfr*<br/>
出力デバイスに関する情報を格納する [Formatrange](/windows/win32/api/richedit/ns-richedit-formatrange) 構造体へのポインター。 NULL は、リッチエディットコントロール内のキャッシュされた情報を解放できることを示します。

*bDisplay*<br/>
テキストを表示するかどうかを示します。 FALSE の場合、テキストは測定されただけです。

### <a name="return-value"></a>戻り値

領域に1を加えた最後の文字のインデックス。

### <a name="remarks"></a>解説

通常、この呼び出しの後に [Displayband](#displayband)を呼び出します。

詳細については、Windows SDK の「 [EM_FORMATRANGE](/windows/win32/Controls/em-formatrange) Message And [formatrange](/windows/win32/api/richedit/ns-richedit-formatrange) 構造体」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#10](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_10.cpp)]

## <a name="cricheditctrlgetcharpos"></a><a name="getcharpos"></a> CRichEditCtrl:: GetCharPos

このオブジェクト内の特定の文字の位置 (左上隅) を取得し `CRichEditCtrl` ます。

```
CPoint GetCharPos(long lChar) const;
```

### <a name="parameters"></a>パラメーター

*lChar*<br/>
文字の0から始まるインデックス。

### <a name="return-value"></a>戻り値

*Lchar* によって指定された文字の左上隅の位置。

### <a name="remarks"></a>解説

文字は、0から始まるインデックス値を指定することによって指定されます。 *Lchar* がこのオブジェクトの最後の文字のインデックスよりも大きい場合 `CRichEditCtrl` 、戻り値は、このオブジェクトの最後の文字の直後の文字位置の座標を指定し `CRichEditCtrl` ます。

詳細については、Windows SDK の「 [EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar) 」を参照してください。

## <a name="cricheditctrlgetdefaultcharformat"></a><a name="getdefaultcharformat"></a> CRichEditCtrl:: GetDefaultCharFormat

このオブジェクトの既定の文字書式属性を取得し `CRichEditCtrl` ます。

```
DWORD GetDefaultCharFormat(CHARFORMAT& cf) const;  DWORD GetDefaultCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>パラメーター

*cf*<br/>
最初のバージョンでは、 `CHARFORMAT` 既定の文字書式属性を保持する構造体へのポインター。

2番目のバージョンでは、構造体へのポインターであり、 `CHARFORMAT2` `CHARFORMAT` 既定の文字書式属性を保持する、構造体へのリッチエディット2.0 の拡張機能です。

### <a name="return-value"></a>戻り値

`dwMask` *Cf* のデータメンバー。既定の文字書式属性が指定されています。

### <a name="remarks"></a>解説

詳細については、Windows SDK の EM_GETCHARFORMAT メッセージ、 `CHARFORMAT` および構造体を参照してください `CHARFORMAT2` 。

### <a name="example"></a>例

  [SetDefaultCharFormat](#setdefaultcharformat)の例を参照してください。

## <a name="cricheditctrlgeteventmask"></a><a name="geteventmask"></a> CRichEditCtrl:: GetEventMask

このオブジェクトのイベントマスクを取得し `CRichEditCtrl` ます。

```
long GetEventMask() const;
```

### <a name="return-value"></a>戻り値

このオブジェクトのイベントマスク `CRichEditCtrl` 。

### <a name="remarks"></a>解説

イベントマスクは、 `CRichEditCtrl` オブジェクトが親ウィンドウに送信する通知メッセージを指定します。

詳細については、Windows SDK の「 [EM_GETEVENTMASK](/windows/win32/Controls/em-geteventmask) 」を参照してください。

### <a name="example"></a>例

  [CRichEditCtrl:: SetEventMask](#seteventmask)の例を参照してください。

## <a name="cricheditctrlgetfirstvisibleline"></a><a name="getfirstvisibleline"></a> CRichEditCtrl:: GetFirstVisibleLine

このオブジェクトの最上位に表示される行を決定し `CRichEditCtrl` ます。

```
int GetFirstVisibleLine() const;
```

### <a name="return-value"></a>戻り値

このオブジェクトで最も上位に表示される行の0から始まるインデックス `CRichEditCtrl` 。

### <a name="remarks"></a>解説

詳細については、Windows SDK の「 [EM_GETFIRSTVISIBLELINE](/windows/win32/Controls/em-getfirstvisibleline) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#11](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_11.cpp)]

## <a name="cricheditctrlgetiricheditole"></a><a name="getiricheditole"></a> CRichEditCtrl:: GetIRichEditOle

`IRichEditOle`このオブジェクトのインターフェイスにアクセス `CRichEditCtrl` します。

```
IRichEditOle* GetIRichEditOle() const;
```

### <a name="return-value"></a>戻り値

この[](/windows/win32/api/richole/nn-richole-iricheditole) `CRichEditCtrl` オブジェクトの OLE 機能にアクセスするために使用できる IRichEditOle インターフェイスへのポインター。インターフェイスにアクセスできない場合は NULL です。

### <a name="remarks"></a>解説

このインターフェイスを使用して、この `CRichEditCtrl` オブジェクトの OLE 機能にアクセスします。

詳細については、Windows SDK の「 [EM_GETOLEINTERFACE](/windows/win32/Controls/em-getoleinterface) Message and [IRichEditOle](/windows/win32/api/richole/nn-richole-iricheditole) interface」を参照してください。

## <a name="cricheditctrlgetlimittext"></a><a name="getlimittext"></a> CRichEditCtrl:: GetLimitText

このオブジェクトのテキスト制限を取得し `CRichEditCtrl` ます。

```
long GetLimitText() const;
```

### <a name="return-value"></a>戻り値

このオブジェクトの現在のテキストの制限 (バイト単位) `CRichEditCtrl` 。

### <a name="remarks"></a>解説

テキストの上限は、リッチエディットコントロールが受け入れることができるテキストの最大量 (バイト単位) です。

詳細については、Windows SDK の「 [EM_GETLIMITTEXT](/windows/win32/Controls/em-getlimittext) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#12](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_12.cpp)]

## <a name="cricheditctrlgetline"></a><a name="getline"></a> CRichEditCtrl:: GetLine

このオブジェクトからテキストの行を取得 `CRichEditCtrl` します。

```
int GetLine(
    int nIndex,
    LPTSTR lpszBuffer) const;

int GetLine(
    int nIndex,
    LPTSTR lpszBuffer,
    int nMaxLength) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
取得する行の0から始まるインデックス。

*lpszBuffer*<br/>
テキストを受信するバッファーを指します。 バッファーの最初の単語では、バッファーにコピーできる最大バイト数を指定する必要があります。

*nMaxLength*<br/>
*Lpszbuffer* にコピーできる最大文字数。 2番目の形式のは、 `GetLine` この値を、 *lpszbuffer* によって指定されたバッファーの最初の単語に配置します。

### <a name="return-value"></a>戻り値

*Lpszbuffer* にコピーされた文字数。

### <a name="remarks"></a>解説

コピーされた行に終端の null 文字が含まれていません。

> [!NOTE]
> バッファーの最初の単語にはコピーする文字数が格納されるため、バッファーの長さが4バイト以上であることを確認してください。

詳細については、Windows SDK の「 [EM_GETLINE](/windows/win32/Controls/em-getline) 」を参照してください。

### <a name="example"></a>例

  [GetLineCount](#getlinecount)の例を参照してください。

## <a name="cricheditctrlgetlinecount"></a><a name="getlinecount"></a> CRichEditCtrl:: GetLineCount

オブジェクトの行数を取得し `CRichEditCtrl` ます。

```
int GetLineCount() const;
```

### <a name="return-value"></a>戻り値

このオブジェクトの行数 `CRichEditCtrl` 。

### <a name="remarks"></a>解説

詳細については、Windows SDK の「 [EM_GETLINECOUNT](/windows/win32/Controls/em-getlinecount) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#13](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_13.cpp)]

## <a name="cricheditctrlgetmodify"></a><a name="getmodify"></a> CRichEditCtrl:: GetModify

このオブジェクトの内容が変更されたかどうかを判断し `CRichEditCtrl` ます。

```
BOOL GetModify() const;
```

### <a name="return-value"></a>戻り値

このオブジェクト内のテキスト `CRichEditCtrl` が変更されている場合は0以外。それ以外の場合は0。

### <a name="remarks"></a>解説

Windows は、リッチエディットコントロールの内容が変更されているかどうかを示す内部フラグを保持します。 このフラグは、エディットコントロールが最初に作成されたときにクリアされ、 [Setmodify](#setmodify) メンバー関数を呼び出すことによってクリアすることもできます。

詳細については、Windows SDK の「 [EM_GETMODIFY](/windows/win32/Controls/em-getmodify) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#14](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_14.cpp)]

## <a name="cricheditctrlgetoptions"></a><a name="getoptions"></a> CRichEditCtrl:: GetOptions

リッチエディットコントロールに対して現在設定されているオプションを取得します。

```
UINT GetOptions() const;
```

### <a name="return-value"></a>戻り値

現在のオプションフラグ値の組み合わせ。 これらの値の一覧については、「Windows SDK」で説明されているように、 [EM_SETOPTIONS](/windows/win32/Controls/em-setoptions)メッセージの *foptions* パラメーターを参照してください。

## <a name="cricheditctrlgetparaformat"></a><a name="getparaformat"></a> CRichEditCtrl:: GetParaFormat

現在の選択範囲の段落書式属性を取得します。

```
DWORD GetParaFormat(PARAFORMAT& pf) const;  DWORD GetParaFormat(PARAFORMAT2& pf) const;
```

### <a name="parameters"></a>パラメーター

*pf*<br/>
最初のバージョンでは、現在の選択範囲の段落書式属性を保持する [PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat) 構造体へのポインター。

2番目のバージョンでは、 [PARAFORMAT2](/windows/win32/api/richedit/ns-richedit-paraformat2) 構造体へのポインター。これは、構造体のリッチエディット2.0 拡張機能であり `PARAFORMAT` 、既定の文字書式属性を保持します。

### <a name="return-value"></a>戻り値

`dwMask` *Pf* のデータメンバー。 現在の選択範囲全体で一貫した段落書式属性を指定します。

### <a name="remarks"></a>解説

複数の段落が選択されている場合、 *pf* は最初に選択された段落の属性を受け取ります。 戻り値は、選択範囲全体で一貫性のある属性を指定します。

詳細については、Windows SDK の [EM_GETPARAFORMAT](/windows/win32/Controls/em-getparaformat) メッセージ、 `PARAFORMAT` および構造体を参照してください `PARAFORMAT2` 。

### <a name="example"></a>例

  [CRichEditCtrl:: SetParaFormat](#setparaformat)の例を参照してください。

## <a name="cricheditctrlgetpunctuation"></a><a name="getpunctuation"></a> CRichEditCtrl:: GetPunctuation 点

リッチエディットコントロールの現在の区切り文字を取得します。

```
BOOL GetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc) const;
```

### <a name="parameters"></a>パラメーター

*fType*<br/>
Windows SDK 内の [EM_GETPUNCTUATION](/windows/win32/Controls/em-getpunctuation)の *fType* パラメーターに記述されている句読点の種類フラグ。

*lpPunc*<br/>
Windows SDK で説明されているように、 [句読点](/windows/win32/api/richedit/ns-richedit-punctuation) 構造体へのポインター。

### <a name="return-value"></a>戻り値

操作が成功した場合は0以外。それ以外の場合は0。

### <a name="remarks"></a>解説

このメンバー関数は、アジア言語バージョンのオペレーティングシステムでのみ使用できます。

## <a name="cricheditctrlgetrect"></a><a name="getrect"></a> CRichEditCtrl:: GetRect

このオブジェクトの書式設定の四角形を取得 `CRichEditCtrl` します。

```cpp
void GetRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>パラメーター

*lpRect*<br/>
このオブジェクトの書式指定用の四角形を受け取るため[の、RECT または](../../atl-mfc-shared/reference/crect-class.md) [RECT](/windows/win32/api/windef/ns-windef-rect)へのポインター `CRichEditCtrl` 。

### <a name="remarks"></a>解説

書式設定の四角形は、テキストの外接する四角形です。 この値は、オブジェクトのサイズとは関係 `CRichEditCtrl` ありません。

詳細については、Windows SDK の「 [EM_GETRECT](/windows/win32/Controls/em-getrect) 」を参照してください。

### <a name="example"></a>例

  [Limittext](#limittext)の例を参照してください。

## <a name="cricheditctrlgetredoname"></a><a name="getredoname"></a> CRichEditCtrl:: GetRedoName

再実行キューで次に使用可能なアクションの種類を取得します (存在する場合)。

```
UNDONAMEID GetRedoName() const;
```

### <a name="return-value"></a>戻り値

成功した場合は、 `GetRedoName` コントロールの再実行キューの次のアクションの型を示す、 [Undonameid](/windows/win32/api/richedit/ne-richedit-undonameid) 列挙型を返します。 再実行キューが空の場合、またはキューのやり直しアクションの種類が不明である場合、は `GetRedoName` 0 を返します。

### <a name="remarks"></a>解説

元に戻す、または再実行できるアクションの種類には、入力、削除、ドラッグアンドドロップ、切り取り、貼り付けの各操作があります。 この情報は、redoable アクションのドロップダウンリストボックスなど、元に戻す操作ややり直し操作を行うための拡張ユーザーインターフェイスを提供するアプリケーションに役立ちます。

## <a name="cricheditctrlgetsel"></a><a name="getsel"></a> CRichEditCtrl:: GetSel

このオブジェクト内の現在の選択範囲の境界を取得し `CRichEditCtrl` ます。

```cpp
void GetSel(CHARRANGE& cr) const;

void GetSel(
    long& nStartChar,
    long& nEndChar) const;
```

### <a name="parameters"></a>パラメーター

*cr*<br/>
現在の選択範囲の境界を受け取る [Charrange](/windows/win32/api/richedit/ns-richedit-charrange) 構造体への参照。

*nStartChar*<br/>
現在の選択範囲の最初の文字の0から始まるインデックス番号。

*nEndChar*<br/>
現在の選択範囲の最後の文字の0から始まるインデックス番号。

### <a name="remarks"></a>解説

この関数の2つの形式は、選択範囲の境界を取得するための別の方法を提供します。 これらのフォームの簡単な説明を次に示します。

- **Getsel (** `cr` **)** このフォームは、 `CHARRANGE` 構造体をメンバーとメンバーと共に使用して、 `cpMin` 境界を `cpMax` 返します。

- **Getsel (** `nStartChar` **,** `nEndChar` **)** このフォームは、パラメーター *nstartchar* と *nEndChar* 内の境界を返します。

先頭 ( `cpMin` または *Nstartchar*) が0で、end ( `cpMax` または *nEndChar*) が-1 の場合、選択にはすべてが含まれます。

詳細については、Windows SDK の「 [EM_EXGETSEL](/windows/win32/Controls/em-exgetsel) Message および [charrange](/windows/win32/api/richedit/ns-richedit-charrange) 構造体」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#15](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_15.cpp)]

## <a name="cricheditctrlgetselectioncharformat"></a><a name="getselectioncharformat"></a> CRichEditCtrl:: GetSelectionCharFormat

現在の選択範囲の文字書式属性を取得します。

```
DWORD GetSelectionCharFormat(CHARFORMAT& cf) const;  DWORD GetSelectionCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>パラメーター

*cf*<br/>
最初のバージョンでは、現在の選択範囲の文字書式属性を受け取る [CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata) 構造体へのポインター。

2番目のバージョンでは、 [CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w) 構造体へのポインター。これは、 `CHARFORMAT` 現在の選択範囲の文字書式属性を受け取るための、構造体のリッチエディット2.0 拡張機能です。

### <a name="return-value"></a>戻り値

`dwMask` *Cf* のデータメンバー。現在の選択範囲全体で一貫した文字書式属性を指定します。

### <a name="remarks"></a>解説

*Cf* パラメーターは、現在選択されている最初の文字の属性を受け取ります。 戻り値は、選択範囲全体で一貫性のある属性を指定します。

詳細については、Windows SDK の [EM_GETCHARFORMAT](/windows/win32/Controls/em-getcharformat) メッセージ、 `CHARFORMAT` および構造体を参照してください `CHARFORMAT2` 。

### <a name="example"></a>例

  [SetSelectionCharFormat](#setselectioncharformat)の例を参照してください。

## <a name="cricheditctrlgetselectiontype"></a><a name="getselectiontype"></a> CRichEditCtrl:: GetSelectionType

このオブジェクトの選択の種類を決定し `CRichEditCtrl` ます。

```
WORD GetSelectionType() const;
```

### <a name="return-value"></a>戻り値

現在の選択内容を示すフラグ。 次のフラグの組み合わせ。

- SEL_EMPTY は、現在選択されていないことを示します。

- SEL_TEXT は、現在の選択範囲にテキストが含まれていることを示します。

- SEL_OBJECT は、現在の選択範囲に少なくとも1つの OLE 項目が含まれていることを示します。

- SEL_MULTICHAR は、現在の選択範囲に複数のテキスト文字が含まれていることを示します。

- SEL_MULTIOBJECT は、現在の選択範囲に複数の OLE オブジェクトが含まれていることを示します。

### <a name="remarks"></a>解説

詳細については、Windows SDK の「 [EM_SELECTIONTYPE](/windows/win32/Controls/em-selectiontype) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#16](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_16.cpp)]

## <a name="cricheditctrlgetseltext"></a><a name="getseltext"></a> CRichEditCtrl:: GetSelText

このオブジェクトの現在の選択範囲からテキストを取得し `CRichEditCtrl` ます。

```
long GetSelText(LPSTR lpBuf) const;  CString GetSelText() const;
```

### <a name="parameters"></a>パラメーター

*lpBuf*<br/>
現在の選択範囲内のテキストを受け取るバッファーへのポインター。

### <a name="return-value"></a>戻り値

フォームによって異なります。

- **Getseltext (** `lpBuf` **)** null 終了を含まない、 *lpbuf* にコピーされた文字数。

- **Getseltext ()** 現在の選択範囲を格納している文字列。

### <a name="remarks"></a>解説

最初の形式である **getseltext (** ) を使用する場合は、 `lpBuf` バッファーが受信するテキストに対して十分な大きさであることを確認する必要があります。 [Getsel](#getsel)を呼び出して、現在の選択範囲の文字数を確認します。

詳細については、Windows SDK の「 [EM_GETSELTEXT](/windows/win32/Controls/em-getseltext) 」を参照してください。

### <a name="example"></a>例

  [CRichEditCtrl:: GetSelectionType](#getselectiontype)の例を参照してください。

## <a name="cricheditctrlgettextlength"></a><a name="gettextlength"></a> CRichEditCtrl:: GetTextLength

このオブジェクトのテキストの長さ (文字数) を取得し `CRichEditCtrl` ます。終端の null 文字は含まれません。

```
long GetTextLength() const;
```

### <a name="return-value"></a>戻り値

このオブジェクト内のテキストの長さ `CRichEditCtrl` 。

### <a name="remarks"></a>解説

詳細については、Windows SDK の「 [WM_GETTEXTLENGTH](/windows/win32/winmsg/wm-gettextlength) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#17](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_17.cpp)]

## <a name="cricheditctrlgettextlengthex"></a><a name="gettextlengthex"></a> CRichEditCtrl:: GetTextLengthEx

リッチエディットコントロールのテキストの長さを計算します。

```
long GetTextLengthEx(
    DWORD dwFlags,
    UINT uCodePage = -1) const;
```

### <a name="parameters"></a>パラメーター

*dwFlags*<br/>
テキストの長さを決定するために使用するメソッドを指定する値。 このメンバーは、Windows SDK で説明されている [GETTEXTLENGTHEX](/windows/win32/api/richedit/ns-richedit-gettextlengthex) の flags メンバーに示されている1つ以上の値にすることができます。

*uCodePage*<br/>
変換用のコードページ (ANSI コードページの場合は CP_ACP、Unicode の場合は 1200)。

### <a name="return-value"></a>戻り値

エディットコントロールの文字数またはバイト数。 互換性のないフラグが *dwFlags* で設定されている場合、このメンバー関数は E_INVALIDARG を返します。

### <a name="remarks"></a>解説

`GetTextLengthEx` テキストの長さを確認するための追加の方法を提供します。 リッチエディット2.0 機能がサポートされています。 詳細については、「Windows SDKfor の [リッチエディットコントロールについ](/windows/win32/Controls/about-rich-edit-controls) て」を参照してください。

## <a name="cricheditctrlgettextmode"></a><a name="gettextmode"></a> CRichEditCtrl:: GetTextMode

リッチエディットコントロールの現在のテキストモードと元に戻すレベルを取得します。

```
UINT GetTextMode() const;
```

### <a name="return-value"></a>戻り値

Windows SDK で説明されているように、 [TEXTMODE](/windows/win32/api/richedit/ne-richedit-textmode) 列挙型からの一連のビットフラグ。 フラグは、コントロールの現在のテキストモードと元に戻すレベルを示します。

## <a name="cricheditctrlgettextrange"></a><a name="gettextrange"></a> CRichEditCtrl:: GetTextRange

指定した文字の範囲を取得します。

```
int GetTextRange(
    int nFirst,
    int nLast,
    CString& refString) const;
```

### <a name="parameters"></a>パラメーター

*nFirst*<br/>
範囲内の最初の文字の直前の文字位置のインデックス。

*nLast*<br/>
範囲内の最後の文字の直後に続く文字位置。

*refString*<br/>
テキストを受け取る [CString](../../atl-mfc-shared/reference/cstringt-class.md) オブジェクトへの参照。

### <a name="return-value"></a>戻り値

コピーされた文字数。終端の null 文字は含まれません。

### <a name="remarks"></a>解説

詳細については、Windows SDK の「 [EM_GETTEXTRANGE](/windows/win32/Controls/em-gettextrange) 」を参照してください。

`GetTextRange` では、リッチエディット2.0 機能がサポートされています。 詳細については、「Windows SDKfor の [リッチエディットコントロールについ](/windows/win32/Controls/about-rich-edit-controls) て」を参照してください。

## <a name="cricheditctrlgetundoname"></a><a name="getundoname"></a> CRichEditCtrl:: GetUndoName

Undo キューで次に使用可能なアクションの種類を取得します (存在する場合)。

```
UNDONAMEID GetUndoName() const;
```

### <a name="return-value"></a>戻り値

元に戻す操作がコントロールの元に戻すキューにある場合、は、 `GetUndoName` キュー内の次のアクションの種類を示す、 [Undonameid](/windows/win32/api/richedit/ne-richedit-undonameid) 列挙型を返します。 元に戻すキューが空の場合、またはキュー内の元に戻す操作の種類が不明な場合、は `GetUndoName` 0 を返します。

### <a name="remarks"></a>解説

元に戻す、または再実行できるアクションの種類には、入力、削除、ドラッグアンドドロップ、切り取り、貼り付けの各操作があります。 この情報は、元に戻すことができるアクションのドロップダウンリストボックスなど、元に戻す操作ややり直し操作を行うための拡張ユーザーインターフェイスを提供するアプリケーションに役立ちます。

## <a name="cricheditctrlgetwordwrapmode"></a><a name="getwordwrapmode"></a> CRichEditCtrl:: GetWordWrapMode

リッチエディットコントロールの現在のワードラップおよび単語区切りのオプションを取得します。

```
UINT GetWordWrapMode() const;
```

### <a name="return-value"></a>戻り値

現在の単語の折り返しおよび単語区切りのオプション。 これらのオプションについては、Windows SDK の「 [EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode) 」を参照してください。

### <a name="remarks"></a>解説

このメンバー関数は、アジア言語バージョンのオペレーティングシステムでのみ使用できます。

## <a name="cricheditctrlhideselection"></a><a name="hideselection"></a> CRichEditCtrl:: HideSelection

選択範囲の表示を変更します。

```cpp
void HideSelection(
    BOOL bHide,
    BOOL bPerm);
```

### <a name="parameters"></a>パラメーター

*bHide*<br/>
選択範囲を表示するか非表示にするかを示します。選択範囲を非表示にする場合は TRUE です。

*bPerm*<br/>
選択範囲の表示におけるこの変更を永続的にするかどうかを示します。

### <a name="remarks"></a>解説

*Bperm* が TRUE の場合、このオブジェクトの ECO_NOHIDESEL オプションが変更され `CRichEditCtrl` ます。 このオプションの簡単な説明については、「 [SetOptions](#setoptions)」を参照してください。 この関数を使用すると、このオブジェクトのすべてのオプションを設定でき `CRichEditCtrl` ます。

詳細については、Windows SDK の「 [EM_HIDESELECTION](/windows/win32/Controls/em-hideselection) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#18](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_18.cpp)]

## <a name="cricheditctrllimittext"></a><a name="limittext"></a> CRichEditCtrl:: LimitText

ユーザーが編集コントロールに入力できるテキストの長さを制限します。

```cpp
void LimitText(long nChars = 0);
```

### <a name="parameters"></a>パラメーター

*nChars*<br/>
ユーザーが入力できるテキストの長さ (バイト単位) を指定します。 このパラメーターが 0 (既定値) の場合、テキストの長さは64K バイトに設定されます。

### <a name="remarks"></a>解説

テキストの制限を変更すると、ユーザーが入力できるテキストのみが制限されます。 エディットコントロールに既に存在するテキストには影響しません。また、の [SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext) メンバー関数によってエディットコントロールにコピーされるテキストの長さにも影響しません `CWnd` 。 アプリケーションで関数を使用して、の `SetWindowText` 呼び出しで指定されたよりも多くのテキストを編集コントロールに配置する場合 `LimitText` 、ユーザーは編集コントロール内の任意のテキストを削除できます。 ただし、テキストの制限により、現在の選択範囲を削除してもテキストがテキストの上限を超えない限り、ユーザーは既存のテキストを新しいテキストに置き換えることができなくなります。

> [!NOTE]
> Text 制限の場合、各 OLE 項目は1つの文字としてカウントされます。

詳細については、Windows SDK の「 [EM_EXLIMITTEXT](/windows/win32/Controls/em-exlimittext) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#19](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_19.cpp)]

## <a name="cricheditctrllinefromchar"></a><a name="linefromchar"></a> CRichEditCtrl:: LineFromChar

指定した文字インデックスを含む行の行番号を取得します。

```
long LineFromChar(long nIndex) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
エディットコントロールのテキストに、目的の文字の0から始まるインデックス値を格納します。または、-1 を格納します。 *NIndex* が-1 の場合は、現在の行、つまり、カレットを含む行を指定します。

### <a name="return-value"></a>戻り値

*NIndex* によって指定された文字インデックスを含む行の0から始まる行番号。 *NIndex* が-1 の場合は、選択範囲の最初の文字を含む行の番号が返されます。 選択されていない場合は、現在の行番号が返されます。

### <a name="remarks"></a>解説

文字インデックスは、リッチエディットコントロールの先頭からの文字数です。 文字カウントの場合、OLE 項目は単一の文字としてカウントされます。

詳細については、Windows SDK の「 [EM_EXLINEFROMCHAR](/windows/win32/Controls/em-exlinefromchar) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#20](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_20.cpp)]

## <a name="cricheditctrllineindex"></a><a name="lineindex"></a> CRichEditCtrl:: LineIndex

このオブジェクト内の行の文字インデックスを取得し `CRichEditCtrl` ます。

```
int LineIndex(int nLine = -1) const;
```

### <a name="parameters"></a>パラメーター

*N 行*<br/>
エディットコントロールのテキスト内の目的の行のインデックス値を格納します。または、-1 を格納します。 *N 行* が-1 の場合は、現在の行、つまり、カレットを含む行を指定します。

### <a name="return-value"></a>戻り値

*N 行* で指定された行の文字インデックス。指定した行番号がエディットコントロールの行数よりも大きい場合は-1。

### <a name="remarks"></a>解説

文字インデックスは、リッチエディットコントロールの先頭から指定した行までの文字数です。

詳細については、Windows SDK の「 [EM_LINEINDEX](/windows/win32/controls/em-lineindex) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#21](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_21.cpp)]

## <a name="cricheditctrllinelength"></a><a name="linelength"></a> CRichEditCtrl:: LineLength

リッチエディットコントロールの行の長さを取得します。

```
int LineLength(int nLine = -1) const;
```

### <a name="parameters"></a>パラメーター

*N 行*<br/>
長さを取得する行内の文字の文字インデックスを指定します。 このパラメーターが-1 の場合、現在の行の長さ (カレットを含む行) が返されます。行内の選択したテキストの長さは含まれません。 `LineLength`1 行のエディットコントロールに対してを呼び出すと、このパラメーターは無視されます。

### <a name="return-value"></a>戻り値

`LineLength`複数行のエディットコントロールに対してを呼び出すと、戻り値は、 *n 行* によって指定された行の長さ (TCHAR) になります。  行の末尾に復帰文字は含まれません。 `LineLength`単一行のエディットコントロールに対してを呼び出した場合、戻り値は、エディットコントロールのテキストの長さ (TCHAR) です。 N 行がコントロール内の文字数よりも大きい場合、戻り値は0になります。

### <a name="remarks"></a>解説

[Lineindex](#lineindex)メンバー関数を使用して、このオブジェクト内の特定の行番号の文字インデックスを取得し `CRichEditCtrl` ます。

詳細については、Windows SDK の「 [EM_LINELENGTH](/windows/win32/Controls/em-linelength) 」を参照してください。

### <a name="example"></a>例

  [Lineindex](#lineindex)の例を参照してください。

## <a name="cricheditctrllinescroll"></a><a name="linescroll"></a> CRichEditCtrl:: LineScroll

複数行のエディットコントロールのテキストをスクロールします。

```cpp
void LineScroll(
    int nLines,
    int nChars = 0);
```

### <a name="parameters"></a>パラメーター

*nLines*<br/>
垂直方向にスクロールする行数を指定します。

*nChars*<br/>
水平方向にスクロールする文字位置の数を指定します。 リッチエディットコントロールに ES_RIGHT スタイルまたは ES_CENTER スタイルがある場合、この値は無視されます。 [編集スタイル](../../mfc/reference/styles-used-by-mfc.md#edit-styles) は、 [作成](#create)時に指定します。

### <a name="remarks"></a>解説

エディットコントロール内のテキストの最後の行を垂直方向にスクロールすることはできません。 現在の行と *nLines* で指定された行数が、エディットコントロールの行の合計数を超えた場合、エディットコントロールの最後の行が編集コントロールウィンドウの一番上にスクロールされるように値が調整されます。

`LineScroll` を使用すると、行の最後の文字を越えて水平方向にスクロールできます。

詳細については、Windows SDK の「 [EM_LINESCROLL](/windows/win32/Controls/em-linescroll) 」を参照してください。

### <a name="example"></a>例

  [GetFirstVisibleLine](#getfirstvisibleline)の例を参照してください。

## <a name="cricheditctrlpaste"></a><a name="paste"></a> CRichEditCtrl::P aste

クリップボードのデータを、カーソル位置 `CRichEditCtrl` (キャレットの位置) のに挿入します。

```cpp
void Paste();
```

### <a name="remarks"></a>解説

データは、クリップボードに認識可能な形式のデータが含まれている場合にのみ挿入されます。

詳細については、Windows SDK の「 [WM_PASTE](/windows/win32/dataxchg/wm-paste) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#22](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_22.cpp)]

## <a name="cricheditctrlpastespecial"></a><a name="pastespecial"></a> CRichEditCtrl::P Ast-Al

特定のクリップボード形式のデータをこのオブジェクトに貼り付け `CRichEditCtrl` ます。

```cpp
void PasteSpecial(
    UINT nClipFormat,
    DWORD dvAspect = 0,
    HMETAFILE hMF = 0);
```

### <a name="parameters"></a>パラメーター

*nClipFormat*<br/>
このオブジェクトに貼り付けるクリップボード形式 `CRichEditCtrl` 。

*dvAspect*<br/>
クリップボードから取得するデータのデバイスの縦横比。

*hMF*<br/>
貼り付けるオブジェクトのアイコンビューを含むメタファイルへのハンドル。

### <a name="remarks"></a>解説

挿入ポイント (キャレットの位置) に新しい素材が挿入されます。

詳細については、Windows SDK の「 [EM_PASTESPECIAL](/windows/win32/Controls/em-pastespecial) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#23](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_23.cpp)]

## <a name="cricheditctrlposfromchar"></a><a name="posfromchar"></a> CRichEditCtrl::P osFromChar

エディットコントロール内の指定した文字のクライアント領域の座標を取得します。

```
CPoint PosFromChar(UINT nChar) const;
```

### <a name="parameters"></a>パラメーター

*nChar*<br/>
文字の0から始まるインデックス。

### <a name="return-value"></a>戻り値

文字の位置 (x, y)。 単一行のエディットコントロールの場合、y 座標は常に0になります。

### <a name="remarks"></a>解説

詳細については、Windows SDK の「 [EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar) 」を参照してください。

## <a name="cricheditctrlredo"></a><a name="redo"></a> CRichEditCtrl:: Redo

コントロールの再実行キューの次のアクションをやり直します。

```
BOOL Redo();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

詳細については、Windows SDK の「 [EM_REDO](/windows/win32/Controls/em-redo) 」を参照してください。

## <a name="cricheditctrlreplacesel"></a><a name="replacesel"></a> CRichEditCtrl:: ReplaceSel

このオブジェクトの現在の選択項目を、 `CRichEditCtrl` 指定したテキストで置き換えます。

```cpp
void ReplaceSel(
    LPCTSTR lpszNewText,
    BOOL bCanUndo = FALSE);
```

### <a name="parameters"></a>パラメーター

*lpszNewText*<br/>
置換テキストを含む null で終わる文字列へのポインター。

*bCanUndo*<br/>
この関数を元に戻すことができるように指定するには、このパラメーターの値を TRUE に設定します。 既定値は FALSE です。

### <a name="remarks"></a>解説

このオブジェクト内のすべてのテキストを置換するには `CRichEditCtrl` 、 [CWnd:: SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)を使用します。

現在選択されていない場合は、挿入ポイント、つまり現在のカレット位置に置換テキストが挿入されます。

この関数は、挿入されたテキストを既存の文字書式で書式設定します。 (を呼び出す前に (0,-1) を呼び出すことによって) テキストの範囲全体を置き換える場合 `SetSel` `ReplaceSel` は、前の段落の書式設定を保持する段落文字の末尾があります。これは、新しく挿入されたテキストによって継承されます。

詳細については、Windows SDK の「 [EM_REPLACESEL](/windows/win32/Controls/em-replacesel) 」を参照してください。

### <a name="example"></a>例

  [Lineindex](#lineindex)の例を参照してください。

## <a name="cricheditctrlrequestresize"></a><a name="requestresize"></a> CRichEditCtrl:: RequestResize

この `CRichEditCtrl` オブジェクトが EN_REQUESTRESIZE 通知メッセージを親ウィンドウに強制的に送信するようにします。

```cpp
void RequestResize();
```

### <a name="remarks"></a>解説

この関数は、制限カラムオブジェクトの [CWnd:: OnSize](../../mfc/reference/cwnd-class.md#onsize) の処理中に役立ち `CRichEditCtrl` ます。

詳細については、「Windows SDK の [リッチエディットコントロールについて](/windows/win32/Controls/about-rich-edit-controls)」の「 [EM_REQUESTRESIZE](/windows/win32/Controls/em-requestresize)メッセージ」と「**制限カラム rich edit controls** 」セクションを参照してください。

## <a name="cricheditctrlsetautourldetect"></a><a name="setautourldetect"></a> CRichEditCtrl:: SetAutoURLDetect

リッチエディットコントロールが URL を自動的に検出するように設定します。

```
BOOL SetAutoURLDetect(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>パラメーター

*bEnable*<br/>
コントロールが URL を自動的に検出するように設定されているかどうかを指定します。 TRUE の場合、有効になります。 FALSE の場合、無効になります。

### <a name="return-value"></a>戻り値

成功した場合は0。それ以外の場合は0。 たとえば、メモリ不足のためにメッセージが失敗することがあります。

### <a name="remarks"></a>解説

有効にすると、リッチエディットコントロールによってテキストがスキャンされ、標準の URL 形式と一致するかどうかが判断されます。 これらの URL 形式の一覧については、Windows SDK の「 [EM_AUTOURLDETECT](/windows/win32/Controls/em-autourldetect) 」を参照してください。

> [!NOTE]
> `SetAutoURLDetect`編集コントロールが url 以外のテキストに対して CFE_LINK 効果を使用する場合は、TRUE に設定しないでください。 `SetAutoURLDetect` Url に対してこの効果を有効にし、他のすべてのテキストに対して無効にします。 CFE_LINK 効果の詳細については、「 [EN_LINK](/windows/win32/Controls/en-link) 」を参照してください。

## <a name="cricheditctrlsetbackgroundcolor"></a><a name="setbackgroundcolor"></a> CRichEditCtrl:: SetBackgroundColor

このオブジェクトの背景色を設定 `CRichEditCtrl` します。

```
COLORREF SetBackgroundColor(
    BOOL bSysColor,
    COLORREF cr);
```

### <a name="parameters"></a>パラメーター

*bSysColor*<br/>
背景色をシステム値に設定する必要があるかどうかを示します。 この値が TRUE の場合、 *cr* は無視されます。

*cr*<br/>
要求された背景色。 *Bsyscolor* が FALSE の場合にのみ使用されます。

### <a name="return-value"></a>戻り値

このオブジェクトの前の背景色 `CRichEditCtrl` 。

### <a name="remarks"></a>解説

背景色は、システム値または指定された [COLORREF](/windows/win32/gdi/colorref) 値に設定できます。

詳細については、Windows SDK の「 [EM_SETBKGNDCOLOR](/windows/win32/Controls/em-setbkgndcolor) Message and [COLORREF](/windows/win32/gdi/colorref) 構造体」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#24](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_24.cpp)]

## <a name="cricheditctrlsetdefaultcharformat"></a><a name="setdefaultcharformat"></a> CRichEditCtrl:: SetDefaultCharFormat

このオブジェクトの新しいテキストの文字書式属性を設定し `CRichEditCtrl` ます。

```
BOOL SetDefaultCharFormat(CHARFORMAT& cf);
BOOL SetDefaultCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>パラメーター

*cf*<br/>
最初のバージョンでは、新しい既定の文字書式属性を含む [CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata) 構造体へのポインター。

2番目のバージョンでは、 [CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w) 構造体へのポインター。これは、構造体に対するリッチエディット2.0 拡張機能であり、 `CHARFORMAT` 既定の文字書式属性が含まれています。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

Cf のメンバーによって指定された属性のみ `dwMask` が、この関数によって変更されます。 

詳細については、Windows SDK の [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) メッセージ、 `CHARFORMAT` および構造体を参照してください `CHARFORMAT2` 。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#25](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_25.cpp)]

## <a name="cricheditctrlseteventmask"></a><a name="seteventmask"></a> CRichEditCtrl:: SetEventMask

このオブジェクトのイベントマスクを設定 `CRichEditCtrl` します。

```
DWORD SetEventMask(DWORD dwEventMask);
```

### <a name="parameters"></a>パラメーター

*dwEventMask*<br/>
このオブジェクトの新しいイベントマスク `CRichEditCtrl` 。

### <a name="return-value"></a>戻り値

前のイベントマスク。

### <a name="remarks"></a>解説

イベントマスクは、 `CRichEditCtrl` オブジェクトが親ウィンドウに送信する通知メッセージを指定します。

詳細については、Windows SDK の「 [EM_SETEVENTMASK](/windows/win32/Controls/em-seteventmask) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#26](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_26.cpp)]

## <a name="cricheditctrlsetmodify"></a><a name="setmodify"></a> CRichEditCtrl:: SetModify

編集コントロールの変更されたフラグを設定またはクリアします。

```cpp
void SetModify(BOOL bModified = TRUE);
```

### <a name="parameters"></a>パラメーター

*bModified*<br/>
値が TRUE の場合は、テキストが変更されたことを示します。値が FALSE の場合は、変更されていないことを示します。 既定では、modified フラグが設定されています。

### <a name="remarks"></a>解説

Modified フラグは、エディットコントロール内のテキストが変更されたかどうかを示します。 ユーザーがテキストを変更するたびに自動的に設定されます。 値を取得するには、 [Getmodify](#getmodify) メンバー関数を使用します。

詳細については、Windows SDK の「 [EM_SETMODIFY](/windows/win32/Controls/em-setmodify) 」を参照してください。

### <a name="example"></a>例

  「 [Getmodify](#getmodify)」の例を参照してください。

## <a name="cricheditctrlsetolecallback"></a><a name="setolecallback"></a> CRichEditCtrl:: SetOLECallback

`CRichEditCtrl` `IRichEditOleCallback` OLE 関連のリソースおよび情報へのアクセスに使用するオブジェクトをこのオブジェクトに与えます。

```
BOOL SetOLECallback(IRichEditOleCallback* pCallback);
```

### <a name="parameters"></a>パラメーター

*pCallback*<br/>
この[](/windows/win32/api/richole/nn-richole-iricheditolecallback) `CRichEditCtrl` オブジェクトが OLE 関連のリソースと情報を取得するために使用する IRichEditOleCallback オブジェクトへのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

この `CRichEditCtrl` オブジェクトは、 [IUnknown:: AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) を呼び出して、 *pcallback* によって指定された COM オブジェクトの使用状況カウントをインクリメントします。

詳細については、Windows SDK の「 [EM_SETOLECALLBACK](/windows/win32/Controls/em-setolecallback) Message and [IRichEditOleCallback](/windows/win32/api/richole/nn-richole-iricheditolecallback) interface」を参照してください。

## <a name="cricheditctrlsetoptions"></a><a name="setoptions"></a> CRichEditCtrl:: SetOptions

このオブジェクトのオプションを設定し `CRichEditCtrl` ます。

```cpp
void SetOptions(
    WORD wOp,
    DWORD dwFlags);
```

### <a name="parameters"></a>パラメーター

*wOp*<br/>
操作の種類を示します。 次のいずれかの値です。

- オプションは、 *dwFlags* によって指定されたものに ECOOP_SET 設定します。

- 現在のオプションを ECOOP_OR、 *dwFlags* で指定されたオプションと結合します。

- ECOOP_AND は、 *dwFlags* でも指定されている現在のオプションのみを保持します。

- ECOOP_XOR、 *dwFlags* によって指定されたオプションを使用して、論理的に排他的なオプションを指定します。

*dwFlags*<br/>
リッチエディットオプション。 フラグの値については、「解説」を参照してください。

### <a name="remarks"></a>解説

オプションは、次の値の組み合わせにすることができます。

- ダブルクリックすると、自動的に単語を選択 ECO_AUTOWORDSELECTION ます。

- ユーザーが行の末尾に文字を入力すると、ECO_AUTOVSCROLL によってテキストが自動的に10文字右にスクロールされます。 ユーザーが ENTER キーを押すと、コントロールはすべてのテキストをスクロールして0の位置に戻ります。

- ユーザーが最後の行で ENTER キーを押すと、ECO_AUTOHSCROLL によってテキストが1ページ上に自動的にスクロールされます。

- ECO_NOHIDESEL、エディットコントロールの既定の動作を否定します。 既定の動作では、コントロールが入力フォーカスを失ったときに選択が非表示になり、コントロールが入力フォーカスを受け取ったときに選択が表示されます。 ECO_NOHIDESEL を指定した場合、コントロールにフォーカスがない場合でも、選択したテキストは反転されます。

- ECO_READONLY を指定すると、エディットコントロールのテキストを入力したり編集したりできなくなります。

- ECO_WANTRETURN は、ユーザーが ENTER キーを押したときに、ダイアログボックスの複数行のリッチエディットコントロールにテキストを入力したときに、キャリッジリターンが挿入されることを指定します。 このスタイルを指定しない場合は、ENTER キーを押すと、リッチエディットコントロールの親ウィンドウにコマンドが送信され、親ウィンドウの既定のボタン (たとえば、ダイアログボックスの [OK] ボタン) がクリックされます。 このスタイルは、単一行のエディットコントロールには影響しません。

- ECO_SAVESEL は、コントロールがフォーカスを失ったときに選択範囲を保持します。 既定では、フォーカスを取り戻すと、コントロールの内容全体が選択されます。

- ECO_VERTICAL は、テキストとオブジェクトを垂直方向に描画します。 アジア言語でのみ使用できます。

詳細については、Windows SDK の「 [EM_SETOPTIONS](/windows/win32/Controls/em-setoptions) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#27](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_27.cpp)]

## <a name="cricheditctrlsetparaformat"></a><a name="setparaformat"></a> CRichEditCtrl:: SetParaFormat

このオブジェクトの現在の選択項目の段落書式属性を設定し `CRichEditCtrl` ます。

```
BOOL SetParaFormat(PARAFORMAT& pf);
BOOL SetParaFormat(PARAFORMAT2& pf);
```

### <a name="parameters"></a>パラメーター

*pf*<br/>
最初のバージョンでは、新しい既定の段落書式属性を含む [PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat) 構造体へのポインター。

2番目のバージョンでは、 [PARAFORMAT2](/windows/win32/api/richedit/ns-richedit-paraformat2) 構造体へのポインター。これは、構造体のリッチエディット2.0 拡張機能であり `PARAFORMAT` 、既定の文字書式属性を保持します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

`dwMask`この関数によって、 *pf* のメンバーによって指定された属性のみが変更されます。

詳細については、Windows SDK の [EM_SETPARAFORMAT](/windows/win32/Controls/em-setparaformat) メッセージ、 `PARAFORMAT` および構造体を参照してください `PARAFORMAT2` 。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#28](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_28.cpp)]

## <a name="cricheditctrlsetpunctuation"></a><a name="setpunctuation"></a> CRichEditCtrl:: SetPunctuation 点

リッチエディットコントロールの句読点を設定します。

```
BOOL SetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc);
```

### <a name="parameters"></a>パラメーター

*fType*<br/>
句読点フラグ。 使用可能な値の一覧については、Windows SDK の [EM_SETPUNCTUATION](/windows/win32/Controls/em-setpunctuation)の *fType* パラメーターを参照してください。

*lpPunc*<br/>
Windows SDK で説明されているように、 [句読点](/windows/win32/api/richedit/ns-richedit-punctuation) 構造体へのポインター。

### <a name="return-value"></a>戻り値

成功した場合は0以外の。それ以外の場合は0。

### <a name="remarks"></a>解説

このメンバー関数は、アジア言語バージョンのオペレーティングシステムでのみ使用できます。

## <a name="cricheditctrlsetreadonly"></a><a name="setreadonly"></a> CRichEditCtrl:: SetReadOnly

このオブジェクトの ECO_READONLY オプションを変更 `CRichEditCtrl` します。

```
BOOL SetReadOnly(BOOL bReadOnly = TRUE);
```

### <a name="parameters"></a>パラメーター

*bReadOnly*<br/>
このオブジェクトを読み取り専用にする必要があるかどうかを示し `CRichEditCtrl` ます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

このオプションの簡単な説明については、「 [SetOptions](#setoptions)」を参照してください。 この関数を使用すると、このオブジェクトのすべてのオプションを設定でき `CRichEditCtrl` ます。

詳細については、Windows SDK の「 [EM_SETREADONLY](/windows/win32/Controls/em-setreadonly) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#29](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_29.cpp)]

## <a name="cricheditctrlsetrect"></a><a name="setrect"></a> CRichEditCtrl:: SetRect

このオブジェクトの書式設定の四角形を設定 `CRichEditCtrl` します。

```cpp
void SetRect(LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*lpRect*<br/>
書式指定用の四角形の新しい境界を示す RECT[または](../../atl-mfc-shared/reference/crect-class.md) [RECT](/windows/win32/api/windef/ns-windef-rect)へのポインター。

### <a name="remarks"></a>解説

書式設定の四角形は、テキストの制限四角形です。 制限する四角形は、リッチエディットコントロールウィンドウのサイズとは関係ありません。 この `CRichEditCtrl` オブジェクトが最初に作成されたとき、書式設定の四角形はウィンドウのクライアント領域と同じサイズになります。 `SetRect`リッチエディットウィンドウよりも書式設定の四角形を拡大または縮小するには、を使用します。

詳細については、Windows SDK の「 [EM_SETRECT](/windows/win32/Controls/em-setrect) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#30](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_30.cpp)]

## <a name="cricheditctrlsetsel"></a><a name="setsel"></a> CRichEditCtrl:: SetSel

このオブジェクト内の選択を設定し `CRichEditCtrl` ます。

```cpp
void SetSel(
    long nStartChar,
    long nEndChar);

void SetSel(CHARRANGE& cr);
```

### <a name="parameters"></a>パラメーター

*nStartChar*<br/>
選択範囲の最初の文字の0から始まるインデックス番号。

*nEndChar*<br/>
選択範囲の最後の文字の0から始まるインデックス番号。

*cr*<br/>
現在の選択範囲の境界を保持する[Charrange](/windows/win32/api/richedit/ns-richedit-charrange)構造体。

### <a name="remarks"></a>解説

この関数の2つの形式は、選択範囲の境界を設定する別の方法を提供します。 これらのフォームの簡単な説明を次に示します。

- **SetSel (** `cr` **)** このフォームは、 `CHARRANGE` 構造体をメンバーとメンバーと共に使用して、 `cpMin` 境界を設定し `cpMax` ます。

- **SetSel (** `nStartChar` **,** `nEndChar` **)** この形式では、パラメーター *nstartchar* と *nEndChar* を使用して境界を設定します。

カレットは、start ( `cpMin` または *Nstartchar*) インデックスと end ( `cpMax` または *nEndChar*) インデックスの値の大きい方によって示される選択範囲の末尾に配置されます。 この関数は、の内容をスクロールして、 `CRichEditCtrl` キャレットが表示されるようにします。

このオブジェクト内のすべてのテキストを選択するには `CRichEditCtrl` 、 `SetSel` 開始インデックスを0に、終了インデックスを-1 にしてを呼び出します。

詳細については、Windows SDK の「 [EM_EXSETSEL](/windows/win32/Controls/em-exsetsel) Message および [charrange](/windows/win32/api/richedit/ns-richedit-charrange) 構造体」を参照してください。

### <a name="example"></a>例

  [Getsel](#getsel)の例を参照してください。

## <a name="cricheditctrlsetselectioncharformat"></a><a name="setselectioncharformat"></a> CRichEditCtrl:: SetSelectionCharFormat

このオブジェクトの現在の選択範囲に含まれるテキストの文字書式属性を設定し `CRichEditCtrl` ます。

```
BOOL SetSelectionCharFormat(CHARFORMAT& cf);
BOOL SetSelectionCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>パラメーター

*cf*<br/>
最初のバージョンでは、現在の選択範囲の新しい文字書式属性を含む [CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata) 構造体へのポインター。

2番目のバージョンでは、 [CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w) 構造体へのポインター。これは、 `CHARFORMAT` 現在の選択範囲の新しい文字書式属性を格納する、構造体のリッチエディット2.0 拡張機能です。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

Cf のメンバーによって指定された属性のみ `dwMask` が、この関数によって変更されます。 

詳細については、Windows SDK の [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) 、およびの各 `CHARFORMAT` 構造体を参照してください `CHARFORMAT2` 。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#31](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_31.cpp)]

## <a name="cricheditctrlsettargetdevice"></a><a name="settargetdevice"></a> CRichEditCtrl:: SetTargetDevice

このオブジェクトで、WYSIWYG に使用されるターゲットデバイスと線の幅を設定します (表示される内容は次のようになり `CRichEditCtrl` ます)。

```
BOOL SetTargetDevice(
    HDC hDC,
    long lLineWidth);

BOOL SetTargetDevice(
    CDC& dc,
    long lLineWidth);
```

### <a name="parameters"></a>パラメーター

*hDC*<br/>
新しいターゲットデバイスのデバイスコンテキストを処理します。

*lLineWidth*<br/>
書式設定に使用する線の幅。

*dc*<br/>
新しいターゲットデバイスの[CDC](../../mfc/reference/cdc-class.md) 。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

この関数が成功した場合、リッチエディットコントロールは、パラメーターとして渡されたデバイスコンテキストを所有します。 その場合、呼び出し元の関数はデバイスコンテキストを破棄しないでください。

詳細については、Windows SDK の「 [EM_SETTARGETDEVICE](/windows/win32/Controls/em-settargetdevice) 」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#32](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_32.cpp)]

## <a name="cricheditctrlsettextmode"></a><a name="settextmode"></a> CRichEditCtrl:: SetTextMode

リッチエディットコントロールのテキストモードまたは元に戻す/やり直しのレベルを設定します。

```
BOOL SetTextMode(UINT fMode);
```

### <a name="parameters"></a>パラメーター

*fMode*<br/>
コントロールのテキストモードと元に戻すレベルのパラメーターの新しい設定を指定します。 使用可能な値の一覧については、Windows SDK の [EM_SETTEXTMODE](/windows/win32/Controls/em-settextmode) の mode パラメーターを参照してください。

### <a name="return-value"></a>戻り値

成功した場合は0。それ以外の場合は0。

### <a name="remarks"></a>解説

テキストモードの詳細については、Windows SDK の「EM_SETTEXTMODE」を参照してください。

コントロールにテキストが含まれている場合、このメンバー関数は失敗します。 コントロールが空であることを確認するには、空の文字列を含む [WM_SETTEXT](/windows/win32/winmsg/wm-settext) メッセージを送信します。

## <a name="cricheditctrlsetundolimit"></a><a name="setundolimit"></a> CRichEditCtrl:: SetUndoLimit

元に戻すキューに格納できるアクションの最大数を設定します。

```
UINT SetUndoLimit(UINT nLimit);
```

### <a name="parameters"></a>パラメーター

*nLimit*<br/>
元に戻すキューに格納できるアクションの最大数を指定します。 元に戻す操作を無効にするには、0に設定します。

### <a name="return-value"></a>戻り値

リッチエディットコントロールの元に戻す操作の最大数。

### <a name="remarks"></a>解説

既定では、元に戻すキューのアクションの最大数は100です。 この数を増やす場合は、新しい数値を格納するのに十分なメモリが必要です。 パフォーマンスを向上させるには、制限を可能な限り最小値に設定します。

## <a name="cricheditctrlsetwordcharformat"></a><a name="setwordcharformat"></a> CRichEditCtrl:: SetWordCharFormat

このオブジェクトで現在選択されている単語の文字書式属性を設定し `CRichEditCtrl` ます。

```
BOOL SetWordCharFormat(CHARFORMAT& cf);
BOOL SetWordCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>パラメーター

*cf*<br/>
最初のバージョンでは、現在選択されている単語の新しい文字書式属性を含む [CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata) 構造体へのポインター。

2番目のバージョンでは、 [CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w) 構造体へのポインター。これは、 `CHARFORMAT` 現在選択されている単語の新しい文字書式属性を格納している、構造体のリッチエディット2.0 拡張機能です。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

Cf のメンバーによって指定された属性のみ `dwMask` が、この関数によって変更されます。 

詳細については、Windows SDK の [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) メッセージ、 `CHARFORMAT` および構造体を参照してください `CHARFORMAT2` 。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#33](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_33.cpp)]

## <a name="cricheditctrlsetwordwrapmode"></a><a name="setwordwrapmode"></a> CRichEditCtrl:: SetWordWrapMode

リッチエディットコントロールのワードラップおよび単語区切りのオプションを設定します。

```
UINT SetWordWrapMode(UINT uFlags) const;
```

### <a name="parameters"></a>パラメーター

*uFlags*<br/>
ワードラップと単語区切りに設定するオプション。 使用可能なオプションの一覧については、Windows SDK の「 [EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode) 」を参照してください。

### <a name="return-value"></a>戻り値

現在の単語折り返しおよび単語区切りのオプション。

### <a name="remarks"></a>解説

このメッセージは、アジア言語バージョンのオペレーティングシステムでのみ使用できます。

## <a name="cricheditctrlstopgrouptyping"></a><a name="stopgrouptyping"></a> CRichEditCtrl:: StopGroupTyping

コントロールが、現在の元に戻す操作に追加の入力操作を収集できないようにします。

```cpp
void StopGroupTyping();
```

### <a name="remarks"></a>解説

コントロールは、次の入力アクション (存在する場合) を、元に戻すキューの新しいアクションに格納します。

詳細については、Windows SDK の「 [EM_STOPGROUPTYPING](/windows/win32/Controls/em-stopgrouptyping) 」を参照してください。

## <a name="cricheditctrlstreamin"></a><a name="streamin"></a> CRichEditCtrl:: StreamIn

このオブジェクト内のテキスト `CRichEditCtrl` を、指定した入力ストリームのテキストに置き換えます。

```
long StreamIn(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>パラメーター

*nFormat*<br/>
入力データ形式を指定するフラグ。 詳細については、次の「解説」を参照してください。

*es*<br/>
入力ストリームを指定する[editstream](/windows/win32/api/richedit/ns-richedit-editstream)構造体。 詳細については、次の「解説」を参照してください。

### <a name="return-value"></a>戻り値

入力ストリームから読み取った文字数。

### <a name="remarks"></a>解説

*Nformat* の値には、次のいずれかを指定する必要があります。

- SF_TEXT はテキストの読み取りのみを示します。

- SF_RTF は、テキストの読み取りと書式設定を示します。

これらの値のいずれかを SFF_SELECTION と組み合わせることができます。 SFF_SELECTION が指定されている場合、は `StreamIn` 現在の選択項目を入力ストリームの内容に置き換えます。 指定されていない場合、は `StreamIn` このオブジェクトの内容全体を置き換え `CRichEditCtrl` ます。

`EDITSTREAM`パラメーター *es* では、バッファーにテキストを入力するコールバック関数を指定します。 このコールバック関数は、入力ストリームが使い果たされるまで繰り返し呼び出されます。

詳細については、Windows SDK の「 [EM_STREAMIN](/windows/win32/Controls/em-streamin) Message および [editstream](/windows/win32/api/richedit/ns-richedit-editstream) 構造体」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#34](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_34.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#35](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_35.cpp)]

## <a name="cricheditctrlstreamout"></a><a name="streamout"></a> CRichEditCtrl:: StreamOut

このオブジェクトの内容を `CRichEditCtrl` 指定された出力ストリームに書き込みます。

```
long StreamOut(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>パラメーター

*nFormat*<br/>
出力データ形式を指定するフラグ。 詳細については、次の「解説」を参照してください。

*es*<br/>
出力ストリームを指定する[editstream](/windows/win32/api/richedit/ns-richedit-editstream)構造体。 詳細については、次の「解説」を参照してください。

### <a name="return-value"></a>戻り値

出力ストリームに書き込まれた文字数。

### <a name="remarks"></a>解説

*Nformat* の値には、次のいずれかを指定する必要があります。

- SF_TEXT はテキストのみを書き込むことを示します。

- SF_RTF テキストと書式設定を記述します。

- SF_RTFNOOBJS は、テキストと書式設定を記述し、OLE 項目をスペースに置換します。

- SF_TEXTIZED は、OLE 項目のテキスト表現を使用してテキストと書式設定を記述します。

これらの値のいずれかを SFF_SELECTION と組み合わせることができます。 SFF_SELECTION が指定されている場合、では、 `StreamOut` 現在の選択項目が出力ストリームに書き込まれます。 指定されていない場合、は `StreamOut` このオブジェクトの内容全体を書き込み `CRichEditCtrl` ます。

`EDITSTREAM`パラメーター *es* では、バッファーにテキストを入力するコールバック関数を指定します。 このコールバック関数は、出力ストリームが使い果たされるまで繰り返し呼び出されます。

詳細については、Windows SDK の「 [EM_STREAMOUT](/windows/win32/Controls/em-streamout) Message および [editstream](/windows/win32/api/richedit/ns-richedit-editstream) 構造体」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CRichEditCtrl#36](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_36.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#37](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_37.cpp)]

## <a name="cricheditctrlundo"></a><a name="undo"></a> CRichEditCtrl:: Undo

リッチエディットコントロールの最後の操作を元に戻します。

```
BOOL Undo();
```

### <a name="return-value"></a>戻り値

元に戻す操作が成功した場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>解説

元に戻す操作は元に戻すこともできます。 たとえば、の最初の呼び出しで、削除されたテキストを復元でき `Undo` ます。 編集操作が介在しない限り、の2回目の呼び出しでテキストを削除でき `Undo` ます。

詳細については、Windows SDK の「 [EM_UNDO](/windows/win32/Controls/em-undo) 」を参照してください。

### <a name="example"></a>例

  [Canundo](#canundo)の例を参照してください。

## <a name="see-also"></a>関連項目

[MFC のサンプルワードパッド](../../overview/visual-cpp-samples.md)<br/>
[CWnd クラス](../../mfc/reference/cwnd-class.md)<br/>
[階層図](../../mfc/hierarchy-chart.md)<br/>
[CEdit クラス](../../mfc/reference/cedit-class.md)<br/>
[CRichEditView クラス](../../mfc/reference/cricheditview-class.md)
