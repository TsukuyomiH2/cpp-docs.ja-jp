---
title: MFC ODBC コンシューマー ウィザード
ms.date: 08/29/2019
helpviewer_keywords:
- wizards [MFC]
ms.assetid: f64a890b-a252-4887-88a1-782a7cd4ff3d
ms.openlocfilehash: 45087434c0093f99383096761d58a8029c9d5009
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81373017"
---
# <a name="mfc-odbc-consumer-wizard"></a>MFC ODBC コンシューマー ウィザード

::: moniker range="vs-2019"

このウィザードは Visual Studio 2019 以降で使用できません。

::: moniker-end

::: moniker range="<=vs-2017"

このウィザードでは、ODBC レコードセット クラスと、指定したデータ ソースにアクセスするために必要なデータ バインディングを設定します。

## <a name="uielement-list"></a>UI 要素の一覧

- **データ ソース**

  [**データ ソース**] ボタンを使用すると、指定した ODBC ドライバを使用して、指定したデータ ソースを設定できます。 データ ソース ファイル (DSN) の詳細については、ODBC SDK[のファイル データ ソース](/sql/odbc/reference/file-data-sources)を参照してください。

  [**データ ソースの選択**] ダイアログ ボックスには、次の 2 つのタブがあります。

  - **[ファイル データ ソース**] タブ:

     [**ファイルの場所**] ボックスには、データ ソースとして使用するファイルを選択するディレクトリを指定します。 デフォルトは\プログラム ファイル\共通ファイル\ODBC\データ ソースです。 既存のファイル データ ソース (.dsn ファイル) がメイン リスト ボックスに表示されます。 ODBC データ ソース[アドミニストレータ](/sql/odbc/admin/odbc-data-source-administrator)の [**ファイル DSN]** タブを使用して、データ ソースを事前に設定するか、このダイアログ ボックスを使用して新しいデータ ソースを作成できます。

     このダイアログ ボックスから新しいファイル データ ソースを`New`作成するには、DSN 名をクリックして指定します。[**新しいデータ ソースの作成**] ダイアログ ボックスが表示されます。 [**新しいデータ ソースの作成**] ダイアログ ボックスで、`Next`適切なドライバを選択し、 をクリックします。[**参照**] をクリックし、データ ソースとして使用するファイルの名前を選択します (.xls ファイルなどの DSN 以外のファイルを表示するには 、[すべてのファイル] を選択する必要があります)。を`Next`クリックし、[**完了**] をクリックします。 DSN 以外のファイルを選択した場合は、DSN に変換する "ODBC Excel セットアップ" などのドライバ固有のダイアログ ボックスが表示されます。

     > [!NOTE]
     > ODBC データ ソース アドミニストレータを使用して、事前に新しいファイル データ ソースを作成することもできます。 [**スタート]** メニューの **[設定**]、[**コントロール パネル**]、[**管理ツール**]、[**データ ソース (ODBC)]** の順に選択し **、ODBC データ ソース アドミニストレータ**を選択します。

     [DSN**名]** ボックスでは、ファイル データ ソースの名前を指定できます。 DSN 名の最後に、Excel ファイルの場合は .xls、Access ファイルの場合は .mdb など、適切なファイル拡張子で終了するようにする必要があります。

     DSN の詳細については、ODBC SDK の[「ファイル データ ソース](/sql/odbc/reference/file-data-sources)」を参照してください。

  - **[マシン データ ソース**] タブ:

     このタブには、システムソースとユーザーデータソースが表示されます。 ユーザー データ ソースは、このコンピューター上のユーザーに固有です。 システム データ ソースは、このコンピュータのすべてのユーザーまたはシステム全体のサービスで使用できます。 ODBC SDK[のマシン データ ソース](/sql/odbc/reference/machine-data-sources)を参照してください。

     ODBC データ ソースの詳細については、ODBC SDK の[「データ ソース](/sql/odbc/reference/data-sources)」を参照してください。

  [**OK**] をクリックして完了します。 **[データベース オブジェクトの選択]** ダイアログ ボックスが表示されます。 このダイアログ ボックスで、コンシューマが使用するテーブルまたはビューを選択します。 複数のビューとテーブルを選択するには、コントロールキーを押しながら項目をクリックします。 [**OK**] をクリックして完了します。

- **クラス**

   既定では、選択したファイルまたはマシン のデータ ソースの名前に基づくコンシューマー クラスの名前。

- **.h ファイル**

   既定では、選択したファイルまたはマシン のデータ ソースの名前に基づくコンシューマー クラス ヘッダー ファイルの名前。

- **.cpp ファイル**

   既定では、選択したファイルまたはマシン のデータ ソースの名前に基づくコンシューマー クラス実装ファイルの名前。

- **Type**

   レコードセットがダイナセット (既定) かスナップショットかを指定します。

  - **ダイナセット**: レコードセットがダイナセットであることを指定します。 ダイナセットは、クエリを実行したデータベースのデータにインデックス付きビューを提供するクエリの結果です。 ダイナセットは、元のデータに対する整数インデックスのみをキャッシュし、スナップショットに対するパフォーマンス向上を提供します。 インデックスは、クエリの結果として見つかった各レコードを直接指し示し、レコードが削除されるかどうかを示します。 また、照会されたレコードの更新情報にアクセスすることもできます。 これは既定値です。

  - **スナップショット**: レコードセットがスナップショットであることを指定します。 スナップショットはクエリの結果であり、ある時点でデータベースに対するビューです。 クエリの結果として見つかったすべてのレコードがキャッシュされるため、元のレコードに対する変更は表示されません。

- **すべての列をバインドする**

   選択したテーブルのすべての列をバインドするかどうかを指定します。 このボックスを選択すると (既定)、すべての列がバインドされます。このボックスを選択しない場合、列はバインドされません。

::: moniker-end

## <a name="see-also"></a>関連項目

[MFC ODBC コンシューマー](../../mfc/reference/adding-an-mfc-odbc-consumer.md)<br/>
[コード ウィザードを使用した機能の追加](../../ide/adding-functionality-with-code-wizards-cpp.md)
