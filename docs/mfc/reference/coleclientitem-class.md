---
title: クラス
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: c880b1fb724b533bb049666460948c6df661a03c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81376282"
---
# <a name="coleclientitem-class"></a>クラス

OLE アイテムへのコンテナー インターフェイスを定義します。

## <a name="syntax"></a>構文

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[をクリックします。](#coleclientitem)|`COleClientItem` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[をアクティブにします。](#activate)|操作の OLE アイテムを開き、指定した動詞を実行します。|
|[をアクティブにします。](#activateas)|アイテムを別の種類としてアクティブにします。|
|[オブジェクトをアタッチします。](#attachdataobject)|OLE オブジェクトのデータにアクセスします。|
|[データを作成します。](#cancreatefromdata)|コンテナー アプリケーションが埋め込みオブジェクトを作成できるかどうかを示します。|
|[データを作成します。](#cancreatelinkfromdata)|コンテナー アプリケーションがリンク オブジェクトを作成できるかどうかを示します。|
|[をクリックします。](#canpaste)|クリップボードに埋め込み可能な OLE アイテムまたは静的な OLE アイテムが含まれているかどうかを示します。|
|[をクリックします。](#canpastelink)|クリップボードにリンク可能な OLE アイテムが含まれているかどうかを示します。|
|[をクリックします。](#close)|サーバーへのリンクを閉じますが、OLE アイテムは破棄されません。|
|[をクリックします。](#convertto)|項目を別の型に変換します。|
|[クリップボードへコピーします。](#copytoclipboard)|OLE アイテムをクリップボードにコピーします。|
|[::作成からクローン](#createclonefrom)|既存のアイテムの複製を作成します。|
|[クリップボードから作成します。](#createfromclipboard)|クリップボードから埋め込みアイテムを作成します。|
|[データを作成します。](#createfromdata)|データ オブジェクトから埋め込みアイテムを作成します。|
|[ファイルから作成します。](#createfromfile)|埋め込みアイテムをファイルから作成します。|
|[クリップボードからリンクを作成します。](#createlinkfromclipboard)|クリップボードからリンク アイテムを作成します。|
|[データからリンクを作成します。](#createlinkfromdata)|データ オブジェクトからリンク アイテムを作成します。|
|[ファイルからリンクを作成します。](#createlinkfromfile)|ファイルからリンク アイテムを作成します。|
|[をクリックします。](#createnewitem)|サーバー アプリケーションを起動して、新しい埋め込みアイテムを作成します。|
|[クリップボードから静的なアイテムを作成します。](#createstaticfromclipboard)|クリップボードから静的なアイテムを作成します。|
|[データから生成します。](#createstaticfromdata)|データ オブジェクトから静的な項目を作成します。|
|[クライアント アイテム::Dアクティブ化](#deactivate)|項目を非アクティブにします。|
|[:Dアクティブ化UI](#deactivateui)|コンテナー アプリケーションのユーザー インターフェイスを元の状態に復元します。|
|[クライアントアイテム::D](#delete)|リンクアイテムである場合、OLE アイテムを削除または閉じます。|
|[クライアントアイテム::Doドラッグドロップ](#dodragdrop)|ドラッグ アンド ドロップ操作を実行します。|
|[:D をクリックします。](#doverb)|指定した動詞を実行します。|
|[:Dロー](#draw)|OLE アイテムを描画します。|
|[をクリックします。](#getactiveview)|アイテムがインプレースでアクティブ化されるビューを取得します。|
|[を選択します。](#getcachedextent)|OLE アイテムの四角形の境界を返します。|
|[を選択します。](#getclassid)|現在のアイテムのクラス ID を取得します。|
|[を取得します。](#getclipboarddata)|メンバー関数を呼び出してクリップボードに配置されるデータを`CopyToClipboard`取得します。|
|[を取得します。](#getdocument)|現在の`COleDocument`アイテムを含むオブジェクトを返します。|
|[次の項目を取得します。](#getdrawaspect)|表示用のアイテムの現在のビューを取得します。|
|[を取得します。](#getextent)|OLE アイテムの四角形の境界を返します。|
|[レジストリを取得します。](#geticonfromregistry)|特定の CLSID のサーバーに関連付けられたアイコンへのハンドルを取得します。|
|[をクリックします。](#geticonicmetafile)|項目のアイコンの描画に使用するメタファイルを取得します。|
|[ウィンドウを取得します。](#getinplacewindow)|アイテムの埋め込み先編集ウィンドウへのポインターを返します。|
|[をクリックします。](#getitemstate)|アイテムの現在の状態を取得します。|
|[を取得します。](#getlaststatus)|最後の OLE 操作の状態を返します。|
|[を選択します。](#getlinkupdateoptions)|リンクアイテムの更新モードを返します (詳細機能)。|
|[次の項目を取得します。](#gettype)|OLE アイテムの種類 (埋め込み、リンク、または静的) を返します。|
|[次の操作を行います。](#getusertype)|項目の型を説明する文字列を取得します。|
|[をクリックします。](#isinplaceactive)|アイテムがインプレース アクティブの場合は TRUE を返します。|
|[をクリックします。](#islinkuptodate)|リンクされたアイテムがソース ドキュメントに最新の状態の場合は TRUE を返します。|
|[を変更しました。](#ismodified)|アイテムが最後に保存されてから変更された場合は TRUE を返します。|
|[を開く](#isopen)|アイテムがサーバー アプリケーションで現在開かれている場合は TRUE を返します。|
|[を実行しています。](#isrunning)|アイテムのサーバー アプリケーションが実行されている場合は TRUE を返します。|
|[をアクティブにします。](#onactivate)|アクティブ化されたことを項目に通知するために、フレームワークによって呼び出されます。|
|[をクリックします。](#onactivateui)|アクティブになっており、そのユーザー インターフェイスを表示する必要があることを項目に通知するために、フレームワークによって呼び出されます。|
|[コントロールクライアントアイテム::オンチェンジ](#onchange)|サーバーが OLE アイテムを変更したときに呼び出されます。 実装が必要です。|
|[を無効にします。](#ondeactivate)|項目が非アクティブ化されたときに、フレームワークによって呼び出されます。|
|[クライアントアイテム::オンアクティブ化](#ondeactivateui)|サーバーがインプレース ユーザー インターフェイスを削除したときに、フレームワークによって呼び出されます。|
|[をクリックします。](#ongetclipboarddata)|クリップボードにコピーするデータを取得するために、フレームワークによって呼び出されます。|
|[メニューを挿入します。](#oninsertmenus)|複合メニューを作成するために、フレームワークによって呼び出されます。|
|[次の項目を削除します。](#onremovemenus)|複合メニューからコンテナーのメニューを削除するために、フレームワークによって呼び出されます。|
|[次の項目を使用します。](#onsetmenu)|複合メニューをインストールおよび削除するために、フレームワークによって呼び出されます。|
|[コントロールバーを表示します。](#onshowcontrolbars)|コントロール バーの表示と非表示を切り替えるために、フレームワークによって呼び出されます。|
|[をクリックします。](#onupdateframetitle)|フレーム ウィンドウのタイトル バーを更新するために、フレームワークによって呼び出されます。|
|[::再アクティブ化と元に戻す](#reactivateandundo)|アイテムを再アクティブ化し、最後のインプレース編集操作を元にし直します。|
|[をクリックします。](#release)|OLE リンク アイテムへの接続を解放し、開いている場合は閉じます。 クライアント アイテムを破棄しません。|
|[を読み込む](#reload)|への呼び出しの後に`ActivateAs`項目を再読み込みします。|
|[実行します。](#run)|アイテムに関連付けられているアプリケーションを実行します。|
|[次の項目を選択します。](#setdrawaspect)|レンダリングするアイテムの現在のビューを設定します。|
|[を選択します。](#setextent)|OLE アイテムの外接する四角形を設定します。|
|[を選択します。](#sethostnames)|OLE アイテムを編集するときにサーバーが表示する名前を設定します。|
|[を切り取るアイテム::アイコンメタファイル](#seticonicmetafile)|アイテムのアイコンの描画に使用するメタファイルをキャッシュします。|
|[をクリックします。](#setitemrects)|項目の外接する四角形を設定します。|
|[をクリックします。](#setlinkupdateoptions)|リンクアイテムの更新モードを設定します(高度な機能)。|
|[を切り取るアイテム::デバイスを印刷します。](#setprintdevice)|このクライアント項目の印刷対象デバイスを設定します。|
|[をクリックします。](#updatelink)|アイテムのプレゼンテーション キャッシュを更新します。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[をクリックします。](#canactivate)|インプレース アクティブ化が許可されているかどうかを判断するために、フレームワークによって呼び出されます。|
|[を選択します。](#onchangeitemposition)|アイテムの位置が変更されたときに、フレームワークによって呼び出されます。|
|[次の項目を元に戻します。](#ondeactivateandundo)|アクティブ化後に元に戻すために、フレームワークによって呼び出されます。|
|[状態を破棄します。](#ondiscardundostate)|項目の元に戻す状態情報を破棄するために、フレームワークによって呼び出されます。|
|[をクリックします。](#ongetcliprect)|アイテムのクリッピング四角形座標を取得するために、フレームワークによって呼び出されます。|
|[を選択します。](#ongetitemposition)|ビューに対する項目の相対的な位置を取得するために、フレームワークによって呼び出されます。|
|[コンテキストを取得します。](#ongetwindowcontext)|アイテムが所定の位置でアクティブ化されたときに、フレームワークによって呼び出されます。|
|[::オンスクロールバイ](#onscrollby)|ビューに項目をスクロールするフレームワークによって呼び出されます。|
|[をクリックします。](#onshowitem)|OLE アイテムを表示するために、フレームワークによって呼び出されます。|

## <a name="remarks"></a>解説

OLE アイテムは、サーバー アプリケーションによって作成および管理されるデータを表し、ユーザーが単一のドキュメントとして表示されるようにドキュメントに "シームレスに" 組み込むことができます。 その結果、OLE アイテムと含まれているドキュメントで構成される "複合ドキュメント" が作成されます。

OLE アイテムは、埋め込みまたはリンクのいずれかです。 埋め込まれている場合、データは複合ドキュメントの一部として保存されます。 リンクされている場合、そのデータはサーバー アプリケーションによって作成された別のファイルの一部として格納され、そのファイルへのリンクのみが複合ドキュメントに格納されます。 すべての OLE アイテムには、編集するために呼び出すサーバー アプリケーションを指定する情報が含まれています。

`COleClientItem`は、サーバー アプリケーションからの要求に応答して呼び出される、オーバーライド可能な関数をいくつか定義します。これらのオーバーライド可能な機能は、通常、通知として機能します。 これにより、サーバー アプリケーションは、OLE アイテムの編集時にユーザーが行った変更をコンテナーに通知したり、編集中に必要な情報を取得したりできます。

`COleClientItem`クラス[、COle ドキュメント](../../mfc/reference/coledocument-class.md)[、COle リンクDoc、](../../mfc/reference/colelinkingdoc-class.md)または[COleServerDoc](../../mfc/reference/coleserverdoc-class.md)クラスのいずれかで使用できます。 を使用`COleClientItem`するには、クラスを派生させ、項目に対する変更に対するコンテナーの応答方法を定義する[OnChange](#onchange)メンバー関数を実装します。 インプレース アクティブ化をサポートするには、[メンバー](#ongetitemposition)関数をオーバーライドします。 この関数は、OLE アイテムの表示位置に関する情報を提供します。

コンテナー インターフェイスの使用の詳細については、「[コンテナー: コンテナーの実装](../../mfc/containers-implementing-a-container.md)と[アクティブ化](../../mfc/activation-cpp.md)」を参照してください。

> [!NOTE]
> Windows SDK では、埋め込みアイテムとリンクされたアイテムを "オブジェクト" と呼び、アイテムの種類を "クラス" と呼びます。 この参照では、"item" という用語を使用して、対応する C++ オブジェクトと OLE エンティティを区別し、C++ クラスから OLE カテゴリを区別するために "type" という用語を使用します。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxole.h

## <a name="coleclientitemactivate"></a><a name="activate"></a>をアクティブにします。

例外がスローされたときに独自の処理を実行できるように[、DoVerb](#doverb)の代わりに指定された動詞を実行します。

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>パラメーター

*nVerb*<br/>
実行する動詞を指定します。 次のいずれかを指定できます。

|[値]|意味|Symbol|
|-----------|-------------|------------|
|- 0|主動詞|OLEIVERB_PRIMARY|
|- 1|二次動詞|(なし)|
|- 1|編集用のアイテムを表示する|OLEIVERB_SHOW|
|- 2|別のウィンドウでアイテムを編集|OLEIVERB_OPEN|
|- 3|アイテムを非表示にする|OLEIVERB_HIDE|

通常、-1 値は別の動詞の別名です。 オープン編集がサポートされていない場合、-2 の効果は -1 と同じです。 その他の値については、次[を :D参照してください。](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb)

*pビュー*<br/>
OLE アイテムを含むコンテナー ビュー ウィンドウへのポインター。これは、インプレース アクティベーションのためにサーバー アプリケーションで使用されます。 コンテナーがインプレース アクティベーションをサポートしていない場合は、このパラメーターは NULL にする必要があります。

*をクリックします。*<br/>
項目がアクティブ化される原因となったメッセージへのポインター。

### <a name="remarks"></a>解説

サーバー アプリケーションが Microsoft Foundation クラス ライブラリを使用して作成された場合、この関数によって、対応する`COleServerItem`オブジェクトの[OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb)メンバー関数が実行されます。

主動詞が Edit で *、nVerb*パラメータに 0 が指定されている場合、OLE アイテムを編集できるようにサーバー アプリケーションが起動されます。 コンテナー アプリケーションがインプレース アクティベーションをサポートしている場合は、編集を行うことができます。 コンテナーがインプレース アクティブ化をサポートしていない場合 (または Open 動詞が指定されている場合)、サーバーは別のウィンドウで起動され、編集を行うことができます。 通常、コンテナー アプリケーションのユーザーが OLE アイテムをダブルクリックすると *、nVerb*パラメーターの主動詞の値によって、ユーザーが実行できるアクションが決まります。 ただし、サーバーが 1 つのアクションのみをサポートしている場合は *、nVerb*パラメーターで指定された値に関係なく、そのアクションを実行します。

詳細については、次を[:D参照してください。](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb)

## <a name="coleclientitemactivateas"></a><a name="activateas"></a>をアクティブにします。

OLE のオブジェクト変換機能を使用して *、clsidNew*で指定された型の項目であるかのようにアイテムをアクティブにします。

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>パラメーター

*ユーザーの種類*<br/>
"Word 文書" など、ターゲット ユーザーの種類を表す文字列へのポインター。

*クルシドオールド*<br/>
アイテムの現在のクラス ID への参照。 クラス ID は、リンクでない限り、格納されている実際のオブジェクトの型を表す必要があります。 その場合、リンクが参照する項目の CLSID にする必要があります。 [項目](../../mfc/reference/coleconvertdialog-class.md)に対して正しいクラス ID が自動的に提供されます。

*クシド新*<br/>
ターゲット クラス ID への参照。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

これは[、:D 自動的](../../mfc/reference/coleconvertdialog-class.md#doconvert)に呼び出されます。 通常は直接呼び出されません。

## <a name="coleclientitemattachdataobject"></a><a name="attachdataobject"></a>オブジェクトをアタッチします。

OLE アイテムのデータにアクセスするための[COleDataObject](../../mfc/reference/coledataobject-class.md)を初期化します。

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>パラメーター

*オブジェクト*<br/>
OLE アイテム`COleDataObject`内のデータにアクセスできるように初期化されるオブジェクトへの参照。

## <a name="coleclientitemcanactivate"></a><a name="canactivate"></a>をクリックします。

OLE アイテムのインプレース アクティブ化を要求したときに、フレームワークによって呼び出されます。この関数の戻り値は、インプレースアクティベーションが許可されるかどうかを決定します。

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>戻り値

インプレース アクティブ化が許可されている場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

既定の実装では、コンテナーに有効なウィンドウがある場合に、インプレース アクティブ化を許可します。 アクティブ化要求を受け入れるか拒否するための特別なロジックを実装するには、この関数をオーバーライドします。 たとえば、OLE アイテムが小さすぎる場合や現在表示されていない場合、アクティブ化要求を拒否できます。

詳細については、Windows SDK[の「IOleInPlace サイト::CanInPlaceActivate」](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate)を参照してください。

## <a name="coleclientitemcancreatefromdata"></a><a name="cancreatefromdata"></a>データを作成します。

コンテナアプリケーションが特定`COleDataObject`のオブジェクトから埋め込みオブジェクトを作成できるかどうかを確認します。

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>パラメーター

*オブジェクト*<br/>
OLE アイテムの作成元の[オブジェクト](../../mfc/reference/coledataobject-class.md)へのポインター。

### <a name="return-value"></a>戻り値

コンテナーがオブジェクトから埋め込みオブジェクトを作成できる`COleDataObject`場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

この`COleDataObject`クラスは、クリップボードから、ドラッグ アンド ドロップ、または埋め込み OLE アイテムからさまざまな形式のデータを取得するためのデータ転送で使用されます。

コンテナはこの機能を使用して、[貼り付けの編集] コマンドおよび [形式を選択して貼り付け貼り付け] コマンドを有効または無効にできます。

詳細については、「[データ オブジェクトとデータ ソース (OLE)」](../../mfc/data-objects-and-data-sources-ole.md)を参照してください。

## <a name="coleclientitemcancreatelinkfromdata"></a><a name="cancreatelinkfromdata"></a>データを作成します。

コンテナ アプリケーションが、指定された`COleDataObject`オブジェクトからリンク オブジェクトを作成できるかどうかを確認します。

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>パラメーター

*オブジェクト*<br/>
OLE アイテムの作成元の[オブジェクト](../../mfc/reference/coledataobject-class.md)へのポインター。

### <a name="return-value"></a>戻り値

コンテナがオブジェクトからリンク オブジェクトを作成できる場合は`COleDataObject`、0 以外の値を返します。

### <a name="remarks"></a>解説

この`COleDataObject`クラスは、クリップボードから、ドラッグ アンド ドロップ、または埋め込み OLE アイテムからさまざまな形式のデータを取得するためのデータ転送で使用されます。

コンテナはこの機能を使用して、[形式を選択して貼り付け貼り付け]コマンドと[リンクを編集]コマンドを有効または無効にできます。

詳細については、「[データ オブジェクトとデータ ソース (OLE)」](../../mfc/data-objects-and-data-sources-ole.md)を参照してください。

## <a name="coleclientitemcanpaste"></a><a name="canpaste"></a>をクリックします。

埋め込まれた OLE アイテムをクリップボードから貼り付けることができるかどうかを確認します。

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>戻り値

埋め込み OLE アイテムをクリップボードから貼り付けることができる場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

詳細については、「Windows SDK[の OleGet クリップボード](/windows/win32/api/ole2/nf-ole2-olegetclipboard)と[OleQueryCreateFromData」](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata)を参照してください。

## <a name="coleclientitemcanpastelink"></a><a name="canpastelink"></a>をクリックします。

リンクされた OLE アイテムをクリップボードから貼り付けることができるかどうかを確認します。

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>戻り値

リンクされた OLE アイテムをクリップボードから貼り付けることができる場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

詳細については、Windows SDK[の「OleGet クリップボード](/windows/win32/api/ole2/nf-ole2-olegetclipboard)と[OleQueryLinkFromData」](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata)を参照してください。

## <a name="coleclientitemclose"></a><a name="close"></a>をクリックします。

OLE アイテムの状態を実行状態から読み込まれた状態に変更します。

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
OLE アイテムが読み込まれた状態に戻ったときに、どのような状況で OLE アイテムが保存されるのかを指定するフラグ。 次のいずれかの値になります。

- OLECLOSE_SAVEIFDIRTY OLE アイテムを保存します。

- OLECLOSE_NOSAVE OLE アイテムを保存しません。

- OLECLOSE_PROMPTSAVE OLE アイテムを保存するかどうかをユーザーに確認します。

### <a name="remarks"></a>解説

この関数は、OLE アイテムが実行されていない場合には無効です。

詳細については、次を[参照してください。](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close)

## <a name="coleclientitemcoleclientitem"></a><a name="coleclientitem"></a>をクリックします。

オブジェクトを`COleClientItem`構築し、C++ オブジェクトのみを構築し、OLE 初期化を実行しないドキュメントアイテムのコンテナー ドキュメントのコレクションに追加します。

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
この項目を含むコンテナー ドキュメントへのポインター。 これは、任意の[COleDocument](../../mfc/reference/coledocument-class.md)派生関数を指定できます。

### <a name="remarks"></a>解説

NULL ポインターを渡した場合、コンテナー ドキュメントに追加は行われなくなります。 明示的に[呼](../../mfc/reference/coledocument-class.md#additem)び出す必要があります。

OLE アイテムを使用する前に、次の作成メンバー関数のいずれかを呼び出す必要があります。

- [クリップボードから作成](#createfromclipboard)

- [データを作成します。](#createfromdata)

- [ファイルから作成します。](#createfromfile)

- [クリップボードから静的な作成](#createstaticfromclipboard)

- [データを作成します。](#createstaticfromdata)

- [クリップボードからリンクを作成します。](#createlinkfromclipboard)

- [データからリンクを作成します。](#createlinkfromdata)

- [ファイルからリンクを作成します。](#createlinkfromfile)

- [新しいアイテムの作成](#createnewitem)

- [作成クローンから](#createclonefrom)

## <a name="coleclientitemconvertto"></a><a name="convertto"></a>をクリックします。

このメンバー関数を呼び出して、項目を*clsidNew*で指定された型に変換します。

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>パラメーター

*クシド新*<br/>
対象の型のクラス ID。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

これは、[自動的](../../mfc/reference/coleconvertdialog-class.md)に呼び出されます。 直接呼び出す必要はありません。

## <a name="coleclientitemcopytoclipboard"></a><a name="copytoclipboard"></a>クリップボードへコピーします。

OLE アイテムをクリップボードにコピーします。

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>パラメーター

*bインクルードリンク*<br/>
リンク情報をクリップボードにコピーし、リンクアイテムを貼り付けできるようにする場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

通常、この関数は、[編集] メニューから Copy コマンドまたは Cut コマンドのメッセージ ハンドラーを記述するときに呼び出します。 Copy コマンドまたは Cut コマンドを実装する場合は、コンテナー アプリケーションで項目選択を実装する必要があります。

詳細については、Windows SDK[の「OleSet クリップボード](/windows/win32/api/ole2/nf-ole2-olesetclipboard)」を参照してください。

## <a name="coleclientitemcreateclonefrom"></a><a name="createclonefrom"></a>::作成からクローン

指定した OLE アイテムのコピーを作成します。

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
複製する OLE アイテムへのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

コピーはソースアイテムと同じです。 この関数を使用すると、元に戻す操作をサポートできます。

## <a name="coleclientitemcreatefromclipboard"></a><a name="createfromclipboard"></a>クリップボードから作成します。

クリップボードの内容から埋め込みアイテムを作成します。

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*レンダリング*<br/>
サーバーが OLE アイテムをレンダリングする方法を指定するフラグ。 指定できる値については、Windows SDK の[「OLERENDER」](/windows/win32/api/oleidl/ne-oleidl-olerender)を参照してください。

*cf フォーマット*<br/>
OLE アイテムの作成時にキャッシュされるクリップボード データ形式を指定します。

*フォーマットの問題*<br/>
*レンダリング*がOLERENDER_FORMATまたはOLERENDER_DRAWの場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *cfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定します。 このパラメーターを省略すると、構造体の他のフィールドにデフォルト値が`FORMATETC`使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

通常、この関数は、[編集] メニューの [貼り付け] コマンドのメッセージ ハンドラーから呼び出します。 [(CanPaste](#canpaste)メンバー関数が 0 以外を返す場合は、フレームワークによって [貼り付け] コマンドが有効になります)。

詳細については、Windows SDK[の「OLE レンダリング](/windows/win32/api/oleidl/ne-oleidl-olerender)と[フォーマットの作成](/windows/win32/api/objidl/ns-objidl-formatetc)」を参照してください。

## <a name="coleclientitemcreatefromdata"></a><a name="createfromdata"></a>データを作成します。

`COleDataObject`オブジェクトから埋め込みアイテムを作成します。

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*オブジェクト*<br/>
OLE アイテムの作成元の[オブジェクト](../../mfc/reference/coledataobject-class.md)へのポインター。

*レンダリング*<br/>
サーバーが OLE アイテムをレンダリングする方法を指定するフラグ。 指定できる値については、Windows SDK の[「OLERENDER」](/windows/win32/api/oleidl/ne-oleidl-olerender)を参照してください。

*cf フォーマット*<br/>
OLE アイテムの作成時にキャッシュされるクリップボード データ形式を指定します。

*フォーマットの問題*<br/>
*レンダリング*がOLERENDER_FORMATまたはOLERENDER_DRAWの場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *cfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定します。 このパラメーターを省略すると、構造体の他のフィールドにデフォルト値が`FORMATETC`使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

クリップボードからの貼り付けやドラッグ アンド ドロップ操作などのデータ転送操作は、サーバー`COleDataObject`アプリケーションから提供される情報を含むオブジェクトを提供します。 通常は[、CView::OnDrop](../../mfc/reference/cview-class.md#ondrop)のオーバーライドで使用されます。

詳細については、Windows SDK[の「OLECREATEFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata) [、OLE レンダリング](/windows/win32/api/oleidl/ne-oleidl-olerender)、および[フォーマット」](/windows/win32/api/objidl/ns-objidl-formatetc)を参照してください。

## <a name="coleclientitemcreatefromfile"></a><a name="createfromfile"></a>ファイルから作成します。

ファイルから埋め込み OLE アイテムを作成します。

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*ファイル名*<br/>
OLE アイテムの作成元となるファイルの名前へのポインター。

*Clsid*<br/>
将来利用するために予約されています。

*レンダリング*<br/>
サーバーが OLE アイテムをレンダリングする方法を指定するフラグ。 指定できる値については、Windows SDK の[「OLERENDER」](/windows/win32/api/oleidl/ne-oleidl-olerender)を参照してください。

*cf フォーマット*<br/>
OLE アイテムの作成時にキャッシュされるクリップボード データ形式を指定します。

*フォーマットの問題*<br/>
*レンダリング*がOLERENDER_FORMATまたはOLERENDER_DRAWの場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *cfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定します。 このパラメーターを省略すると、構造体の他のフィールドにデフォルト値が`FORMATETC`使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

フレームワークは、ユーザーが [ファイルから作成] ボタンが選択されているときに [オブジェクトの挿入] ダイアログ ボックスから [OK] を選択した場合[、COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem)からこの関数を呼び出します。

詳細については、Windows SDK[の「ファイルの作成](/windows/win32/api/ole/nf-ole-olecreatefromfile)[、OLE レンダリング](/windows/win32/api/oleidl/ne-oleidl-olerender)、および[フォーマット」](/windows/win32/api/objidl/ns-objidl-formatetc)を参照してください。

## <a name="coleclientitemcreatelinkfromclipboard"></a><a name="createlinkfromclipboard"></a>クリップボードからリンクを作成します。

クリップボードの内容からリンク アイテムを作成します。

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*レンダリング*<br/>
サーバーが OLE アイテムをレンダリングする方法を指定するフラグ。 指定できる値については、Windows SDK の[「OLERENDER」](/windows/win32/api/oleidl/ne-oleidl-olerender)を参照してください。

*cf フォーマット*<br/>
OLE アイテムの作成時にキャッシュされるクリップボード データ形式を指定します。

*フォーマットの問題*<br/>
*レンダリング*がOLERENDER_FORMATまたはOLERENDER_DRAWの場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *cfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定します。 このパラメーターを省略すると、構造体の他のフィールドにデフォルト値が`FORMATETC`使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

通常、この関数は、[編集] メニューの [リンク貼り付け] コマンドのメッセージ ハンドラーから呼び出します。 (クリップボードにリンクできる OLE アイテムが含まれている場合は[、COleDocument](../../mfc/reference/coledocument-class.md)の既定の実装で [リンク貼り付け] コマンドが有効になります)。

詳細については、Windows SDK[の「OLE レンダリング](/windows/win32/api/oleidl/ne-oleidl-olerender)と[フォーマットの作成](/windows/win32/api/objidl/ns-objidl-formatetc)」を参照してください。

## <a name="coleclientitemcreatelinkfromdata"></a><a name="createlinkfromdata"></a>データからリンクを作成します。

`COleDataObject`オブジェクトからリンク アイテムを作成します。

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*オブジェクト*<br/>
OLE アイテムの作成元の[オブジェクト](../../mfc/reference/coledataobject-class.md)へのポインター。

*レンダリング*<br/>
サーバーが OLE アイテムをレンダリングする方法を指定するフラグ。 指定できる値については、Windows SDK の[「OLERENDER」](/windows/win32/api/oleidl/ne-oleidl-olerender)を参照してください。

*cf フォーマット*<br/>
OLE アイテムの作成時にキャッシュされるクリップボード データ形式を指定します。

*フォーマットの問題*<br/>
*レンダリング*がOLERENDER_FORMATまたはOLERENDER_DRAWの場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *cfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定します。 このパラメーターを省略すると、構造体の他のフィールドにデフォルト値が`FORMATETC`使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

ユーザーがリンクを作成する必要があることを示すときに、ドロップ操作中に呼び出します。 また、[貼り付け] コマンドの処理にも使用できます。 これは、リンク オプションが選択`COleClientItem::CreateLinkFromClipboard`されている場合に[、フレームワーク](../../mfc/reference/colepastespecialdialog-class.md#createitem)によって呼び出されます。

詳細については、Windows SDK[の「OLE](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata)[レンダリング](/windows/win32/api/oleidl/ne-oleidl-olerender)」および[「フォーマット」](/windows/win32/api/objidl/ns-objidl-formatetc)を参照してください。

## <a name="coleclientitemcreatelinkfromfile"></a><a name="createlinkfromfile"></a>ファイルからリンクを作成します。

ファイルからリンクされた OLE アイテムを作成します。

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*ファイル名*<br/>
OLE アイテムの作成元となるファイルの名前へのポインター。

*レンダリング*<br/>
サーバーが OLE アイテムをレンダリングする方法を指定するフラグ。 指定できる値については、Windows SDK の[「OLERENDER」](/windows/win32/api/oleidl/ne-oleidl-olerender)を参照してください。

*cf フォーマット*<br/>
OLE アイテムの作成時にキャッシュされるクリップボード データ形式を指定します。

*フォーマットの問題*<br/>
*レンダリング*がOLERENDER_FORMATまたはOLERENDER_DRAWの場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *cfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定します。 このパラメーターを省略すると、構造体の他のフィールドにデフォルト値が`FORMATETC`使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

[ファイルから作成] ボタンが選択され、[リンク] チェック ボックスがオンになっている場合に、ユーザーが [オブジェクトの挿入] ダイアログ ボックスから [OK] を選択した場合、フレームワークは、この関数を呼び出します。 これは、から呼び出[されます。](../../mfc/reference/coleinsertdialog-class.md#createitem)

詳細については、Windows SDK[の「OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile) [、OLERENDER、](/windows/win32/api/oleidl/ne-oleidl-olerender)および[フォーマット」](/windows/win32/api/objidl/ns-objidl-formatetc)を参照してください。

## <a name="coleclientitemcreatenewitem"></a><a name="createnewitem"></a>をクリックします。

埋め込みアイテムを作成します。この関数は、OLE アイテムを作成できるサーバー アプリケーションを起動します。

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*Clsid*<br/>
作成する OLE アイテムの種類を一意に識別する ID。

*レンダリング*<br/>
サーバーが OLE アイテムをレンダリングする方法を指定するフラグ。 指定できる値については、Windows SDK の[「OLERENDER」](/windows/win32/api/oleidl/ne-oleidl-olerender)を参照してください。

*cf フォーマット*<br/>
OLE アイテムの作成時にキャッシュされるクリップボード データ形式を指定します。

*フォーマットの問題*<br/>
*レンダリング*がOLERENDER_FORMATまたはOLERENDER_DRAWの場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *cfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定します。 このパラメーターを省略すると、構造体の他のフィールドにデフォルト値が`FORMATETC`使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

[新規作成] ボタンを選択したときにユーザーが [オブジェクトの挿入] ダイアログ ボックスから [OK] を選択した場合、フレームワークはこの関数を呼び出します。

詳細については、Windows SDK[の「OLE 作成](/windows/win32/api/ole/nf-ole-olecreate)[、OLE レンダリング](/windows/win32/api/oleidl/ne-oleidl-olerender)、および[フォーマット」](/windows/win32/api/objidl/ns-objidl-formatetc)を参照してください。

## <a name="coleclientitemcreatestaticfromclipboard"></a><a name="createstaticfromclipboard"></a>クリップボードから静的なアイテムを作成します。

クリップボードの内容から静的なアイテムを作成します。

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*レンダリング*<br/>
サーバーが OLE アイテムをレンダリングする方法を指定するフラグ。 指定できる値については、Windows SDK の[「OLERENDER」](/windows/win32/api/oleidl/ne-oleidl-olerender)を参照してください。

*cf フォーマット*<br/>
OLE アイテムの作成時にキャッシュされるクリップボード データ形式を指定します。

*フォーマットの問題*<br/>
*レンダリング*がOLERENDER_FORMATまたはOLERENDER_DRAWの場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *cfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定します。 このパラメーターを省略すると、構造体の他のフィールドにデフォルト値が`FORMATETC`使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

静的アイテムにはプレゼンテーション データが含まれますが、ネイティブ データは含まれません。したがって、編集できません。 通常、この関数は[、メンバー関数が](#createfromclipboard)失敗した場合に呼び出します。

詳細については、Windows SDK[の「OLE レンダリング](/windows/win32/api/oleidl/ne-oleidl-olerender)と[フォーマットの作成](/windows/win32/api/objidl/ns-objidl-formatetc)」を参照してください。

## <a name="coleclientitemcreatestaticfromdata"></a><a name="createstaticfromdata"></a>データから生成します。

`COleDataObject`オブジェクトから静的な項目を作成します。

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*オブジェクト*<br/>
OLE アイテムの作成元の[オブジェクト](../../mfc/reference/coledataobject-class.md)へのポインター。

*レンダリング*<br/>
サーバーが OLE アイテムをレンダリングする方法を指定するフラグ。 指定できる値については、Windows SDK の[「OLERENDER」](/windows/win32/api/oleidl/ne-oleidl-olerender)を参照してください。

*cf フォーマット*<br/>
OLE アイテムの作成時にキャッシュされるクリップボード データ形式を指定します。

*フォーマットの問題*<br/>
*レンダリング*がOLERENDER_FORMATまたはOLERENDER_DRAWの場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *cfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定します。 このパラメーターを省略すると、構造体の他のフィールドにデフォルト値が`FORMATETC`使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

静的アイテムにはプレゼンテーション データが含まれますが、ネイティブ データは含まれません。したがって、編集できません。 これは、静的アイテムがクリップボードからだけでなく、任意のから`COleDataObject`作成できる点を除いて、基本的には[CreateStaticFromClipboard](#createstaticfromclipboard)と同じです。

静的が選択されている場合[は、クリックして](../../mfc/reference/colepastespecialdialog-class.md#createitem)使用します。

詳細については、Windows SDK[の「OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata) [、OLERENDER、](/windows/win32/api/oleidl/ne-oleidl-olerender)および[フォーマット」](/windows/win32/api/objidl/ns-objidl-formatetc)を参照してください。

## <a name="coleclientitemdeactivate"></a><a name="deactivate"></a>クライアント アイテム::Dアクティブ化

OLE アイテムを非アクティブ化し、関連付けられているリソースを解放します。

```
void Deactivate();
```

### <a name="remarks"></a>解説

通常、ユーザーがアイテムの境界外のクライアント領域でマウスをクリックすると、インプレース アクティブな OLE アイテムを非アクティブ化します。 OLE アイテムを非アクティブにすると、元に戻す状態が破棄され[、ReactivateAndUndo](#reactivateandundo)メンバー関数を呼び出すことができなくなります。

アプリケーションが元に戻す機能をサポート`Deactivate`している場合は、呼び出しません。代わりに[、DeactivateUI](#deactivateui)を呼び出します。

詳細[については、](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate)次を参照してください。

## <a name="coleclientitemdeactivateui"></a><a name="deactivateui"></a>:Dアクティブ化UI

ユーザーがインプレースでアクティブ化された項目を非アクティブ化するときに、この関数を呼び出します。

```
void DeactivateUI();
```

### <a name="remarks"></a>解説

この関数は、コンテナー アプリケーションのユーザー インターフェイスを元の状態に戻し、インプレース アクティブ化用に作成されたメニューやその他のコントロールを非表示にします。

この関数は、項目の元に戻す状態情報をフラッシュしません。 その情報は保持されるため、項目を非アクティブ化した直後にコンテナーの undo コマンドが選択された場合に備えて、後でサーバー アプリケーションで元に戻すコマンドを実行するために[ReactivateAndUndo](#reactivateandundo)を使用できます。

詳細[については、](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate)次を参照してください。

## <a name="coleclientitemdelete"></a><a name="delete"></a>クライアントアイテム::D

コンテナ ドキュメントから OLE アイテムを削除します。

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>パラメーター

*b自動削除*<br/>
アイテムをドキュメントから削除するかどうかを指定します。

### <a name="remarks"></a>解説

この関数は[Release](#release)メンバー関数を呼び出し、アイテムの C++ オブジェクトを削除し、OLE アイテムをドキュメントから完全に削除します。 OLE アイテムが埋め込まれている場合、そのアイテムのネイティブ データは削除されます。 常に実行中のサーバーを閉じます。したがって、アイテムが開いているリンクの場合、この関数はそれを閉じます。

## <a name="coleclientitemdodragdrop"></a><a name="dodragdrop"></a>クライアントアイテム::Doドラッグドロップ

メンバー関数`DoDragDrop`を呼び出してドラッグ アンド ドロップ操作を実行します。

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
クライアント座標 (ピクセル単位) での画面上のアイテムの四角形。

*ptオフセット*<br/>
ドラッグ時にマウスの位置が位置していた*lpItemRect*からのオフセット。

*bインクルードリンク*<br/>
リンク データをクリップボードにコピーする場合は、この値を TRUE に設定します。 サーバー アプリケーションがリンクをサポートしていない場合は、FALSE に設定します。

*dw エフェクト*<br/>
ドラッグ操作でドラッグソースが許可する効果を決定します。

*ドラッグを開始します。*<br/>
ドラッグが実際に開始される位置を定義する四角形へのポインター。 詳細については、「解説」を参照してください。

### <a name="return-value"></a>戻り値

ドロップエフェクト値。 DROPEFFECT_MOVE場合は、元のデータを削除する必要があります。

### <a name="remarks"></a>解説

ドラッグ アンド ドロップ操作はすぐには開始されません。 このオブジェクトは *、lpRectStartDrag*で指定された四角形からマウス カーソルが離れるまで、または指定されたミリ秒数が経過するまで待機します。 *lpRectStartDrag*が NULL の場合、四角形のサイズは 1 ピクセルです。

遅延時間は、レジストリ キーの設定で指定します。 遅延時間を変更するには[、CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring)または[CWinApp::WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint)を呼び出します。 遅延時間を指定しない場合は、デフォルト値の 200 ミリ秒が使用されます。 ドラッグ遅延時間は次のように保存されます。

- Windows NT ドラッグ遅延時間は、HKEY_LOCAL_MACHINE\ソフトウェア\Windows\NT\現在のバージョン\IniFileMapping\win.ini\Windows\ドラッグディレイに保存されます。

- ウィンドウズ 3.x ドラッグ遅延時間は WIN に格納されます。INI ファイル、[ウィンドウ] セクションの下。

- Windows 95/98 ドラッグ遅延時間は、キャッシュされたバージョンの WIN に格納されます。Ini。

レジストリまたは .INI ファイルを[参照してください](/windows/win32/api/winbase/nf-winbase-writeprofilestringw)。

## <a name="coleclientitemdoverb"></a><a name="doverb"></a>:D をクリックします。

指定`DoVerb`された動詞を実行する呼び出し。

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>パラメーター

*nVerb*<br/>
実行する動詞を指定します。 次のいずれかを含めることができます。

|[値]|意味|Symbol|
|-----------|-------------|------------|
|- 0|主動詞|OLEIVERB_PRIMARY|
|- 1|二次動詞|(なし)|
|- 1|編集用のアイテムを表示する|OLEIVERB_SHOW|
|- 2|別のウィンドウでアイテムを編集|OLEIVERB_OPEN|
|- 3|アイテムを非表示にする|OLEIVERB_HIDE|

通常、-1 値は別の動詞の別名です。 オープン編集がサポートされていない場合、-2 の効果は -1 と同じです。 その他の値については、次[を :D参照してください。](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb)

*pビュー*<br/>
ビュー ウィンドウへのポインター。これは、インプレース アクティベーションのためにサーバーによって使用されます。 コンテナー アプリケーションでインプレース アクティブ化が許可されていない場合は、このパラメーターは NULL にする必要があります。

*をクリックします。*<br/>
項目がアクティブ化される原因となったメッセージへのポインター。

### <a name="return-value"></a>戻り値

動詞が正常に実行された場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

この関数は[、Activate](#activate)メンバー関数を呼び出して動詞を実行します。 また、例外をキャッチし、スローされた場合にユーザーにメッセージ ボックスを表示します。

主動詞が Edit で *、nVerb*パラメータに 0 が指定されている場合、OLE アイテムを編集できるようにサーバー アプリケーションが起動されます。 コンテナー アプリケーションがインプレース アクティベーションをサポートしている場合は、編集を行うことができます。 コンテナーがインプレース アクティブ化をサポートしていない場合 (または Open 動詞が指定されている場合)、サーバーは別のウィンドウで起動され、編集を行うことができます。 通常、コンテナー アプリケーションのユーザーが OLE アイテムをダブルクリックすると *、nVerb*パラメーターの主動詞の値によって、ユーザーが実行できるアクションが決まります。 ただし、サーバーが 1 つのアクションのみをサポートしている場合は *、nVerb*パラメーターで指定された値に関係なく、そのアクションを実行します。

## <a name="coleclientitemdraw"></a><a name="draw"></a>:Dロー

指定したデバイス コンテキストを使用して、指定した外接する四角形に OLE アイテムを描画します。

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
OLE アイテムの描画に使用される[CDC](../../mfc/reference/cdc-class.md)オブジェクトへのポインター。

*lpBounds*<br/>
(デバイス コンテキストによって決定される論理`RECT`単位で) OLE アイテムを描画する境界の四角形を定義する[CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは構造体へのポインター。

*アスペクト*<br/>
OLE アイテムの表示方法、つまり OLE アイテムの表示方法を指定します。 *nDrawAspect*が -1 の場合は、SetDrawAspect を使用して設定された最後[のアスペクト](#setdrawaspect)が使用されます。 このフラグの可能な値の詳細については、「 [SetDrawAspect](#setdrawaspect)」を参照してください。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

この関数は、 の[OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw)メンバー関数によって作成された OLE アイテムの`COleServerItem`メタファイル表現を使用できます。

通常は、`Draw`画面表示に使用し、画面デバイス コンテキストを*pDC*として渡します。 この場合、最初の 2 つのパラメーターのみを指定する必要があります。

*lpBounds*パラメーターは、ターゲット デバイス コンテキスト内の四角形を識別します (現在のマッピング モードに対して相対的)。 レンダリングには画像のスケーリングが含まれる場合があり、表示されるビューと最終的な印刷イメージの間で拡大縮小するビューをコンテナー アプリケーションで使用できます。

詳細については、Windows SDK[の「IViewObject::Draw」](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw)を参照してください。

## <a name="coleclientitemgetactiveview"></a><a name="getactiveview"></a>をクリックします。

アイテムがインプレースアクティブになっているビューを返します。

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>戻り値

ビューへのポインター。それ以外の場合は NULL、項目は、インプレースアクティブ化されません。

## <a name="coleclientitemgetcachedextent"></a><a name="getcachedextent"></a>を選択します。

OLE アイテムのサイズを取得します。

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>パラメーター

*lp サイズ*<br/>
サイズ情報を`SIZE`受け取る構造体または[CSize](../../atl-mfc-shared/reference/csize-class.md)オブジェクトへのポインター。

*アスペクト*<br/>
境界を取得する OLE アイテムのアスペクトを指定します。 可能な値については、「[を参照](#setdrawaspect)してください。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外。OLE アイテムが空白の場合は 0。

### <a name="remarks"></a>解説

この関数は[、GetExtent](#getextent)と同じ情報を提供します。 ただし[、OnChange](#onchange)`GetCachedExtent`などの他の OLE ハンドラの処理中にエクステント情報を取得するために呼び出すことができます。 寸法はMM_HIMETRIC単位です。

これは、この項目`GetCachedExtent`の範囲を取得するのに[は、IOleObject インターフェイスを使用するのではなく、IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2)インターフェイスを使用するため、可能です。 [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject) COM`IViewObject2`オブジェクトは、IViewObject::Draw への以前の呼び出しで使用[された](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw)エクステント情報をキャッシュします。

詳細については、Windows SDK[の IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent)を参照してください。

## <a name="coleclientitemgetclassid"></a><a name="getclassid"></a>を選択します。

項目のクラス ID を*pClassID*が指すメモリに返します。

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>パラメーター

*クラスID*<br/>
クラス ID を取得するための[CLSID](/windows/win32/com/clsid-key-hklm)型の識別子へのポインター。 CLSID の詳細については、Windows SDK を参照してください。

### <a name="remarks"></a>解説

クラス ID は、項目を編集するアプリケーションを一意に識別する 128 ビットの数値です。

詳細については、Windows SDK の[「IPersist::GetClassID」](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid)を参照してください。

## <a name="coleclientitemgetclipboarddata"></a><a name="getclipboarddata"></a>を取得します。

[CopyToClipboard](#copytoclipboard)メンバー関数`COleDataSource`の呼び出しによってクリップボードに格納されるすべてのデータを格納しているオブジェクトを取得します。

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>パラメーター

*を使用します。*<br/>
OLE アイテムに含まれるデータを受け取る[COleDataSource](../../mfc/reference/coledatasource-class.md)オブジェクトへのポインター。

*bインクルードリンク*<br/>
リンク データを含める必要がある場合は TRUE。それ以外の場合は FALSE。

*を指定します。*<br/>
オブジェクトの原点からのマウス カーソルのオフセット (ピクセル単位)。

*lp サイズ*<br/>
オブジェクトのサイズ (ピクセル単位)。

### <a name="remarks"></a>解説

`GetClipboardData`は、既定の実装として呼び出[されます](#ongetclipboarddata)。 によって`OnGetClipboardData``CopyToClipboard`提供されるデータ形式に加えて、データ形式を提供する場合にのみオーバーライドします。 これらの書式を呼び`COleDataSource`出す前または呼`CopyToClipboard`び出し後に`COleDataSource`オブジェクトに配置し、オブジェクトを[COleDataSource::SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard)関数に渡します。 たとえば、コンテナドキュメント内の OLE アイテムの位置をクリップボードに追加する場合は、その情報を渡すための独自の形式を定義し、 呼び出す`COleDataSource``CopyToClipboard`前に に格納します。

## <a name="coleclientitemgetdocument"></a><a name="getdocument"></a>を取得します。

OLE アイテムを含むドキュメントへのポインターを取得します。

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>戻り値

OLE アイテムを含むドキュメントへのポインター。 アイテムがドキュメントの一部でない場合は NULL。

### <a name="remarks"></a>解説

このポインターを使用すると、`COleDocument``COleClientItem`コンストラクターに引数として渡したオブジェクトにアクセスできます。

## <a name="coleclientitemgetdrawaspect"></a><a name="getdrawaspect"></a>次の項目を取得します。

メンバー関数`GetDrawAspect`を呼び出して、アイテムの現在の "アスペクト" または ビューを確認します。

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>戻り値

値が[SetDrawAspect](#setdrawaspect)の参照に一覧表示されている DVASPECT 列挙体の値。

### <a name="remarks"></a>解説

アスペクトは、アイテムのレンダリング方法を指定します。

## <a name="coleclientitemgetextent"></a><a name="getextent"></a>を取得します。

OLE アイテムのサイズを取得します。

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>パラメーター

*lp サイズ*<br/>
サイズ情報を`SIZE`受け取`CSize`る構造体またはオブジェクトへのポインター。

*アスペクト*<br/>
境界を取得する OLE アイテムのアスペクトを指定します。 可能な値については、「[を参照](#setdrawaspect)してください。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外。OLE アイテムが空白の場合は 0。

### <a name="remarks"></a>解説

サーバー アプリケーションが Microsoft Foundation クラス ライブラリを使用して作成された場合、この関数によって、対応する`COleServerItem`オブジェクトの[OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent)メンバー関数が呼び出されます。 取得したサイズは[SetExtent](#setextent)メンバー関数によって最後に設定されたサイズと異なる場合があります。指定されたサイズ`SetExtent`は、提案として扱われます。 寸法はMM_HIMETRIC単位です。

> [!NOTE]
> [OnChange](#onchange)`GetExtent`などの OLE ハンドラの処理中は呼び出しません。 代わりに[GetCachedExtent を](#getcachedextent)呼び出します。

詳細については、次を[参照](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent)してください。

## <a name="coleclientitemgeticonfromregistry"></a><a name="geticonfromregistry"></a>レジストリを取得します。

特定の CLSID のサーバーに関連付けられたアイコン リソースへのハンドルを取得します。

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>パラメーター

*Clsid*<br/>
アイコンに関連付けられたサーバーの CLSID への参照。

### <a name="return-value"></a>戻り値

アイコン リソースへの有効なハンドル、またはサーバーのアイコンまたは既定のアイコンが見つからない場合は NULL。

### <a name="remarks"></a>解説

このメンバー関数は、サーバーが既に実行されている場合でも、サーバーを起動したり、アイコンを動的に取得したりしません。 代わりに、このメンバー関数は、サーバーの実行可能イメージを開き、登録されたサーバーに関連付けられた静的アイコンを取得します。

## <a name="coleclientitemgeticonicmetafile"></a><a name="geticonicmetafile"></a>をクリックします。

項目のアイコンの描画に使用するメタファイルを取得します。

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>戻り値

正常終了した場合はメタファイルへのハンドル。それ以外の場合は NULL。

### <a name="remarks"></a>解説

現在のアイコンがない場合は、既定のアイコンが返されます。 これは MFC/OLE ダイアログによって自動的に呼び出され、通常は直接呼び出されません。

この関数は、後で使用するためにメタファイルをキャッシュするために[SetIconicMetafile](#seticonicmetafile)を呼び出します。

## <a name="coleclientitemgetinplacewindow"></a><a name="getinplacewindow"></a>ウィンドウを取得します。

埋め`GetInPlaceWindow`込み先編集用に項目が開かれているウィンドウへのポインターを取得するには、メンバー関数を呼び出します。

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>戻り値

アイテムの埋め込み先編集ウィンドウへのポインター。アイテムがアクティブでない場合、またはサーバーが使用できない場合は NULL です。

### <a name="remarks"></a>解説

この関数は、インプレースアクティブなアイテムに対してのみ呼び出す必要があります。

## <a name="coleclientitemgetitemstate"></a><a name="getitemstate"></a>をクリックします。

OLE アイテムの現在の状態を取得します。

```
UINT GetItemState() const;
```

### <a name="return-value"></a>戻り値

列挙`COleClientItem::ItemState`値は、次のいずれかになります。 `emptyState` `loadedState` `openState` `activeState` `activeUIState` これらの状態の詳細については、「[コンテナー: クライアント アイテムの状態](../../mfc/containers-client-item-states.md)」を参照してください。

### <a name="remarks"></a>解説

OLE アイテムの状態が変更されたときに通知を受け取るために[、OnChange](#onchange)メンバー関数を使用します。

詳細については、「[コンテナ: クライアント アイテムの状態](../../mfc/containers-client-item-states.md)」を参照してください。

## <a name="coleclientitemgetlaststatus"></a><a name="getlaststatus"></a>を取得します。

最後の OLE 操作の状態コードを返します。

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>戻り値

SCODE 値。

### <a name="remarks"></a>解説

BOOL 値が FALSE を返すメンバー関数、または NULL を返`GetLastStatus`すその他のメンバー関数の場合、より詳細なエラー情報が返されます。 ほとんどの OLE メンバー関数は、より重大なエラーに対して例外をスローします。 SCODE の解釈に関する具体的な情報は、SCODE 値を最後に返した基になる OLE 呼び出しによって異なります。

SCODE の詳細については、Windows SDK のドキュメント[の COM エラー コードの構造](/windows/win32/com/structure-of-com-error-codes)を参照してください。

## <a name="coleclientitemgetlinkupdateoptions"></a><a name="getlinkupdateoptions"></a>を選択します。

OLE アイテムのリンク更新オプションの現在の値を取得します。

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>戻り値

次のいずれかの値:

- OLEUPDATE_ALWAYS リンクされたアイテムを可能な限り更新します。 このオプションは、[リンク] ダイアログ ボックスの [リンク更新の自動更新] オプション ボタンをサポートします。

- OLEUPDATE_ONCALL コンテナー アプリケーションからの要求のみでリンク アイテムを更新します[(UpdateLink](#updatelink)メンバー関数が呼び出されたとき)。 このオプションは、[リンク] ダイアログ ボックスの [手動でリンク更新] オプション ボタンをサポートします。

### <a name="remarks"></a>解説

これは高度な操作です。

この関数は[、クラスによって](../../mfc/reference/colelinksdialog-class.md)自動的に呼び出されます。

詳細については、Windows SDK[の「IOleLink::GetUpdate オプション」](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions)を参照してください。

## <a name="coleclientitemgettype"></a><a name="gettype"></a>次の項目を取得します。

OLE アイテムが埋め込みまたはリンクされているか、または静的かどうかを調べます。

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>戻り値

次のいずれかの値を持つ符号なし整数。

- OT_LINK OLE アイテムはリンクです。

- OT_EMBEDDED OLE アイテムが埋め込まれています。

- OT_STATIC OLE アイテムは静的で、ネイティブ データは含まれていないため、編集できません。

## <a name="coleclientitemgetusertype"></a><a name="getusertype"></a>次の操作を行います。

OLE アイテムの種類を表すユーザーに表示される文字列 ("Word 文書" など) を取得します。

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>パラメーター

*ユーザークラスタイプ*<br/>
OLE アイテムの型を表す文字列のバリアントを示す値。 これは、次のいずれかの値を持つことができます。

- USERCLASSTYPE_FULL ユーザーに表示される完全な型名。

- USERCLASSTYPE_SHORT ポップアップ メニューと [リンクの編集] ダイアログ ボックスで使用する短い名前 (最大 15 文字) です。

- USERCLASSTYPE_APPNAME クラスを処理するアプリケーションの名前です。

*文字列*<br/>
OLE アイテムの型を記述する文字列が返される[CString](../../atl-mfc-shared/reference/cstringt-class.md)オブジェクトへの参照。

### <a name="remarks"></a>解説

これは、多くの場合、システム登録データベースのエントリです。

フルタイプ名が要求されているが使用できない場合は、代わりに短い名前が使用されます。 OLE アイテムの種類のエントリが登録データベースに見つからない場合、または OLE アイテムの種類に登録されているユーザータイプがない場合は、OLE アイテムに現在格納されているユーザーの種類が使用されます。 そのユーザーの種類の名前が空の文字列の場合は、「不明なオブジェクト」が使用されます。

詳細については、次を[参照](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype)してください。

## <a name="coleclientitemisinplaceactive"></a><a name="isinplaceactive"></a>をクリックします。

OLE アイテムがインプレース アクティブかどうかを確認します。

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>戻り値

OLE アイテムがインプレース アクティブの場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

アイテムがインプレイスで編集されているかどうかによって、異なるロジックを実行するのが一般的です。 関数は、現在の項目の状態が、`activeState`または のいずれかに等`activeUIState`しいかどうかをチェックします。

## <a name="coleclientitemislinkuptodate"></a><a name="islinkuptodate"></a>をクリックします。

OLE アイテムが最新かどうかを調べます。

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>戻り値

OLE アイテムが最新の場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

リンク元のドキュメントが更新されている場合、リンクアイテムは最新の状態になっかさせることができます。 その中にリンクを含む埋め込みアイテムも同様に最新の状態にならない場合があります。 この関数は、OLE アイテムの再帰的なチェックを行います。 OLE アイテムが最新の状態でなくて済むかどうかを判断すると、実際に更新を実行する場合と同じくらいコストがかかる可能性があります。

これは、[実装](../../mfc/reference/colelinksdialog-class.md)によって自動的に呼び出されます。

詳細については、次を[参照してください](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate)。

## <a name="coleclientitemismodified"></a><a name="ismodified"></a>を変更しました。

OLE アイテムが最後に保存された後に変更された状態かどうかを確認します。

```
BOOL IsModified() const;
```

### <a name="return-value"></a>戻り値

OLE アイテムがダーティの場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

詳細については、「Windows SDK の[IPersist ストレージ::IsDirty」](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty)を参照してください。

## <a name="coleclientitemisopen"></a><a name="isopen"></a>を開く

OLE アイテムが開いているかどうかを調べます。つまり、別のウィンドウで実行されているサーバー アプリケーションのインスタンスで開きます。

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>戻り値

OLE アイテムが開いている場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

ハッチング パターンを使用してオブジェクトを描画するタイミングを決定するために使用されます。 開いているオブジェクトは、オブジェクトの上にハッチング パターンを描画する必要があります。 これを行うには[、CRectTracker](../../mfc/reference/crecttracker-class.md)オブジェクトを使用できます。

## <a name="coleclientitemisrunning"></a><a name="isrunning"></a>を実行しています。

OLE アイテムが実行中かどうかを調べます。つまり、アイテムがサーバー アプリケーションで読み込まれて実行されているかどうか。

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>戻り値

OLE アイテムが実行中の場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

詳細については、「Windows SDK[での OleIsRunning」](/windows/win32/api/ole2/nf-ole2-oleisrunning)を参照してください。

## <a name="coleclientitemonactivate"></a><a name="onactivate"></a>をアクティブにします。

アイテムが有効になったのを通知するために、フレームワークによって呼び出されます。

```
virtual void OnActivate();
```

### <a name="remarks"></a>解説

この関数は、サーバーが実行されていることを示すために呼び出されます。 この時点では、オブジェクトにはアクティブなユーザー インターフェイスがありません (は存在`activeUIState`しません)。 メニューまたはツールバーがインストールされていません。 その場合、[メンバー関数が](#onactivateui)呼び出されます。

既定の実装では、パラメーターとしてOLE_CHANGEDSTATE [OnChange](#onchange)メンバー関数を呼び出します。 アイテムがインプレース アクティブになったときにカスタム処理を実行するには、この関数をオーバーライドします。

## <a name="coleclientitemonactivateui"></a><a name="onactivateui"></a>をクリックします。

オブジェクトがアクティブ`OnActivateUI`な UI 状態に入ったときに、フレームワークが呼び出します。

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>解説

これで、オブジェクトにツールバーとメニューがインストールされました。

デフォルトの実装では、後`GetServerWindow`で呼び出す場合はサーバの HWND を記憶します。

## <a name="coleclientitemonchange"></a><a name="onchange"></a>コントロールクライアントアイテム::オンチェンジ

ユーザーが OLE アイテムを変更、保存、または閉じたときに、フレームワークによって呼び出されます。

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>パラメーター

*nコード*<br/>
サーバーがこのアイテムを変更した理由。 次のいずれかの値になります。

- OLE_CHANGED OLE アイテムの外観が変更されました。

- OLE_SAVED OLE アイテムが保存されました。

- OLE_CLOSED OLE アイテムが閉じられました。

- OLE_CHANGED_STATE OLE アイテムが状態を変更しました。

*ドウパラム*<br/>
*nCode*がOLE_SAVEDまたはOLE_CLOSEDの場合、このパラメーターは使用されません。 *nCode*がOLE_CHANGED場合、このパラメーターは、変更された OLE アイテムのアスペクトを指定します。 可能な値については[、COleClientItem::Draw](#draw)の*dwParam*パラメーターを参照してください。 *nCode*がOLE_CHANGED_STATE場合、このパラメーターは`COleClientItem::ItemState`列挙値であり、入力される状態を記述します。 値は、 `emptyState`、 、 `loadedState`、 、 `openState` `activeState`、または`activeUIState`のいずれかになります。

### <a name="remarks"></a>解説

(サーバー アプリケーションが Microsoft Foundation クラス ライブラリを使用して作成されている場合、この関数`Notify`は 、 `COleServerDoc` `COleServerItem`のメンバー関数に応じて呼び出されます。既定の実装では *、nCode*がOLE_CHANGEDまたはOLE_SAVEDの場合、コンテナ ドキュメントは変更済みとしてマークされます。

OLE_CHANGED_STATEの場合[、GetItemState](#getitemstate)から返される現在の状態は古い状態であり、この状態変更前の現在の状態を意味します。

OLE アイテムの状態の変更に応答するには、この関数をオーバーライドします。 通常は、アイテムが表示される領域を無効にして、アイテムの外観を更新します。 オーバーライドの先頭で基本クラスの実装を呼び出します。

## <a name="coleclientitemonchangeitemposition"></a><a name="onchangeitemposition"></a>を選択します。

OLE アイテムの範囲がインプレース アクティブ化の間に変更されたことをコンテナーに通知するために、フレームワークによって呼び出されます。

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>パラメーター

*レクトポス*<br/>
コンテナー アプリケーションのクライアント領域に対する項目の相対的な位置を示します。

### <a name="return-value"></a>戻り値

項目の位置が正常に変更された場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

既定の実装では、OLE アイテムの新しい可視四角形を決定し、新しい値を使用して[SetItemRect を](#setitemrects)呼び出します。 既定の実装では、アイテムに対して表示される四角形が計算され、その情報がサーバーに渡されます。

サイズ変更/移動操作に特別な規則を適用するには、この関数をオーバーライドします。 アプリケーションが MFC で記述されている場合、サーバーが呼び出されたためにこの呼び出し[が実行されます](../../mfc/reference/coleserverdoc-class.md#requestpositionchange)。

## <a name="coleclientitemondeactivate"></a><a name="ondeactivate"></a>を無効にします。

OLE アイテムがインプレース アクティブ状態 ( `activeState`) から読み込み状態に遷移したときに、フレームワークによって呼び出されます。

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>解説

この関数は、OLE アイテムが閉じていることを示すために呼び出されます。 その場合は、[メンバー関数が呼](#ondeactivateui)び出されます。

既定の実装では、パラメーターとしてOLE_CHANGEDSTATE [OnChange](#onchange)メンバー関数を呼び出します。 インプレース アクティブなアイテムが非アクティブになったときにカスタム処理を実行するには、この関数をオーバーライドします。 たとえば、コンテナー アプリケーションで undo コマンドをサポートしている場合、この関数をオーバーライドして元に戻す状態を破棄できます。

## <a name="coleclientitemondeactivateandundo"></a><a name="ondeactivateandundo"></a>次の項目を元に戻します。

OLE アイテムをアクティブにした後にユーザーが元に戻すコマンドを呼び出したときに、フレームワークによって呼び出されます。

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>解説

既定の実装では[、DeactivateUI](#deactivateui)を呼び出してサーバーのユーザー インターフェイスを非アクティブ化します。 コンテナー アプリケーションに undo コマンドを実装している場合は、この関数をオーバーライドします。 オーバーライドで、関数の基本クラス バージョンを呼び出し、アプリケーションで最後に実行されたコマンドを元に戻します。

詳細については、Windows SDK[の「IOleInPlace サイト::Dアクティブ化と元に戻す](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo)」を参照してください。

## <a name="coleclientitemondeactivateui"></a><a name="ondeactivateui"></a>クライアントアイテム::オンアクティブ化

ユーザーが、その場でアクティブ化された項目を非アクティブ化したときに呼び出されます。

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>パラメーター

*元に戻す*<br/>
編集の変更を元に戻すことができるかどうかを指定します。

### <a name="remarks"></a>解説

この関数は、コンテナー アプリケーションのユーザー インターフェイスを元の状態に戻し、インプレース アクティブ化用に作成されたメニューやその他のコントロールを非表示にします。

*bUndoable*が FALSE の場合、コンテナーは、サーバーによって最後に実行された操作が元に戻すことが不可能であることを示すため、事実上、元に戻すコマンドを無効にする必要があります。

## <a name="coleclientitemondiscardundostate"></a><a name="ondiscardundostate"></a>状態を破棄します。

OLE アイテムの編集中に元に戻す状態を破棄する操作をユーザーが実行したときに、フレームワークによって呼び出されます。

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>解説

既定の実装では、何も行われません。 コンテナー アプリケーションに undo コマンドを実装している場合は、この関数をオーバーライドします。 オーバーライドで、コンテナー アプリケーションの undo 状態を破棄します。

サーバーが Microsoft ファウンデーション クラス ライブラリで書き込まれた場合、サーバーは、この関数を呼び出すことによって[、COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate)を呼び出すことによって呼び出すことができます。

詳細については、Windows SDK[の「IOleInPlaceSite::DiscardUndoState」](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate)を参照してください。

## <a name="coleclientitemongetclipboarddata"></a><a name="ongetclipboarddata"></a>をクリックします。

`COleDataSource` [CopyToClipboard](#copytoclipboard)または[DoDragDrop](#dodragdrop)メンバー関数の呼び出しによってクリップボードに配置されるすべてのデータを含むオブジェクトを取得するために、フレームワークによって呼び出されます。

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>パラメーター

*bインクルードリンク*<br/>
リンク データをクリップボードにコピーする場合は、この値を TRUE に設定します。 サーバー アプリケーションがリンクをサポートしていない場合は、これを FALSE に設定します。

*を指定します。*<br/>
オブジェクトの原点からのマウス カーソルのオフセットへのポインター (ピクセル単位)。

*lp サイズ*<br/>
オブジェクトのサイズをピクセル単位で指定します。

### <a name="return-value"></a>戻り値

クリップボード データを格納している[COleDataSource](../../mfc/reference/coledatasource-class.md)オブジェクトへのポインター。

### <a name="remarks"></a>解説

この関数の既定の実装は[、GetClipboardData](#getclipboarddata)を呼び出します。

## <a name="coleclientitemongetcliprect"></a><a name="ongetcliprect"></a>をクリックします。

フレームワークは、メンバー`OnGetClipRect`関数を呼び出して、編集中のアイテムのクリッピング四角形座標を取得します。

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>パラメーター

*ルクレクト*<br/>
項目のクリッピング四角形座標を保持する[CRect](../../atl-mfc-shared/reference/crect-class.md)クラスのオブジェクトへのポインター。

### <a name="remarks"></a>解説

座標は、コンテナー アプリケーション ウィンドウのクライアント領域に対する相対的なピクセル数です。

既定の実装では、アイテムがインプレース アクティブになっているビューのクライアント四角形を返します。

## <a name="coleclientitemongetitemposition"></a><a name="ongetitemposition"></a>を選択します。

フレームワークは、メンバー`OnGetItemPosition`関数を呼び出して、インプレースで編集されている項目の座標を取得します。

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>パラメーター

*r位置*<br/>
項目の位置座標を格納する[CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトへの参照。

### <a name="remarks"></a>解説

座標は、コンテナー アプリケーション ウィンドウのクライアント領域に対する相対的なピクセル数です。

この関数の既定の実装は、何も行いません。 インプレース編集をサポートするアプリケーションでは、その実装が必要です。

## <a name="coleclientitemongetwindowcontext"></a><a name="ongetwindowcontext"></a>コンテキストを取得します。

アイテムが所定の位置でアクティブ化されたときに、フレームワークによって呼び出されます。

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>パラメーター

*フレーム*<br/>
メイン フレーム ウィンドウへのポインターへのポインター。

*をクリックします。*<br/>
ドキュメント フレーム ウィンドウへのポインターへのポインター。

*をクリックします。*<br/>
フレーム ウィンドウ情報を受け取る[OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

この関数は、OLE アイテムの親ウィンドウに関する情報を取得するために使用します。

コンテナが MDI アプリケーションの場合、既定の実装は *、ppMainFrame*内の[CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md)オブジェクトへのポインタと *、ppDocFrame*のアクティブな[CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md)オブジェクトへのポインタを返します。 コンテナが SDI アプリケーションの場合、既定の実装は*ppMainFrame*の[CFrameWnd](../../mfc/reference/cframewnd-class.md)オブジェクトへのポインタを返し *、ppDocFrame*で NULL を返します。 既定の実装では、 *lpFrameInfo*のメンバーも入力します。

既定の実装がアプリケーションに適合しない場合にのみ、この関数をオーバーライドします。たとえば、アプリケーションに SDI や MDI とは異なるユーザー インターフェイスのパラダイムがある場合などです。 これは、高度なオーバーライド可能です。

詳細[については、](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext)[次を参照](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo)してください。

## <a name="coleclientitemoninsertmenus"></a><a name="oninsertmenus"></a>メニューを挿入します。

コンテナー アプリケーションのメニューを空のメニューに挿入するために、インプレース アクティブ化中にフレームワークによって呼び出されます。

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>パラメーター

*共有される*<br/>
空のメニューを指します。

*幅*<br/>
ファイル、編集、コンテナー、オブジェクト、ウィンドウ、ヘルプの各メニュー グループに含まれるメニューの数を示す 6 つの LONG 値の配列へのポイント。 コンテナー アプリケーションは、この配列の要素 0、2、および 4 に対応するファイル、コンテナー、ウィンドウのメニュー グループを担当します。

### <a name="remarks"></a>解説

このメニューはサーバーに渡され、サーバー固有のメニューが挿入され、複合メニューが作成されます。 この関数を繰り返し呼び出して、複数の複合メニューを作成できます。

既定の実装は*pMenuShared*インプレース コンテナー メニューに挿入します。つまり、ファイル、コンテナー、ウィンドウのメニュー グループです。 このメニュー リソースを設定するために[使用されます。](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) また、既定の実装では、メニュー リソースに応じて *、lpMenuWidths*の要素 0、2、および 4 に適切な値が割り当てられます。 既定の実装がアプリケーションに適していない場合は、この関数をオーバーライドします。たとえば、アプリケーションで、リソースをドキュメント タイプに関連付けるためのドキュメント テンプレートを使用していない場合などです。 この関数をオーバーライドする場合は[、OnSetMenu](#onsetmenu)と[OnRemoveMenus](#onremovemenus)もオーバーライドする必要があります。 これは、高度なオーバーライド可能です。

詳細については、「次の[トピックを挿入するウィンドウ::Windows](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) SDK のメニューを挿入する」を参照してください。

## <a name="coleclientitemonremovemenus"></a><a name="onremovemenus"></a>次の項目を削除します。

インプレース アクティブ化が終了したときに、指定された複合メニューからコンテナーのメニューを削除するために、フレームワークによって呼び出されます。

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>パラメーター

*共有される*<br/>
メンバー関数の呼び出しによって構築される複合メニューへの[ポイント](#oninsertmenus)。

### <a name="remarks"></a>解説

既定の実装は*pMenuShared*から削除されますインプレース コンテナー メニュー、つまり、ファイル、コンテナー、ウィンドウメニュー グループです。 既定の実装がアプリケーションに適していない場合は、この関数をオーバーライドします。たとえば、アプリケーションで、リソースをドキュメント タイプに関連付けるためのドキュメント テンプレートを使用していない場合などです。 この関数をオーバーライドする場合は、[おそらく、同様に OnInsert メニュー](#oninsertmenus)と[OnSetMenu をオーバーライドする](#onsetmenu)必要があります。 これは、高度なオーバーライド可能です。

*pMenuShared*のサブメニューは、サーバーが繰り返し呼び出`OnInsertMenus`されている場合、複数の複合メニューで共有される場合があります。 したがって、 のオーバーライドでサブメニューを削除しないでください`OnRemoveMenus`。あなたはそれらを取り外すだけです。

詳細については、「Windows SDK[のメニューの削除」を](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus)参照してください。

## <a name="coleclientitemonscrollby"></a><a name="onscrollby"></a>::オンスクロールバイ

サーバーからの要求に応じて OLE アイテムをスクロールするために、フレームワークによって呼び出されます。

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>パラメーター

*サイズ範囲*<br/>
x 方向と y 方向をスクロールする距離をピクセル単位で指定します。

### <a name="return-value"></a>戻り値

項目がスクロールされた場合は 0 以外の値を返します。項目をスクロールできない場合は 0。

### <a name="remarks"></a>解説

たとえば、OLE アイテムが部分的に表示され、ユーザーがインプレース編集の実行中に可視領域の外側に移動した場合、カーソルを表示したままにします。 既定の実装では、何も行われません。 指定した量だけ項目をスクロールするには、この関数をオーバーライドします。 スクロールの結果として、OLE アイテムの表示部分が変更される可能性があります。 [SetItemRects を](#setitemrects)呼び出して、アイテムの可視四角形を更新します。

詳細については、「Windows SDK[のスクロール](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll)」を参照してください。

## <a name="coleclientitemonsetmenu"></a><a name="onsetmenu"></a>次の項目を使用します。

インプレース アクティブ化の開始と終了が 2 回、フレームワークによって呼び出されます。合成メニューを初めてインストールし、2 回目に (*ホールメニュー*が NULL に等しい) とそれを削除します。

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>パラメーター

*共有される*<br/>
[メンバー](#oninsertmenus)関数と`InsertMenu`関数の呼び出しによって構築される複合メニューへのポインター。

*ホールメニュー*<br/>
`OleCreateMenuDescriptor`関数によって返されるメニュー記述子へのハンドル。

*オブジェクトを使用します。*<br/>
OLE アイテムの編集ウィンドウへのハンドル。 これは、OLE から編集コマンドを受け取るウィンドウです。

### <a name="remarks"></a>解説

既定の実装では、複合メニューをインストールまたは削除し[、OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)関数を呼び出してディスパッチ コードをインストールまたは削除します。 既定の実装がアプリケーションに適していない場合は、この関数をオーバーライドします。 この関数をオーバーライドする場合は、おそらく[、同様に OnInsert メニュー](#oninsertmenus)と[OnRemoveMenus を](#onremovemenus)オーバーライドする必要があります。 これは、高度なオーバーライド可能です。

詳細については、「[を](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor)参照してください。 [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) [IOleInPlaceFrame::SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu)

## <a name="coleclientitemonshowcontrolbars"></a><a name="onshowcontrolbars"></a>コントロールバーを表示します。

コンテナー アプリケーションのコントロール バーを表示および非表示にするために、フレームワークによって呼び出されます。

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コンテナー アプリケーションのフレーム ウィンドウへのポインター。 メイン フレーム ウィンドウまたは MDI 子ウィンドウのいずれかを指定できます。

*bショー*<br/>
コントロール バーを表示するか非表示にするかを指定します。

### <a name="return-value"></a>戻り値

関数呼び出しによってコントロール バーの状態が変化する場合は 0 以外の値を返します。呼び出しが変更されない場合、または*pFrameWnd*がコンテナのフレーム ウィンドウを指していない場合は 0。

### <a name="remarks"></a>解説

コントロール バーが bShow で指定された状態に既に存在する場合、この関数は 0 を返*します。* これは、たとえば、コントロール バーが非表示で*bShow*が FALSE の場合に発生します。

既定の実装では、最上位のフレーム ウィンドウからツール バーが削除されます。

## <a name="coleclientitemonshowitem"></a><a name="onshowitem"></a>をクリックします。

OLE アイテムを表示するためにフレームワークによって呼び出され、編集中に完全に表示されます。

```
virtual void OnShowItem();
```

### <a name="remarks"></a>解説

コンテナー アプリケーションが埋め込みアイテムへのリンクをサポートしている場合に使用されます (つまり[、COleLinkDoc](../../mfc/reference/colelinkingdoc-class.md)からドキュメント クラスを派生している場合)。 この関数は、インプレース アクティブ化中、または OLE アイテムがリンク ソースであり、ユーザーが編集する場合に呼び出されます。 既定の実装では、コンテナー ドキュメントの最初のビューがアクティブになります。 OLE アイテムが表示されるようにドキュメントをスクロールするには、この関数をオーバーライドします。

## <a name="coleclientitemonupdateframetitle"></a><a name="onupdateframetitle"></a>をクリックします。

フレーム ウィンドウのタイトル バーを更新するために、インプレース アクティブ化中にフレームワークによって呼び出されます。

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>戻り値

この関数がフレーム タイトルを正常に更新した場合は 0 以外の値を返します。

### <a name="remarks"></a>解説

既定の実装では、フレーム ウィンドウのタイトルは変更されません。 アプリケーションに別のフレーム タイトルを設定する場合は、この関数をオーバーライド*server app* - します *("docname*のサーバー アプリ*アイテム*" (REPORT の "Microsoft Excel - スプレッドシート" のようにします)。DOC")。 これは、高度なオーバーライド可能です。

## <a name="coleclientitemreactivateandundo"></a><a name="reactivateandundo"></a>::再アクティブ化と元に戻す

OLE アイテムを再アクティブ化し、インプレース編集中にユーザーが最後に実行した操作を元に戻します。

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

コンテナー アプリケーションが元に戻すコマンドをサポートしている場合は、OLE アイテムを非アクティブにした直後にユーザーが元に戻すコマンドを選択した場合は、この関数を呼び出します。

サーバー アプリケーションが Microsoft ファウンデーション クラス ライブラリで記述されている場合、この関数によりサーバーは[COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo)を呼び出します。

詳細[については、](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo)次を参照してください。

## <a name="coleclientitemrelease"></a><a name="release"></a>をクリックします。

OLE アイテムが使用するリソースをクリーンアップします。

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
OLE アイテムが読み込まれた状態に戻ったときに、どのような状況で OLE アイテムが保存されるのかを指定するフラグ。 使用できる値の一覧については[、「COleClientItem::Close」を参照してください](#close)。

### <a name="remarks"></a>解説

`Release`はデストラクターによって`COleClientItem`呼び出されます。

詳細については、Windows SDK の[「IUnknown::リリース](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)」を参照してください。

## <a name="coleclientitemreload"></a><a name="reload"></a>を読み込む

アイテムを閉じて再読み込みします。

```
BOOL Reload();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

ActivateAs`Reload`の呼び出しによって、項目を別の種類の項目として[アクティブ](#activateas)化した後に関数を呼び出します。

## <a name="coleclientitemrun"></a><a name="run"></a>実行します。

この項目に関連付けられているアプリケーションを実行します。

```
void Run();
```

### <a name="remarks"></a>解説

項目を`Run`アクティブ化する前に、メンバー関数を呼び出してサーバー アプリケーションを起動します。 これは[、Activate](#activate)と[DoVerb](#doverb)によって自動的に行われるため、通常はこの関数を呼び出す必要はありません。 [DoVerb](#doverb)を実行する前に[SetExtent](#setextent)などの項目属性を設定するためにサーバーを実行する必要がある場合は、この関数を呼び出します。

## <a name="coleclientitemsetdrawaspect"></a><a name="setdrawaspect"></a>次の項目を選択します。

項目の`SetDrawAspect`"アスペクト" または ビューを設定するには、メンバー関数を呼び出します。

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>パラメーター

*アスペクト*<br/>
DVASPECT 列挙体の値。 このパラメーターには、次のいずれかの値を指定できます。

- アイテムDVASPECT_CONTENT、コンテナ内の埋め込みオブジェクトとして表示できるように表示されます。

- DVASPECT_THUMBNAILアイテムは、閲覧ツールで表示できるように「サムネイル」表現でレンダリングされます。

- DVASPECT_ICON項目はアイコンで表されます。

- DVASPECT_DOCPRINTアイテムは、[ファイル] メニューの [印刷] コマンドを使用して印刷されたかのように表示されます。

### <a name="remarks"></a>解説

アスペクトは、その関数の*nDrawAspect*引数の既定値が使用されている場合に[Draw](#draw)によってアイテムをレンダリングする方法を指定します。

この関数は、アイコンの変更 (およびアイコンの変更ダイアログを直接呼び出す他のダイアログ) によって自動的に呼び出され、ユーザーから要求されたときにアイコン表示を有効にします。

## <a name="coleclientitemsetextent"></a><a name="setextent"></a>を選択します。

OLE アイテムに使用できる領域の大きな量を指定します。

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>パラメーター

*サイズ*<br/>
サイズ情報を格納する[CSize](../../atl-mfc-shared/reference/csize-class.md)オブジェクト。

*アスペクト*<br/>
境界を設定する OLE アイテムのアスペクトを指定します。 可能な値については、「[を参照](#setdrawaspect)してください。

### <a name="remarks"></a>解説

サーバー アプリケーションが Microsoft Foundation クラス ライブラリを使用して作成された場合、対応する`COleServerItem`オブジェクトの[OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent)メンバー関数が呼び出されます。 OLE アイテムは、それに応じて表示を調整できます。 寸法はMM_HIMETRIC単位である必要があります。 ユーザーが OLE アイテムのサイズを変更するとき、または何らかの形式のレイアウト ネゴシエーションをサポートしている場合は、この関数を呼び出します。

詳細については、次を[参照](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)してください。

## <a name="coleclientitemsethostnames"></a><a name="sethostnames"></a>を選択します。

埋め込まれた OLE アイテムのコンテナー アプリケーションの名前とコンテナーの名前を指定します。

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>パラメーター

*ホスト*<br/>
コンテナー アプリケーションのユーザー参照名へのポインター。

*をクリックします。*<br/>
OLE アイテムを含むコンテナーの識別文字列へのポインター。

### <a name="remarks"></a>解説

サーバー アプリケーションが Microsoft ファウンデーション クラス ライブラリを使用して作成された場合、この関数は`COleServerDoc`OLE アイテムを含むドキュメントの[OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames)メンバー関数を呼び出します。 この情報は、OLE アイテムを編集するときにウィンドウ タイトルで使用されます。 コンテナー ドキュメントが読み込まれるたびに、フレームワークはドキュメント内のすべての OLE アイテムに対してこの関数を呼び出します。 `SetHostNames`は埋め込みアイテムにのみ適用できます。 埋め込み OLE アイテムが編集用にアクティブになるたびに、この関数を呼び出す必要はありません。

これは、オブジェクトが読み込まれるとき、またはファイルが別の名前で保存されたときに、アプリケーション名とドキュメント名で自動的に呼び出されます。 したがって、通常、この関数を直接呼び出す必要はありません。

詳細については、次を[参照](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames)してください。

## <a name="coleclientitemseticonicmetafile"></a><a name="seticonicmetafile"></a>を切り取るアイテム::アイコンメタファイル

アイテムのアイコンの描画に使用するメタファイルをキャッシュします。

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>パラメーター

*メタピクト*<br/>
項目のアイコンの描画に使用するメタファイルへのハンドル。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

メタファイルを取得するには[、GetIconicMetafile](#geticonicmetafile)を使用します。

*hMetaPict*パラメーターが項目にコピーされます。したがって *、hMetaPict*は呼び出し元によって解放される必要があります。

## <a name="coleclientitemsetitemrects"></a><a name="setitemrects"></a>をクリックします。

OLE アイテムの外接する四角形または可視の四角形を設定します。

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>パラメーター

*lprcPosRect*<br/>
親ウィンドウを基準とした OLE アイテムの境界をクライアント座標で囲む四角形へのポインター。

*lprcクリップレック*<br/>
親ウィンドウを基準とした OLE アイテムの可視部分の境界をクライアント座標で囲んだ四角形へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

この関数は[、メンバー関数](#onchangeitemposition)の既定の実装によって呼び出されます。 OLE アイテムの位置または表示部分が変更されるたびに、この関数を呼び出す必要があります。 通常、これは、ビューの[OnSize](../../mfc/reference/cwnd-class.md#onsize)および[OnScrollBy](../../mfc/reference/cview-class.md#onscrollby)メンバー関数から呼び出すということです。

詳細[については、](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)次を参照してください。

## <a name="coleclientitemsetlinkupdateoptions"></a><a name="setlinkupdateoptions"></a>をクリックします。

指定したリンク アイテムのプレゼンテーションにリンク更新オプションを設定します。

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>パラメーター

*ドウアップデートオプト*<br/>
このアイテムのリンク更新オプションの値。 この値は、次のいずれかである必要があります。

- OLEUPDATE_ALWAYS リンクされたアイテムを可能な限り更新します。 このオプションは、[リンク] ダイアログ ボックスの [リンク更新の自動更新] オプション ボタンをサポートします。

- OLEUPDATE_ONCALL コンテナー アプリケーションからの要求のみでリンク アイテムを更新します[(UpdateLink](#updatelink)メンバー関数が呼び出されたとき)。 このオプションは、[リンク] ダイアログ ボックスの [手動でリンク更新] オプション ボタンをサポートします。

### <a name="remarks"></a>解説

通常、ユーザーが [リンク] ダイアログ ボックスで選択した更新オプションは変更しないでください。

詳細については、Windows SDK[の「IOleLink::SetUpdate オプション」](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions)を参照してください。

## <a name="coleclientitemsetprintdevice"></a><a name="setprintdevice"></a>を切り取るアイテム::デバイスを印刷します。

この項目の印刷対象デバイスを変更します。

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>パラメーター

*Ptd*<br/>
新しい印刷対象デバイスに関する情報を含む[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)データ構造体へのポインター。 NULL にすることができます。

*Ppd*<br/>
新しい印刷対象デバイスに関する情報を含む[PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga)データ構造体へのポインター。 NULL にすることができます。

### <a name="return-value"></a>戻り値

関数が正常に終了した場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

この関数は、項目の印刷対象デバイスを更新しますが、プレゼンテーション キャッシュは更新しません。 アイテムのプレゼンテーション キャッシュを更新するには[、UpdateLink](#updatelink)を呼び出します。

この関数の引数には、OLE システムがターゲット デバイスを識別するために使用する情報が含まれます。 この`PRINTDLG`構造体には、Windows が共通の [印刷] ダイアログ ボックスを初期化するために使用する情報が含まれています。 ユーザーがダイアログ ボックスを閉じた後、Windows は、この構造体でユーザーの選択に関する情報を返します。 オブジェクト`m_pd`のメンバーは[CPrintDialog](../../mfc/reference/cprintdialog-class.md)構造体です`PRINTDLG`。

この構造体の詳細については、Windows SDK の[印刷を](/windows/win32/api/commdlg/ns-commdlg-printdlga)参照してください。

詳細については、Windows SDK の[「DVTARGETDEVICE」](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)を参照してください。

## <a name="coleclientitemupdatelink"></a><a name="updatelink"></a>をクリックします。

OLE アイテムのプレゼンテーション データを直ちに更新します。

```
BOOL UpdateLink();
```

### <a name="return-value"></a>戻り値

正常に完了した場合はゼロ以外、それ以外の場合は 0 です。

### <a name="remarks"></a>解説

リンクされたアイテムの場合、この関数はリンク 元を検索して、OLE アイテムの新しいプレゼンテーションを取得します。 このプロセスには、1 つ以上のサーバー アプリケーションの実行が含まれる場合があり、時間がかかる場合があります。 埋め込みアイテムの場合、関数は再帰的に動作し、埋め込みアイテムに最新ではない可能性のあるリンクが含まれているかどうかを確認し、それらを更新します。 また、ユーザーは[リンク]ダイアログ ボックスを使用して個々のリンクを手動で更新することもできます。

詳細については、Windows SDK[の「IOleLink::Update」](/windows/win32/api/oleidl/nf-oleidl-iolelink-update)を参照してください。

## <a name="see-also"></a>関連項目

[MFC サンプル MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[サンプル O クライアント](../../overview/visual-cpp-samples.md)<br/>
[CDocItem クラス](../../mfc/reference/cdocitem-class.md)<br/>
[階層グラフ](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem クラス](../../mfc/reference/coleserveritem-class.md)
