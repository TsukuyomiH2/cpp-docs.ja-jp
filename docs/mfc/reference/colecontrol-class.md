---
title: COleControl クラス
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 8e931b03dc09926d44fa5cb4125dd2ffa41c5813
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81366193"
---
# <a name="colecontrol-class"></a>COleControl クラス

OLE コントロールを開発するための強力な基底クラスです。

## <a name="syntax"></a>構文

```
class COleControl : public CWnd
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[コントロール::コントロール](#colecontrol)|`COleControl` オブジェクトを作成します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[コントロール::アンビエントアピアランス](#ambientappearance)|コントロールの現在の外観を取得します。|
|[コントロール::アンビエントバックカラー](#ambientbackcolor)|アンビエント BackColor プロパティの値を返します。|
|[コントロール::アンビエントディスプレイ名](#ambientdisplayname)|コンテナーで指定されたコントロールの名前を返します。|
|[コントロール::アンビエントフォント](#ambientfont)|アンビエント Font プロパティの値を返します。|
|[コントロール::アンビエントフォーカラー](#ambientforecolor)|プロパティの値を返します。|
|[コントロール::アンビエントロケールID](#ambientlocaleid)|コンテナのロケール ID を返します。|
|[コントロール::アンビエントスケールユニット](#ambientscaleunits)|コンテナーで使用される単位の種類を返します。|
|[コントロール::アンビエントショーグラブハンドル](#ambientshowgrabhandles)|グラブ ハンドルを表示するかどうかを決定します。|
|[コントロール::アンビエントショーハッチング](#ambientshowhatching)|ハッチングを表示するかどうかを指定します。|
|[コントロール::アンビエントテキスト整列](#ambienttextalign)|コンテナで指定されたテキスト配置の種類を返します。|
|[コントロール::アンビエントUIデッド](#ambientuidead)|コントロールがユーザー インターフェイスの操作に応答するかどうかを決定します。|
|[コントロール::アンビエントユーザーモード](#ambientusermode)|コンテナーのモードを決定します。|
|[コントロール::バインドされたプロパティを変更しました](#boundpropertychanged)|バインドされたプロパティが変更されたことをコンテナーに通知します。|
|[コントロール::バインドプロパティ要求編集](#boundpropertyrequestedit)|プロパティ値を編集するアクセス許可を要求します。|
|[コントロール::クライアントを親に](#clienttoparent)|コントロールの原点を基準にしたポイントを、コンテナの原点を基準としたポイントに変換します。|
|[コントロール::クリップキャレットレック](#clipcaretrect)|コントロールに重なっている場合に、キャレット四角形を調整します。|
|[コントロールコントロール::コントロール情報が変更されました](#controlinfochanged)|コントロールによって処理されるニーモニックのセットが変更された後に、この関数を呼び出します。|
|[コントロール::D再生エラー](#displayerror)|コントロールのユーザーにストック エラー イベントを表示します。|
|[コントロール::Doクリック](#doclick)|ストック`DoClick`メソッドの実装。|
|[コントロール::Doプロップエクスチェンジ](#dopropexchange)|オブジェクトのプロパティを`COleControl`シリアル化します。|
|[コントロール::Doスーパークラスペイント](#dosuperclasspaint)|Windows コントロールからサブクラス化された OLE コントロールを再描画します。|
|[コントロール::イネーブルシンプルフレーム](#enablesimpleframe)|コントロールの単純なフレーム サポートを有効にします。|
|[コントロール::エクスチェンジエクステント](#exchangeextent)|コントロールの幅と高さをシリアル化します。|
|[コントロール::エクスチェンジストックプロップス](#exchangestockprops)|コントロールのストック プロパティをシリアル化します。|
|[コントロール::交換バージョン](#exchangeversion)|コントロールのバージョン番号をシリアル化します。|
|[コントロール::火災クリック](#fireclick)|ストック`Click`イベントを発生させます。|
|[コントロール::FireDblクリック](#firedblclick)|ストック`DblClick`イベントを発生させます。|
|[コントロール::火災エラー](#fireerror)|ストック`Error`イベントを発生させます。|
|[コントロール::火災イベント](#fireevent)|カスタム イベントを発生させます。|
|[コントロール::ファイアキーダウン](#firekeydown)|ストック`KeyDown`イベントを発生させます。|
|[コントロール::火のキープレス](#firekeypress)|ストック`KeyPress`イベントを発生させます。|
|[コントロール::ファイアキーアップ](#firekeyup)|ストック`KeyUp`イベントを発生させます。|
|[コントロール::火のマウスダウン](#firemousedown)|ストック`MouseDown`イベントを発生させます。|
|[コントロール::火のマウス移動](#firemousemove)|ストック`MouseMove`イベントを発生させます。|
|[コントロール::火のマウスアップ](#firemouseup)|ストック`MouseUp`イベントを発生させます。|
|[コントロール::火災状態変更](#firereadystatechange)|コントロールの準備完了状態が変化したときにイベントを発生させます。|
|[コントロール::取得ライセンス認証ポリシー](#getactivationpolicy)|インターフェイスをサポートするコントロールの既定のアクティブ化動作を`IPointerInactive`変更します。|
|[コントロール::アンビエントプロパティ](#getambientproperty)|指定したアンビエント プロパティの値を返します。|
|[コントロール::外観を取得します。](#getappearance)|ストックの外観プロパティの値を返します。|
|[コントロール::ゲットバックカラー](#getbackcolor)|ストックの BackColor プロパティの値を返します。|
|[コントロール::ゲットボーダースタイル](#getborderstyle)|ストックボーダースタイルプロパティの値を返します。|
|[コントロール::取得キャプチャ](#getcapture)|ウィンドウなしのアクティブなコントロール オブジェクトにマウス キャプチャがあるかどうかを判断します。|
|[コントロール::クラスIDを取得します。](#getclassid)|コントロールの OLE クラス ID を取得します。|
|[コントロール::クライアントオフセットを取得します。](#getclientoffset)|コントロールの四角形領域の左上隅とクライアント領域の左上隅の差を取得します。|
|[コントロール::クライアントレクトを取得します。](#getclientrect)|コントロールのクライアント領域のサイズを取得します。|
|[コントロール::クライアントサイトを取得します。](#getclientsite)|オブジェクトに対して、コンテナー内の現在のクライアント サイトへのポインターを照会します。|
|[コントロール::コントロールフラグを取得します。](#getcontrolflags)|制御フラグの設定を取得します。|
|[コントロール::コントロールサイズを取得します。](#getcontrolsize)|OLE コントロールの位置とサイズを返します。|
|[コントロール::ゲットDC](#getdc)|ウィンドウなしのコントロールがコンテナーからデバイス コンテキストを取得する手段を提供します。|
|[コントロール::取得有効](#getenabled)|ストックの Enabled プロパティの値を返します。|
|[コントロール::取得拡張コントロール](#getextendedcontrol)|コンテナーに属する拡張コントロール オブジェクトへのポインターを取得します。|
|[コントロール::ゲットフォーカス](#getfocus)|コントロールにフォーカスがあるかどうかを判断します。|
|[コントロール::フォントを取得します。](#getfont)|ストック Font プロパティの値を返します。|
|[コントロール::テキストメトリックスを取得します。](#getfonttextmetrics)|オブジェクトのメトリックを`CFontHolder`返します。|
|[コントロール::取得フォーカラー](#getforecolor)|ストック ForeColor プロパティの値を返します。|
|[コントロール::ゲットワード](#gethwnd)|ストック hWnd プロパティの値を返します。|
|[コントロール::メッセージ文字列を取得します。](#getmessagestring)|メニュー項目のステータス バーテキストを提供します。|
|[コントロール::サポートされていない取得](#getnotsupported)|ユーザーがコントロールのプロパティ値にアクセスできないようにします。|
|[コントロール::ゲットレディステート](#getreadystate)|コントロールの準備状態を返します。|
|[コントロール::コンテナを取得します。](#getrectincontainer)|コントロールのコンテナーを基準とした四角形を返します。|
|[コントロール::テキストメトリックス](#getstocktextmetrics)|ストック Font プロパティのメトリックを返します。|
|[コントロール::テキストを取得します。](#gettext)|ストック テキストまたはキャプション プロパティの値を返します。|
|[コントロール::ウィンドウレスドロップターゲットを取得します。](#getwindowlessdroptarget)|ウィンドウなしのコントロールをドラッグ アンド ドロップ操作の対象にする場合にオーバーライドします。|
|[コントロール::初期化IID](#initializeiids)|コントロールが使用する IID の基本クラスに通知します。|
|[コントロール::内部取得フォント](#internalgetfont)|ストック`CFontHolder`Font プロパティのオブジェクトを返します。|
|[コントロール::内部ゲットテキスト](#internalgettext)|ストックキャプションまたはテキストプロパティを取得します。|
|[コントロール::内部セットレディ状態](#internalsetreadystate)|コントロールの準備状態を設定し、状態変更の準備完了イベントを発生させます。|
|[コントロール::無効化コントロール](#invalidatecontrol)|表示されたコントロールの領域を無効にして、再描画します。|
|[コントロール::無効化Rgn](#invalidatergn)|指定した領域内のコンテナー ウィンドウのクライアント領域を無効にします。 領域内のウィンドウなしのコントロールを再描画するために使用できます。|
|[コントロール::変換VBX](#isconvertingvbx)|OLE コントロールの特殊な読み込みを許可します。|
|[コントロール::イズイストレ](#ismodified)|コントロールの状態が変更されたかどうかを判断します。|
|[コントロール::Is 最適化ドロー](#isoptimizeddraw)|コンテナが現在の描画操作に最適化された描画をサポートするかどうかを示します。|
|[コントロール::IsSubクラス化コントロール](#issubclassedcontrol)|コントロールが Windows コントロールのサブクラスかどうかを判断するために呼び出されます。|
|[コントロール::読み込み](#load)|以前の非同期データをリセットし、コントロールの非同期プロパティの新しい読み込みを開始します。|
|[コントロール::ロックインプレイスアクティブ](#lockinplaceactive)|コントロールをコンテナーで非アクティブ化できるかどうかを判断します。|
|[コントロール::オンエンビエントプロパティチェンジ](#onambientpropertychange)|アンビエント プロパティが変更されたときに呼び出されます。|
|[コントロール::オンアピアランス変更](#onappearancechanged)|ストック外観プロパティが変更されたときに呼び出されます。|
|[コントロール::オンバックカラー変更](#onbackcolorchanged)|ストックの BackColor プロパティが変更されたときに呼び出されます。|
|[コントロール::オンボーダースタイル変更](#onborderstylechanged)|ストックボーダースタイルプロパティが変更されたときに呼び出されます。|
|[コントロール::オンクリック](#onclick)|株式クリックイベントを発生させるために呼び出されます。|
|[コントロール::閉じる](#onclose)|呼び出されたコントロール`IOleControl::Close`に通知します。|
|[コントロール::オンド動詞](#ondoverb)|コントロール動詞が実行された後に呼び出されます。|
|[コントロール::オンドロー](#ondraw)|コントロールが自身を再描画するように要求されたときに呼び出されます。|
|[コントロール::オンドローメタファイル](#ondrawmetafile)|メタファイル デバイス コンテキストを使用してコントロールが再描画を要求されたときに、コンテナーによって呼び出されます。|
|[コントロール::オンエディット](#onedit)|コンテナが UI に呼び出す OLE コントロールをアクティブ化します。|
|[コントロール::オンEnabled変更](#onenabledchanged)|ストックの Enabled プロパティが変更されたときに呼び出されます。|
|[コントロール::オン列挙動詞](#onenumverbs)|コントロールの動詞を列挙するためにコンテナーによって呼び出されます。|
|[コントロール::イベントアドバイス](#oneventadvise)|イベント ハンドラーがコントロールに接続またはコントロールから切断されたときに呼び出されます。|
|[コントロール::フォント変更](#onfontchanged)|ストック Font プロパティが変更されたときに呼び出されます。|
|[コントロール::オンフォーカラー変更](#onforecolorchanged)|ストック ForeColor プロパティが変更されたときに呼び出されます。|
|[コントロール::オンフリーズイベント](#onfreezeevents)|コントロールのイベントが固定またはフリーズ解除されたときに呼び出されます。|
|[コントロール::オンゲットカラーセット](#ongetcolorset)|呼び出されたコントロール`IOleObject::GetColorSet`に通知します。|
|[コントロール::オンゲットコントロール情報](#ongetcontrolinfo)|コンテナーにニーモニック情報を提供します。|
|[コントロール::オンゲット表示文字列](#ongetdisplaystring)|プロパティ値を表す文字列を取得するために呼び出されます。|
|[コントロール::オンゲットインプレイスメニュー](#ongetinplacemenu)|コンテナー メニューにマージされるコントロールのメニューのハンドルを要求します。|
|[コントロール::オンゲットナチュラルエクステント](#ongetnaturalextent)|指定されたサイズおよびエクステント モードに最も近いコントロールの表示サイズを取得するには、オーバーライドします。|
|[コントロール::オンゲット事前定義文字列](#ongetpredefinedstrings)|プロパティの可能な値を表す文字列を返します。|
|[コントロール::オンゲット事前定義値](#ongetpredefinedvalue)|定義済みの文字列に対応する値を返します。|
|[コントロール::オンゲットビューエクステント](#ongetviewextent)|コントロールの表示領域のサイズを取得するには、オーバーライドします(2 パス描画を有効にできます)。|
|[コントロール::オンゲットビューレック](#ongetviewrect)|コントロールのサイズを特定の位置から始まる四角形に変換する場合にオーバーライドします。|
|[コントロール::オンゲットビューステータス](#ongetviewstatus)|コントロールのビューの状態を取得するためにオーバーライドします。|
|[コントロール::オンハイドツールバー](#onhidetoolbars)|コントロールが UI 非アクティブ化されたときにコンテナーによって呼び出されます。|
|[コントロール::アクティブマウス移動](#oninactivemousemove)|マウス ポインターの下の非アクティブなコントロールのコンテナーがコントロールにメッセージWM_MOUSEMOVEディスパッチするようにオーバーライドします。|
|[コントロール::アクティブなセットカーソル](#oninactivesetcursor)|マウス ポインターの下の非アクティブなコントロールのコンテナーがコントロールにメッセージWM_SETCURSORディスパッチするようにオーバーライドします。|
|[コントロール::オンキーダウンイベント](#onkeydownevent)|ストック KeyDown イベントが発生した後に呼び出されます。|
|[コントロール::キープレスイベント](#onkeypressevent)|ストック KeyPress イベントが発生した後に呼び出されます。|
|[コントロール::オンキーアップイベント](#onkeyupevent)|ストック KeyUp イベントが発生した後に呼び出されます。|
|[コントロール::オンマッププロパティページ](#onmappropertytopage)|プロパティの編集に使用するプロパティ ページを示します。|
|[コントロール::オンムネモニック](#onmnemonic)|コントロールのニーモニック キーが押されたときに呼び出されます。|
|[コントロール::オンプロパティ](#onproperties)|コントロールの "プロパティ" 動詞が呼び出されたときに呼び出されます。|
|[コントロール::オンクエリヒットポイント](#onqueryhitpoint)|コントロールの表示が特定のポイントと重なっているかどうかを問い合わせるためにオーバーライドします。|
|[コントロール::オンクエリヒットレクト](#onqueryhitrect)|コントロールの表示が指定された四角形の任意のポイントと重なっているかどうかを問い合わせます。|
|[コントロール::オンレンダリングデータ](#onrenderdata)|指定した形式でデータを取得するために、フレームワークによって呼び出されます。|
|[コントロール::オンレンダリングファイルデータ](#onrenderfiledata)|指定した形式でファイルからデータを取得するために、フレームワークによって呼び出されます。|
|[コントロール::オンレンダリンググローバルデータ](#onrenderglobaldata)|指定した形式でグローバル メモリからデータを取得するために、フレームワークによって呼び出されます。|
|[コントロール::オンリセット状態](#onresetstate)|コントロールのプロパティを既定値にリセットします。|
|[コントロール::オンセットクライアントサイト](#onsetclientsite)|呼び出されたコントロール`IOleControl::SetClientSite`に通知します。|
|[コントロール::オンセットデータ](#onsetdata)|コントロールのデータを別の値に置き換えます。|
|[コントロール::オンセットエクステント](#onsetextent)|コントロールの範囲が変更された後に呼び出されます。|
|[コントロール::オンセットオブジェクトレクト](#onsetobjectrects)|コントロールのディメンションが変更された後に呼び出されます。|
|[コントロール::オンショーツールバー](#onshowtoolbars)|コントロールが UI アクティブになったときに呼び出されます。|
|[コントロール::テキスト変更](#ontextchanged)|ストック テキスト または キャプション プロパティが変更されたときに呼び出されます。|
|[コントロール::ウィンドウレスメッセージ](#onwindowlessmessage)|ウィンドウなしのコントロールのウィンドウ メッセージ (マウスメッセージやキーボード メッセージ以外) を処理します。|
|[コントロール::Pレントトクライアント](#parenttoclient)|コンテナーの原点を基準にしたポイントを、コントロールの原点を基準としたポイントに変換します。|
|[コントロール::Post モーダルダイアログ](#postmodaldialog)|モーダル ダイアログ ボックスが閉じられたことをコンテナーに通知します。|
|[コントロール::Pモーダルダイアログ](#premodaldialog)|モーダル ダイアログ ボックスが表示されようとしていることをコンテナーに通知します。|
|[コントロールウィンドウを再作成します。](#recreatecontrolwindow)|コントロールのウィンドウを破棄し、再作成します。|
|[コントロール::リフレッシュ](#refresh)|コントロールの外観を強制的に再描画します。|
|[コントロール::リリースキャプチャ](#releasecapture)|マウス キャプチャを解放します。|
|[コントロール::リリースDC](#releasedc)|ウィンドウなしコントロールのコンテナーのディスプレイ デバイス コンテキストを解放します。|
|[コントロールウィンドウ:リペアレントコントロールウィンドウ](#reparentcontrolwindow)|コントロール ウィンドウの親をリセットします。|
|[コントロール::リセットストックプロップ](#resetstockprops)|ストック`COleControl`プロパティを既定値に初期化します。|
|[コントロール::リセットバージョン](#resetversion)|バージョン番号を指定された値に初期化します。|
|[コントロール::スクロールウィンドウ](#scrollwindow)|ウィンドウなしのコントロールが、ディスプレイ上のインプレイス アクティブ イメージ内の領域をスクロールできるようにします。|
|[コントロール::フォントオブジェクトの選択](#selectfontobject)|カスタムの Font プロパティをデバイス コンテキストに選択します。|
|[コントロール::ストックフォントを選択します。](#selectstockfont)|デバイス コンテキストにストック Font プロパティを選択します。|
|[コントロール::シリアル範囲](#serializeextent)|コントロールの表示領域をシリアル化または初期化します。|
|[コントロール::シリアルストックプロップス](#serializestockprops)|ストック プロパティをシリアル化`COleControl`または初期化します。|
|[コントロール::シリアルバージョン](#serializeversion)|コントロールのバージョン情報をシリアル化または初期化します。|
|[コントロール::設定外観](#setappearance)|ストック外観プロパティの値を設定します。|
|[コントロール::セットバックカラー](#setbackcolor)|ストックの BackColor プロパティの値を設定します。|
|[コントロール::セットボーダースタイル](#setborderstyle)|ストックボーダースタイルプロパティの値を設定します。|
|[コントロール::セットキャプチャ](#setcapture)|コントロールの代わりに、コントロールのコンテナー ウィンドウにマウス キャプチャを取得させます。|
|[コントロール::コントロールサイズを設定します。](#setcontrolsize)|OLE コントロールの位置とサイズを設定します。|
|[コントロール::セット有効](#setenabled)|ストックの有効なプロパティの値を設定します。|
|[コントロール::セットフォーカス](#setfocus)|コントロールのコンテナー ウィンドウに、コントロールの代わりに入力フォーカスを取得させます。|
|[コントロール::フォントを設定します。](#setfont)|ストックフォントプロパティの値を設定します。|
|[コントロール::設定フォーカラー](#setforecolor)|ストック ForeColor プロパティの値を設定します。|
|[コントロール::セットイニシャルサイズ](#setinitialsize)|コンテナに最初に表示されたときの OLE コントロールのサイズを設定します。|
|[コントロール::セット修正フラグ](#setmodifiedflag)|コントロールの変更状態を変更します。|
|[コントロール::セットは許可されていません](#setnotpermitted)|編集要求が失敗したことを示します。|
|[コントロール::セットはサポートされていません](#setnotsupported)|ユーザーがコントロールのプロパティ値を変更できないようにします。|
|[コントロール::セットレクティンコンテナ](#setrectincontainer)|コントロールのコンテナーを基準にして四角形を設定します。|
|[コントロール::テキストの設定](#settext)|ストックテキストまたはキャプションプロパティの値を設定します。|
|[コントロール::スローエラー](#throwerror)|OLE コントロールでエラーが発生したことを示します。|
|[コントロール::トランスフォームクードル](#transformcoords)|コンテナーとコントロールの間の座標値を変換します。|
|[コントロール::翻訳色](#translatecolor)|OLE_COLOR値を COLORREF 値に変換します。|
|[読み込み中に](#willambientsbevalidduringload)|アンビエント プロパティを、次回のコントロールの読み込み時に使用できるかどうかを決定します。|
|[コントロール::ウィンドウプロセッサ](#windowproc)|オブジェクトの Windows プロシージャ`COleControl`を提供します。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[コントロール::Dローコンテンツ](#drawcontent)|コントロールの外観を更新する必要があるときに、フレームワークによって呼び出されます。|
|[:Dローメタファイル](#drawmetafile)|メタファイル デバイス コンテキストが使用されているときに、フレームワークによって呼び出されます。|
|[コントロール::IsInvoke 許可](#isinvokeallowed)|オートメーション メソッドの呼び出しを有効にします。|
|[コントロール::セットイニシャルデータフォーマット](#setinitialdataformats)|コントロールでサポートされているデータ形式のリストを初期化するために、フレームワークによって呼び出されます。|

## <a name="remarks"></a>解説

から派生`CWnd`したこのクラスは、Windows ウィンドウ オブジェクトのすべての機能に加えて、イベントの発生やメソッドやプロパティのサポートなど、OLE 固有の機能を継承します。

OLE コントロールは OLE コンテナー アプリケーションに挿入でき、メソッドとプロパティをコンテナに公開する双方向のイベント システムを使用して、コンテナと通信できます。 標準の OLE コンテナは、OLE コントロールの基本機能のみをサポートしています。 OLE コントロールの拡張機能をサポートできません。 イベントの発生は、コントロールで実行される特定のアクションの結果として、イベントがコンテナーに送信されるときに発生します。 さらに、コンテナは、C++ クラスのメンバー関数およびデータ メンバーに似た、公開されたメソッドとプロパティのセットを使用してコントロールと通信します。 この方法を使用すると、開発者はコントロールの外観を制御し、特定のアクションが発生したときにコンテナーに通知できます。

## <a name="windowless-controls"></a>ウィンドウなしのコントロール

OLE コントロールは、ウィンドウなしでアクティブな場所で使用できます。 ウィンドウレスコントロールには、次のような大きな利点があります。

- ウィンドウレスコントロールは透明で長方形でない場合があります

- ウィンドウなしのコントロールは、オブジェクトのインスタンスサイズと作成時間を削減します。

コントロールはウィンドウを必要としません。 ウィンドウが提供するサービスは、単一の共有ウィンドウ (通常はコンテナー) と少しのディスパッチ コードを介して簡単に提供できます。 ウィンドウを持つことは、ほとんどがオブジェクト上の不必要な合併症です。

ウィンドウなしのアクティブ化を使用する場合、コンテナー (ウィンドウを持つ) は、コントロールのウィンドウによって提供されるサービスを提供する役割を担います。 たとえば、コントロールがキーボード フォーカスの照会、マウス キャプチャのクエリ、またはデバイス コンテキストの取得を行う必要がある場合、これらの操作はコンテナーによって管理されます。 ウィンドウ`COleControl`なし操作メンバー関数は、コンテナーに対してこれらの操作を呼び出します。

ウィンドウなしのアクティブ化が有効になっている場合、コンテナーは、入力メッセージをコントロール`IOleInPlaceObjectWindowless`のインターフェイス (ウィンドウなしのサポートのための[IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)の拡張機能) にデリゲートします。 `COleControl`このインターフェイスの実装は、マウスの座標を適切に調整した後、コントロールのメッセージ マップを通じてこれらのメッセージをディスパッチします。 これらのメッセージは、メッセージ マップに対応するエントリを追加することで、通常のウィンドウ メッセージと同様に処理できます。

ウィンドウなしのコントロールでは、対応するメンバー関数や`COleControl`関連する`CWnd`Windows API 関数の代わりに、常にメンバー関数を使用する必要があります。

OLE コントロール オブジェクトは、アクティブになったときにのみウィンドウを作成できますが、アクティブでない遷移に必要な作業量が増え、遷移の速度が下がります。 これが問題である場合があります:例として、テキスト ボックスのグリッドを検討してください。 列を上下にカーソルを移動する場合、各コントロールをインプレースアクティブにしてから非アクティブ化する必要があります。 非アクティブ/アクティブな遷移の速度は、スクロール速度に直接影響します。

OLE コントロール フレームワークの開発の詳細については[、「MFC ActiveX コントロール](../../mfc/mfc-activex-controls.md)と[概要 : MFC ActiveX コントロール プログラムの作成](../../mfc/reference/mfc-activex-control-wizard.md)」を参照してください。 ウィンドウなしコントロールやちらつきのないコントロールなど、OLE コントロールの最適化については[、「MFC ActiveX コントロール: 最適化](../../mfc/mfc-activex-controls-optimization.md)」を参照してください。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxctl.h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>コントロール::アンビエントバックカラー

アンビエント BackColor プロパティの値を返します。

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント BackColor プロパティの現在の値 (存在する場合)。 プロパティがサポートされていない場合、この関数はシステム定義の Windows 背景色を返します。

### <a name="remarks"></a>解説

アンビエント BackColor プロパティは、すべてのコントロールで使用でき、コンテナーによって定義されます。 コンテナはこのプロパティをサポートする必要はありません。

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>コントロール::アンビエントディスプレイ名

コンテナーがコントロールに割り当てた名前は、ユーザーに表示されるエラー メッセージに使用できます。

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>戻り値

OLE コントロールの名前。 既定では、長さ 0 の文字列です。

### <a name="remarks"></a>解説

コンテナはこのプロパティをサポートする必要はありません。

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>コントロール::アンビエントフォント

アンビエント Font プロパティの値を返します。

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント フォント ディスパッチ インターフェイスへのポインター。 既定値は NULL です。 戻り値が NULL でない場合は[、IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)メンバー関数を呼び出してフォントを解放する必要があります。

### <a name="remarks"></a>解説

アンビエント Font プロパティはコンテナによって定義され、すべてのコントロールで使用できます。コンテナはこのプロパティをサポートする必要はありません。

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>コントロール::アンビエントフォーカラー

プロパティの値を返します。

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント ForeColor プロパティの現在の値 (存在する場合)。 サポートされていない場合、この関数はシステム定義の Windows テキストの色を返します。

### <a name="remarks"></a>解説

アンビエント ForeColor プロパティは、すべてのコントロールで使用でき、コンテナーによって定義されます。 コンテナはこのプロパティをサポートする必要はありません。

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>コントロール::アンビエントロケールID

コンテナのロケール ID を返します。

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>戻り値

コンテナーの LocaleID プロパティの値 (存在する場合)。 このプロパティがサポートされていない場合、この関数は 0 を返します。

### <a name="remarks"></a>解説

コントロールは、LocaleID を使用して、特定のロケールに合わせてユーザー インターフェイスを調整できます。 コンテナはこのプロパティをサポートする必要はありません。

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>コントロール::アンビエントアピアランス

コントロール オブジェクトの現在の外観設定を取得します。

```
short AmbientAppearance();
```

### <a name="return-value"></a>戻り値

コントロールの外観:

- **0**フラットな外観

- **1** 3Dの外観

### <a name="remarks"></a>解説

コントロールのDISPID_AMBIENT_APPEARANCE プロパティの現在の値を取得します。

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>コントロール::アンビエントスケールユニット

コンテナーで使用される単位の種類を返します。

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエントスケール単位を含む文字列。 このプロパティがサポートされていない場合、この関数は長さ 0 の文字列を返します。

### <a name="remarks"></a>解説

コンテナのアンビエント ScaleUnits プロパティを使用して、選択した単位 (twip やセンチメートルなど) でラベル付けされた位置または寸法を表示できます。 コンテナはこのプロパティをサポートする必要はありません。

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>コントロール::アンビエントショーグラブハンドル

コンテナーがアクティブな場合に、コントロールがそれ自体のグラブ ハンドルを表示できるかどうかを決定します。

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>戻り値

グラブ ハンドルを表示する必要がある場合は 0 以外。それ以外の場合は 0。 このプロパティがサポートされていない場合、この関数は 0 以外を返します。

### <a name="remarks"></a>解説

コンテナはこのプロパティをサポートする必要はありません。

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>コントロール::アンビエントショーハッチング

UI がアクティブな場合に、コンテナーがコントロール自体をハッチ パターンで表示できるかどうかを決定します。

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>戻り値

ハッチングパターンを表示する場合は 0 以外。それ以外の場合は 0。 このプロパティがサポートされていない場合、この関数は 0 以外を返します。

### <a name="remarks"></a>解説

コンテナはこのプロパティをサポートする必要はありません。

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>コントロール::アンビエントテキスト整列

コントロール コンテナーが優先するアンビエント テキストの配置を決定します。

```
short AmbientTextAlign();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント TextAlign プロパティの状態。 このプロパティがサポートされていない場合、この関数は 0 を返します。

有効な戻り値の一覧を次に示します。

|戻り値|意味|
|------------------|-------------|
|0|一般的な配置 (右の数値、左のテキスト)。|
|1|左の正当化|
|2|Center|
|3|右正当化|

### <a name="remarks"></a>解説

このプロパティは、すべての埋め込みコントロールで使用でき、コンテナーによって定義されます。 コンテナはこのプロパティをサポートする必要はありません。

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>コントロール::アンビエントUIデッド

コンテナーがユーザー インターフェイスの操作にコントロールを応答するかどうかを決定します。

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>戻り値

コントロールがユーザー インターフェイスの操作に応答する場合は 0 以外の値を返します。それ以外の場合は 0。 このプロパティがサポートされていない場合、この関数は 0 を返します。

### <a name="remarks"></a>解説

たとえば、コンテナーはデザイン モードで TRUE に設定できます。

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>コントロール::アンビエントユーザーモード

コンテナがデザイン モードかユーザー モードの場合に決定します。

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>戻り値

コンテナーがユーザー モードの場合は 0 以外。それ以外の場合は 0 (デザイン モード)。 このプロパティがサポートされていない場合、この関数は TRUE を返します。

### <a name="remarks"></a>解説

たとえば、コンテナーはデザイン モードでこれを FALSE に設定できます。

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>コントロール::バインドされたプロパティを変更しました

バインドされたプロパティ値が変更されたことを示します。

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>パラメーター

*Dispid*<br/>
コントロールのバインドされたプロパティのディスパッチ ID。

### <a name="remarks"></a>解説

これは、プロパティの Set メソッドを使用して変更が行われなかった場合でも、プロパティの値が変更されるたびに呼び出す必要があります。 特に、メンバー変数にマップされるバインドされたプロパティに注意してください。 そのようなメンバー変数が変更されるたびに、`BoundPropertyChanged`呼び出す必要があります。

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>コントロール::バインドプロパティ要求編集

コントロールによって提供される`IPropertyNotifySink`バインドされたプロパティ値を変更するアクセス許可をインターフェイスから要求します。

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>パラメーター

*Dispid*<br/>
コントロールのバインドされたプロパティのディスパッチ ID。

### <a name="return-value"></a>戻り値

変更が許可されている場合は 0 以外の値を返します。それ以外の場合は 0。 既定値は 0 以外です。

### <a name="remarks"></a>解説

アクセス許可が拒否された場合、コントロールはプロパティの値を変更しないようにする必要があります。 これは、プロパティ値を変更しようとしたアクションを無視するか、失敗することによって行うことができます。

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>コントロール::クライアントを親に

*pPoint*の座標を親座標に変換します。

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>パラメーター

*lprcBounds*<br/>
コンテナー内の OLE コントロールの境界へのポインター。 クライアント領域ではなく、境界線やスクロール バーを含むコントロール全体の領域。

*pポイント*<br/>
親 (コンテナー) の座標に変換される OLE クライアント領域ポイントへのポインター。

### <a name="remarks"></a>解説

入力時*pPoint*は、OLE コントロールのクライアント領域 (コントロールのクライアント領域の左上隅) の原点を基準にしています。 出力時*の pPoint*は親の原点 (コンテナの左上隅) を基準にしています。

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>コントロール::クリップキャレットレック

キャレット四角形が、オーバーラップしている不透明なオブジェクトで完全に覆われている場合、または部分的に覆われている場合に、その四角形を調整します。

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*Lprect*<br/>
入力時に、調整するキャレット領域を含む[RECT](/windows/win32/api/windef/ns-windef-rect)構造体へのポインター。 出力では、調整されたキャレット領域、またはキャレット四角形が完全に覆われている場合は NULL。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

キャレットは、通常、テキストまたはグラフィックスが挿入される場所を示す点滅する線、ブロック、またはビットマップです。

ウィンドウなしのオブジェクトは、キャレットが重なり合うオブジェクトによって部分的に隠されているか、まったく隠されているかを最初にチェックせずに、キャレットを安全に表示することはできません。 これを可能にするために、オブジェクトはキャレットを調整`ClipCaretRect`(縮小) してクリッピング領域に収まるようにするために使用できます。

キャレットを作成するオブジェクトは、キャレットの四`ClipCaretRect`角形をに送信し、キャレット用に調整された四角形を使用する必要があります。 キャレットが完全に隠されている場合、このメソッドは FALSE を返し、この場合はキャレットをまったく表示しません。

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>コントロール::コントロール

`COleControl` オブジェクトを構築します。

```
COleControl();
```

### <a name="remarks"></a>解説

通常、この関数は直接呼び出されません。 OLE コントロールは、通常、クラス ファクトリによって作成されます。

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>コントロールコントロール::コントロール情報が変更されました

コントロールでサポートされているニーモニックのセットが変更されたときに、この関数を呼び出します。

```
void ControlInfoChanged();
```

### <a name="remarks"></a>解説

この通知を受け取ると、コントロールのコンテナーは[、IOleControl::GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)を呼び出すことによって、新しいニーモニック セットを取得します。 コンテナはこの通知に応答する必要はありません。

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>コントロール::D再生エラー

ストック Error イベントが処理された後にフレームワークによって呼び出されます (イベント ハンドラーがエラーの表示を抑制していない場合)。

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>パラメーター

*Scode*<br/>
報告される状態コード値。 考えられるコードの完全な一覧については[、「ActiveX コントロール: 詳細トピック」を参照してください](../../mfc/mfc-activex-controls-advanced-topics.md)。

*説明をします。*<br/>
報告されるエラーの説明。

*ソースを指定します。*<br/>
エラーを生成するモジュールの名前 (通常は OLE コントロール モジュールの名前)。

*ファイル*<br/>
エラーの説明を含むヘルプ ファイルの名前。

*ヘルプID*<br/>
報告されるエラーのヘルプ コンテキスト ID。

### <a name="remarks"></a>解説

既定の動作では、エラーの説明を含むメッセージ ボックスが*表示されます*。

エラーの表示方法をカスタマイズするには、この関数をオーバーライドします。

## <a name="colecontroldoclick"></a><a name="doclick"></a>コントロール::Doクリック

コントロール上でのマウス クリック操作をシミュレートします。

```
void DoClick();
```

### <a name="remarks"></a>解説

オーバーライド可能な`COleControl::OnClick`メンバー関数が呼び出され、コントロールでサポートされている場合は、ストック Click イベントが発生します。

この関数は、基本クラス`COleControl`で DoClick という名前のストック メソッドとしてサポートされています。 詳細については、「 [ActiveX コントロール : メソッド](../../mfc/mfc-activex-controls-methods.md)」を参照してください。

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>コントロール::Doプロップエクスチェンジ

ストリームやプロパティ セットなどの永続的なストレージ表現からコントロールを読み込むか格納するときに、フレームワークによって呼び出されます。

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>パラメーター

*pPX*<br/>
`CPropExchange` オブジェクトを指すポインターです。 フレームワークは、プロパティ交換のコンテキストを確立するために、このオブジェクトを提供します。

### <a name="remarks"></a>解説

通常、この関数は、OLE コントロールの特定のユーザー定義プロパティを読み込むか、または格納する関数の**PX_** ファミリを呼び出します。

コントロール ウィザードを使用して OLE コントロール プロジェクトを作成した場合、この関数のオーバーライドされたバージョンは、`COleControl``COleControl::DoPropExchange`基本クラス関数 の呼び出しでサポートされるストック プロパティをシリアル化します。 ユーザー定義プロパティを OLE コントロールに追加する場合は、新しいプロパティをシリアル化するためにこの関数を変更する必要があります。 シリアル化の詳細については[、「ActiveX コントロール : シリアル化](../../mfc/mfc-activex-controls-serializing.md)」を参照してください。

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>コントロール::Doスーパークラスペイント

Windows コントロールからサブクラス化された OLE コントロールを再描画します。

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
コントロール コンテナーのデバイス コンテキストへのポインター。

*rcバウンド*<br/>
コントロールが描画される領域。

### <a name="remarks"></a>解説

非アクティブな OLE コントロールの描画を適切に処理します。 この関数は、OLE コントロールが Windows コントロールのサブクラスを作成し、コントロールの`OnDraw`関数で呼び出す必要がある場合にのみ使用してください。

この関数と Windows コントロールのサブクラス化の詳細については[、「ActiveX コントロール: Windows コントロールのサブクラス化](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)」を参照してください。

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>コントロール::Dローコンテンツ

コントロールの外観を更新する必要があるときに、フレームワークによって呼び出されます。

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
デバイス コンテキストへのポインター。

*Rc*<br/>
描画する矩形領域。

### <a name="remarks"></a>解説

この関数は、オーバーライド可能な`OnDraw`関数を直接呼び出します。

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>:Dローメタファイル

メタファイル デバイス コンテキストが使用されているときに、フレームワークによって呼び出されます。

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
メタファイル デバイス コンテキストへのポインター。

*Rc*<br/>
描画する矩形領域。

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>コントロール::イネーブルシンプルフレーム

OLE コントロールの単純なフレーム特性を有効にします。

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>解説

この特性により、コントロールは他のコントロールの視覚的なコンテインメントをサポートできますが、実際の OLE コンテインメントはサポートしません。 たとえば、複数のコントロールが含まれるグループ ボックスがあります。 これらのコントロールは OLE に含まれていませんが、同じグループ ボックスに含まれています。

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>コントロール::エクスチェンジエクステント

コントロールのエクステントの状態 (HIMETRIC 単位のディメンション) をシリアル化または初期化します。

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>パラメーター

*pPX*<br/>
[オブジェクトへの](../../mfc/reference/cpropexchange-class.md)ポインター。 フレームワークは、プロパティ交換のコンテキストを確立するために、このオブジェクトを提供します。

### <a name="return-value"></a>戻り値

関数が成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

この関数は通常、 の既定の`COleControl::DoPropExchange`実装によって呼び出されます。

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>コントロール::エクスチェンジストックプロップス

コントロールのストック プロパティの状態をシリアル化または初期化します。

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>パラメーター

*pPX*<br/>
[オブジェクトへの](../../mfc/reference/cpropexchange-class.md)ポインター。 フレームワークは、プロパティ交換のコンテキストを確立するために、このオブジェクトを提供します。

### <a name="remarks"></a>解説

この関数は通常、 の既定の`COleControl::DoPropExchange`実装によって呼び出されます。

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>コントロール::交換バージョン

コントロールのバージョン情報の状態をシリアル化または初期化します。

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>パラメーター

*pPX*<br/>
`CPropExchange` オブジェクトを指すポインターです。 フレームワークは、プロパティ交換のコンテキストを確立するために、このオブジェクトを提供します。

*デフォルト*<br/>
コントロールの現在のバージョン番号。

*b変換*<br/>
保存時に永続データを最新の形式に変換するか、またはロードされたのと同じ形式で維持するかを示します。

### <a name="return-value"></a>戻り値

関数の 0 以外の値は成功しました。それ以外の場合は 0。

### <a name="remarks"></a>解説

通常、これは コントロールの オーバーライドによって呼び出される最初の関数`COleControl::DoPropExchange`です。 読み込み時に、この関数は永続データのバージョン番号を読み取り、それに応じて[CPropExchange](../../mfc/reference/cpropexchange-class.md)オブジェクトのバージョン属性を設定します。 保存時に、この関数は永続データのバージョン番号を書き込みます。

永続性とバージョン管理の詳細については[、「ActiveX コントロール : シリアル化](../../mfc/mfc-activex-controls-serializing.md)」を参照してください。

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>コントロール::火災クリック

アクティブなコントロール上でマウスがクリックされたときに、フレームワークによって呼び出されます。

```
void FireClick();
```

### <a name="remarks"></a>解説

このイベントがカスタム イベントとして定義されている場合は、イベントがいつ発生するかを決定します。

Click イベントを自動的に起動するには、コントロールのイベント マップにストック Click イベントが定義されている必要があります。

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>コントロール::FireDblクリック

アクティブなコントロール上でマウスをダブルクリックしたときに、フレームワークによって呼び出されます。

```
void FireDblClick();
```

### <a name="remarks"></a>解説

このイベントがカスタム イベントとして定義されている場合は、イベントがいつ発生するかを決定します。

DblClick イベントの自動起動を行うには、コントロールのイベント マップにストック DblClick イベントが定義されている必要があります。

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>コントロール::火災エラー

ストック エラー イベントを発生させます。

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>パラメーター

*Scode*<br/>
報告される状態コード値。 考えられるコードの完全な一覧については[、「ActiveX コントロール: 詳細トピック」を参照してください](../../mfc/mfc-activex-controls-advanced-topics.md)。

*説明をします。*<br/>
報告されるエラーの説明。

*ヘルプID*<br/>
報告されるエラーのヘルプ ID。

### <a name="remarks"></a>解説

このイベントは、コントロール内でエラーが発生したことをコード内の適切な場所で通知する方法を提供します。 Click や MouseMove などの他のストック イベントとは異なり、エラーはフレームワークによって発生することはありません。

プロパティの get 関数、プロパティ セット関数、またはオートメーション メソッドの間に発生するエラーを報告するには[、COleControl::ThrowError](#throwerror)を呼び出します。

OLE コントロールの株価エラー イベントの実装では、SCODE 値が使用されます。 コントロールがこのイベントを使用し、Visual Basic 4.0 で使用する予定の場合、SCODE 値は Visual Basic ではサポートされていないため、エラーが発生します。

この問題を解決するには、コントロールの SCODE パラメータを手動で変更します。ODL ファイルを**長い**. また、SCODE パラメータを使用するカスタム イベント、メソッド、またはプロパティでも同じ問題が発生します。

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>コントロール::火災イベント

任意の数のオプション引数を指定して、コントロールからユーザー定義のイベントを発生させます。

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>パラメーター

*Dispid*<br/>
発生するイベントのディスパッチ ID。

*pbパラム*<br/>
イベントのパラメーター型の記述子。

### <a name="remarks"></a>解説

通常、この関数は直接呼び出さないでください。 代わりに、コントロールのクラス宣言のイベント マップ セクションでイベント発生関数を呼び出します。

*pbParams*引数はスペースで区切られた**VTS_** のリストです。 スペース (コンマではない) で区切られるこれらの値の 1 つ以上は、関数のパラメーター リストを指定します。 使用できる値は次のとおりです。

|Symbol|パラメーターのタイプ|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> すべてのバリアント型に対して、バリアント型のデータ定数へのポインターを提供するVTS_FONTとVTS_PICTUREを除く、追加のバリアント定数が定義されています。 これらの定数は **、VTS_P**`constantname`の規則を使用して名前が付けられます。 たとえば、VTS_PCOLORはVTS_COLOR定数へのポインターです。

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>コントロール::ファイアキーダウン

コントロールが UI アクティブのときにキーが押されたときに、フレームワークによって呼び出されます。

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>パラメーター

*プンチャー*<br/>
押されたキーの仮想キー コード値へのポインター。 標準の仮想キー コードの一覧については、Winuser.h を参照してください。

*状態*<br/>
次のフラグの組み合わせを含みます。

- SHIFT_MASK Shift キーがアクション中に押されました。

- CTRL_MASK 操作中に Ctrl キーが押されました。

- ALT_MASKアクション中に Alt キーが押されました。

### <a name="remarks"></a>解説

このイベントがカスタム イベントとして定義されている場合は、イベントがいつ発生するかを決定します。

KeyDown イベントを自動的に起動するには、コントロールのイベント マップにストック KeyDown イベントが定義されている必要があります。

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>コントロール::火のキープレス

カスタム コントロールがコンテナー内で UI Active であるときにキーが押されて解放されたときに、フレームワークによって呼び出されます。

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>パラメーター

*プンチャー*<br/>
押されたキーの文字値へのポインター。

### <a name="remarks"></a>解説

このイベントがカスタム イベントとして定義されている場合は、イベントがいつ発生するかを決定します。

イベントの受信者は、たとえば、すべての小文字を大文字に変換する*pnChar*を変更できます。 変更した文字を調べる場合は、`OnKeyPressEvent`をオーバーライドします。

KeyPress イベントの自動起動を行うには、コントロールのイベント マップにストック KeyPress イベントが定義されている必要があります。

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>コントロール::ファイアキーアップ

カスタム コントロールがコンテナー内で UI Active である間にキーが解放されたときに、フレームワークによって呼び出されます。

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>パラメーター

*プンチャー*<br/>
解放されたキーの仮想キー コード値へのポインター。 標準の仮想キー コードの一覧については、Winuser.h を参照してください。

*状態*<br/>
次のフラグの組み合わせを含みます。

- SHIFT_MASK Shift キーがアクション中に押されました。

- CTRL_MASK 操作中に Ctrl キーが押されました。

- ALT_MASKアクション中に Alt キーが押されました。

### <a name="remarks"></a>解説

このイベントがカスタム イベントとして定義されている場合は、イベントがいつ発生するかを決定します。

KeyUp イベントを自動的に起動するには、コントロールのイベント マップにストック KeyUp イベントが定義されている必要があります。

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>コントロール::火のマウスダウン

アクティブなカスタム コントロール上でマウス ボタンが押されたときに、フレームワークによって呼び出されます。

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>パラメーター

*nボタン*<br/>
マウス ボタンが押された数値。 次のいずれかの値を含めることができます。

- LEFT_BUTTON マウスの左ボタンが押された。

- MIDDLE_BUTTON マウスの中ボタンが押された。

- RIGHT_BUTTON マウスの右ボタンが押された。

*状態*<br/>
次のフラグの組み合わせを含みます。

- SHIFT_MASK Shift キーがアクション中に押されました。

- CTRL_MASK 操作中に Ctrl キーが押されました。

- ALT_MASKアクション中に Alt キーが押されました。

*X*<br/>
マウス ボタンが押されたときのカーソルの x 座標。 座標は、コントロール ウィンドウの左上隅を基準にしています。

*Y*<br/>
マウス ボタンが押されたときのカーソルの y 座標。 座標は、コントロール ウィンドウの左上隅を基準にしています。

### <a name="remarks"></a>解説

このイベントがカスタム イベントとして定義されている場合は、イベントがいつ発生するかを決定します。

MouseDown イベントを自動起動するには、コントロールのイベント マップに、ストックの MouseDown イベントが定義されている必要があります。

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>コントロール::火のマウス移動

アクティブなカスタム コントロール上でカーソルが移動したときに、フレームワークによって呼び出されます。

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>パラメーター

*nボタン*<br/>
押されたマウス ボタンの数値。 次の値の組み合わせが含まれます。

- LEFT_BUTTON アクション中にマウスの左ボタンが押された。

- MIDDLE_BUTTON アクション中にマウスの中ボタンが押された。

- RIGHT_BUTTON アクション中にマウスの右ボタンが押された。

*状態*<br/>
次のフラグの組み合わせを含みます。

- SHIFT_MASK Shift キーがアクション中に押されました。

- CTRL_MASK 操作中に Ctrl キーが押されました。

- ALT_MASKアクション中に Alt キーが押されました。

*X*<br/>
カーソルの x 座標。 座標は、コントロール ウィンドウの左上隅を基準にしています。

*Y*<br/>
カーソルの y 座標。 座標は、コントロール ウィンドウの左上隅を基準にしています。

### <a name="remarks"></a>解説

このイベントがカスタム イベントとして定義されている場合は、イベントがいつ発生するかを決定します。

MouseMove イベントを自動的に起動するには、コントロールのイベント マップに、ストックの MouseMove イベントが定義されている必要があります。

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>コントロール::火のマウスアップ

アクティブなカスタム コントロール上でマウス ボタンが離されたときに、フレームワークによって呼び出されます。

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>パラメーター

*nボタン*<br/>
マウス ボタンを離した数値。 次のいずれかの値になります。

- LEFT_BUTTON マウスの左ボタンが離されました。

- MIDDLE_BUTTON マウスの中央ボタンが離されました。

- RIGHT_BUTTON マウスの右ボタンが離されました。

*状態*<br/>
次のフラグの組み合わせを含みます。

- SHIFT_MASK Shift キーがアクション中に押されました。

- CTRL_MASK 操作中に Ctrl キーが押されました。

- ALT_MASKアクション中に Alt キーが押されました。

*X*<br/>
マウス ボタンが離されたときのカーソルの x 座標。 座標は、コントロール ウィンドウの左上隅を基準にしています。

*Y*<br/>
マウス ボタンが離されたときのカーソルの y 座標。 座標は、コントロール ウィンドウの左上隅を基準にしています。

### <a name="remarks"></a>解説

このイベントがカスタム イベントとして定義されている場合は、イベントがいつ発生するかを決定します。

MouseUp イベントを自動起動するには、コントロールのイベント マップに、ストックの MouseUp イベントが定義されている必要があります。

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>コントロール::火災状態変更

コントロールの準備状態の現在の値を持つイベントを発生させます。

```
void FireReadyStateChange();
```

### <a name="remarks"></a>解説

準備完了状態は、次のいずれかの値になります。

|||
|-|-|
|READYSTATE_UNINITIALIZED|既定の初期化状態|
|READYSTATE_LOADING|コントロールは現在そのプロパティを読み込んでいます|
|READYSTATE_LOADED|コントロールが初期化されました|
|READYSTATE_INTERACTIVE|コントロールには対話的に使用できる十分なデータがありますが、すべての非同期データがまだ読み込まれているわけではありません|
|READYSTATE_COMPLETE|コントロールにはすべてのデータが含|

コントロールの現在の準備状況を確認するには[、GetReadyState](#getreadystate)を使用します。

[準備完了](#internalsetreadystate)状態を指定された値に変更し、呼び出`FireReadyStateChange`します。

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>コントロール::取得ライセンス認証ポリシー

インターフェイスをサポートするコントロールの既定のアクティブ化動作を`IPointerInactive`変更します。

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>戻り値

POINTERINACTIVE 列挙体からのフラグの組み合わせ。 可能なフラグは次のとおりです。

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|マウスの移動操作中にマウスがオブジェクトに入ると、オブジェクトをインプレースでアクティブにする必要があります。|
|POINTERINACTIVE_DEACTIVATEONLEAVE|マウスの移動操作中にマウスがオブジェクトから離れるときは、オブジェクトを非アクティブにする必要があります。|
|POINTERINACTIVE_ACTIVATEONDRAG|ドラッグ アンド ドロップ操作中にマウスをドラッグすると、オブジェクトをインプレース でアクティブにする必要があります。|

### <a name="remarks"></a>解説

インターフェイスが`IPointerInactive`有効な場合、コンテナーはWM_SETCURSORを委任し、メッセージをWM_MOUSEMOVEします。 `COleControl`このインターフェイスの実装は、マウスの座標を適切に調整した後、コントロールのメッセージ マップを通じてこれらのメッセージをディスパッチします。

コンテナーは、マウス ポインターをサポートする`IPointerInactive`非アクティブなオブジェクトの上にマウス ポインターを使用して、WM_SETCURSOR`GetActivationPolicy`またはWM_MOUSEMOVE メッセージを受信するたびに、インターフェイスを呼び出し、POINTERINACTIVE 列挙体からフラグを返す必要があります。

これらのメッセージは、メッセージ マップに対応するエントリを追加することで、通常のウィンドウ メッセージと同じように処理できます。 ハンドラでは、最初に値が`m_hWnd`NULL 以外であることを確認せずに、メンバー変数 (またはそれを使用するメンバー関数) を使用しないようにします。

特別な視覚的フィードバックを与えるなど、マウスカーソルを設定したり、マウス移動イベントを発生させたりする以外に行うオブジェクトは、POINTERINACTIVE_ACTIVATEONENTRYフラグを返し、アクティブな場合にのみフィードバックを描画する必要があります。 オブジェクトがこのフラグを返す場合、コンテナーは即座にインプレースでアクティブ化し、呼び出しをトリガーしたメッセージ`GetActivationPolicy`をに転送する必要があります。

POINTERINACTIVE_ACTIVATEONENTRYフラグとPOINTERINACTIVE_DEACTIVATEONLEAVEフラグの両方が返された場合、オブジェクトはオブジェクト上にマウスが表示されている場合にのみアクティブになります。 POINTERINACTIVE_ACTIVATEONENTRYフラグのみが返された場合、オブジェクトはマウスが最初にオブジェクトに入ったときに 1 回だけアクティブになります。

また、非アクティブなコントロールを OLE ドラッグ アンド ドロップ操作の対象にすることもできます。 そのためには、ユーザーがオブジェクトをドラッグした時点でコントロールをアクティブにする必要があります。 ドラッグ中にアクティブ化を行う場合は、POINTERINACTIVE_ACTIVATEONDRAG フラグを返します。

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

通信する`GetActivationPolicy`情報は、コンテナによってキャッシュに入れてはならない。 代わりに、このメソッドは、マウスが非アクティブなオブジェクトに入るたびに呼び出す必要があります。

マウスが入ったときにアクティブにするオブジェクトを非アクティブにする要求が非アクティブでない場合、コンテナーは、マウス ポインターがオブジェクト上にある限り[OnInactiveSetCursor](#oninactivesetcursor)を呼び出すことによって、このオブジェクトに後続のWM_SETCURSOR メッセージをディスパッチする必要があります。

通常、`IPointerInactive`インターフェイスを有効にすると、コントロールで常にマウス メッセージを処理できるようになります。 `IPointerInactive`インターフェイスをサポートしていないコンテナーでこの動作を取得するには、コントロールを常にアクティブにする必要があります表示されている場合、コントロールは、その他のフラグの中でOLEMISC_ACTIVATEWHENVISIBLEフラグを持っている必要があります。 ただし、 をサポート`IPointerInactive`するコンテナーでこのフラグが有効にならないようにするには、OLEMISC_IGNOREACTIVATEWHENVISIBLE フラグを指定することもできます。

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>コントロール::アンビエントプロパティ

コンテナーのアンビエント プロパティの値を取得します。

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>パラメーター

*ドウディスピピッド*<br/>
目的のアンビエント プロパティのディスパッチ ID。

*vtプロップ*<br/>
*pvProp*で返される値の型を指定するバリアント型タグ。

*pv プロップ*<br/>
プロパティ値または戻り値を受け取る変数のアドレスへのポインター。 このポインターの実際の型は *、 vtProp*で指定された型と一致する必要があります。

|vtプロップ|pvProp のタイプ|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>戻り値

アンビエント プロパティがサポートされている場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

を使用`GetAmbientProperty`して、アンビエントディスプレイ名プロパティと ScaleUnits プロパティを取得する場合は *、vtProp*を VT_BSTR に *、pvProp*を に`CString*`設定します。 アンビエント フォント プロパティを取得する場合は *、vtProp*を VT_FONT に *、pvProp*を LPFONTDISP* に設定します。

[アンビエント バックカラー](#ambientbackcolor)やアンビエント[フォント](#ambientfont)などの共通アンビエント プロパティに対して関数が既に用意されています。

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>コントロール::外観を取得します。

コントロールのストック外観プロパティの Get 関数を実装します。

```
short GetAppearance ();
```

### <a name="return-value"></a>戻り値

戻り値は、現在の外観設定を、成功した場合は**短い**(VT_I2) 値として指定します。 コントロールの外観がフラットな場合は 0、コントロールの外観が 3D の場合は 1 です。

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>コントロール::ゲットバックカラー

コントロールのストック BackColor プロパティの取得関数を実装します。

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>戻り値

成功した場合、戻り値は現在の背景色をOLE_COLOR値として指定します。 この値は、 を呼び出して COLORREF`TranslateColor`値に変換できます。

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>コントロール::ゲットボーダースタイル

コントロールのストックボーダースタイルプロパティの取得関数を実装します。

```
short GetBorderStyle();
```

### <a name="return-value"></a>戻り値

コントロールに通常の境界線がある場合は 1。コントロールに境界線がない場合は 0。

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>コントロール::取得キャプチャ

オブジェクトに`COleControl`マウス キャプチャが含まれているかどうかを判断します。

```
CWnd* GetCapture();
```

### <a name="return-value"></a>戻り値

コントロールがアクティブでウィンドウなしの場合は、コントロールに現在マウス キャプチャがある場合は**この**値を返します (コントロールのコンテナーによって決定されます)。

それ以外の`CWnd`場合は、マウス キャプチャを持つオブジェクト`CWnd::GetCapture`を返します (と同じです)。

### <a name="remarks"></a>解説

アクティブ化されたウィンドウなしのコントロールは[、SetCapture](#setcapture)が呼び出されたときにマウス キャプチャを受け取ります。

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>コントロール::クラスIDを取得します。

コントロールの OLE クラス ID を取得するために、フレームワークによって呼び出されます。

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>パラメーター

*pclsid*<br/>
クラス ID の位置へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功しなかった場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

通常[、IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)によって実装されます。

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>コントロール::クライアントオフセットを取得します。

コントロールの四角形領域の左上隅とクライアント領域の左上隅の差を取得します。

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>パラメーター

*pdx オフセット*<br/>
OLE コントロールのクライアント領域の水平オフセットへのポインター。

*pdy オフセット*<br/>
OLE コントロールのクライアント領域の垂直オフセットへのポインター。

### <a name="remarks"></a>解説

OLE コントロールのコンテナー内には四角形の領域があります。 コントロールのクライアント領域は、境界線とスクロール バーを除くコントロール領域です。 取得されるオフセット`GetClientOffset`は、コントロールの四角形領域の左上隅とクライアント領域の左上隅の差です。 コントロールに標準の境界線とスクロール バー以外のクライアント要素がある場合は、このメンバー関数をオーバーライドしてオフセットを指定します。

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>コントロール::クライアントレクトを取得します。

コントロールのクライアント領域のサイズを取得します。

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>パラメーター

*Lprect*<br/>
ウィンドウなしコントロール`RECT`のクライアント領域のサイズを格納する構造体へのポインター。つまり、コントロールのサイズからウィンドウの境界線、フレーム、スクロール バーなどを引いた値です。 *lpRect*パラメーターは、コントロールの位置ではなく、コントロールのクライアント四角形のサイズを示します。

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>コントロール::クライアントサイトを取得します。

オブジェクトに対して、コンテナー内の現在のクライアント サイトへのポインターを照会します。

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>戻り値

コンテナー内のコントロールの現在のクライアント サイトへのポインター。

### <a name="remarks"></a>解説

返されたポインターは`IOleClientSite`のインスタンスを指します。 コンテナー`IOleClientSite`によって実装されるインターフェイスは、オブジェクトのコンテキストのビューです: ドキュメント内でアンカーされている場所、ストレージ、ユーザー インターフェイス、およびその他のリソースを取得します。

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>コントロール::コントロールフラグを取得します。

制御フラグの設定を取得します。

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>戻り値

コントロール フラグ列挙体のフラグの ORed の組み合わせ:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>解説

既定では、`GetControlFlags` は `fastBeginPaint | clipPaintDC` を返します。

|||
|-|-|
|`fastBeginPaint`|設定されている場合は、既定で設定される BeginPaint API の代わりに、OLE コントロール用に調整された[開始ペイント](/windows/win32/api/winuser/nf-winuser-beginpaint)関数を使用します。|
|`clipPaintDC`|設定されていない場合は、行われる呼び`IntersectClipRect`出`COleControl`しを無効にし、小さな速度の利点を得ます。 ウィンドウなしのアクティブ化を使用している場合、フラグは無効です。|
|`pointerInactive`|設定されている場合、既定で無効になっているインターフェイスの実装を`COleControl``IPointerInactive`有効にすることで、コントロールが非アクティブな間にマウス操作が行われます。|
|`noFlickerActivate`|設定すると、余分な描画操作とそれに伴う視覚的なちらつきがなくなります。 コントロールが非アクティブ状態とアクティブ状態で同じように描画される場合に使用します。 ウィンドウなしのアクティブ化を使用している場合、フラグは無効です。|
|`windowlessActivate`|設定されている場合、コントロールがウィンドウなしのアクティブ化を使用します。|
|`canOptimizeDraw`|設定されている場合、コントロールが最適化された描画を実行することを示します (コンテナーがサポートしている場合)。|

OLE コントロールの`GetControlFlags`最適化およびその他の最適化の詳細については、「 [ActiveX コントロール : 最適化](../../mfc/mfc-activex-controls-optimization.md)」を参照してください。

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>コントロール::コントロールサイズを取得します。

OLE コントロール ウィンドウのサイズを取得します。

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>パラメーター

*Pcx*<br/>
コントロールの幅をピクセル単位で指定します。

*pcy*<br/>
コントロールの高さをピクセル単位で指定します。

### <a name="remarks"></a>解説

コントロール ウィンドウのすべての座標は、コントロールの左上隅を基準にしています。

## <a name="colecontrolgetdc"></a><a name="getdc"></a>コントロール::ゲットDC

ウィンドウなしのオブジェクトが、コンテナーから画面 (または互換性のある) デバイス コンテキストを取得できるようにします。

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>パラメーター

*lprcRect*<br/>
ウィンドウなしのコントロールが再描画する四角形へのポインターを、コントロールのクライアント座標で指定します。 NULL は、オブジェクトの全範囲を意味します。

*dwFlags*<br/>
デバイス コンテキストの描画属性。 選択肢は次のとおりです。

- OLEDC_NODRAWオブジェクトがデバイス コンテキストを使用して描画を実行するのではなく、表示デバイスに関する情報を取得するだけであることを示します。 コンテナーは、それ以上処理せずに、ウィンドウの DC を渡すだけです。

- OLEDC_PAINTBKGND DC を返す前に、コンテナーが背景を描画することを要求します。 オブジェクトが、透明な背景を持つ領域を再描画するために DC を要求している場合は、このフラグを使用する必要があります。

- OLEDC_OFFSCREENオブジェクトが画面にコピーする画面外のビットマップにレンダリングすることをコンテナーに通知します。 オブジェクトは、描画操作が実行しようとしているときにこのフラグを使用する必要があります。 コンテナは、この要求を受け入れるかどうか自由です。 ただし、このフラグが設定されていない場合、コンテナーは、画面上の DC を返す必要があります。 これにより、オブジェクトは **(XOR**操作を介して)選択を表示するなどの直接画面操作を実行できます。

### <a name="return-value"></a>戻り値

正常終了した場合は、コンテナー`CWnd`クライアント領域のディスプレイ デバイス コンテキストへのポインター。それ以外の場合は、NULL を返します。 表示デバイス コンテキストは、後続の GDI 関数で使用して、コンテナーのウィンドウのクライアント領域に描画できます。

### <a name="remarks"></a>解説

描画後にコンテキストを解放するには[、ReleaseDC](#releasedc)メンバー関数を呼び出す必要があります。 を呼`GetDC`び出すとき、オブジェクトは、自分のクライアント座標で描画する四角形を渡します。 `GetDC`これらをコンテナークライアント領域の座標に変換します。 オブジェクトは、独自のクライアント領域の四角形よりも大きい描画四角形を要求[しないでください。](#getclientrect) これにより、オブジェクトが意図しない場所に誤って描画されるのを防ぐことができます。

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>コントロール::取得有効

コントロールのストックの "有効" プロパティの Get 関数を実装します。

```
BOOL GetEnabled();
```

### <a name="return-value"></a>戻り値

コントロールが有効な場合は 0 以外。それ以外の場合は 0。

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>コントロール::取得拡張コントロール

プロパティの拡張セットを持つコントロールを表すコンテナーによって保持されるオブジェクトへのポインターを取得します。

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>戻り値

コンテナーの拡張コントロール オブジェクトへのポインター。 使用可能なオブジェクトがない場合、値は NULL です。

このオブジェクトは、その`IDispatch`インターフェイスを介して操作できます。 オブジェクトによって提供`QueryInterface`される他の使用可能なインターフェイスを取得することもできます。 ただし、オブジェクトは、特定のインターフェイスのセットをサポートする必要はありません。 コンテナの拡張制御オブジェクトの特定の機能に依存すると、コントロールを他の任意のコンテナに移植できる範囲が制限されます。

### <a name="remarks"></a>解説

この関数を呼び出す関数は、オブジェクトの処理が終了したときにポインターを解放します。 コンテナはこのオブジェクトをサポートする必要はありません。

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>コントロール::ゲットフォーカス

オブジェクトに`COleControl`フォーカスがあるかどうかを判断します。

```
CWnd* GetFocus();
```

### <a name="return-value"></a>戻り値

コントロールがアクティブでウィンドウなしの場合は、コントロールに現在キーボード フォーカスがある場合は**この**値を返します (コントロールのコンテナーによって決定される場合) 、フォーカスがない場合は NULL を返します。

それ以外の`CWnd`場合は、フォーカスのあるオブジェクトを返します`CWnd::GetFocus`(と同じです)。

### <a name="remarks"></a>解説

アクティブ化されたウィンドウなしのコントロールは[、SetFocus](#setfocus)が呼び出されたときにフォーカスを受け取ります。

## <a name="colecontrolgetfont"></a><a name="getfont"></a>コントロール::フォントを取得します。

ストック フォント プロパティの Get 関数を実装します。

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>戻り値

コントロールのストック Font プロパティのフォント ディスパッチ インターフェイスへのポインター。

### <a name="remarks"></a>解説

呼び出し元は、終了時にオブジェクトを解放する必要があることに注意してください。 コントロールの実装内で、コントロールの`InternalGetFont`ストック Font オブジェクトにアクセスするために使用します。 コントロールでのフォントの使用の詳細については[、「ActiveX コントロール : ActiveX コントロールでのフォントの使用](../../mfc/mfc-activex-controls-using-fonts.md)」を参照してください。

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>コントロール::テキストメトリックスを取得します。

コントロールが所有するオブジェクト`CFontHolder`のテキスト メトリックを測定します。

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>パラメーター

*lptm*<br/>
[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)構造体へのポインター。

*フォントホルダー*<br/>
[オブジェクト](../../mfc/reference/cfontholder-class.md)への参照。

### <a name="remarks"></a>解説

このようなフォントは、[関数を](#selectfontobject)使用して選択できます。 `GetFontTextMetrics`は *、lptm*が指す`fontHolder``TEXTMETRIC`構造体を、成功した場合はフォントに関する有効なメトリック情報で初期化するか、成功しなかった場合は構造体にゼロを埋めます。 コントロールは、埋め込み OLE オブジェクトと同様に、メタファイルにレンダリングする必要があるため、コントロールを描画する場合は[、GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics)の代わりにこの関数を使用する必要があります。

既定`TEXTMETRIC`のフォントの構造は、[関数](#selectfontobject)が呼び出されたときに更新されます。 stock Font`GetFontTextMetrics`プロパティを選択した後にのみ呼び出して、提供される情報が有効であることを確認してください。

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>コントロール::取得フォーカラー

プロパティの取得関数を実装します。

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>戻り値

戻り値は、現在の前景色をOLE_COLOR値として指定します (成功した場合)。 この値は、 を呼び出して[COLORREF](/windows/win32/gdi/colorref) `TranslateColor`値に変換できます。

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>コントロール::ゲットワード

ストック hWnd プロパティの Get 関数を実装します。

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>戻り値

OLE コントロールのウィンドウ ハンドル (存在する場合)それ以外の場合は NULL。

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>コントロール::メッセージ文字列を取得します。

*nID*で識別されるメニュー項目の目的を説明する短い文字列を取得するために、フレームワークによって呼び出されます。

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
メニュー項目 ID。

*rメッセージ*<br/>
文字列を返す[CString](../../atl-mfc-shared/reference/cstringt-class.md)オブジェクトへの参照。

### <a name="remarks"></a>解説

メニュー項目が強調表示されているときに、ステータス バーに表示するメッセージを取得するために使用できます。 既定の実装では、 *nID*で識別される文字列リソースの読み込みを試みます。

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>コントロール::サポートされていない取得

ユーザーがコントロールのプロパティ値にアクセスできないようにします。

```
void GetNotSupported();
```

### <a name="remarks"></a>解説

コントロールのユーザーによるプロパティの取得がサポートされていないプロパティの Get 関数の代わりに、この関数を呼び出します。 たとえば、書き込み専用のプロパティがあります。

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>コントロール::ゲットレディステート

コントロールの準備状態を返します。

```
long GetReadyState();
```

### <a name="return-value"></a>戻り値

コントロールの準備状態(次のいずれかの値)。

|||
|-|-|
|READYSTATE_UNINITIALIZED|既定の初期化状態|
|READYSTATE_LOADING|コントロールは現在そのプロパティを読み込んでいます|
|READYSTATE_LOADED|コントロールが初期化されました|
|READYSTATE_INTERACTIVE|コントロールには対話的に使用できる十分なデータがありますが、すべての非同期データがまだ読み込まれているわけではありません|
|READYSTATE_COMPLETE|コントロールにはすべてのデータが含|

### <a name="remarks"></a>解説

ほとんどの単純なコントロールは、LOADED と INTERACTIVE を区別する必要がありません。 ただし、データ パス プロパティをサポートするコントロールは、少なくとも一部のデータが非同期的に受信されるまで対話式にする準備ができていない場合があります。 コントロールは、できるだけ早く対話的に機能するように試みる必要があります。

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>コントロール::コンテナを取得します。

コンテナーに対するコントロールの四角形の座標を、デバイス単位で表した値で取得します。

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*Lprect*<br/>
コントロールの座標がコピーされる四角形の構造体へのポインター。

### <a name="return-value"></a>戻り値

コントロールがインプレース アクティブの場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

四角形は、コントロールがインプレース アクティブの場合にのみ有効です。

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>コントロール::テキストメトリックス

コントロールのストック フォント プロパティのテキスト[メトリックを測定](#selectstockfont)します。

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>パラメーター

*lptm*<br/>
[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)構造体へのポインター。

### <a name="remarks"></a>解説

関数`GetStockTextMetrics`は`TEXTMETRIC`*、lptm*が指す構造体を有効なメトリック情報で初期化します( 成功しなかった場合は 0 を埋める)。 コントロールは、埋め込み OLE オブジェクトと同様に、メタファイルにレンダリングする必要があるため、コントロールを描画するときに[GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics)の代わりにこの関数を使用します。

デフォルト`TEXTMETRIC`・フォントの構造は、`SelectStockFont`関数が呼び出されたときにリフレッシュされます。 この関数は、提供される情報が有効であることを保証するために、ストック フォントを選択した後にのみ呼び出す必要があります。

## <a name="colecontrolgettext"></a><a name="gettext"></a>コントロール::テキストを取得します。

ストック テキストまたはキャプションプロパティの Get 関数を実装します。

```
BSTR GetText();
```

### <a name="return-value"></a>戻り値

コントロール テキスト文字列の現在の値、または文字列が存在しない場合は長さ 0 の文字列。

> [!NOTE]
> BSTR データ型の詳細については、「マクロとグローバル」セクションの[データ型](../../mfc/reference/data-types-mfc.md)を参照してください。

### <a name="remarks"></a>解説

この関数の呼び出し元は`SysFreeString`、リソースを解放するために返された文字列を呼び出す必要があります。 コントロールの実装内で、コントロールの`InternalGetText`ストック テキスト または キャプション プロパティにアクセスするために使用します。

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>コントロール::ウィンドウレスドロップターゲットを取得します。

ウィンドウ`GetWindowlessDropTarget`なしのコントロールを OLE ドラッグ アンド ドロップ操作の対象にする場合は、オーバーライドします。

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>戻り値

オブジェクトの`IDropTarget`インターフェイスへのポインター。 ウィンドウがないため、ウィンドウなしのオブジェクトはインターフェイスを`IDropTarget`登録できません。 ただし、ドラッグ アンド ドロップに参加するために、ウィンドウレス オブジェクトはインターフェイスを実装し、`GetWindowlessDropTarget`に戻すことができます。

### <a name="remarks"></a>解説

通常、この場合、コントロールのウィンドウがドロップ ターゲットとして登録されている必要があります。 ただし、コントロールには独自のウィンドウがないため、コンテナーは独自のウィンドウをドロップ ターゲットとして使用します。 コントロールは、コンテナーが適切なタイミングで呼`IDropTarget`び出しをデリゲートできるインターフェイスの実装を提供する必要があります。 次に例を示します。

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>コントロール::初期化IID

コントロールが使用する IID の基本クラスに通知します。

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>パラメーター

*ピイドプライマリー*<br/>
コントロールのプライマリ ディスパッチ インターフェイスのインターフェイス ID へのポインター。

*ピイドイベント*<br/>
コントロールのイベント インターフェイスのインターフェイス ID へのポインター。

### <a name="remarks"></a>解説

コントロールのコンストラクターでこの関数を呼び出して、コントロールが使用するインターフェイス ID を基本クラスに通知します。

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>コントロール::内部取得フォント

コントロールのストック Font プロパティにアクセスします。

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>戻り値

ストック フォント オブジェクトを含む[CFontHolder](../../mfc/reference/cfontholder-class.md)オブジェクトへの参照。

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>コントロール::内部ゲットテキスト

コントロールのストック テキスト プロパティまたはキャプション プロパティにアクセスします。

```
const CString& InternalGetText();
```

### <a name="return-value"></a>戻り値

コントロールテキスト文字列への参照。

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>コントロール::内部セットレディ状態

コントロールの準備状態を設定します。

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>パラメーター

*lニューレディステート*<br/>
コントロールに設定する準備状態(次のいずれかの値)。

|||
|-|-|
|READYSTATE_UNINITIALIZED|既定の初期化状態|
|READYSTATE_LOADING|コントロールは現在そのプロパティを読み込んでいます|
|READYSTATE_LOADED|コントロールが初期化されました|
|READYSTATE_INTERACTIVE|コントロールには対話的に使用できる十分なデータがありますが、すべての非同期データがまだ読み込まれているわけではありません|
|READYSTATE_COMPLETE|コントロールにはすべてのデータが含|

### <a name="remarks"></a>解説

ほとんどの単純なコントロールは、LOADED と INTERACTIVE を区別する必要がありません。 ただし、データ パス プロパティをサポートするコントロールは、少なくとも一部のデータが非同期的に受信されるまで対話式にする準備ができていない場合があります。 コントロールは、できるだけ早く対話的に機能するように試みる必要があります。

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>コントロール::無効化コントロール

コントロールを強制的に再描画します。

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>パラメーター

*Lprect*<br/>
無効にするコントロールの領域へのポインター。

*まをする*<br/>
更新領域が処理されるときに、更新領域内の背景を消去するかどうかを指定します。

### <a name="remarks"></a>解説

*lpRect*に NULL 値が設定されている場合、コントロール全体が再描画されます。 *lpRect*が NULL でない場合、これは無効にするコントロールの四角形の部分を示します。 コントロールにウィンドウがない場合、または現在アクティブでない場合、四角形は無視され、クライアント サイトの[IAdviseSink::OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange)メンバー関数が呼び出されます。 この関数は、`CWnd::InvalidateRect`または`InvalidateRect`の代わりに使用します。

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>コントロール::無効化Rgn

指定した領域内のコンテナー ウィンドウのクライアント領域を無効にします。

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>パラメーター

*Prgn*<br/>
無効にする OLE オブジェクトの表示領域を、ウィンドウ内のクライアント座標で識別する[CRgn](../../mfc/reference/crgn-class.md)オブジェクトへのポインター。 このパラメーターが NULL の場合、エクステントはオブジェクト全体になります。

*まをする*<br/>
無効な領域内の背景を消去するかどうかを指定します。 TRUE の場合、背景は消去されます。 FALSE の場合、背景は変更されません。

### <a name="remarks"></a>解説

これは、コンテナー内のウィンドウなしのコントロールを再描画するために使用できます。 無効化された領域は、更新領域内の他のすべての領域と共に、次の[WM_PAINT](/windows/win32/gdi/wm-paint)メッセージが送信されるときに、描画用にマークされます。

更新領域の一部に対して*bErase*が TRUE の場合、指定した部分だけでなく領域全体の背景も消去されます。

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>コントロール::変換VBX

OLE コントロールの特殊な読み込みを許可します。

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>戻り値

コントロールが変換される場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

VBX コントロールを使用するフォームを OLE コントロールを使用するフォームに変換する場合は、OLE コントロール用の特別な読み込みコードが必要になることがあります。 たとえば、OLE コントロールのインスタンスを読み込む場合は、 で[PX_Font](persistence-of-ole-controls.md#px_font)を呼び`DoPropExchange`出す場合があります。

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

ただし、VBX コントロールには Font オブジェクトがありません。各フォント プロパティは個別に保存されました。 この場合、次の 2`IsConvertingVBX`つのケースを区別するために使用します。

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

もう 1 つのケースとしては、VBX コントロールが独自のバイナリ データを保存した場合 (VBM_SAVEPROPERTY メッセージ ハンドラ内)、OLE コントロールはバイナリ データを別の形式で保存します。 OLE コントロールと VBX コントロールとの下位互換性を持たせたい場合は、VBX コントロールと OLE`IsConvertingVBX`コントロールのどちらが読み込まれているのかを区別することによって、この関数を使用して古い形式と新しい形式の両方を読み取ります。

コントロールの`DoPropExchange`関数では、この条件をチェックし、true の場合は、この変換に固有のロード コード (前の例など) を実行できます。 コントロールが変換されない場合は、通常のロード コードを実行できます。 この機能は、VBX のコントロールから変換される場合にのみ適用されます。

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>コントロール::IsInvoke 許可

オートメーション メソッドの呼び出しを有効にします。

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>戻り値

コントロールが初期化されている場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

(によって識別される`IDispatch::Invoke``IsInvokeAllowed``dispid`) によって識別される特定の関数が呼び出されるかどうかを判断するためのフレームワークの呼び出しの実装。 OLE コントロールの既定の動作では、コントロールが初期化されている場合にのみオートメーション メソッドを呼び出すことができます。ただし、`IsInvokeAllowed`仮想関数であり、必要に応じてオーバーライドできます (コントロールがオートメーション サーバーとして使用されている場合など)。

## <a name="colecontrolismodified"></a><a name="ismodified"></a>コントロール::イズイストレ

コントロールの状態が変更されたかどうかを判断します。

```
BOOL IsModified();
```

### <a name="return-value"></a>戻り値

最後に保存された後にコントロールの状態が変更された場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

プロパティの値が変更されると、コントロールの状態が変更されます。

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>コントロール::Is 最適化ドロー

コンテナが現在の描画操作に最適化された描画をサポートするかどうかを決定します。

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>戻り値

コンテナーが現在の描画操作に最適化された描画をサポートしている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

最適化された描画がサポートされている場合、描画が終了したときに、コントロールは古いオブジェクト (ペン、ブラシ、フォントなど) をデバイス コンテキストに選択する必要はありません。

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>コントロール::IsSubクラス化コントロール

コントロールが Windows コントロールをサブクラス化するかどうかを判断するために、フレームワークによって呼び出されます。

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>戻り値

コントロールがサブクラス化されている場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

この関数をオーバーライドし、OLE コントロールが Windows コントロールのサブクラスである場合は TRUE を返す必要があります。

## <a name="colecontrolload"></a><a name="load"></a>コントロール::読み込み

非同期的に読み込まれた前のデータをリセットし、コントロールの非同期プロパティの新しい読み込みを開始します。

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>パラメーター

*ストニューパス*<br/>
非同期コントロール プロパティの絶対位置を参照するパスを含む文字列へのポインター。

*プロップ*<br/>
非同期コントロール プロパティを実装する[オブジェクト](../../mfc/reference/cdatapathproperty-class.md)。

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>コントロール::ロックインプレイスアクティブ

コンテナーがコントロールを非アクティブ化しないようにします。

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>パラメーター

*ブロック*<br/>
コントロールのインプレース アクティブ状態をロックする場合は TRUE。ロックを解除する場合は FALSE。

### <a name="return-value"></a>戻り値

ロックが成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

コントロールのすべてのロックは、終了時にコントロールのロック解除とペアにする必要があります。 イベントを発生する場合など、コントロールをロックするのは短期間だけです。

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>コントロール::オンエンビエントプロパティチェンジ

コンテナーのアンビエント プロパティの値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>パラメーター

*Dispid*<br/>
変更されたアンビエント プロパティのディスパッチ ID、または複数のプロパティが変更された場合DISPID_UNKNOWN。

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>コントロール::オンアピアランス変更

ストック外観プロパティ値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>解説

このプロパティの変更後に通知を行う場合は、この関数をオーバーライドします。 既定の実装では`InvalidateControl`、 が呼び出されます。

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>コントロール::オンバックカラー変更

ストックの BackColor プロパティ値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>解説

このプロパティの変更後に通知を行う場合は、この関数をオーバーライドします。 既定の実装では`InvalidateControl`、 が呼び出されます。

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>コントロール::オンボーダースタイル変更

ストックの BorderStyle プロパティ値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>解説

既定の実装では`InvalidateControl`、 が呼び出されます。

このプロパティの変更後に通知を行う場合は、この関数をオーバーライドします。

## <a name="colecontrolonclick"></a><a name="onclick"></a>コントロール::オンクリック

マウス ボタンがクリックされたか、DoClick ストック メソッドが呼び出されたときに、フレームワークによって呼び出されます。

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>パラメーター

*Ibutton*<br/>
マウス ボタンのインデックスです。 次のいずれかの値になります。

- LEFT_BUTTON マウスの左ボタンがクリックされました。

- MIDDLE_BUTTON マウスの中ボタンがクリックされました。

- RIGHT_BUTTON マウスの右ボタンがクリックされました。

### <a name="remarks"></a>解説

既定の実装では`COleControl::FireClick`、 が呼び出されます。

既定の処理を変更または拡張するには、このメンバー関数をオーバーライドします。

## <a name="colecontrolonclose"></a><a name="onclose"></a>コントロール::閉じる

コンテナーがコントロールの`IOleControl::Close`関数を呼び出したときに、フレームワークによって呼び出されます。

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>パラメーター

*を選択します。*<br/>
読み込み前にオブジェクトを保存するかどうかを示すフラグ。 有効な値は次のとおりです。

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>解説

既定では、`OnClose`コントロール オブジェクトが変更されている場合は *、dwSaveOption*がOLECLOSE_SAVEIFDIRTYまたはOLECLOSE_PROMPTSAVEである場合に保存されます。

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>コントロール::オンド動詞

コンテナーがメンバー関数を呼び出すとき`IOleObject::DoVerb`に、フレームワークによって呼び出されます。

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*i動詞*<br/>
呼び出されるコントロール動詞のインデックス。

*をクリックします。*<br/>
動詞が呼び出される原因となった Windows メッセージへのポインター。

*スーンドペアレント*<br/>
コントロールの親ウィンドウへのハンドル。 動詞の実行によってウィンドウ (またはウィンドウ) が作成される場合は *、hWndParent*を親として使用する必要があります。

*Lprect*<br/>
コンテナーに対するコントロールの座標がコピーされる RECT 構造体へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

デフォルトの実装では、ON_OLEVERBとON_STDOLEVERBメッセージ・マップ・エントリーを使用して、呼び出す適切な関数を判別します。

動詞の既定の処理を変更するには、この関数をオーバーライドします。

## <a name="colecontrolondraw"></a><a name="ondraw"></a>コントロール::オンドロー

指定したデバイス コンテキストを使用して、指定した外接する四角形に OLE コントロールを描画するために、フレームワークによって呼び出されます。

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
描画が発生するデバイス コンテキスト。

*rcバウンド*<br/>
境界線を含む、コントロールの四角形領域。

*rc 無効です*<br/>
無効なコントロールの四角形領域。

### <a name="remarks"></a>解説

`OnDraw`通常は画面表示用に呼び出され、画面デバイス コンテキストを*pDC*として渡します。 *rcBounds*パラメーターは、ターゲット デバイス コンテキスト内の四角形を識別します (現在のマッピング モードに対して相対的)。 *rcInvalid*パラメーターは、無効な実際の四角形です。 場合によっては、これは*rcBounds*よりも小さい領域になります。

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>コントロール::オンドローメタファイル

指定したメタファイル デバイス コンテキストを使用して、指定した外接する四角形に OLE コントロールを描画するために、フレームワークによって呼び出されます。

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
描画が発生するデバイス コンテキスト。

*rcバウンド*<br/>
境界線を含む、コントロールの四角形領域。

### <a name="remarks"></a>解説

既定の実装では[、OnDraw](#ondraw)関数を呼び出します。

## <a name="colecontrolonedit"></a><a name="onedit"></a>コントロール::オンエディット

コントロールを UI アクティブにします。

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
動詞を呼び出した Windows メッセージへのポインター。

*スーンドペアレント*<br/>
コントロールの親ウィンドウへのハンドル。

*Lprect*<br/>
コンテナー内のコントロールによって使用される四角形へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

これは、コントロールのOLEIVERB_UIACTIVATE動詞を呼び出すのと同じ効果があります。

この関数は、通常、ON_OLEVERBメッセージ マップ エントリのハンドラー関数として使用されます。 これにより、コントロールの [オブジェクト] メニューで "編集" 動詞を使用できるようになります。 次に例を示します。

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>コントロール::オンEnabled変更

ストックの有効なプロパティ値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>解説

このプロパティの変更後に通知を行う場合は、この関数をオーバーライドします。 既定の実装は[、InvalidateControl](#invalidatecontrol)を呼び出します。

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>コントロール::オン列挙動詞

コンテナーがメンバー関数を呼び出すとき`IOleObject::EnumVerbs`に、フレームワークによって呼び出されます。

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コントロールの動詞を`IEnumOLEVERB`列挙するオブジェクトへのポインター。

### <a name="return-value"></a>戻り値

動詞が使用可能な場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

既定の実装では、メッセージ マップ内のON_OLEVERBエントリを列挙します。

動詞の列挙の既定の方法を変更するには、この関数をオーバーライドします。

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>コントロール::イベントアドバイス

イベント ハンドラーが OLE コントロールに接続または OLE コントロールから切断されたときに、フレームワークによって呼び出されます。

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>パラメーター

*アドバイス*<br/>
TRUE は、イベント ハンドラーがコントロールに接続されたことを示します。 FALSE は、イベント ハンドラーがコントロールから切断されたことを示します。

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>コントロール::フォント変更

ストック Font プロパティ値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>解説

既定の実装では`COleControl::InvalidateControl`、 が呼び出されます。 コントロールが Windows コントロールをサブクラス化している場合、既定の実装では、コントロールのウィンドウにWM_SETFONT メッセージも送信されます。

このプロパティの変更後に通知を行う場合は、この関数をオーバーライドします。

### <a name="example"></a>例

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>コントロール::オンフォーカラー変更

ストック ForeColor プロパティ値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>解説

既定の実装では`InvalidateControl`、 が呼び出されます。

このプロパティの変更後に通知を行う場合は、この関数をオーバーライドします。

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>コントロール::オンフリーズイベント

コンテナーが を呼び出した`IOleControl::FreezeEvents`後、フレームワークによって呼び出されます。

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>パラメーター

*bフリーズ*<br/>
コントロールのイベント処理が凍結されている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

既定の実装では、何も行われません。

イベント処理が固定または凍結解除されたときに、さらに動作を行う場合は、この関数をオーバーライドします。

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>コントロール::オンゲットカラーセット

コンテナーがメンバー関数を呼び出すとき`IViewObject::GetColorSet`に、フレームワークによって呼び出されます。

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>パラメーター

*Ptd*<br/>
ピクチャをレンダリングするターゲット デバイスへのポインター。 この値が NULL の場合、画像は既定のターゲット デバイス (通常はディスプレイ デバイス) に対してレンダリングされます。

*デフ*<br/>
*ptd*で示されるターゲット デバイスの情報コンテキストを指定します。 このパラメーターはデバイス コンテキストにできますが、必ずしも 1 つではありません。 *ptd*が NULL の場合は *、null*も必要です。

*カラーセット*<br/>
使用する色のセットをコピーする場所へのポインター。 関数がカラー セットを返さない場合は、NULL が返されます。

### <a name="return-value"></a>戻り値

有効なカラー セットが返された場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

コンテナは、OLE コントロールの描画に必要なすべての色を取得するために、この関数を呼び出します。 コンテナーは、カラー パレット全体を設定するために必要な色と組み合わせて取得したカラー セットを使用できます。 既定の実装では FALSE が返されます。

この要求の特別な処理を行うには、この関数をオーバーライドします。

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>コントロール::オンゲットコントロール情報

コントロールのコンテナーがコントロールに関する情報を要求したときに、フレームワークによって呼び出されます。

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
入力する[CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo)構造体へのポインター。

### <a name="remarks"></a>解説

この情報は、主にコントロールのニーモニック キーの説明で構成されます。 既定の実装では *、pControlInfo*に既定の情報が設定されます。

コントロールがニーモニック キーを処理する必要がある場合は、この関数をオーバーライドします。

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>コントロール::オンゲット表示文字列

によって識別されるプロパティの現在の値を表す文字列を取得するために、フレームワークによって呼び出*されます*。

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>パラメーター

*Dispid*<br/>
コントロールのプロパティのディスパッチ ID。

*strValue*<br/>
文字列を返す[CString](../../atl-mfc-shared/reference/cstringt-class.md)オブジェクトへの参照。

### <a name="return-value"></a>戻り値

*strValue*に文字列が返された場合は 0 以外の値を返します。

### <a name="remarks"></a>解説

値を文字列に直接変換できないプロパティをコントロールに含め、コンテナ指定のプロパティ ブラウザーにプロパティの値を表示する場合は、この関数をオーバーライドします。

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>コントロール::オンゲットインプレイスメニュー

コントロールが UI アクティブ化されたときに、コンテナーの既存のメニューにマージするメニューを取得するときに、フレームワークによって呼び出されます。

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>戻り値

コントロールのメニューのハンドル。 既定の実装では NULL が返されます。

### <a name="remarks"></a>解説

OLE リソースのマージの詳細については、「[メニューとリソース (OLE)」](../../mfc/menus-and-resources-ole.md)を参照してください。

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>コントロール::オンゲットナチュラルエクステント

コンテナーの`IViewObjectEx::GetNaturalExtent`要求に応じてフレームワークによって呼び出されます。

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>パラメーター

*dwアスペクト*<br/>
オブジェクトがどのように表示されるかを指定します。 リプレゼンテーションには、コンテンツ、アイコン、サムネイル、印刷ドキュメントなどがあります。 有効な値は、列挙体[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)または DVASPECT2 から取得されます。

*Lindex*<br/>
対象となるオブジェクトの部分。 現在は -1 のみが有効です。

*Ptd*<br/>
オブジェクトのサイズを返すターゲット デバイスを定義する[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)構造体へのポイント。

*デフ*<br/>
オブジェクトがデバイス メトリックを抽出し、デバイスの機能をテストできる*ptd*パラメーターで示されるターゲット デバイスの情報コンテキストを指定します。 *ptd*が NULL の場合、オブジェクトは*hicTargetDev*パラメーターの値を無視する必要があります。

*をクリックします。*<br/>
データの`DVEXTENTINFO`サイズを指定する構造体へのポイント。 構造`DVEXTENTINFO`は次のとおりです。

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

構造体メンバー`dwExtentMode`は、次の 2 つの値のいずれかを取ることができます。

- DVEXTENT_CONTENTコントロールがコンテンツに正確に収まるようにする必要がある大きさを問い合わせる(サイズに合わせる)

- DVEXTENT_INTEGRAL サイズ変更時に、提案されたサイズを制御に渡す

*プサイズル*<br/>
コントロールによって返されるデータのサイズ変更を指します。 調整されなかったディメンションに対して、返されるサイズ変更データは -1 に設定されます。

### <a name="return-value"></a>戻り値

正常にサイズを返すか、またはサイズを調整する場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

この関数をオーバーライドして、構造体内の指定されたサイズおよびエクステント モードに最も近`DVEXTENTINFO`いオブジェクトの表示サイズを返します。 既定の実装では FALSE が返され、サイズは調整されません。

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>コントロール::オンゲット事前定義文字列

プロパティの可能な値を表す定義済みの文字列のセットを取得するために、フレームワークによって呼び出されます。

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>パラメーター

*Dispid*<br/>
コントロールのプロパティのディスパッチ ID。

*を配列します。*<br/>
戻り値を格納する文字列配列。

*を指定します。*<br/>
戻り値を格納する DWORD 配列。

### <a name="return-value"></a>戻り値

要素が*pStringArray および pCookieArray*に追加されている場合は 0 以外*の値を指定します*。

### <a name="remarks"></a>解説

文字列で表すことができる値のセットを持つプロパティがコントロールにある場合は、この関数をオーバーライドします。 *に*追加された各要素に対して、対応する "クッキー" 要素を*pCookieArray*に追加する必要があります。 これらの「クッキー」値は、後でフレームワークから`COleControl::OnGetPredefinedValue`関数に渡される可能性があります。

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>コントロール::オンゲット事前定義値

のオーバーライドによって以前に返された定義済み文字列のいずれかに対応する値を取得するために、フレームワークによって呼び`COleControl::OnGetPredefinedStrings`出されます。

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>パラメーター

*Dispid*<br/>
コントロールのプロパティのディスパッチ ID。

*ドウクッキー*<br/>
のオーバーライドによって以前に返されたクッキー値`COleControl::OnGetPredefinedStrings`。

*ルプバーアウト*<br/>
プロパティ値が`VARIANT`返される構造体へのポインター。

### <a name="return-value"></a>戻り値

値が*lpvarOut*に返された場合は 0 以外の値を返します。それ以外の場合は 0。

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>コントロール::オンゲットビューエクステント

コンテナーの[IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent)要求に応答してフレームワークによって呼び出されます。

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>パラメーター

*アスペクト*<br/>
オブジェクトのどの形式またはアスペクトを表示するかを記述する DWORD。 有効な値は、列挙体[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)または DVASPECT2 から取得されます。

*Lindex*<br/>
対象となるオブジェクトの部分。 現在は -1 のみが有効です。

*Ptd*<br/>
オブジェクトのサイズを返すターゲット デバイスを定義する[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)構造体へのポイント。

*ルプサイズル*<br/>
オブジェクトのサイズが返される位置を指します。

### <a name="return-value"></a>戻り値

エクステント情報が正常に返された場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

コントロールで 2 パス描画を使用し、不透明部分と透明部分の寸法が異なる場合は、この関数をオーバーライドします。

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>コントロール::オンゲットビューレック

コンテナーの`IViewObjectEx::GetRect`要求に応じてフレームワークによって呼び出されます。

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>パラメーター

*dwアスペクト*<br/>
オブジェクトのどの形式またはアスペクトを表示するかを記述する DWORD。 有効な値は、列挙体[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)または DVASPECT2 から取得されます。

- DVASPECT_CONTENTオブジェクト全体の外接する四角形です。 オブジェクトの原点とサイズの左上隅は、 によって返される`GetViewExtent`範囲と同じです *。*

- DVASPECT_OPAQUE矩形の不透明な領域を持つオブジェクトは、その四角形を返します。 他の人は失敗します。

- DVASPECT_TRANSPARENT透明または不規則な部分をカバーする矩形。

*プレック*<br/>
オブジェクトを描画する四角形を指定する[RECTL](/previous-versions/dd162907\(v=vs.85\))構造体へのポインター。 このパラメータは、オブジェクトの位置と伸縮を制御します。

### <a name="return-value"></a>戻り値

オブジェクトに合わせてサイズが変更された四角形が正常に返された場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

オブジェクトのサイズは、特定の位置`OnGetViewRect`から始まる長方形に変換されます (デフォルトは表示の左上隅です)。 コントロールで 2 パス描画を使用し、不透明部分と透明部分の寸法が異なる場合は、この関数をオーバーライドします。

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>コントロール::オンゲットビューステータス

コンテナーの`IViewObjectEx::GetViewStatus`要求に応じてフレームワークによって呼び出されます。

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>戻り値

正常終了した場合は、VIEWSTATUS 列挙の値の 1 つ。それ以外の場合は 0。 指定できる値は、次の任意の組み合わせです。

|||
|-|-|
|VIEWSTATUS_OPAQUE|オブジェクトは完全に不透明です。 このビットが設定されていない場合、オブジェクトには透明な部分が含まれます。 このビットは、コンテンツ関連の側面にのみ適用され、DVASPECT_ICONまたはDVASPECT_DOCPRINTには適用されません。|
|VIEWSTATUS_SOLIDBKGND|オブジェクトは、(ブラシ パターンではなく、単色で構成される)、純色の背景を持ちます。 このビットは、VIEWSTATUS_OPAQUEが設定されている場合にのみ意味があり、コンテンツ関連の側面にのみ適用され、DVASPECT_ICONまたはDVASPECT_DOCPRINTには適用されません。|
|VIEWSTATUS_DVASPECTOPAQUE|オブジェクトはDVASPECT_OPAQUEをサポートします。 このアスペクトを使用して、描画の側面をパラメーターとして受け取る IViewObjectEx メソッドをすべて呼び出すことができます。|
|VIEWSTATUS_DVASPECTTRANSPARENT|オブジェクトはDVASPECT_TRANSPARENTをサポートします。 描画`IViewObjectEx`の側面をパラメーターとして使用するすべてのメソッドは、このアスペクトを使用して呼び出すことができます。|

### <a name="remarks"></a>解説

コントロールで 2 パス描画を使用する場合は、この関数をオーバーライドします。 既定の実装はVIEWSTATUS_OPAQUE返します。

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>コントロール::オンハイドツールバー

コントロールが UI 非アクティブ化されたときに、フレームワークによって呼び出されます。

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>解説

実装では、 で表示されるすべてのツール`OnShowToolbars`バーを非表示にする必要があります。

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>コントロール::アクティブマウス移動

WM_MOUSEMOVE メッセージの受信時にマウス ポインターの下の非アクティブオブジェクトのコンテナーによって呼び出されます。

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>パラメーター

*lprcBounds*<br/>
オブジェクトの境界を示す四角形 (格納ウィンドウのクライアント座標)。 WM_MOUSEMOVEメッセージを受信したときの、画面上の正確な位置とサイズをオブジェクトに通知します。

*X*<br/>
ウィンドウを含むクライアント座標でのマウス位置の x 座標。

*Y*<br/>
ウィンドウを含むクライアント座標でのマウス位置の y 座標。

*州*<br/>
キーボードのキーボード修飾子キーの現在の状態を識別します。 有効な値は、MK_CONTROL、MK_SHIFT、MK_ALT、MK_BUTTON、MK_LBUTTON、MK_MBUTTON、およびMK_RBUTTONのいずれかの組み合わせです。

### <a name="remarks"></a>解説

ウィンドウのクライアント座標(ピクセル)は、マウスカーソルの位置を渡すために使用されることに注意してください。 これは、同じ座標系でオブジェクトの外接する四角形も渡すことで可能になります。

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>コントロール::アクティブなセットカーソル

WM_SETCURSOR メッセージの受信時にマウス ポインターの下の非アクティブオブジェクトのコンテナーによって呼び出されます。

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>パラメーター

*lprcBounds*<br/>
オブジェクトの境界を示す四角形 (格納ウィンドウのクライアント座標)。 WM_SETCURSORメッセージを受信したときの、画面上の正確な位置とサイズをオブジェクトに通知します。

*X*<br/>
ウィンドウを含むクライアント座標でのマウス位置の x 座標。

*Y*<br/>
ウィンドウを含むクライアント座標でのマウス位置の y 座標。

*ドウマウスメッセージ*<br/>
WM_SETCURSORが発生したマウス メッセージの識別子。

*常に設定する*<br/>
オブジェクトがカーソルを設定する必要があるかどうかを指定します。 TRUE の場合、オブジェクトはカーソルを設定する必要があります。FALSE の場合、カーソルはカーソルを設定する義務を負わないので、その場合はS_FALSE返す必要があります。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

ウィンドウのクライアント座標(ピクセル)は、マウスカーソルの位置を渡すために使用されることに注意してください。 これは、同じ座標系でオブジェクトの外接する四角形も渡すことで可能になります。

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>コントロール::オンキーダウンイベント

ストック KeyDown イベントが処理された後にフレームワークによって呼び出されます。

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>パラメーター

*Nchar*<br/>
押されたキーの仮想キー コード値。 標準の仮想キー コードの一覧については、Winuser.h を参照してください。

*状態*<br/>
次のフラグの組み合わせを含みます。

- SHIFT_MASK Shift キーがアクション中に押されました。

- CTRL_MASK 操作中に Ctrl キーが押されました。

- ALT_MASKアクション中に Alt キーが押されました。

### <a name="remarks"></a>解説

イベントが発生した後にコントロールがキー情報にアクセスする必要がある場合は、この関数をオーバーライドします。

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>コントロール::キープレスイベント

ストック KeyPress イベントが発生した後にフレームワークによって呼び出されます。

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>パラメーター

*Nchar*<br/>
押されたキーの仮想キー コード値を格納します。 標準の仮想キー コードの一覧については、Winuser.h を参照してください。

### <a name="remarks"></a>解説

*nChar*値がコンテナによって変更された可能性があることに注意してください。

このイベントが発生した後に通知する場合は、この関数をオーバーライドします。

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>コントロール::オンキーアップイベント

ストック KeyDown イベントが処理された後にフレームワークによって呼び出されます。

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>パラメーター

*Nchar*<br/>
押されたキーの仮想キー コード値。 標準の仮想キー コードの一覧については、Winuser.h を参照してください。

*状態*<br/>
次のフラグの組み合わせを含みます。

- SHIFT_MASK Shift キーがアクション中に押されました。

- CTRL_MASK 操作中に Ctrl キーが押されました。

- ALT_MASKアクション中に Alt キーが押されました。

### <a name="remarks"></a>解説

イベントが発生した後にコントロールがキー情報にアクセスする必要がある場合は、この関数をオーバーライドします。

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>コントロール::オンマッププロパティページ

指定したプロパティの編集を実装するプロパティ ページのクラス ID を取得するために、フレームワークによって呼び出されます。

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>パラメーター

*Dispid*<br/>
コントロールのプロパティのディスパッチ ID。

*lpclsid*<br/>
クラス ID`CLSID`が返される構造体へのポインター。

*ページオプション*<br/>
指定されたプロパティ ページの使用が省略可能かどうかを示すインジケーターを返します。

### <a name="return-value"></a>戻り値

クラス ID が*lpclsid*で返された場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

コンテナーのプロパティ ブラウザーからコントロールのプロパティ ページを呼び出す方法を提供するには、この関数をオーバーライドします。

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>コントロール::オンムネモニック

OLE コントロールのニーモニック キーが押されたことをコンテナーが検出したときに、フレームワークによって呼び出されます。

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>パラメーター

*Pmsg*<br/>
ニーモニック キーの押下時に生成された Windows メッセージへのポインター。

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>コントロール::オンプロパティ

コントロールのプロパティ動詞がコンテナーによって呼び出されたときに、フレームワークによって呼び出されます。

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
動詞を呼び出した Windows メッセージへのポインター。

*スーンドペアレント*<br/>
コントロールの親ウィンドウへのハンドル。

*Lprect*<br/>
コンテナー内のコントロールによって使用される四角形へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

既定の実装では、モーダル プロパティ ダイアログ ボックスが表示されます。

この関数を使用して、コントロールのプロパティ ページを表示することもできます。 *hWndParent* `OnProperties`パラメーターでコントロールの親のハンドルを渡して、関数を呼び出します。 この場合 *、lpMsg*および*lpRect*パラメーターの値は無視されます。

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>コントロール::オンクエリヒットポイント

コンテナーの`IViewObjectEx::QueryHitPoint`要求に応じてフレームワークによって呼び出されます。

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>パラメーター

*dwアスペクト*<br/>
オブジェクトの表現方法を指定します。 有効な値は、列挙体[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)または DVASPECT2 から取得されます。

*をクリックします。*<br/>
OLE コントロール`RECT`クライアント領域の外接する四角形を指定する構造体へのポインター。

*ptlLoc*<br/>
ヒットの`POINT`チェック対象となる点を指定する構造体へのポインター。 点は、OLE クライアント領域座標で指定します。

*をクリックします。*<br/>
ヒットをチェックしたポイントに「近い」と定義する距離。

*結果を返します。*<br/>
ヒット クエリの結果へのポインター。 次のいずれかの値:

- *ptlLoc* HITRESULT_OUTSIDE OLE オブジェクトの外側にあり、閉じられていない。

- *HITRESULT_TRANSPARENT ptlLoc*は OLE オブジェクトの範囲内にありますが、イメージに近いわけではありません。 たとえば、透明な円の中央にある点をHITRESULT_TRANSPARENTできます。

- HITRESULT_CLOSE *ptlLoc*は OLE オブジェクトの内部または外側にありますが、オブジェクトの内部と見なされるほど近い値です。 小さい、細い、または詳細なオブジェクトは、この値を使用することができます。 ポイントがオブジェクトの外接する四角形の外側にある場合でも、その点は近い場合があります (小さなオブジェクトを押す場合に必要です)。

- *ptlLoc* HITRESULT_HITオブジェクトのイメージ内にあります。

### <a name="return-value"></a>戻り値

ヒット結果が正常に返された場合は 0 以外。それ以外の場合は 0。 ヒットとは、OLE コントロールの表示領域と重なっています。

### <a name="remarks"></a>解説

オブジェクトの表示矩形が指定されたポイントと重なっているかどうかを照会します (ポイントにヒット)。 `QueryHitPoint`矩形以外のオブジェクトのヒットをテストするためにオーバーライドできます。

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>コントロール::オンクエリヒットレクト

コンテナーの`IViewObjectEx::QueryHitRect`要求に応じてフレームワークによって呼び出されます。

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>パラメーター

*dwアスペクト*<br/>
オブジェクトがどのように表示されるかを指定します。 有効な値は、列挙体[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)または DVASPECT2 から取得されます。

*をクリックします。*<br/>
OLE コントロール`RECT`クライアント領域の外接する四角形を指定する構造体へのポインター。

*プルクロック*<br/>
オブジェクトの`RECT`左上隅を基準にして、ヒット (オブジェクト四角形と重なり合う) をチェックする四角形を指定する構造体へのポインター。

*をクリックします。*<br/>
使用されていません。

*結果を返します。*<br/>
ヒット クエリの結果へのポインター。 次のいずれかの値:

- HITRESULT_OUTSIDE、四角形内の点が OLE オブジェクトにヒットしません。

- HITRESULT_HIT四角形の少なくとも 1 つのポイントがオブジェクトにヒットします。

### <a name="return-value"></a>戻り値

ヒット結果が正常に返された場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

オブジェクトの表示四角形が、指定された四角形の任意のポイントと重なっているかどうかを問い合わせます (四角形にヒットします)。 `QueryHitRect`矩形以外のオブジェクトのヒットをテストするためにオーバーライドできます。

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>コントロール::オンレンダリングデータ

指定した形式でデータを取得するために、フレームワークによって呼び出されます。

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>パラメーター

*フォーマットの問題*<br/>
情報が要求される形式を指定する[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポイント。

*中程度*<br/>
データが返される[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1)構造体へのポイント。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

指定された形式は、遅延レンダリングの[遅延レンダリングの遅延RenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)または[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)メンバー関数を使用して、以前にコントロール オブジェクトに配置された形式です。 指定されたストレージ メディアがファイル`OnRenderFileData`または`OnRenderGlobalData`メモリの場合は、この関数の既定の実装がそれぞれ 呼び出します。 要求された形式がCF_METAFILEPICTまたは永続的なプロパティ セット形式の場合、既定の実装では適切なデータがレンダリングされ、0 以外が返されます。 それ以外の場合は 0 を返し、何もしません。

*lpStgMedium->タイムが*TYMED_NULL場合は、stGMEDIUM を割り当て *、lpFormatEtc->のタイム*で指定されたとおりに設定する必要があります。 TYMED_NULLしない場合は、STGMEDIUM にデータが入力されます。

要求された形式とメディアでデータを提供するには、この関数をオーバーライドします。 データによっては、代わりにこの関数の他のバージョンの 1 つをオーバーライドする必要があります。 データが小さく、サイズが固定されている場合は`OnRenderGlobalData`、 をオーバーライドします。 データがファイル内にある場合、または可変サイズの場合は、`OnRenderFileData`オーバーライドします。

詳細については、Windows SDK `FORMATETC` `STGMEDIUM`の と の構造を参照してください。

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>コントロール::オンレンダリングファイルデータ

ストレージ メディアがファイルの場合に、指定した形式でデータを取得するためにフレームワークによって呼び出されます。

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>パラメーター

*フォーマットの問題*<br/>
情報が要求される形式を指定する[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポイント。

*ファイル*<br/>
データがレンダリングされる[CFile](../../mfc/reference/cfile-class.md)オブジェクトへのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

指定された形式は、遅延レンダリングの[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)メンバー関数を使用して、コントロール オブジェクトに以前に配置された形式です。 この関数の既定の実装では、単に FALSE が返されます。

要求された形式とメディアでデータを提供するには、この関数をオーバーライドします。 データによっては、代わりにこの関数の他のバージョンの 1 つをオーバーライドする必要があります。 複数のストレージ メディアを処理する場合は、`OnRenderData`をオーバーライドします。 データがファイル内にある場合、または可変サイズの場合は、`OnRenderFileData`オーバーライドします。

詳細については、Windows SDK`FORMATETC`の構造を参照してください。

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>コントロール::オンレンダリンググローバルデータ

指定されたストレージ メディアがグローバル メモリである場合に、指定した形式でデータを取得するためにフレームワークによって呼び出されます。

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>パラメーター

*フォーマットの問題*<br/>
情報が要求される形式を指定する[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポイント。

*フグローバル*<br/>
データが返されるグローバル メモリへのハンドルへのポイント。 メモリが割り当てられていない場合、このパラメータは NULL にすることができます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

指定された形式は、遅延レンダリングの[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)メンバー関数を使用して、コントロール オブジェクトに以前に配置された形式です。 この関数の既定の実装では、単に FALSE が返されます。

*phGlobal*が NULL の場合は、新しい HGLOBAL を割り当て *、phGlobal*に返す必要があります。 それ以外の場合は *、phGlobal*によって指定された HGLOBAL にデータを入力する必要があります。 HGLOBAL に格納されるデータの量は、メモリー・ブロックの現行サイズを超えてはなりません。 また、ブロックを大きなサイズに再割り当てすることはできません。

要求された形式とメディアでデータを提供するには、この関数をオーバーライドします。 データによっては、代わりにこの関数の他のバージョンの 1 つをオーバーライドする必要があります。 複数のストレージ メディアを処理する場合は、`OnRenderData`をオーバーライドします。 データがファイル内にある場合、または可変サイズの場合は、`OnRenderFileData`オーバーライドします。

詳細については、Windows SDK`FORMATETC`の構造を参照してください。

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>コントロール::オンリセット状態

コントロールのプロパティを既定値に設定する必要があるときに、フレームワークによって呼び出されます。

```
virtual void OnResetState();
```

### <a name="remarks"></a>解説

既定の実装では[、プロパティ](#dopropexchange)を既定値に`CPropExchange`設定するオブジェクトを渡す DoPropExchange を呼び出します。

コントロール ライターは、このオーバーライド可能な OLE コントロールの初期化コードを挿入できます。 この`IPersistStream::Load`関数は、最初に呼び出すことなく`IPersistStorage::Load`[、IPersistStream::Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load)または[IPersistStorage::ロード](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)が失敗した場合、または[IPersistStreamInit::InpersistNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)または[IPersistStorage:InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew)が呼び出されたときに呼び出されます。

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>コントロール::オンセットクライアントサイト

コンテナーがコントロールの`IOleControl::SetClientSite`関数を呼び出したときに、フレームワークによって呼び出されます。

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>解説

既定では、`OnSetClientSite`データ パス プロパティが読み込まれているかどうかをチェックし、`DoDataPathPropExchange`読み込まれている場合は を呼び出します。

この通知の特別な処理を行うには、この関数をオーバーライドします。 特に、この関数のオーバーライドは基本クラスを呼び出す必要があります。

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>コントロール::オンセットデータ

コントロールのデータを指定したデータに置き換えるために、フレームワークによって呼び出されます。

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>パラメーター

*フォーマットの問題*<br/>
データの形式を指定する[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。

*中程度*<br/>
データが存在する[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1)構造体へのポインター。

*bリリース*<br/>
コントロールがストレージ メディアを解放する必要がある場合は TRUE。コントロールがストレージ メディアを解放しない場合は FALSE。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

データが永続プロパティ セット形式の場合、既定の実装では、それに応じてコントロールの状態が変更されます。 それ以外の場合、既定の実装では何も実行されません。 *bRelease*が TRUE の場合は`ReleaseStgMedium`、呼び出しが行われます。それ以外の場合は使用できません。

コントロールのデータを指定したデータに置き換えるには、この関数をオーバーライドします。

詳細については、Windows SDK `FORMATETC` `STGMEDIUM`の と の構造を参照してください。

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>コントロール::オンセットエクステント

コントロールの範囲を変更する必要があるときに[、IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)を呼び出した結果、フレームワークによって呼び出されます。

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>パラメーター

*を指定します。*<br/>
HIMETRIC 単位`SIZEL`で表されるコントロールの幅と高さを表すために長整数を使用する構造体へのポインター。

### <a name="return-value"></a>戻り値

サイズ変更が受け入れられた場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

既定の実装では、コントロールの範囲のサイズ変更を処理します。 コントロールがインプレース アクティブの場合、コンテナーの呼び出し`OnPosRectChanged`が行われます。

コントロールの既定のサイズ変更を変更するには、この関数をオーバーライドします。

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>コントロール::オンセットオブジェクトレクト

フレームワークによって呼び出され、[呼](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)び出しを実装します。

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コンテナーに対する`RECT`コントロールの新しい位置とサイズを示す構造体へのポインター。

*クリップ*<br/>
コントロールを`RECT`クリップする四角形領域を示す構造体へのポインター。

### <a name="return-value"></a>戻り値

位置変更が受け入れられた場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

既定の実装では、コントロール ウィンドウの位置変更とサイズ変更が自動的に処理され、TRUE が返されます。

この関数の既定の動作を変更するには、この関数をオーバーライドします。

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>コントロール::オンショーツールバー

コントロールが UI アクティブになったときに、フレームワークによって呼び出されます。

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>解説

既定の実装では、何も行われません。

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>コントロール::テキスト変更

ストックキャプションまたはTextプロパティ値が変更されたときに、フレームワークによって呼び出されます。

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>解説

既定の実装では`InvalidateControl`、 が呼び出されます。

このプロパティの変更後に通知を行う場合は、この関数をオーバーライドします。

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>コントロール::ウィンドウレスメッセージ

コンテナーの`IOleInPlaceObjectWindowless::OnWindowMessage`要求に応じてフレームワークによって呼び出されます。

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>パラメーター

*Msg*<br/>
Windows によって渡されるメッセージ識別子。

*wParam*<br/>
Windows によって渡される。 追加のメッセージ固有の情報を指定します。 このパラメーターの内容は *、msg*パラメーターの値によって異なります。

*lParam*<br/>
Windows によって渡される。 追加のメッセージ固有の情報を指定します。 このパラメーターの内容は *、msg*パラメーターの値によって異なります。

*結果を返します。*<br/>
ウィンドウ結果コード。 メッセージ処理の結果を指定し、送信されるメッセージに依存します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

ウィンドウなしコントロールのウィンドウ メッセージを処理します。 `COleControl`'s`OnWindowlessMessage`は、マウス メッセージやキーボード メッセージ以外のウィンドウ メッセージに使用する必要があります。 `COleControl`ウィンドウなしの OLE オブジェクトのマウス キャプチャとキーボード フォーカスを取得するために[、SetCapture](#setcapture)と[SetFocus](#setfocus)を提供します。

ウィンドウなしのオブジェクトにはウィンドウがないため、コンテナがメッセージをディスパッチできるようにするメカニズムが必要です。 ウィンドウなしの OLE オブジェクトは、`OnWindowMessage``IOleInPlaceObjectWindowless`インターフェイスのメソッド (ウィンドウなしのサポートのための[IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)の拡張機能) を通じて、コンテナーからメッセージを取得します。 `OnWindowMessage`はパラメータを`HWND`受け取りません。

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>コントロール::Pレントトクライアント

*pPoint*の座標をクライアント座標に変換します。

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>パラメーター

*lprcBounds*<br/>
コンテナー内の OLE コントロールの境界へのポインター。 クライアント領域ではなく、境界線やスクロール バーを含むコントロール全体の領域。

*pポイント*<br/>
コントロールのクライアント領域の座標に変換される親 (コンテナー) ポイントへのポインター。

*ヒットテスト*<br/>
ヒット テストをポイントで実行するかどうかを指定します。

### <a name="return-value"></a>戻り値

*bHitTest*が FALSE の場合は、HTNOWHERE を返します。 *bHitTest*が TRUE の場合、親 (コンテナー) ポイントが OLE コントロールのクライアント領域に配置された場所を返します。

- サイズ変更の境界線を持たないウィンドウの境界線で表示されます。

- ウィンドウの下側の水平境界線の HTBOTTOM。

- ウィンドウの境界線の左下隅に表示されます。

- ウィンドウの境界線の右下隅に表示されます。

- タイトル バー領域内の HTCAPTION。

- クライアント領域での HTCLIENT。

- HTERROR 画面の背景またはウィンドウ間の分割線上`DefWndProc`(Windows 機能がエラーを示すシステムビープ音を生成することを除いて HTNOWHERE と同じ)。

- サイズボックス内の HTGROWBOX.

- 水平スクロールバーで HTHSCROLL.

- ウィンドウの左の境界線に表示されます。

- 最大化ボタンの HTMAXBUTTON。

- メニュー領域内のメニュー。

- 最小化ボタンの HTMIN ボタン。

- HTNOWHERE 画面の背景またはウィンドウ間の分割線上に表示されます。

- [最小化] ボタンで HTREDUCE します。

- ウィンドウの右側の境界線に表示されます。

- サイズボックス内のサイズ (HTGROWBOX と同じ)。

- コントロール メニューまたは子ウィンドウの閉じるボタンでの HTSYSMENU。

- ウィンドウの上部の水平境界線の HTTOP。

- HTTOPLEFT ウィンドウの境界線の左上隅に表示されます。

- ウィンドウの境界線の右上隅に表示されます。

- 現在別のウィンドウで覆われているウィンドウで HTTRANSPARENT.

- 垂直スクロールバーのHTVSCROLL。

- 最大化ボタンで HTZOOM.

### <a name="remarks"></a>解説

入力時*pPoint*は親の原点 (コンテナの左上隅) を基準にしています。 出力*時の pPoint*は、OLE コントロールのクライアント領域 (コントロールのクライアント領域の左上隅) の原点を基準にしています。

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>コントロール::Post モーダルダイアログ

モーダル ダイアログ ボックスが閉じられたことをコンテナーに通知します。

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>パラメーター

*スーンドペアレント*<br/>
モーダル ダイアログ ボックスの親ウィンドウへのハンドル。

### <a name="remarks"></a>解説

モーダル ダイアログ ボックスを表示した後、この関数を呼び出します。 によって無効になっているトップレベル ウィンドウをコンテナーが有効にするには、この関数を呼び出`PreModalDialog`す必要があります。 この関数は、 への`PreModalDialog`呼び出しと組み合わせる必要があります。

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>コントロール::Pモーダルダイアログ

モーダル ダイアログ ボックスが表示されようとしていることをコンテナーに通知します。

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>パラメーター

*スーンドペアレント*<br/>
モーダル ダイアログ ボックスの親ウィンドウへのハンドル。

### <a name="remarks"></a>解説

モーダル ダイアログ ボックスを表示する前に、この関数を呼び出します。 コンテナーがすべてのトップレベル ウィンドウを無効にできるように、この関数を呼び出す必要があります。 モーダル ダイアログ ボックスが表示されたら、 を呼`PostModalDialog`び出す必要があります。

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>コントロールウィンドウを再作成します。

コントロールのウィンドウを破棄し、再作成します。

```
void RecreateControlWindow();
```

### <a name="remarks"></a>解説

ウィンドウのスタイル ビットを変更する必要がある場合に必要な場合があります。

## <a name="colecontrolrefresh"></a><a name="refresh"></a>コントロール::リフレッシュ

OLE コントロールの再描画を強制します。

```
void Refresh();
```

### <a name="remarks"></a>解説

この関数は、基本クラス`COleControl`で、Refresh という名前のストック メソッドとしてサポートされています。 これにより、OLE コントロールのユーザーは、特定の時間にコントロールを再描画できます。 このメソッドの詳細については、「 [ActiveX コントロール : メソッド](../../mfc/mfc-activex-controls-methods.md)」を参照してください。

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>コントロール::リリースキャプチャ

マウス キャプチャを解放します。

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

コントロールに現在マウス キャプチャがある場合、キャプチャは解放されます。 それ以外の場合、この関数は効果がありません。

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>コントロール::リリースDC

ウィンドウなしコントロールのコンテナーのディスプレイ デバイス コンテキストを解放し、他のアプリケーションで使用するためにデバイス コンテキストを解放します。

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
解放するコンテナー デバイス コンテキストを識別します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

アプリケーションは`ReleaseDC`[、GetDC](#getdc)への呼び出しごとに呼び出す必要があります。

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>コントロールウィンドウ:リペアレントコントロールウィンドウ

コントロールの親を設定します。

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>パラメーター

*フーンドアウター*<br/>
コントロール ウィンドウのハンドル。

*スーンドペアレント*<br/>
新しい親ウィンドウのハンドル。

### <a name="remarks"></a>解説

コントロール ウィンドウの親をリセットします。

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>コントロール::リセットストックプロップ

ストック プロパティの状態を`COleControl`既定値に初期化します。

```
void ResetStockProps();
```

### <a name="remarks"></a>解説

プロパティは、外観、背景色、境界線スタイル、キャプション、有効、フォント、ForeColor、hWnd、およびテキストです。 ストック プロパティの詳細については、「 [ActiveX コントロール : ストック プロパティの追加](../../mfc/mfc-activex-controls-adding-stock-properties.md)」を参照してください。

を使用`ResetStockProps`して、コントロールのバイナリ初期化のパフォーマンスを`ResetVersion`向上させることができます。 `COleControl::OnResetState` 次の例を見てください。 初期化の最適化の詳細については、「 [ActiveX コントロール : 最適化](../../mfc/mfc-activex-controls-optimization.md)」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>コントロール::リセットバージョン

バージョン番号を指定した値に初期化します。

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>パラメーター

*デフォルト*<br/>
コントロールに割り当てるバージョン番号。

### <a name="remarks"></a>解説

を使用`ResetVersion`して、コントロールのバイナリ初期化のパフォーマンスを`ResetStockProps`向上させることができます。 `COleControl::OnResetState` サンプルを参照[してください](#resetstockprops)。 初期化の最適化の詳細については、「 [ActiveX コントロール : 最適化](../../mfc/mfc-activex-controls-optimization.md)」を参照してください。

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>コントロール::スクロールウィンドウ

ウィンドウなしの OLE オブジェクトが、画面上の埋め込み位置にあるアクティブなイメージ内の領域をスクロールできるようにします。

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>パラメーター

*x金額*<br/>
水平方向のスクロール量をデバイス単位で指定します。 左にスクロールするには、このパラメータは負の値である必要があります。

*y金額*<br/>
垂直スクロールの量をデバイス単位で指定します。 上方向にスクロールするには、このパラメータは負の値である必要があります。

*Lprect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは RECT 構造体を指し、OLE オブジェクトのクライアント領域のスクロールする部分を、ウィンドウ内のクライアント座標で指定します。 *lpRect*が NULL の場合、OLE オブジェクトのクライアント領域全体がスクロールされます。

*lp クリップレック*<br/>
クリップする四`CRect`角形を`RECT`指定するオブジェクトまたは構造体へのポインター。 四角形の内側のピクセルだけがスクロールされます。 四角形の外側のビットは *、lpRect*四角形に含まれている場合でも影響を受けません。 *lpClipRect*が NULL の場合、スクロール四角形に対してクリッピングは実行されません。

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>コントロール::フォントオブジェクトの選択

デバイス コンテキストにフォントを選択します。

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
デバイス コンテキスト オブジェクトへのポインター。

*フォントホルダー*<br/>
選択するフォントを表す[CFontHolder](../../mfc/reference/cfontholder-class.md)オブジェクトへの参照。

### <a name="return-value"></a>戻り値

以前に選択したフォントへのポインター。 呼び出し元が*fontHolder*を使用するすべての描画操作を完了したら、そのフォントをパラメータとして[CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject)に渡して、以前に選択したフォントを再選択する必要があります。

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>コントロール::ストックフォントを選択します。

デバイス コンテキストにストック Font プロパティを選択します。

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
フォントを選択するデバイス コンテキスト。

### <a name="return-value"></a>戻り値

以前に選択`CFont`したオブジェクトへのポインター。 完了したら、このフォントをデバイス コンテキストに戻す場合は[、CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject)を使用する必要があります。

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>コントロール::シリアル範囲

コントロールに割り当てられた表示領域の状態をシリアル化または初期化します。

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>パラメーター

*ar*<br/>
シリアル`CArchive`化するオブジェクトまたはシリアル化するオブジェクト。

### <a name="remarks"></a>解説

`SerializeExtent`を使用`SerializeStockProps`して、コントロールのバイナリ永続性のパフォーマンスを`SerializeVersion`向上させることができます。 `COleControl::Serialize` 次の例を見てください。 初期化の最適化の詳細については、「 [ActiveX コントロール : 最適化](../../mfc/mfc-activex-controls-optimization.md)」を参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>コントロール::シリアルストックプロップス

`COleControl`外観、バックカラー、境界線スタイル、キャプション、有効、フォント、ForeColor、およびテキストのストック プロパティの状態をシリアル化または初期化します。

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>パラメーター

*ar*<br/>
シリアル`CArchive`化するオブジェクトまたはシリアル化するオブジェクト。

### <a name="remarks"></a>解説

ストック プロパティの詳細については、「 [ActiveX コントロール : ストック プロパティの追加](../../mfc/mfc-activex-controls-adding-stock-properties.md)」を参照してください。

`SerializeStockProps`を使用`SerializeExtent`して、コントロールのバイナリ永続性のパフォーマンスを`SerializeVersion`向上させることができます。 `COleControl::Serialize` 例については[、SerializeExtent](#serializeextent)のコードを参照してください。 初期化の最適化の詳細については、「 [ActiveX コントロール : 最適化](../../mfc/mfc-activex-controls-optimization.md)」を参照してください。

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>コントロール::シリアルバージョン

コントロールのバージョン情報の状態をシリアル化または初期化します。

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>パラメーター

*ar*<br/>
シリアル`CArchive`化するオブジェクトまたはシリアル化するオブジェクト。

*デフォルト*<br/>
コントロールの現在のバージョン番号。

*b変換*<br/>
保存時に永続データを最新の形式に変換するか、読み込んだときと同じ形式で保持するかを示します。

### <a name="return-value"></a>戻り値

コントロールのバージョン番号。 指定されたアーカイブがロードされている場合`SerializeVersion`は、そのアーカイブからロードされたバージョンを返します。 それ以外の場合は、現在読み込まれているバージョンを返します。

### <a name="remarks"></a>解説

`SerializeVersion`を使用`SerializeExtent`して、コントロールのバイナリ永続性のパフォーマンスを`SerializeStockProps`向上させることができます。 `COleControl::Serialize` 例については[、SerializeExtent](#serializeextent)のコードを参照してください。 初期化の最適化の詳細については、「 [ActiveX コントロール : 最適化](../../mfc/mfc-activex-controls-optimization.md)」を参照してください。

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>コントロール::設定外観

コントロールのストック外観プロパティの値を設定します。

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>パラメーター

*外観*<br/>
コントロールの外観に使用する**短い**(VT_I2) 値。 値が 0 の場合、コントロールの外観はフラットに設定され、値 1 はコントロールの外観を 3D に設定します。

### <a name="remarks"></a>解説

ストック プロパティの詳細については、「 [ActiveX コントロール : プロパティ](../../mfc/mfc-activex-controls-properties.md)」を参照してください。

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>コントロール::セットバックカラー

コントロールのストック BackColor プロパティ値を設定します。

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>パラメーター

*ドウバックカラー*<br/>
コントロールの背景描画に使用するOLE_COLOR値。

### <a name="remarks"></a>解説

このプロパティおよびその他の関連プロパティの使用方法の詳細については[、「ActiveX コントロール: プロパティ](../../mfc/mfc-activex-controls-properties.md)」を参照してください。

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>コントロール::セットボーダースタイル

コントロールのストック境界線スタイル プロパティ値を設定します。

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>パラメーター

*スボーダースタイル*<br/>
コントロールの新しい境界線スタイル。0 は境界線がないことを示し、1 は通常の境界線を示します。

### <a name="remarks"></a>解説

その後、コントロール ウィンドウが再作成され、`OnBorderStyleChanged`呼び出されます。

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>コントロール::セットキャプチャ

コントロールの代わりに、コントロールのコンテナー ウィンドウにマウス キャプチャを取得させます。

```
CWnd* SetCapture();
```

### <a name="return-value"></a>戻り値

以前にマウス入力`CWnd`を受け取ったウィンドウ オブジェクトへのポインター。

### <a name="remarks"></a>解説

コントロールがアクティブでウィンドウなしの場合、この関数はコントロールの代わりにコントロールのコンテナー ウィンドウにマウス キャプチャを与えます。 それ以外の場合、この関数はコントロール自体にマウス キャプチャを保持させる`CWnd::SetCapture`(と同じ) 。

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>コントロール::コントロールサイズを設定します。

OLE コントロール ウィンドウのサイズを設定し、コントロール サイトが変更されていることをコンテナに通知します。

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>パラメーター

*Cx*<br/>
コントロールの新しい幅をピクセル単位で指定します。

*Cy*<br/>
コントロールの新しい高さをピクセル単位で指定します。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

この関数は、コントロールのコンストラクターで使用しないでください。

コントロール ウィンドウのすべての座標は、コントロールの左上隅を基準にしています。

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>コントロール::セット有効

コントロールのストックの有効プロパティ値を設定します。

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>パラメーター

*b有効*<br/>
コントロールを有効にする場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このプロパティを設定した`OnEnabledChange`後に呼び出されます。

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>コントロール::セットフォーカス

コントロールのコンテナー ウィンドウに、コントロールの代わりに入力フォーカスを取得させます。

```
CWnd* SetFocus();
```

### <a name="return-value"></a>戻り値

以前に`CWnd`入力フォーカスを持っていたウィンドウ オブジェクトへのポインター。

### <a name="remarks"></a>解説

コントロールがアクティブでウィンドウなしの場合、この関数はコントロールの代わりにコントロールのコンテナー ウィンドウに入力フォーカスを与えます。 入力フォーカスは、コンテナーのウィンドウにキーボード入力を指示し、コンテナーは、呼び出し`SetFocus`元の OLE オブジェクトに後続のすべてのキーボード メッセージをディスパッチします。 以前に入力フォーカスを持っていたウィンドウは、そのウィンドウを失います。

コントロールがウィンドウなしの場合、この関数はコントロール自体に入力フォーカスを持たさせます (と同`CWnd::SetFocus`じです)。

## <a name="colecontrolsetfont"></a><a name="setfont"></a>コントロール::フォントを設定します。

コントロールのストック Font プロパティを設定します。

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>パラメーター

*を使用します。*<br/>
Font ディスパッチ インターフェイスへのポインター。

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>コントロール::設定フォーカラー

コントロールのストック ForeColor プロパティ値を設定します。

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>パラメーター

*カラーを確認する*<br/>
コントロールの前景描画に使用するOLE_COLOR値。

### <a name="remarks"></a>解説

このプロパティおよびその他の関連プロパティの使用方法の詳細については[、「ActiveX コントロール: プロパティ](../../mfc/mfc-activex-controls-properties.md)」を参照してください。

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>コントロール::セットイニシャルデータフォーマット

コントロールでサポートされているデータ形式のリストを初期化するために、フレームワークによって呼び出されます。

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>解説

既定の実装では、CF_METAFILEPICTと永続的なプロパティ セットの 2 つの形式を指定します。

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>コントロール::セットイニシャルサイズ

コンテナに最初に表示されたときの OLE コントロールのサイズを設定します。

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>パラメーター

*Cx*<br/>
OLE コントロールの初期の幅 (ピクセル単位)。

*Cy*<br/>
OLE コントロールの初期の高さ (ピクセル単位)。

### <a name="remarks"></a>解説

コントロールの初期サイズを設定するには、コンストラクターでこの関数を呼び出します。 初期サイズは、デバイス単位またはピクセル単位で測定されます。 この呼び出しは、コントロールのコンストラクターで行うことをお勧めします。

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>コントロール::セット修正フラグ

コントロールの変更状態を変更します。

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>パラメーター

*bModified*<br/>
コントロールの変更フラグの新しい値。 TRUE は、コントロールの状態が変更されたことを示します。FALSE は、コントロールの状態が保存されたことを示します。

### <a name="remarks"></a>解説

コントロールの永続的な状態に影響する変更が発生するたびに、この関数を呼び出します。 たとえば、永続プロパティの値が変更された場合は、この関数を*bModified* TRUE で呼び出**します**。

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>コントロール::セットは許可されていません

編集要求が失敗したことを示します。

```
void SetNotPermitted();
```

### <a name="remarks"></a>解説

失敗した場合に`BoundPropertyRequestEdit`この関数を呼び出します。 この関数は、set 操作が`COleDispScodeException`許可されないことを示す型の例外をスローします。

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>コントロール::セットはサポートされていません

ユーザーがコントロールのプロパティ値を変更できないようにします。

```
void SetNotSupported();
```

### <a name="remarks"></a>解説

コントロールのユーザーによるプロパティ値の変更がサポートされていないプロパティの Set 関数の代わりに、この関数を呼び出します。 たとえば、読み取り専用のプロパティがあります。

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>コントロール::セットレクティンコンテナ

コントロールの四角形の座標をコンテナーに対して相対的に設定します。

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*Lprect*<br/>
コンテナーに対するコントロールの新しい座標を含む四角形へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

コントロールが開いている場合は、サイズが変更されます。それ以外の場合は`OnPosRectChanged`、コンテナの関数が呼び出されます。

## <a name="colecontrolsettext"></a><a name="settext"></a>コントロール::テキストの設定

コントロールのストックキャプションまたはテキストプロパティの値を設定します。

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>パラメーター

*テキスト*<br/>
文字列へのポインター。

### <a name="remarks"></a>解説

ストックキャプションとテキストのプロパティは、両方とも同じ値にマップされることに注意してください。 つまり、いずれかのプロパティに変更を加えると、両方のプロパティが自動的に変更されます。 一般に、コントロールは、ストックキャプションまたはテキストプロパティをサポートする必要がありますが、両方をサポートしていません。

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>コントロール::スローエラー

コントロール内のエラーの発生を通知します。

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>パラメーター

*Sc*<br/>
報告される状態コード値。 考えられるコードの完全な一覧については[、「ActiveX コントロール: 詳細トピック」を参照してください](../../mfc/mfc-activex-controls-advanced-topics.md)。

*説明 ID*<br/>
報告される例外の文字列リソース ID。

*ヘルプID*<br/>
報告されるトピックのヘルプ ID。

*説明*<br/>
報告される例外の説明を含む文字列。

### <a name="remarks"></a>解説

この関数は、OLE プロパティの Get 関数または Set 関数、または OLE オートメーション メソッドの実装からだけ呼び出す必要があります。 他の時に発生するエラーを通知する必要がある場合は、stock Error イベントを発生させる必要があります。

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>コントロール::トランスフォームクードル

HIMETRIC 単位とコンテナのネイティブ単位の間の座標値を変換します。

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>パラメーター

*lpptlヒメトリック*<br/>
HIMETRIC`POINTL`単位の座標を含む構造体へのポインター。

*コンテナ*<br/>
コンテナーの`POINTF`単位サイズの座標を含む構造体へのポインター。

*フラグ*<br/>
次の値の組み合わせ。

- XFORMCOORDS_POSITION コンテナー内の位置。

- XFORMCOORDS_SIZE コンテナ内のサイズ。

- XFORMCOORDS_HIMETRICTOCONTAINER HIMETRIC 単位をコンテナの単位に変換します。

- XFORMCOORDS_CONTAINERTOHIMETRIC コンテナの単位を HIMETRIC 単位に変換します。

### <a name="remarks"></a>解説

最初の 2 つのフラグは、XFORMCOORDS_POSITIONとXFORMCOORDS_SIZEで、座標を位置として扱うかサイズとして扱うかを示します。 残りの 2 つのフラグは、変換の方向を示します。

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>コントロール::翻訳色

色の値をOLE_COLORデータ型から[COLORREF](/windows/win32/gdi/colorref)データ型に変換します。

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>パラメーター

*clrカラー*<br/>
OLE_COLORデータ型。 詳細については[、「OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor)関数」を参照してください。

*hpal*<br/>
オプションのパレットへのハンドル。NULL を指定できます。

### <a name="return-value"></a>戻り値

デバイスが表すことができる*clrColor*値に最も近い単色を定義する RGB (赤、緑、青) 32 ビットカラー値。

### <a name="remarks"></a>解説

この関数は、ストック ForeColor プロパティと BackColor プロパティを[、CDC](../../mfc/reference/cdc-class.md)メンバー関数で使用される COLORREF 型に変換するのに便利です。

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>読み込み中に

その後、永続的な状態から読み込まれるときに、コントロールが既定値としてアンビエント プロパティの値を使用するかどうかを決定します。

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>戻り値

0 以外のプロパティは、アンビエント プロパティが有効であることを示します。それ以外の場合、アンビエント プロパティは無効になります。

### <a name="remarks"></a>解説

一部のコンテナーでは、コントロールが のオーバーライドの最初の呼び出し中に、その`COleControl::DoPropExchange`アンビエント プロパティにアクセスできない場合があります。 これは、コンテナーが[IPersistStreamInit:::Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load)または[IPersistStorage::読み込みを](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)呼び出す前に[IOleObject::SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite)を呼び出す場合 (つまり、OLEMISC_SETCLIENTSITEFIRSTステータス ビットを受け入れていない場合) に当てはめます。

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>コントロール::ウィンドウプロセッサ

オブジェクトの Windows プロシージャ`COleControl`を提供します。

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>パラメーター

*メッセージ*<br/>
処理する Windows メッセージを指定します。

*wParam*<br/>
メッセージの処理に使用される追加情報を提供します。 パラメーター値はメッセージによって異なります。

*lParam*<br/>
メッセージの処理に使用される追加情報を提供します。 パラメーター値はメッセージによって異なります。

### <a name="return-value"></a>戻り値

ディスパッチされたメッセージの戻り値。

### <a name="remarks"></a>解説

コントロールのメッセージ マップを通じて特定のメッセージをディスパッチします。

## <a name="see-also"></a>関連項目

[MFC サンプル CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC サンプル テストヘルプ](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage クラス](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd クラス](../../mfc/reference/cwnd-class.md)<br/>
[階層グラフ](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder クラス](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder クラス](../../mfc/reference/cpictureholder-class.md)<br/>
