---
title: クラス
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBar
- AFXTOOLBAR/CMFCToolBar
- AFXTOOLBAR/CMFCToolBar::AddBasicCommand
- AFXTOOLBAR/CMFCToolBar::AddCommandUsage
- AFXTOOLBAR/CMFCToolBar::AddToolBarForImageCollection
- AFXTOOLBAR/CMFCToolBar::AdjustLayout
- AFXTOOLBAR/CMFCToolBar::AdjustSize
- AFXTOOLBAR/CMFCToolBar::AllowChangeTextLabels
- AFXTOOLBAR/CMFCToolBar::AreTextLabels
- AFXTOOLBAR/CMFCToolBar::AutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::ButtonToIndex
- AFXTOOLBAR/CMFCToolBar::CalcFixedLayout
- AFXTOOLBAR/CMFCToolBar::CalcSize
- AFXTOOLBAR/CMFCToolBar::CanHandleSiblings
- AFXTOOLBAR/CMFCToolBar::CleanUpImages
- AFXTOOLBAR/CMFCToolBar::CleanUpLockedImages
- AFXTOOLBAR/CMFCToolBar::CanBeClosed
- AFXTOOLBAR/CMFCToolBar::CanBeRestored
- AFXTOOLBAR/CMFCToolBar::CanFocus
- AFXTOOLBAR/CMFCToolBar::CommandToIndex
- AFXTOOLBAR/CMFCToolBar::Create
- AFXTOOLBAR/CMFCToolBar::CreateEx
- AFXTOOLBAR/CMFCToolBar::Deactivate
- AFXTOOLBAR/CMFCToolBar::EnableCustomizeButton
- AFXTOOLBAR/CMFCToolBar::EnableDocking
- AFXTOOLBAR/CMFCToolBar::EnableLargeIcons
- AFXTOOLBAR/CMFCToolBar::EnableQuickCustomization
- AFXTOOLBAR/CMFCToolBar::EnableReflections
- AFXTOOLBAR/CMFCToolBar::EnableTextLabels
- AFXTOOLBAR/CMFCToolBar::FromHandlePermanent
- AFXTOOLBAR/CMFCToolBar::GetAllButtons
- AFXTOOLBAR/CMFCToolBar::GetAllToolbars
- AFXTOOLBAR/CMFCToolBar::GetBasicCommands
- AFXTOOLBAR/CMFCToolBar::GetButton
- AFXTOOLBAR/CMFCToolBar::GetButtonInfo
- AFXTOOLBAR/CMFCToolBar::GetButtonSize
- AFXTOOLBAR/CMFCToolBar::GetButtonStyle
- AFXTOOLBAR/CMFCToolBar::GetButtonText
- AFXTOOLBAR/CMFCToolBar::GetColdImages
- AFXTOOLBAR/CMFCToolBar::GetColumnWidth
- AFXTOOLBAR/CMFCToolBar::GetCommandButtons
- AFXTOOLBAR/CMFCToolBar::GetCount
- AFXTOOLBAR/CMFCToolBar::GetCustomizeButton
- AFXTOOLBAR/CMFCToolBar::GetDefaultImage
- AFXTOOLBAR/CMFCToolBar::GetDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetDisabledMenuImages
- AFXTOOLBAR/CMFCToolBar::GetDroppedDownMenu
- AFXTOOLBAR/CMFCToolBar::GetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::GetHighlightedButton
- AFXTOOLBAR/CMFCToolBar::GetHotBorder
- AFXTOOLBAR/CMFCToolBar::GetHotTextColor
- AFXTOOLBAR/CMFCToolBar::GetHwndLastFocus
- AFXTOOLBAR/CMFCToolBar::GetOVERWRITESetText
- AFXTOOLBAR/CMFCToolBar::GetImageSize
- AFXTOOLBAR/CMFCToolBar::GetImages
- AFXTOOLBAR/CMFCToolBar::GetImagesOffset
- AFXTOOLBAR/CMFCToolBar::GetInvalidateItemRect
- AFXTOOLBAR/CMFCToolBar::GetItemID
- AFXTOOLBAR/CMFCToolBar::GetItemRect
- AFXTOOLBAR/CMFCToolBar::GetLargeColdImages
- AFXTOOLBAR/CMFCToolBar::GetLargeDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLargeImages
- AFXTOOLBAR/CMFCToolBar::GetLockedColdImages
- AFXTOOLBAR/CMFCToolBar::GetLockedDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImageSize
- AFXTOOLBAR/CMFCToolBar::GetLockedMenuImages
- AFXTOOLBAR/CMFCToolBar::GetMenuButtonSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImageSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImages
- AFXTOOLBAR/CMFCToolBar::GetOrigButtons
- AFXTOOLBAR/CMFCToolBar::GetOrigResetButtons
- AFXTOOLBAR/CMFCToolBar::GetResourceID
- AFXTOOLBAR/CMFCToolBar::GetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::GetRowHeight
- AFXTOOLBAR/CMFCToolBar::GetShowTooltips
- AFXTOOLBAR/CMFCToolBar::GetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::GetUserImages
- AFXTOOLBAR/CMFCToolBar::HitTest
- AFXTOOLBAR/CMFCToolBar::InsertButton
- AFXTOOLBAR/CMFCToolBar::InsertSeparator
- AFXTOOLBAR/CMFCToolBar::InvalidateButton
- AFXTOOLBAR/CMFCToolBar::IsAddRemoveQuickCustomize
- AFXTOOLBAR/CMFCToolBar::IsAltCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsAutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::IsBasicCommand
- AFXTOOLBAR/CMFCToolBar::IsButtonExtraSizeAvailable
- AFXTOOLBAR/CMFCToolBar::IsButtonHighlighted
- AFXTOOLBAR/CMFCToolBar::IsCommandPermitted
- AFXTOOLBAR/CMFCToolBar::IsCommandRarelyUsed
- AFXTOOLBAR/CMFCToolBar::IsCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsDragButton
- AFXTOOLBAR/CMFCToolBar::IsExistCustomizeButton
- AFXTOOLBAR/CMFCToolBar::IsFloating
- AFXTOOLBAR/CMFCToolBar::IsLargeIcons
- AFXTOOLBAR/CMFCToolBar::IsLastCommandFromButton
- AFXTOOLBAR/CMFCToolBar::IsLocked
- AFXTOOLBAR/CMFCToolBar::IsOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::IsUserDefined
- AFXTOOLBAR/CMFCToolBar::LoadBitmap
- AFXTOOLBAR/CMFCToolBar::LoadBitmapEx
- AFXTOOLBAR/CMFCToolBar::LoadParameters
- AFXTOOLBAR/CMFCToolBar::LoadState
- AFXTOOLBAR/CMFCToolBar::LoadToolBar
- AFXTOOLBAR/CMFCToolBar::LoadToolBarEx
- AFXTOOLBAR/CMFCToolBar::OnChangeHot
- AFXTOOLBAR/CMFCToolBar::OnFillBackground
- AFXTOOLBAR/CMFCToolBar::OnReset
- AFXTOOLBAR/CMFCToolBar::OnSetAccData
- AFXTOOLBAR/CMFCToolBar::OnSetDefaultButtonText
- AFXTOOLBAR/CMFCToolBar::RemoveAllButtons
- AFXTOOLBAR/CMFCToolBar::RemoveButton
- AFXTOOLBAR/CMFCToolBar::RemoveStateFromRegistry
- AFXTOOLBAR/CMFCToolBar::ReplaceButton
- AFXTOOLBAR/CMFCToolBar::ResetAll
- AFXTOOLBAR/CMFCToolBar::ResetAllImages
- AFXTOOLBAR/CMFCToolBar::RestoreOriginalState
- AFXTOOLBAR/CMFCToolBar::SaveState
- AFXTOOLBAR/CMFCToolBar::SetBasicCommands
- AFXTOOLBAR/CMFCToolBar::SetButtonInfo
- AFXTOOLBAR/CMFCToolBar::SetButtonStyle
- AFXTOOLBAR/CMFCToolBar::SetButtonText
- AFXTOOLBAR/CMFCToolBar::SetButtons
- AFXTOOLBAR/CMFCToolBar::SetCommandUsageOptions
- AFXTOOLBAR/CMFCToolBar::SetCustomizeMode
- AFXTOOLBAR/CMFCToolBar::SetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::SetHeight
- AFXTOOLBAR/CMFCToolBar::SetHotBorder
- AFXTOOLBAR/CMFCToolBar::SetHotTextColor
- AFXTOOLBAR/CMFCToolBar::SetLargeIcons
- AFXTOOLBAR/CMFCToolBar::SetLockedSizes
- AFXTOOLBAR/CMFCToolBar::SetMenuSizes
- AFXTOOLBAR/CMFCToolBar::SetNonPermittedCommands
- AFXTOOLBAR/CMFCToolBar::SetOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::SetPermament
- AFXTOOLBAR/CMFCToolBar::SetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::SetShowTooltips
- AFXTOOLBAR/CMFCToolBar::SetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::SetSizes
- AFXTOOLBAR/CMFCToolBar::SetToolBarBtnText
- AFXTOOLBAR/CMFCToolBar::SetTwoRowsWithSibling
- AFXTOOLBAR/CMFCToolBar::SetUserImages
- AFXTOOLBAR/CMFCToolBar::StretchPane
- AFXTOOLBAR/CMFCToolBar::TranslateChar
- AFXTOOLBAR/CMFCToolBar::UpdateButton
- AFXTOOLBAR/CMFCToolBar::WrapToolBar
- AFXTOOLBAR/CMFCToolBar::AllowShowOnList
- AFXTOOLBAR/CMFCToolBar::CalcMaxButtonHeight
- AFXTOOLBAR/CMFCToolBar::DoPaint
- AFXTOOLBAR/CMFCToolBar::DrawButton
- AFXTOOLBAR/CMFCToolBar::DrawSeparator
- AFXTOOLBAR/CMFCToolBar::OnUserToolTip
- AFXTOOLBAR/CMFCToolBar::m_bDontScaleImages
- AFXTOOLBAR/CMFCToolBar::m_dblLargeImageRatio
helpviewer_keywords:
- CMFCToolBar [MFC], AddBasicCommand
- CMFCToolBar [MFC], AddCommandUsage
- CMFCToolBar [MFC], AddToolBarForImageCollection
- CMFCToolBar [MFC], AdjustLayout
- CMFCToolBar [MFC], AdjustSize
- CMFCToolBar [MFC], AllowChangeTextLabels
- CMFCToolBar [MFC], AreTextLabels
- CMFCToolBar [MFC], AutoGrayInactiveImages
- CMFCToolBar [MFC], ButtonToIndex
- CMFCToolBar [MFC], CalcFixedLayout
- CMFCToolBar [MFC], CalcSize
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CleanUpImages
- CMFCToolBar [MFC], CleanUpLockedImages
- CMFCToolBar [MFC], CanBeClosed
- CMFCToolBar [MFC], CanBeRestored
- CMFCToolBar [MFC], CanFocus
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CommandToIndex
- CMFCToolBar [MFC], Create
- CMFCToolBar [MFC], CreateEx
- CMFCToolBar [MFC], Deactivate
- CMFCToolBar [MFC], EnableCustomizeButton
- CMFCToolBar [MFC], EnableDocking
- CMFCToolBar [MFC], EnableLargeIcons
- CMFCToolBar [MFC], EnableQuickCustomization
- CMFCToolBar [MFC], EnableReflections
- CMFCToolBar [MFC], EnableTextLabels
- CMFCToolBar [MFC], FromHandlePermanent
- CMFCToolBar [MFC], GetAllButtons
- CMFCToolBar [MFC], GetAllToolbars
- CMFCToolBar [MFC], GetBasicCommands
- CMFCToolBar [MFC], GetButton
- CMFCToolBar [MFC], GetButtonInfo
- CMFCToolBar [MFC], GetButtonSize
- CMFCToolBar [MFC], GetButtonStyle
- CMFCToolBar [MFC], GetButtonText
- CMFCToolBar [MFC], GetColdImages
- CMFCToolBar [MFC], GetColumnWidth
- CMFCToolBar [MFC], GetCommandButtons
- CMFCToolBar [MFC], GetCount
- CMFCToolBar [MFC], GetCustomizeButton
- CMFCToolBar [MFC], GetDefaultImage
- CMFCToolBar [MFC], GetDisabledImages
- CMFCToolBar [MFC], GetDisabledMenuImages
- CMFCToolBar [MFC], GetDroppedDownMenu
- CMFCToolBar [MFC], GetGrayDisabledButtons
- CMFCToolBar [MFC], GetHighlightedButton
- CMFCToolBar [MFC], GetHotBorder
- CMFCToolBar [MFC], GetHotTextColor
- CMFCToolBar [MFC], GetHwndLastFocus
- CMFCToolBar [MFC], GetIgnoreSetText
- CMFCToolBar [MFC], GetImageSize
- CMFCToolBar [MFC], GetImages
- CMFCToolBar [MFC], GetImagesOffset
- CMFCToolBar [MFC], GetInvalidateItemRect
- CMFCToolBar [MFC], GetItemID
- CMFCToolBar [MFC], GetItemRect
- CMFCToolBar [MFC], GetLargeColdImages
- CMFCToolBar [MFC], GetLargeDisabledImages
- CMFCToolBar [MFC], GetLargeImages
- CMFCToolBar [MFC], GetLockedColdImages
- CMFCToolBar [MFC], GetLockedDisabledImages
- CMFCToolBar [MFC], GetLockedImages
- CMFCToolBar [MFC], GetLockedImageSize
- CMFCToolBar [MFC], GetLockedMenuImages
- CMFCToolBar [MFC], GetMenuButtonSize
- CMFCToolBar [MFC], GetMenuImageSize
- CMFCToolBar [MFC], GetMenuImages
- CMFCToolBar [MFC], GetOrigButtons
- CMFCToolBar [MFC], GetOrigResetButtons
- CMFCToolBar [MFC], GetResourceID
- CMFCToolBar [MFC], GetRouteCommandsViaFrame
- CMFCToolBar [MFC], GetRowHeight
- CMFCToolBar [MFC], GetShowTooltips
- CMFCToolBar [MFC], GetSiblingToolBar
- CMFCToolBar [MFC], GetUserImages
- CMFCToolBar [MFC], HitTest
- CMFCToolBar [MFC], InsertButton
- CMFCToolBar [MFC], InsertSeparator
- CMFCToolBar [MFC], InvalidateButton
- CMFCToolBar [MFC], IsAddRemoveQuickCustomize
- CMFCToolBar [MFC], IsAltCustomizeMode
- CMFCToolBar [MFC], IsAutoGrayInactiveImages
- CMFCToolBar [MFC], IsBasicCommand
- CMFCToolBar [MFC], IsButtonExtraSizeAvailable
- CMFCToolBar [MFC], IsButtonHighlighted
- CMFCToolBar [MFC], IsCommandPermitted
- CMFCToolBar [MFC], IsCommandRarelyUsed
- CMFCToolBar [MFC], IsCustomizeMode
- CMFCToolBar [MFC], IsDragButton
- CMFCToolBar [MFC], IsExistCustomizeButton
- CMFCToolBar [MFC], IsFloating
- CMFCToolBar [MFC], IsLargeIcons
- CMFCToolBar [MFC], IsLastCommandFromButton
- CMFCToolBar [MFC], IsLocked
- CMFCToolBar [MFC], IsOneRowWithSibling
- CMFCToolBar [MFC], IsUserDefined
- CMFCToolBar [MFC], LoadBitmap
- CMFCToolBar [MFC], LoadBitmapEx
- CMFCToolBar [MFC], LoadParameters
- CMFCToolBar [MFC], LoadState
- CMFCToolBar [MFC], LoadToolBar
- CMFCToolBar [MFC], LoadToolBarEx
- CMFCToolBar [MFC], OnChangeHot
- CMFCToolBar [MFC], OnFillBackground
- CMFCToolBar [MFC], OnReset
- CMFCToolBar [MFC], OnSetAccData
- CMFCToolBar [MFC], OnSetDefaultButtonText
- CMFCToolBar [MFC], RemoveAllButtons
- CMFCToolBar [MFC], RemoveButton
- CMFCToolBar [MFC], RemoveStateFromRegistry
- CMFCToolBar [MFC], ReplaceButton
- CMFCToolBar [MFC], ResetAll
- CMFCToolBar [MFC], ResetAllImages
- CMFCToolBar [MFC], RestoreOriginalState
- CMFCToolBar [MFC], SaveState
- CMFCToolBar [MFC], SetBasicCommands
- CMFCToolBar [MFC], SetButtonInfo
- CMFCToolBar [MFC], SetButtonStyle
- CMFCToolBar [MFC], SetButtonText
- CMFCToolBar [MFC], SetButtons
- CMFCToolBar [MFC], SetCommandUsageOptions
- CMFCToolBar [MFC], SetCustomizeMode
- CMFCToolBar [MFC], SetGrayDisabledButtons
- CMFCToolBar [MFC], SetHeight
- CMFCToolBar [MFC], SetHotBorder
- CMFCToolBar [MFC], SetHotTextColor
- CMFCToolBar [MFC], SetLargeIcons
- CMFCToolBar [MFC], SetLockedSizes
- CMFCToolBar [MFC], SetMenuSizes
- CMFCToolBar [MFC], SetNonPermittedCommands
- CMFCToolBar [MFC], SetOneRowWithSibling
- CMFCToolBar [MFC], SetPermament
- CMFCToolBar [MFC], SetRouteCommandsViaFrame
- CMFCToolBar [MFC], SetShowTooltips
- CMFCToolBar [MFC], SetSiblingToolBar
- CMFCToolBar [MFC], SetSizes
- CMFCToolBar [MFC], SetToolBarBtnText
- CMFCToolBar [MFC], SetTwoRowsWithSibling
- CMFCToolBar [MFC], SetUserImages
- CMFCToolBar [MFC], StretchPane
- CMFCToolBar [MFC], TranslateChar
- CMFCToolBar [MFC], UpdateButton
- CMFCToolBar [MFC], WrapToolBar
- CMFCToolBar [MFC], AllowShowOnList
- CMFCToolBar [MFC], CalcMaxButtonHeight
- CMFCToolBar [MFC], DoPaint
- CMFCToolBar [MFC], DrawButton
- CMFCToolBar [MFC], DrawSeparator
- CMFCToolBar [MFC], OnUserToolTip
- CMFCToolBar [MFC], m_bDontScaleImages
- CMFCToolBar [MFC], m_dblLargeImageRatio
ms.assetid: e7679c01-fb94-44c0-98c6-3af955292fb5
ms.openlocfilehash: 9a90327bde693b87a53838da35adde21ed48dfbb
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/22/2020
ms.locfileid: "81754039"
---
# <a name="cmfctoolbar-class"></a>クラス

クラス`CMFCToolBar`は[CToolBar クラス](../../mfc/reference/ctoolbar-class.md)に似ていますが、ユーザー インターフェイス機能の追加サポートを提供します。 フラット ツール バー、ホット イメージのツール バー、大きいアイコン、ページャー ボタン、ロックされたツール バー、rebar コントロール、イメージの下のテキスト、背景イメージ、およびタブ付きのツール バーなどがサポートされます。 `CMFCToolBar` クラスには、ツール バーおよびメニューに対するユーザーのカスタマイズ、ツール バーとメニューの間のドラッグ アンド ドロップ、コンボ ボックス ボタン、エディット ボックス ボタン、カラー ピッカー、およびロールアップ ボタンのサポートも組み込まれています。

詳細については、Visual Studio のインストールの**\\VC\\atlmfc\\src mfc**フォルダーにあるソース コードを参照してください。

## <a name="syntax"></a>構文

```
class CMFCToolBar : public CMFCBaseToolBar
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|`CMFCToolBar::CMFCToolBar`|既定のコンストラクターです。|
|`CMFCToolBar::~CMFCToolBar`|デストラクターです。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[コマンドバーを追加します。](#addbasiccommand)|ユーザーがメニューを開いたときに常に表示されるコマンドの一覧に、メニュー コマンドを追加します。|
|[使用法の使用法](#addcommandusage)|指定されたコマンドに関連付けられているカウンターを 1 つ増やします。|
|[コレクションコレクション](#addtoolbarforimagecollection)|ユーザー インターフェイス リソースからアプリケーション内のイメージのコレクションにイメージを追加します。|
|[CMFCツールバー::レイアウトを調整する](#adjustlayout)|ツール バーのサイズと位置を再計算します。 [(CBasePane をオーバーライドします::レイアウトを調整](../../mfc/reference/cbasepane-class.md#adjustlayout)します)。|
|[コントロール バー::サイズを調整する](#adjustsize)|ツール バーのサイズを再計算します。|
|[コントロール バー::テキスト ラベルを変更します。](#allowchangetextlabels)|テキスト ラベルをツール バー ボタンのイメージの下に表示できるかどうかを指定します。|
|[CMFCツールバー::アテキストラベル](#aretextlabels)|イメージの下のテキスト ラベルをツール バー ボタンに表示するかどうかを指定します。|
|[CMFCツールバー::オートグレイ非アクティブ画像](#autograyinactiveimages)|非アクティブなボタン イメージの自動生成を有効または無効にします。|
|[CMFCツールバー::ボタンを使用します。](#buttontoindex)|このツール バーの指定された[CMFCToolBarButton クラス](../../mfc/reference/cmfctoolbarbutton-class.md)オブジェクトのインデックスを返します。|
|[CMFCツールバー::計算固定レイアウト](#calcfixedlayout)|ツール バーの水平方向のサイズを計算します。 (CBase ペインをオーバーライド[します::計算固定レイアウト](../../mfc/reference/cbasepane-class.md#calcfixedlayout).)|
|[CMFCツールバー::カルクサイズ](#calcsize)|レイアウト計算プロセスの一部としてフレームワークによって呼び出されます。 (CPane をオーバーライド[します。:CalcSize](../../mfc/reference/cpane-class.md#calcsize).)|
|[兄弟を扱うことができます。](#canhandlesiblings)|ツール バーとその兄弟が同じウィンドウに配置されているかどうかを判定します。|
|[CMFCツールバー::クリーンアップイメージズ](#cleanupimages)|ツール バー イメージに割り当てられたシステム リソースを解放します。|
|[CMFCツールバー::クリーンアップロックされた画像](#cleanuplockedimages)|ロックされたツール バー イメージに割り当てられたシステム リソースを解放します。|
|[CMFCツールバー::缶詰閉](#canbeclosed)|ユーザーがツール バーを閉じることができるかどうかを指定します。 [(CBasePane をオーバーライドします::CanBeClosed](../../mfc/reference/cbasepane-class.md#canbeclosed).)|
|[CMFCツールバー::缶詰](#canberestored)|カスタマイズ後に、システムがツール バーを元の状態に復元できるかどうかを決定します。|
|[CMFCツールバー::カンフォーカス](#canfocus)|ペインがフォーカスを受け取ることができるかどうかを指定します。 [(CBasePane をオーバーライドします。:CanFocus](../../mfc/reference/cbasepane-class.md#canfocus).)|
|[兄弟を扱うことができます。](#canhandlesiblings)|ツール バーとその兄弟が同じウィンドウに配置されているかどうかを判定します。|
|[CMFC ツールバー::コマンドをインデックスに追加します。](#commandtoindex)|指定したコマンド ID を持つツール バーのボタンのインデックスを返します。|
|[CMFCツールバー::作成](#create)|`CMFCToolBar` オブジェクトを作成します。|
|[CMFCツールバー::作成します。](#createex)|大きい`CMFCToolBar`アイコンなど、追加のスタイル オプションを使用するオブジェクトを作成します。|
|[CMFCツールバー::D活性化](#deactivate)|ツール バーを非アクティブにします。|
|[ボタンを有効にします。](#enablecustomizebutton)|ツール バーの最後に表示される **[ボタンの追加と削除**] ボタンを有効または無効にします。|
|[CMFCツールバー::ドッキングを有効にする](#enabledocking)|ペインをメイン フレームにドッキングできるようにします。 [(CBasePane をオーバーライドします::ドッキングを有効にします](../../mfc/reference/cbasepane-class.md#enabledocking)。|
|[アイコンアイコンを有効にします。](#enablelargeicons)|ツール バー ボタンの大きいアイコンを有効または無効にします。|
|[CMFCツールバー::クイックカスタマイズを有効にする](#enablequickcustomization)|ユーザーが**Alt**キーを押してボタンを新しい場所にドラッグできるように、ツール バーのクイック カスタマイズを有効または無効にします。|
|[反射を有効にします。](#enablereflections)|コマンド リフレクションを有効または無効にします。|
|[CMFCツールバー::テキストラベルを有効にする](#enabletextlabels)|ツール バー ボタン イメージの下のテキスト ラベルを有効または無効にします。|
|[CMFCツールバー::ハンドルパーマネント](#fromhandlepermanent)|指定したウィンドウ ハンドルを`CMFCToolBar`含むオブジェクトへのポインターを取得します。|
|[ボタンをクリックします。](#getallbuttons)|ツール バーのボタンの読み取り専用のリストを返します。|
|[ツールバー::すべてのツール バー](#getalltoolbars)|アプリケーション内のすべてのツールバーの読み取り専用リストを返します。|
|[コマンドバー::コマンドを取得します。](#getbasiccommands)|アプリケーションで定義された基本コマンドの読み取り専用リストを返します。|
|[コントロール バー::取得ボタン](#getbutton)|指定したツール バー`CMFCToolBarButton`ボタンインデックスを持つオブジェクトへのポインターを返します。|
|[コントロール バー::取得ボタン情報](#getbuttoninfo)|指定したインデックス位置にあるボタンのコマンド ID、スタイル、およびイメージ インデックスを返します。|
|[コントロール バー::ボタンのサイズ](#getbuttonsize)|ツール バーの各ボタンのサイズを返します。|
|[コントロール バー::ボタンスタイル](#getbuttonstyle)|指定したインデックス位置にあるツール バー ボタンの現在のスタイルを返します。|
|[コントロール バー::ボタンテキスト](#getbuttontext)|指定したインデックスを持つボタンのテキスト ラベルを返します。|
|[CMFCツールバー::ゲットコールドイメージ](#getcoldimages)|アプリケーション内のコールド ツール バー ボタン イメージのコレクションへのポインターを返します。|
|[コントロール バー::列幅を取得します。](#getcolumnwidth)|ツール バー ボタンの幅を返します。|
|[コマンド ボタンを取得します。](#getcommandbuttons)|アプリケーションのすべてのツール バーから、指定したコマンド ID を持つボタンの一覧を返します。|
|[コントロール バー::取得カウント](#getcount)|ツール バーのボタンと区切り記号の数を返します。|
|[ボタンをクリックします。](#getcustomizebutton)|ツール バーに関連付`CMFCCustomizeButton`けられているオブジェクトへのポインターを取得します。|
|[コントロール バー::既定のイメージを取得します。](#getdefaultimage)|指定したコマンド ID を持つツール バー ボタンの既定のイメージのインデックスを返します。|
|[コントロール バー::無効なイメージ](#getdisabledimages)|アプリケーションで無効になっているツール バー ボタンに使用されるイメージのコレクションへのポインターを返します。|
|[メニューバー::メニュー](#getdisabledmenuimages)|アプリケーションで無効なメニュー ボタンに使用されるイメージのコレクションへのポインターを返します。|
|[メニューメニュー](#getdroppeddownmenu)|現在サブメニューを表示しているメニュー ボタン オブジェクトへのポインターを取得します。|
|[ボタンを押します。](#getgraydisabledbuttons)|無効なボタンのイメージが通常のボタン イメージの淡色表示バージョンであるか、無効なボタン イメージのコレクションから取得されるかを指定します。|
|[ボタンをクリックします。](#gethighlightedbutton)|現在強調表示されているツール バー ボタンへのポインターを返します。|
|[CMFCツールバー::ゲットホットボーダー](#gethotborder)|ツール バー ボタンがホット トラッキングされているかどうかを判断します。|
|[コントロール バー::テキストの色を取得します。](#gethottextcolor)|強調表示されたツール バー ボタンのテキストの色を返します。|
|[CMFCツールバー::ゲットフウェンドラストフォーカス](#gethwndlastfocus)|ツールバーの直前に入力フォーカスが設定されていたウィンドウへのハンドルを返します。|
|[テキストを無視します。](#getignoresettext)|ボタン ラベルを設定する呼び出しを無視するかどうかを指定します。|
|[コントロール バー::イメージサイズ](#getimagesize)|ツール バー ボタン イメージの現在のサイズを返します。|
|[CMFCツールバー::取得イメージ](#getimages)|アプリケーション内の既定のボタン イメージのコレクションへのポインターを返します。|
|[をクリックします。](#getimagesoffset)|ツール バー ボタン イメージのグローバル リスト内のこのツール バーのツール バー ボタン イメージを検索するために使用するインデックス オフセットを返します。|
|[コントロール バー::取得イン検証アイテムレクト](#getinvalidateitemrect)|指定されたインデックスのボタンに対して再描画する必要があるクライアント領域の領域を取得します。|
|[をクリックします。](#getitemid)|指定したインデックス位置にあるツール バー ボタンのコマンド ID を返します。|
|[コントロール バー::ゲットアイテムレクト](#getitemrect)|指定したインデックス位置にあるボタンの外接する四角形を返します。|
|[CMFCツールバー::ゲットラージコールドイメージ](#getlargecoldimages)|アプリケーション内の大きなコールド ツール バー ボタン イメージのコレクションへのポインターを返します。|
|[コントロール バー::取得ラージイメージ](#getlargedisabledimages)|アプリケーション内のツール バー ボタン イメージの大きな無効なコレクションへのポインターを返します。|
|[コントロール バー::取得ラージイメージズ](#getlargeimages)|アプリケーション内の大きなツール バー ボタン イメージのコレクションへのポインターを返します。|
|[CMFCツールバー::ゲットロックコールドイメージズ](#getlockedcoldimages)|ツール バーのロックされたコールド イメージのコレクションへのポインターを返します。|
|[CMFCツールバー::取得ロック無効な画像](#getlockeddisabledimages)|ツール バーのロックされた無効なイメージのコレクションへのポインターを返します。|
|[CMFCツールバー::取得ロックされた画像](#getlockedimages)|ツール バーのロックされたボタン イメージのコレクションへのポインターを返します。|
|[コントロール バー:::取得ロックされたイメージのサイズ](#getlockedimagesize)|ロックされたツール バー イメージの既定のサイズを返します。|
|[メニューバー::メニューの取得](#getlockedmenuimages)|ツール バーのロックされたツール バー メニュー イメージのコレクションへのポインターを返します。|
|[ボタンのサイズを取得します。](#getmenubuttonsize)|アプリケーションのメニュー ボタンのサイズを返します。|
|[メニューバー::メニューイメージサイズ](#getmenuimagesize)|アプリケーション内のメニュー ボタン イメージのサイズを返します。|
|[メニューバー::メニューのイメージ](#getmenuimages)|アプリケーション内のメニュー ボタン イメージのコレクションへのポインターを返します。|
|[コントロール バー::ゲット折り付きボタン](#getorigbuttons)|ツール バーのカスタマイズされていないボタンのコレクションを取得します。|
|[コントロール バー::取得折り込みボタン](#getorigresetbuttons)|ツール バーのカスタマイズされていないリセット ボタンのコレクションを取得します。|
|[を使用します。](#getresourceid)|ツール バーのリソース ID を取得します。|
|[を使用します。](#getroutecommandsviaframe)|親フレームまたはオーナーがツールバーにコマンドを送信するオブジェクトを指定します。|
|[CMFCツールバー::ゲットローハイト](#getrowheight)|ツール バー ボタンの高さを返します。|
|[ツールバー::ヒントツール](#getshowtooltips)|ツール バー ボタンにツール ヒントを表示するかどうかを指定します。|
|[CMFCツールバー::ゲット兄弟ツールバー](#getsiblingtoolbar)|ツール バーの兄弟を取得します。|
|[をクリックします。](#getuserimages)|アプリケーション内のユーザー定義のツール バー ボタン イメージのコレクションへのポインターを返します。|
|[CMFCツールバー::ヒットテスト](#hittest)|指定した位置にあるツール バー ボタンのインデックスを返します。|
|[コントロール バー::挿入ボタン](#insertbutton)|ツール バーにボタンを挿入します。|
|[コントロール バー::区切り記号を挿入します。](#insertseparator)|ツール バーに区切り記号を挿入します。|
|[コントロール バー::無効化ボタン](#invalidatebutton)|指定されたインデックスに存在するツール バー ボタンのクライアント領域を無効にします。|
|[CMFC ツールバー::イアド削除クイックカスタマイズ](#isaddremovequickcustomize)|ユーザーが [**カスタマイズ]** メニュー オプションを使用してツール バー ボタンを追加または削除できるかどうかを指定します。|
|[コントロール バー::イシュアル・カスタマイズ・モード](#isaltcustomizemode)|*ボタンの*ドラッグにクイック カスタマイズを使用するかどうかを指定します。|
|[CMFCツールバー::イストオートグレイ非アクティブ画像](#isautograyinactiveimages)|非アクティブな (強調表示されていない) ボタン イメージの自動生成を有効にするかどうかを指定します。|
|[コマンドバー::IsBasicコマンド](#isbasiccommand)|コマンドが基本コマンドのリストにあるかどうかを判断します。|
|[CMFCツールバー::イボタンエクストラサイズ利用可能](#isbuttonextrasizeavailable)|ツール バーに、拡張枠線を持つボタンを表示できるかどうかを指定します。|
|[CMFCツールバー::ボタンが強調表示されました](#isbuttonhighlighted)|ツール バーのボタンを強調表示するかどうかを指定します。|
|[CMFC ツールバー::IsCommand が許可されました。](#iscommandpermitted)|コマンドを許可するかどうかを決定します。|
|[CMFCツールバー::Isコマンドめったに使用されません](#iscommandrarelyused)|コマンドがほとんど使用されないかどうかを判断します[(CMFC ツール バー::SetCommandUsageOptions](#setcommandusageoptions)を参照)。|
|[コントロール バー::イスカスタマイモード](#iscustomizemode)|ツール バー フレームワークがカスタマイズ モードかどうかを指定します。|
|[コントロール バー::イズドラッグボタン](#isdragbutton)|ツール バー ボタンをドラッグするかどうかを指定します。|
|[ボタンを使用します。](#isexistcustomizebutton)|ツールバーに **[カスタマイズ**] ボタンが含まれているかどうかを判断します。|
|[CMFCツールバー::イズフローティング](#isfloating)|ツール バーがフローティング状態かどうかを判断します。|
|[CMFCツールバー::IsLargeアイコン](#islargeicons)|アプリケーションのツールバーに現在大きいアイコンを表示するかどうかを指定します。|
|[ボタンからボタンをクリックします。](#islastcommandfrombutton)|最後に実行されたコマンドが、指定したツール バー ボタンから送信されたかどうかを判断します。|
|[CMFCツールバー::イズロック](#islocked)|ツール バーがロックされているかどうかを判断します。|
|[兄弟と一緒に](#isonerowwithsibling)|ツールバーとその兄弟ツール バーを同じ行に配置するかどうかを指定します。|
|[コントロール バー::ユーザー定義](#isuserdefined)|ツール バーがユーザー定義であるかどうかを指定します。|
|[を使用します。](#loadbitmap)|アプリケーション リソースからツール バー イメージを読み込みます。|
|[を使用します。](#loadbitmapex)|アプリケーション リソースからツール バー イメージを読み込みます。 大きな画像が含まれています。|
|[パラメーターの読み込み](#loadparameters)|Windows レジストリからグローバル ツール バー オプションを読み込みます。|
|[コントロール バー::ロードステート](#loadstate)|Windows レジストリからツール バーの状態情報を読み込みます。 (CPane をオーバーライド[します::ロードステート](../../mfc/reference/cpane-class.md#loadstate).|
|[コントロール バーの使用](#loadtoolbar)|アプリケーション リソースからツール バーを読み込みます。|
|[CMFCツールバー::ロードツールバレックス](#loadtoolbarex)|ヘルパー クラスを使用してアプリケーション リソース`CMFCToolBarInfo`からツール バーを読み込み、アプリケーションが大きなイメージを使用できるようにします。|
|[CMFCツールバー::オンチェンジホット](#onchangehot)|ユーザーがツール バーのボタンを選択したときに、フレームワークによって呼び出されます。|
|[CMFCツールバー::オンフィルバックグラウンド](#onfillbackground)|[CBasePane::DoPaint](../../mfc/reference/cbasepane-class.md#dopaint)からフレームワークによって呼び出され、ツール バーの背景を塗りつぶします。|
|[CMFCツールバー::オンリセット](#onreset)|ツールバーを元の状態に戻します。|
|[コントロール バー::オンセットアクデータ](#onsetaccdata)|(CBase ペインをオーバーライド[します。::OnSetAccData](../../mfc/reference/cbasepane-class.md#onsetaccdata).)|
|[ボタンバー::既定のボタンテキスト](#onsetdefaultbuttontext)|ツール バー ボタンのテキストを既定の状態に戻します。|
|`CMFCToolBar::OnUpdateCmdUI`|内部使用。|
|[ボタンをクリックします。](#removeallbuttons)|ツール バーからすべてのボタンを削除します。|
|[ボタンの削除](#removebutton)|指定したインデックスを持つボタンをツール バーから削除します。|
|[レジストリから削除します。](#removestatefromregistry)|Windows レジストリからツール バーの状態情報を削除します。|
|[ボタンを置き換える](#replacebutton)|ツール バー ボタンを別のツール バー ボタンに置き換えます。|
|[コントロール バー::リセットオール](#resetall)|すべてのツールバーを元の状態に戻します。|
|[コントロール バー::リセットオールイメージ](#resetallimages)|アプリケーション内のすべてのツール バー イメージ コレクションをクリアします。|
|[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)|ツール バーを元の状態に戻します。|
|[CMFCツールバー::セーブステート](#savestate)|Windows レジストリにツール バーの状態情報を保存します。 (CPane をオーバーライド[します::セーブステート](../../mfc/reference/cpane-class.md#savestate).)|
|`CMFCToolBar::Serialize`|( `CBasePane::Serialize`をオーバーライドします)。|
|[コマンド バー::コマンドの設定](#setbasiccommands)|ユーザーがメニューを開いたときに常に表示されるコマンドのリストを設定します。|
|[コントロール バー::ボタンの設定情報](#setbuttoninfo)|ツール バー ボタンのコマンド ID、スタイル、およびイメージ ID を設定します。|
|[コントロール バー::セットボタンスタイル](#setbuttonstyle)|指定したインデックス位置にあるツール バー ボタンのスタイルを設定します。|
|[コントロール バー::ボタンテキストの設定](#setbuttontext)|ツール バー ボタンのテキスト ラベルを設定します。|
|[ボタンを設定します。](#setbuttons)|ツール バーのボタンを設定します。|
|[コマンドの使用オプションを設定します。](#setcommandusageoptions)|めったに使用されないコマンドがアプリケーションのメニューに表示されない場合に指定します。|
|[コントロール バー::設定カスタマイズモード](#setcustomizemode)|アプリケーションのすべてのツール バーのカスタマイズ モードを有効または無効にします。|
|[ボタン::設定グレー無効ボタン](#setgraydisabledbuttons)|ツール バーの無効なボタンを淡色表示にするか、無効にしたイメージを無効にするかを指定します。|
|[コントロール バー::セットハイト](#setheight)|ツール バーの高さを設定します。|
|[CMFCツールバー::セットホットボーダー](#sethotborder)|ツール バー ボタンをホット トラッキングするかどうかを指定します。|
|[コントロール バー::セットホットテキストカラー](#sethottextcolor)|ホット ツール バー ボタンのテキストの色を設定します。|
|[コントロール バー::セットラージアイコン](#setlargeicons)|ツール バー ボタンに大きいアイコンを表示するかどうかを指定します。|
|[CMFCツールバー::セットロックサイズ](#setlockedsizes)|ツール バー上のロックされたボタンとロックされたイメージのサイズを設定します。|
|[CMFCツールバー::セットメニューサイズ](#setmenusizes)|ツール バー メニュー ボタンとそのイメージのサイズを設定します。|
|[コマンド バー::許可されていないコマンド](#setnonpermittedcommands)|ユーザーが実行できないコマンドのリストを設定します。|
|[兄弟と一緒に設定します。](#setonerowwithsibling)|ツールバーとその兄弟を同じ行に配置します。|
|[CMFCツールバー::セットパーマメント](#setpermament)|ユーザーがツール バーを閉じることができるかどうかを指定します。|
|[コントロール バー::コマンドを実行するフレーム](#setroutecommandsviaframe)|親フレームまたはオーナーがツールバーにコマンドを送信するかどうかを指定します。|
|[ツールバー::セットショーツールチップ](#setshowtooltips)|フレームワークにツール ヒントを表示するかどうかを指定します。|
|[CMFCツールバー::セット兄弟ツールバー](#setsiblingtoolbar)|ツール バーの兄弟を指定します。|
|[コントロール バー::セットサイズ](#setsizes)|すべてのツール バーのボタンとイメージのサイズを指定します。|
|[テキストを作成します。](#settoolbarbtntext)|ツール バーのボタンのプロパティを指定します。|
|[兄弟と一緒に設定します。](#settworowswithsibling)|ツールバーとその兄弟を別々の行に配置します。|
|[コントロール バー::セットユーザーイメージズ](#setuserimages)|アプリケーション内のユーザー定義イメージのコレクションを設定します。|
|[CMFCツールバー::ストレッチペイン](#stretchpane)|ツールバーを垂直方向または水平方向に伸縮します。 [(CBasePane をオーバーライドします::ストレッチペイン](../../mfc/reference/cbasepane-class.md#stretchpane).)|
|[CMFCツールバー::翻訳文字](#translatechar)|指定したキー コードが有効なキーボード ショートカットに対応する場合は、ボタン コマンドを実行します。|
|[コントロール バー::更新ボタン](#updatebutton)|指定したボタンの状態を更新します。|
|[コントロール バー::ラップツールバー](#wraptoolbar)|指定した寸法内のツールバー ボタンを再配置します。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[CMFCツールバー::リストを表示します。](#allowshowonlist)|[**ユーザー**設定] ダイアログ ボックスの [**ツールバー** ] ウィンドウの一覧にツール バーを表示するかどうかを指定します。|
|[CMFCツールバー::カルクマックスボタンの高さ](#calcmaxbuttonheight)|ツール バーのボタンの最大高さを計算します。|
|[CMFCツールバー::Doペイント](#dopaint)|ツール バーを再描画します。|
|[CMFCツールバー::Dローボタン](#drawbutton)|ツール バー ボタンを再描画します。|
|[:Dローセパレータ](#drawseparator)|ツール バーの区切り記号を再描画します。|
|[ツールバー::オンユーザーツールチップ](#onusertooltip)|ボタンのツールヒントが表示されようとしているときに、フレームワークによって呼び出されます。|

### <a name="data-members"></a>データ メンバー

|名前|説明|
|----------|-----------------|
|[CMFCツールバー::m_bDontScaleImages](#m_bdontscaleimages)|高 DPI モードでツール バー イメージを拡大/縮小するかどうかを指定します。|
|[コントロール バー::m_dblLargeImageRatio](#m_dbllargeimageratio)|大きいイメージの寸法(高さまたは幅)と通常の画像の寸法の比率を指定します。|

## <a name="remarks"></a>解説

オブジェクトを`CMFCToolBar`アプリケーションに組み込むには、次の手順を実行します。

1. メイン`CMFCToolBar`フレーム ウィンドウにオブジェクトを追加します。

1. メイン フレーム ウィンドウのWM_CREATE メッセージを処理するときには[、CMFCToolBar::作成](#create)または[CMFCToolBar::CreateEx](#createex)を呼び出してツール バーを作成し、そのスタイルを指定します。

1. [CBasePane を呼び出します::ドッキングスタイルを](../../mfc/reference/cbasepane-class.md#enabledocking)指定するには、ドッキングを有効にします。

コンボ ボックスやドロップダウン ツール バーなどの特殊なボタンを挿入するには、親リソースにダミー ボタンを予約し[、CMFCToolBar::ReplaceButton](#replacebutton)を使用して実行時にダミー ボタンを置き換えます。 詳細については、「[チュートリアル : ツールバーにコントロールを配置](../walkthrough-putting-controls-on-toolbars.md)する 」を参照してください。

`CMFCToolBar`は、MFC ライブラリ クラスの基本[クラスクラス CMFCMenuBar クラス](../../mfc/reference/cmfcmenubar-class.md)[、CMFCPopupMenuBar クラス](../../mfc/reference/cmfcpopupmenubar-class.md)、および[CMFCDropDownToolBar クラス](../../mfc/reference/cmfcdropdowntoolbar-class.md)です。

## <a name="example"></a>例

`CMFCToolBar` クラスのさまざまなメソッドの使用方法を次の例に示します。 この例では、ツールバーのウィンドウ ラベルのテキストの設定、境界線の設定、ウィンドウのスタイルの設定、およびツールバーの最後に表示される **[ボタンの追加と削除]** ボタンの有効化を行う方法を示します。 このコード スニペットは、 [IE デモ のサンプル](../../overview/visual-cpp-samples.md)の一部です。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#8](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_2.cpp)]

## <a name="requirements"></a>必要条件

**ヘッダー:** afxtoolbar.h

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[ツールバー](../../mfc/reference/cmfcbasetoolbar-class.md)

`CMFCToolBar`

## <a name="cmfctoolbaraddbasiccommand"></a><a name="addbasiccommand"></a>コマンドバーを追加します。

ユーザーがメニューを開いたときに常に表示されるコマンドの一覧に、メニュー コマンドを追加します。

```
static void __stdcall AddBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>パラメーター

*Uicmd*<br/>
[in]追加するコマンドを指定します。

### <a name="remarks"></a>解説

メニューを開くと、常に基本コマンドが表示されます。 このメソッドは、ユーザーが最近使用したコマンドを表示することを選択した場合に意味があります。

ユーザーがメニューを開いたときに常に表示されるコマンドの一覧を設定するには[、CMFCToolBar::SetBasicCommands](#setbasiccommands)メソッドを使用します。 CMFC[ツールバー::GetBasicCommands](#getbasiccommands)メソッドを使用して、アプリケーションで使用される基本的なコマンドのリストを取得します。

## <a name="cmfctoolbaraddcommandusage"></a><a name="addcommandusage"></a>使用法の使用法

指定されたコマンドに関連付けられているカウンターを 1 つ増やします。

```
static void __stdcall AddCommandUsage(UINT uiCommand);
```

### <a name="parameters"></a>パラメーター

*uiコマンド*<br/>
[in]インクリメントするコマンド カウンターを指定します。

### <a name="remarks"></a>解説

ユーザーがメニュー項目を選択すると、フレームワークはこのメソッドを呼び出します。

フレームワークは、コマンド カウンターを使用して、最近使用したメニュー項目を表示します。

このメソッドは、[コマンド](../../mfc/reference/cmfccmdusagecount-class.md#addcmd)カウンターをインクリメントします。

## <a name="cmfctoolbaraddtoolbarforimagecollection"></a><a name="addtoolbarforimagecollection"></a>コレクションコレクション

ユーザー インターフェイス リソースからアプリケーション内のイメージのコレクションにイメージを追加します。

```
static BOOL __stdcall AddToolBarForImageCollection(
    UINT uiResID,
    UINT uiBmpResID=0,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>パラメーター

*UIResID*<br/>
[in]読み込むイメージを含むツール バーのリソース ID。

*をクリックします。*<br/>
[in]ツール バー イメージを含むビットマップのリソース ID。

*をクリックします。*<br/>
[in]"コールド" ツール バー イメージを含むビットマップのリソース ID です。

*をクリックします。*<br/>
[in]メニュー イメージを含むビットマップのリソース ID。

*を無効にします。*<br/>
[in]ツール バー イメージが無効なビットマップのリソース ID です。

*を無効にします。*<br/>
[in]無効なメニュー イメージを持つビットマップのリソース ID。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は TRUE。FALSE*は、uiResID*または*uiBmpResID*が有効なリソースを指定しない場合、または別のエラーが発生します。

### <a name="remarks"></a>解説

ツール バー イメージを含むビットマップを読み込み、ツール バー イメージのコレクションに追加します。 このメソッドは、一時的なツール バー オブジェクトを作成し、呼び出し[CMFCツール バー::読み込みツール バー](#loadtoolbar)。

## <a name="cmfctoolbaradjustlayout"></a><a name="adjustlayout"></a>CMFCツールバー::レイアウトを調整する

ツール バーのサイズと位置を再計算します。

```
virtual void AdjustLayout();
```

### <a name="remarks"></a>解説

ツール バーのサイズと位置を再計算するために作成された場合に、このメソッドを呼び出します。

フレームワークは、ツールバーのレイアウトを変更する必要があるたびにこのメソッドを呼び出します。 たとえば、ユーザーが別のコントロール バーを移動したり、アプリケーション ウィンドウのサイズを変更したり、ツールバーをカスタマイズしたりすると、レイアウトを変更する必要があります。

から`CMFCToolbar`派生したクラスで独自の動的レイアウトを提供するには、このメソッドをオーバーライドします。

## <a name="cmfctoolbaradjustsize"></a><a name="adjustsize"></a>コントロール バー::サイズを調整する

ツール バーのサイズを再計算します。

```cpp
void AdjustSize();
```

### <a name="remarks"></a>解説

このメソッドは、ツールバーが親フレームの境界に収まるようにします。 このメソッドは、ツール バーに親フレームがない場合は何も実行しません。

[CMFCToolBar::AdjustLayout](#adjustlayout)メソッドは、ツール バーの親がオブジェクトでない場合にサイズを再計算するために、`CMFCReBar`このメソッドを呼び出します。

## <a name="cmfctoolbarallowchangetextlabels"></a><a name="allowchangetextlabels"></a>コントロール バー::テキスト ラベルを変更します。

テキスト ラベルをツール バー ボタンのイメージの下に表示できるかどうかを指定します。

```
virtual BOOL AllowChangeTextLabels() const;
```

### <a name="return-value"></a>戻り値

テキスト ラベルをイメージの下に表示できる場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、選択したツールバーの **[ツールバー** ] ページの [**テキスト ラベルの表示**] チェック ボックスを有効にするかどうかを指定するために、カスタマイズ ダイアログ ボックスから呼び出されます。

既定の実装では TRUE が返されます。

イメージの下のツール バー`CMFCToolBar`ボタンにテキスト ラベルを表示するかどうかをユーザーが決定しない場合は、派生したオブジェクトでこのメソッドをオーバーライドし、FALSE を返します。

## <a name="cmfctoolbarallowshowonlist"></a><a name="allowshowonlist"></a>CMFCツールバー::リストを表示します。

[**ユーザー**設定] ダイアログ ボックスの [ツールバー] ウィンドウのツール バーの一覧に**ツール バー**を表示するかどうかを指定します。

```
virtual BOOL AllowShowOnList() const;
```

### <a name="return-value"></a>戻り値

ツール バー のカスタマイズ ページのリスト ボックスにツール バー オブジェクトを表示できる場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、ツール バー のカスタマイズ ページのリストに、 から派生した特定のオブジェクトを`CMFCToolBar`含めるかどうかを決定するために、フレームワークによって呼び出されます。

既定の実装では、常に TRUE が返されます。 カスタマイズ ダイアログ ボックスのツール バーの一覧にツールバーを表示しない場合は、このメソッドをオーバーライドします。

## <a name="cmfctoolbararetextlabels"></a><a name="aretextlabels"></a>CMFCツールバー::アテキストラベル

イメージの下のテキスト ラベルをツール バー ボタンに表示するかどうかを指定します。

```
BOOL AreTextLabels() const;
```

### <a name="return-value"></a>戻り値

ツール バー ボタンがイメージの下にテキスト ラベルを表示する場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

テキストを表示するかどうかを指定するには[、CMFC ツール バー::有効](#enabletextlabels)テキスト ラベルを使用します。 既定値は FALSE です。 呼び出し[CMFCツールバー::AllowChangeTextLabels](#allowchangetextlabels)ユーザーがカスタマイズ ダイアログ ボックスでこの設定を変更できるかどうかを指定します。

## <a name="cmfctoolbarautograyinactiveimages"></a><a name="autograyinactiveimages"></a>CMFCツールバー::オートグレイ非アクティブ画像

非アクティブなボタン イメージの自動生成を有効または無効にします。

```
static void AutoGrayInactiveImages(
    BOOL bEnable=TRUE,
    int nGrayImagePercentage=0,
    BOOL bRedrawAllToolbars=TRUE);
```

### <a name="parameters"></a>パラメーター

*b 有効にする*<br/>
[in]アクティブでないイメージを暗くするかどうかを指定するブール値。 このパラメーターが TRUE の場合、非アクティブイメージは淡色表示されます。 それ以外の場合、非アクティブなイメージは淡色表示されません。

*イメージの表示*<br/>
[in]非アクティブなイメージの輝度の割合を指定します。 *bEnable*が FALSE の場合、この値は無視されます。

*すべてのツール バー*<br/>
[in]アプリケーション内のすべてのツール バーを再描画するかどうかを指定するブール値。 このパラメーターが TRUE の場合、このメソッドはすべてのツール バーを再描画します。

### <a name="remarks"></a>解説

*bEnable*が TRUE の場合、フレームワークは*nGrayImagePercentage*を使用して、通常のイメージから非アクティブなイメージを生成します。 それ以外の場合は[、CMFCToolBar::GetColdImages](#getcoldimages)メソッドを使用して、非アクティブなイメージのセットを指定する必要があります。 既定では、このオプションは無効になっています。

*パラメーターの*詳細については[、「CMFC ツール バー イメージズ::グレーイメージズ](../../mfc/reference/cmfctoolbarimages-class.md#grayimages)」を参照してください。

## <a name="cmfctoolbarbuttontoindex"></a><a name="buttontoindex"></a>CMFCツールバー::ボタンを使用します。

このツール バーの指定された[CMFCToolBarButton クラス](../../mfc/reference/cmfctoolbarbutton-class.md)オブジェクトのインデックスを返します。

```
int ButtonToIndex(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>パラメーター

*ボタン*<br/>
[in]ツール バー ボタン オブジェクトへのポインター。

### <a name="return-value"></a>戻り値

ツール バー ボタンの内部リスト内の*pButton*のインデックス。指定したボタンがこのツールバーにない場合は -1 を返します。

## <a name="cmfctoolbarcalcfixedlayout"></a><a name="calcfixedlayout"></a>CMFCツールバー::計算固定レイアウト

ツール バーの水平方向のサイズを計算します。

```
virtual CSize CalcFixedLayout(
    BOOL bStretch,
    BOOL bHorz);
```

### <a name="parameters"></a>パラメーター

*bストレッチ*<br/>
[in]TRUE を指定すると、親フレームのサイズまでツール バーが拡大されます。

*bHorz*<br/>
[in]ツールバーを水平方向に配置する場合は TRUE。FALSE を指定すると、ツールバーの垂直方向が垂直方向になります。

### <a name="return-value"></a>戻り値

ツール`CSize`バーのサイズを指定するオブジェクト。

### <a name="remarks"></a>解説

このメソッドは、このメソッドを使用してツール バー`CMFCToolBar::CalcLayout`のサイズを計算します。 *bStretch*が TRUE の場合は *、dwMode*パラメーターのLM_STRETCHフラグを渡します。 *bHorz*が TRUE の場合は、LM_HORZフラグを渡します。

このメソッドを使用する例については、VisualStudioDemo サンプルを参照してください。

## <a name="cmfctoolbarcalcmaxbuttonheight"></a><a name="calcmaxbuttonheight"></a>CMFCツールバー::カルクマックスボタンの高さ

ツール バーのボタンの最大高さを計算します。

```
virtual int CalcMaxButtonHeight();
```

### <a name="return-value"></a>戻り値

ボタンの最大の高さ。

### <a name="remarks"></a>解説

このメソッドは、ツール バーのすべてのツール バー ボタンの高さの最大値を計算します。 高さは、現在のツールバードッキング状態などの要因によって異なる場合があります。

独自の高さの計算`CMFCToolBar`を提供するために派生したクラスでこのメソッドをオーバーライドします。

## <a name="cmfctoolbarcalcsize"></a><a name="calcsize"></a>CMFCツールバー::カルクサイズ

レイアウト計算プロセスの一部としてフレームワークによって呼び出されます。

```
virtual CSize CalcSize(BOOL bVertDock);
```

### <a name="parameters"></a>パラメーター

*bVertDock*<br/>
[in]ツール バーが垂直方向にドッキングされることを指定する場合は TRUE。FALSE を指定すると、ツール バーが水平方向にドッキングされます。

### <a name="return-value"></a>戻り値

ツール`CSize`バーのボタンの全体のサイズを指定するオブジェクト。

### <a name="remarks"></a>解説

このメソッドは、テキスト ラベルの領域や境界線のサイズなど、各ボタンのサイズに影響する属性を考慮します。

ツール バーにボタンが含まれている場合、このメソッドは[、CMFCToolBar::GetButtonSize](#getbuttonsize)メソッドを使用して、単一のボタンの予約サイズを返します。

## <a name="cmfctoolbarcanbeclosed"></a><a name="canbeclosed"></a>CMFCツールバー::缶詰閉

ユーザーがツール バーを閉じることができるかどうかを指定します。

```
virtual BOOL CanBeClosed() const;
```

### <a name="return-value"></a>戻り値

ユーザーがツール バーを閉じることができる場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

フレームワークは、ユーザーがツール バーを閉じることができるかどうかを判断するために、このメソッドを呼び出します。 メソッドが TRUE を返す場合、フレームワークはツール バーのシステム メニューのSC_CLOSE コマンドを有効にし、ユーザーはカスタマイズ ダイアログ ボックスのツール バーの一覧にあるチェック ボックスを使用してツール バーを閉じることができます。

既定の実装では TRUE が返されます。 ユーザーが閉じることができないツール バー`CMFCToolBar`オブジェクトを作成するには、派生したクラスでこのメソッドをオーバーライドします。

## <a name="cmfctoolbarcanberestored"></a><a name="canberestored"></a>CMFCツールバー::缶詰

カスタマイズ後に、システムがツール バーを元の状態に復元できるかどうかを決定します。

```
virtual BOOL CanBeRestored() const;
```

### <a name="return-value"></a>戻り値

アプリケーション リソースからツール バーを復元できる場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

フレームワークは、カスタマイズ後にツール バーを元の状態に戻すことができるかどうかを判断するために、このメソッドを呼び出します。 元の状態は、アプリケーション リソースから読み込まれます。

TRUE`CanBeRestored`を返す場合、カスタマイズ ダイアログ ボックスの **[ツールバー** ] ページで、選択したツールバーの **[リセット**] ボタンが有効になります。

既定の実装は、ツール バーが読み込まれたときに元のリソース ID が 0 以外の場合に TRUE を返します。 通常、復元できないのはユーザー定義のツール バーだけです。

派生クラスでこの動作`CanBeRestored`をカスタマイズするには、このメソッドをオーバーライドできます。

## <a name="cmfctoolbarcanfocus"></a><a name="canfocus"></a>CMFCツールバー::カンフォーカス

ペインがフォーカスを受け取ることができるかどうかを指定します。

```
virtual BOOL CanFocus() const;
```

### <a name="return-value"></a>戻り値

このメソッドは FALSE を返します。

### <a name="remarks"></a>解説

このメソッドは、ツールバー オブジェクトがフォーカスを受け取ることができないため、基本クラスの実装[CBasePane::CanFocus](../../mfc/reference/cbasepane-class.md#canfocus)をオーバーライドします。

## <a name="cmfctoolbarcanhandlesiblings"></a><a name="canhandlesiblings"></a>兄弟を扱うことができます。

ツール バーとその兄弟が同じウィンドウに配置されているかどうかを判定します。

```
BOOL CanHandleSiblings();
```

### <a name="return-value"></a>戻り値

ツール バーに兄弟があり、ツール バーとその兄弟が同じペインに配置されている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

内部の CMFCCustomizeButton::CreatePopupMenu メソッドは、このメソッドを呼び出して、カスタマイズ ポップアップ メニューを表示する**方法を決定**します。 このメソッドが TRUE を返す場合、フレームワークは [ボタンを**1 行に表示**] ボタンまたは **[2 行にボタンを表示]** ボタンを表示します。

通常、このメソッドを使用する必要はありません。 ツール バーに表示される **[カスタマイズ**] ボタンを有効にするには、[メソッド](#enablecustomizebutton)を呼び出します。 **[1 行にボタンを表示**する] ボタンまたは **[2 行にボタンを表示**] ボタンを有効にするには[、CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)を呼び出します。

## <a name="cmfctoolbarcleanupimages"></a><a name="cleanupimages"></a>CMFCツールバー::クリーンアップイメージズ

ツール バー イメージに割り当てられたシステム リソースを解放します。

```
static void CMFCToolBar::CleanUpImages();
```

### <a name="remarks"></a>解説

フレームワークは、アプリケーションがシャットダウンするときにこのメソッドを呼び出します。

## <a name="cmfctoolbarcleanuplockedimages"></a><a name="cleanuplockedimages"></a>CMFCツールバー::クリーンアップロックされた画像

ロックされたツール バー イメージに割り当てられたシステム リソースを解放します。

```cpp
void CleanUpLockedImages();
```

### <a name="remarks"></a>解説

アプリケーションのビジュアル スタイルが変更されたときに、このメソッドを呼び出します。 このメソッドを使用する例については、VisualStudioDemo サンプルを参照してください。

## <a name="cmfctoolbarcommandtoindex"></a><a name="commandtoindex"></a>CMFC ツールバー::コマンドをインデックスに追加します。

指定したコマンド ID を持つツール バーのボタンのインデックスを返します。

```
int CommandToIndex(
    UINT nIDFind,
    int iIndexFirst=0) const;
```

### <a name="parameters"></a>パラメーター

*nID検索*<br/>
[in]コマンド ID を指定します。

*最初にインデックスを作成します。*<br/>
[in]開始する初期インデックスを指定します。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は、ツール バー ボタンの 0 から始まるインデックス。指定された ID のボタンがない場合は -1。

### <a name="remarks"></a>解説

オブジェクト`CMFCToolBar`は、ツールバー上のボタンの内部リストを保持します。 ボタンのコマンド ID を指定して、リスト内のボタンのインデックスを取得します。

*iIndex*が 0 より大きい場合、このメソッドは *、iIndex*より小さいインデックスを持つツール バーのボタンを無視します。

## <a name="cmfctoolbarcreate"></a><a name="create"></a>CMFCツールバー::作成

`CMFCToolBar` オブジェクトを作成します。

```
virtual BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>パラメーター

*pParentWnd*<br/>
[in]ツール バーの親ウィンドウへのポインター。

*Dwstyle*<br/>
[in]ツール バーのスタイル。 スタイルの一覧については、Windows SDK の[ツールバー コントロールとボタン スタイル](/windows/win32/Controls/toolbar-control-and-button-styles)を参照してください。

*nID*<br/>
[in]ツール バーの子ウィンドウの ID。

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、コントロール バーを作成し、ツール バーにアタッチします。 TBSTYLE_FLAT スタイルでコントロール バーを作成します。 別のコントロール バー スタイルが必要な場合は[、CMFC ツール バー](#createex)バーを呼び出します。

## <a name="cmfctoolbarcreateex"></a><a name="createex"></a>CMFCツールバー::作成します。

大きい`CMFCToolBar`アイコンなど、追加のスタイル オプションを使用するオブジェクトを作成します。

```
virtual BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle=TBSTYLE_FLAT,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    CRect rcBorders=CRect(1,
    1,
    1,
    1),
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>パラメーター

*pParentWnd*<br/>
[in]ツール バーの親ウィンドウへのポインター。

*スタイル*<br/>
[in]埋め込みコントロール バー オブジェクトを作成するための追加のスタイル。

*Dwstyle*<br/>
[in]ツール バーのスタイル。 適切なスタイルの一覧については、「[ツールバー コントロール」および「ボタン](/windows/win32/Controls/toolbar-control-and-button-styles)スタイル」を参照してください。

*rcボーダー*<br/>
[in]ツール`CRect`バー ウィンドウの境界線の幅を指定するオブジェクト。

*nID*<br/>
[in]ツール バーの子ウィンドウの ID。

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

このメソッドは、コントロール バーを作成し、ツール バーにアタッチします。

[CMFCToolBar の](#create)代わりにこのメソッドを呼び出します::特定のスタイルを指定する場合に作成します。 たとえば *、dwCtrlStyle を*TBSTYLE_FLATに設定します。Internet Explorer 4 で使用されるツール バーと同様のツール バーを作成するには、TBSTYLE_TRANSPARENTします。

### <a name="example"></a>例

クラスのメソッドの使用方法を`CreateEx`次の例に示します`CMFCToolBar`。 このコード スニペットは、 [IE デモ のサンプル](../../overview/visual-cpp-samples.md)の一部です。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

## <a name="cmfctoolbardeactivate"></a><a name="deactivate"></a>CMFCツールバー::D活性化

ツール バーを非アクティブにします。

```
virtual void Deactivate();
```

### <a name="remarks"></a>解説

このメソッドは、強調表示されたツール バー ボタンからフォーカスを削除することで、ツール バーを非アクティブ化します。 ツール バーがフォーカスを失うか、または破棄された場合、フレームワークはこのメソッドを呼び出します。

## <a name="cmfctoolbardopaint"></a><a name="dopaint"></a>CMFCツールバー::Doペイント

ツール バーを再描画します。

```
virtual void DoPaint(CDC* pDC);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
[in]デバイス コンテキストへのポインター。

### <a name="remarks"></a>解説

このメソッドは、ツール バーの一部を再描画する必要があるときに、フレームワークによって呼び出されます。

から派生したオブジェクトの外観をカスタマイズするには、このメソッド`CMFCToolBar`をオーバーライドします。

## <a name="cmfctoolbardrawbutton"></a><a name="drawbutton"></a>CMFCツールバー::Dローボタン

ツール バー ボタンを再描画します。

```
virtual BOOL DrawButton(
    CDC* pDC,
    CMFCToolBarButton* pButton,
    CMFCToolBarImages* pImages,
    BOOL bHighlighted,
    BOOL bDrawDisabledImages);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
[in]デバイス コンテキストへのポインター。

*ボタン*<br/>
[in]描画するボタンへのポインター。

*pイメージズ*<br/>
[in]ツール バー イメージへのポインター。

*b強調表示*<br/>
[in]ボタンが強調表示されている場合は TRUE。それ以外の場合は FALSE。

*イメージを描画します。*<br/>
[in]無効にされたボタンが淡色表示されている場合は TRUE。それ以外の場合は FALSE。

### <a name="return-value"></a>戻り値

ボタンが再描画された場合は TRUE。FALSE ボタンが非表示の場合。

### <a name="remarks"></a>解説

[CMFCToolBar::DrawButton](#drawbutton)メソッドは、ツール バー ボタンを再描画する必要があるときに、このメソッドを呼び出します。

ツール バーのボタンの外観をカスタマイズする場合は、このメソッドをオーバーライドします。

## <a name="cmfctoolbardrawseparator"></a><a name="drawseparator"></a>:Dローセパレータ

ツール バーの区切り記号を再描画します。

```
virtual void DrawSeparator(
    CDC* pDC,
    const CRect& rect,
    BOOL bHorz);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
[in]デバイス コンテキストへのポインター。

*Rect*<br/>
[in]区切り記号が描画される位置の外接する四角形 (ピクセル単位)。

*bHorz*<br/>
[in]区切り記号が水平の場合は TRUE、区切り記号が垂直の場合は FALSE。

### <a name="remarks"></a>解説

[CMFCToolBar::DoPaint](#dopaint)は、これらのボタンの[CMFCToolBar::DrawButton](#drawseparator)を呼び出す代わりに、TBBS_SEPARATOR スタイルを持つ各[CMFCToolBar::DrawSeparator](#drawbutton)オブジェクトに対してこのメソッドを呼び出します。

[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)から派生したクラスでこのメソッドをオーバーライドして、ツール バーの区切り記号の外観をカスタマイズします。 既定の実装は、現在のビジュアル マネージャーによって外観が決定される区切り記号を描画するために[CMFCVisualManager::OnDrawSeparator](../../mfc/reference/cmfcvisualmanager-class.md#ondrawseparator)を呼び出します。

## <a name="cmfctoolbarenablecustomizebutton"></a><a name="enablecustomizebutton"></a>ボタンを有効にします。

ツール バーに表示される [カスタマイズ] ボタンを有効または無効にします。

```cpp
void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    const CString& strCustomizeText,
    BOOL bQuickCustomize=TRUE);

void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    UINT uiCustomizeTextResId,
    BOOL bQuickCustomize=TRUE);
```

### <a name="parameters"></a>パラメーター

*b 有効にする*<br/>
[in][カスタマイズ] ボタンを有効または無効にします。

*をカスタマイズします。*<br/>
[in][カスタマイズ] ボタンのコマンド ID。

*テキストをカスタマイズします。*<br/>
[in][カスタマイズ] ボタンのテキスト ラベル。

*テキストを取得します。*<br/>
[in][カスタマイズ] ボタン ラベルのリソース文字列 ID。

*カスタマイズを迅速に実行する*<br/>
[in]ボタンからドロップダウンするメニューの **[ボタンの追加と削除**] オプションを有効または無効にします。

### <a name="remarks"></a>解説

*iCustomizeCmd*が -1 の場合、複数のツール バー ボタンがツール バー領域に収まらない場合に、フレームワークに [カスタマイズ] ボタンが表示されます。 ボタンには、左向きの二重矢印またはシェブロンが表示され、ボタンが他に表示されます。

*iCustomizeCmd*が有効なコマンド ID を指定し *、bEnable*が TRUE の場合は、常に [カスタマイズ] ボタンが表示されます。 ボタンには小さな下向き矢印が付いており、コマンドを含むメニューが開きます。 このコマンドは、 *strCustomizeText*で指定されたテキスト ラベルを使用します。 *bQuickCustomize*も TRUE の場合は、メニューに **[ボタンの追加と削除]** オプションが表示されます。

フレームワークは *、iCustomizeCmd*で指定された項目の前に、ツール バー領域に収まらないボタンをメニューに動的に追加します。 下矢印の横にシェブロンが表示されます。

## <a name="cmfctoolbarenabledocking"></a><a name="enabledocking"></a>CMFCツールバー::ドッキングを有効にする

ペインをメイン フレームにドッキングできるようにします。

```
virtual void EnableDocking(DWORD dwAlignment);
```

### <a name="parameters"></a>パラメーター

*dw配置*<br/>
[in]有効にするドッキングの配置を指定します。

### <a name="remarks"></a>解説

このメソッドは、基本クラスの実装[CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)を拡張`CBasePane::m_dwControlBarStyle`するために、データ メンバーをAFX_CBRS_FLOATに設定します。 このメソッドは、基底クラスの実装に*dwAlignment*を渡します。

## <a name="cmfctoolbarenablelargeicons"></a><a name="enablelargeicons"></a>アイコンアイコンを有効にします。

ツール バー ボタンの大きいアイコンを有効または無効にします。

```cpp
void EnableLargeIcons(BOOL bEnable);
```

### <a name="parameters"></a>パラメーター

*b 有効にする*<br/>
[in]大きいアイコンを有効にする場合は TRUE、大きいアイコンを無効にする場合は FALSE。

### <a name="remarks"></a>解説

既定では、大きいアイコンが有効になっています。

## <a name="cmfctoolbarenablequickcustomization"></a><a name="enablequickcustomization"></a>CMFCツールバー::クイックカスタマイズを有効にする

ユーザーが**Alt**キーを押してボタンを新しい場所にドラッグできるように、ツール バーのクイック カスタマイズを有効または無効にします。

```
static void EnableQuickCustomization(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>パラメーター

*b 有効にする*<br/>
[in]クイック カスタマイズを有効にする場合は TRUE、クイック カスタマイズを無効にする場合は FALSE。

## <a name="cmfctoolbarenablereflections"></a><a name="enablereflections"></a>反射を有効にします。

コマンド リフレクションを有効または無効にします。

```cpp
void EnableReflections(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>パラメーター

*b 有効にする*<br/>
[in]コマンドリフレクションを有効にする場合は TRUE。FALSE を指定すると、コマンドリフレクションが無効になります。

### <a name="remarks"></a>解説

コンボ ボックスなどの埋め込みコントロールを含むツール バー ボタンのコマンド リフレクションを有効にします。

コマンド リフレクションの詳細については、「 [TN062: Windows コントロールのメッセージ リフレクション](../../mfc/tn062-message-reflection-for-windows-controls.md)」を参照してください。

## <a name="cmfctoolbarenabletextlabels"></a><a name="enabletextlabels"></a>CMFCツールバー::テキストラベルを有効にする

ツール バー ボタン イメージの下のテキスト ラベルを有効または無効にします。

```cpp
void EnableTextLabels(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>パラメーター

*b 有効にする*<br/>
テキスト ラベルがツール バー ボタン イメージの下に表示される場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

テキスト ラベルが有効になっている場合、ツールバーのすべてのボタンが拡大され、イメージの下にラベルを表示するスペースが確保されます。 カスタマイズ ダイアログ ボックスには、[ツールバー] ページの [**テキスト ラベルの表示**] チェック ボックス**があります**。 ユーザーがツール バーを選択してこのオプションをチェックすると、フレームワーク`EnableTextLabels`は選択したツールバーを呼び出します。 [CMFC ツールバー](../../mfc/reference/cmfctoolbar-class.md)から派生したオブジェクトのチェック ボックスを無効にするには[、CMFC ツールバー](#allowchangetextlabels)から FALSE を返します。

## <a name="cmfctoolbarfromhandlepermanent"></a><a name="fromhandlepermanent"></a>CMFCツールバー::ハンドルパーマネント

指定したウィンドウ ハンドルを`CMFCToolBar`含むオブジェクトへのポインターを取得します。

```
static CMFCToolBar* __stdcall FromHandlePermanent(HWND hwnd);
```

### <a name="parameters"></a>パラメーター

*Hwnd*<br/>
[in]検索するウィンドウ ハンドル。

### <a name="return-value"></a>戻り値

指定されたウィンドウ`CMFCToolBar`ハンドルを含む`CMFCToolBar`オブジェクトへのポインター。

### <a name="remarks"></a>解説

この共有メソッドは、指定されたウィンドウ ハンドルを含`CMFCToolBar`むオブジェクトについて、アプリケーションの各ツール バーを調べます。

## <a name="cmfctoolbargetallbuttons"></a><a name="getallbuttons"></a>ボタンをクリックします。

ツール バーのボタンの読み取り専用のリストを返します。

```
const CObList& GetAllButtons() const;
```

### <a name="return-value"></a>戻り値

[CMFCツールバーボタン](../../mfc/reference/cmfctoolbarbutton-class.md)クラスのコレクションを含む[CObListクラス](../../mfc/reference/coblist-class.md)オブジェクトへの定数参照。

## <a name="cmfctoolbargetalltoolbars"></a><a name="getalltoolbars"></a>ツールバー::すべてのツール バー

アプリケーション内のすべてのツールバーの読み取り専用リストを返します。

```
static const CObList& GetAllToolbars();
```

### <a name="return-value"></a>戻り値

オブジェクトのコレクションを含む[CObList クラス](../../mfc/reference/coblist-class.md)オブジェクトへの const 参照。 `CMFCToolBar`

## <a name="cmfctoolbargetbasiccommands"></a><a name="getbasiccommands"></a>コマンドバー::コマンドを取得します。

アプリケーションで定義された基本コマンドの読み取り専用リストを返します。

```
static const CList<UINT,UINT>& GetBasicCommands();
```

### <a name="return-value"></a>戻り値

基本コマンドのコレクションを含む[CList クラス](../../mfc/reference/clist-class.md)オブジェクトへの const 参照。

### <a name="remarks"></a>解説

呼び出すことによって基本的なコマンド[を追加します。](#addbasiccommand) [CMFCToolBar::SetBasicCommands](#setbasiccommands)

## <a name="cmfctoolbargetbutton"></a><a name="getbutton"></a>コントロール バー::取得ボタン

指定したインデックス位置にある[CMFCToolBarButton クラス](../../mfc/reference/cmfctoolbarbutton-class.md)オブジェクトへのポインターを返します。

```
CMFCToolBarButton* GetButton(int iIndex) const;
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
[in]返すボタンのインデックスを指定します。

### <a name="return-value"></a>戻り値

ツール バー ボタンが存在する場合は、そのボタンへのポインター。または、そのようなボタンがない場合は NULL。

## <a name="cmfctoolbargetbuttoninfo"></a><a name="getbuttoninfo"></a>コントロール バー::取得ボタン情報

指定したインデックス位置にあるボタンのコマンド ID、スタイル、およびイメージ インデックスを返します。

```cpp
void GetButtonInfo(
    int nIndex,
    UINT& nID,
    UINT& nStyle,
    int& iImage) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
[in]ツール バーのボタンのリスト内のボタンのインデックスを指定します。

*nID*<br/>
[アウト]ボタンのコマンド ID。

*nStyle*<br/>
[アウト]ボタンのスタイル。

*iイメージ*<br/>
[アウト]ボタンのイメージのインデックス。

### <a name="remarks"></a>解説

この`GetButtonInfo`メソッドは、指定されたインデックス位置にあるツール バー ボタンを検索し、ボタンのコマンド ID、スタイル、およびイメージインデックスを取得します。

指定されたインデックスのボタンが存在しない場合、フレームワークは*nID*と*nStyle*を 0 に設定し、メソッドが戻るときに*iImage*を -1 に設定します。

## <a name="cmfctoolbargetbuttonsize"></a><a name="getbuttonsize"></a>コントロール バー::ボタンのサイズ

ツール バーの各ボタンのサイズを返します。

```
CSize GetButtonSize() const;
```

### <a name="return-value"></a>戻り値

ツール バーの各ボタンのサイズを指定する[CSize Class](../../atl-mfc-shared/reference/csize-class.md)オブジェクト。

### <a name="remarks"></a>解説

呼び出し[CMFCツールバー::セットサイズ](#setsizes)または[CMFCツールバー::SetLockedSizes](#setlockedsizes)を呼び出して、ツール バーの各ボタンのサイズを設定します。

## <a name="cmfctoolbargetbuttonstyle"></a><a name="getbuttonstyle"></a>コントロール バー::ボタンスタイル

指定したインデックス位置にあるツール バー ボタンの現在のスタイルを返します。

```
UINT GetButtonStyle(int nIndex) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
[in]ツール バー ボタンのインデックスを指定します。

### <a name="return-value"></a>戻り値

ツール バー ボタンのスタイルを指定する値。 . 使用可能なスタイルの一覧については、「[ツール バー コントロール](../../mfc/reference/toolbar-control-styles.md)スタイル」を参照してください。

### <a name="remarks"></a>解説

ツール バー ボタンのスタイルを設定する[CMFC ツール バー](#setbuttonstyle)を呼び出します。

## <a name="cmfctoolbargetbuttontext"></a><a name="getbuttontext"></a>コントロール バー::ボタンテキスト

指定したインデックスを持つボタンのテキスト ラベルを返します。

```
CString GetButtonText(int nIndex) const;

void GetButtonText(
    int nIndex,
    CString& rString) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
[in]ツール バー ボタンのインデックス。

*文字列*<br/>
[アウト]ツール バー ボタンのラベル テキスト。

### <a name="return-value"></a>戻り値

ツール バー ボタンのラベル テキスト。

### <a name="remarks"></a>解説

テキスト ラベル[を設定するには、CMFC](#setbuttontext)ツールバー[CMFCToolBar::SetToolBarBtnText](#settoolbarbtntext)を呼び出します。

## <a name="cmfctoolbargetcoldimages"></a><a name="getcoldimages"></a>CMFCツールバー::ゲットコールドイメージ

アプリケーション内のコールド ツール バー ボタン イメージのコレクションへのポインターを返します。

```
static CMFCToolBarImages* GetColdImages();
```

### <a name="return-value"></a>戻り値

コールド ツール バー ボタン イメージのコレクションへのポインター。

### <a name="remarks"></a>解説

コールド イメージは、ユーザーがツール バー ボタンを操作していないときに使用されるイメージです。 コールド イメージ[を読み込むために](#loadbitmapex)[、CMFC ツール バーを](#loadbitmap)呼び出します。

## <a name="cmfctoolbargetcolumnwidth"></a><a name="getcolumnwidth"></a>コントロール バー::列幅を取得します。

ツール バー ボタンの幅を返します。

```
virtual int GetColumnWidth() const;
```

### <a name="return-value"></a>戻り値

ツール バー ボタンの幅を指定する値。

### <a name="remarks"></a>解説

フレームワークは、ツール バー レイアウトを計算するためにこのメソッドを呼び出します。 ツール バーに異なる列幅を指定するには、派生クラスでこのメソッドをオーバーライドします。

## <a name="cmfctoolbargetcommandbuttons"></a><a name="getcommandbuttons"></a>コマンド ボタンを取得します。

アプリケーションのすべてのツール バーから、指定したコマンド ID を持つボタンの一覧を返します。

```
static int GetCommandButtons(
    UINT uiCmd,
    CObList& listButtons);
```

### <a name="parameters"></a>パラメーター

*Uicmd*<br/>
[in]ボタンのコマンド ID。

*リストボタン*<br/>
[アウト]ツール バー ボタンのリストを受け取る[CObList クラス](../../mfc/reference/coblist-class.md)オブジェクトへの参照。

### <a name="return-value"></a>戻り値

指定したコマンド ID を持つボタンの数。

## <a name="cmfctoolbargetcount"></a><a name="getcount"></a>コントロール バー::取得カウント

ツール バーのボタンと区切り記号の数を返します。

```
int GetCount() const;
```

### <a name="return-value"></a>戻り値

ツール バーのボタンと区切り記号の数。

## <a name="cmfctoolbargetcustomizebutton"></a><a name="getcustomizebutton"></a>ボタンをクリックします。

ツール バーに関連付`CMFCCustomizeButton`けられているオブジェクトへのポインターを取得します。

```
CMFCCustomizeButton* GetCustomizeButton();
```

### <a name="return-value"></a>戻り値

ツール バーに`CMFCCustomizeButton`関連付けられているオブジェクトへのポインター。

### <a name="remarks"></a>解説

このメソッドは、ツール バーの最後に表示される **[カスタマイズ**] ボタンを取得します。 [**カスタマイズ**] ボタンをツール バーに追加するには[、CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton)メソッドを使用します。

[CMFCツールバー::IsExistCustomizeButton](#isexistcustomizebutton)メソッドを呼び出して、ツール バーに有効な`CMFCCustomizeButton`オブジェクトが含まれているかどうかを確認できます。

## <a name="cmfctoolbargetdefaultimage"></a><a name="getdefaultimage"></a>コントロール バー::既定のイメージを取得します。

指定したコマンド ID を持つツール バー ボタンの既定のイメージのインデックスを返します。

```
static int GetDefaultImage(UINT uiID);
```

### <a name="parameters"></a>パラメーター

*Uiid*<br/>
[in]ボタンのコマンド ID を指定します。

### <a name="return-value"></a>戻り値

共有イメージ リスト内のツール バー イメージのインデックス。

### <a name="remarks"></a>解説

この共有メソッドを使用して、指定したコマンド ID を持つツール バー ボタンの既定のイメージのインデックスを取得します。 戻り値は、アプリケーション内のすべてのツール バーのツール バー ボタン イメージの共有コレクションへのインデックスです。 このコレクション[へのポインター](#getimages)を取得するには、メソッドを呼び出します。

## <a name="cmfctoolbargetdisabledimages"></a><a name="getdisabledimages"></a>コントロール バー::無効なイメージ

アプリケーションで無効になっているツール バー ボタンに使用されるイメージのコレクションへのポインターを返します。

```
static CMFCToolBarImages* __stdcall GetDisabledImages();
```

### <a name="return-value"></a>戻り値

無効なツール バー ボタン イメージのコレクションへのポインター。

### <a name="remarks"></a>解説

無効なツール バー ボタン イメージを読み込むには、[クラス](../../mfc/reference/cmfctoolbareditboxbutton-class.md)と[CMFC ツール バー::読み込みビットマップ](#loadbitmap)メソッドを使用します。

## <a name="cmfctoolbargetdisabledmenuimages"></a><a name="getdisabledmenuimages"></a>メニューバー::メニュー

アプリケーションで無効なメニュー ボタンに使用されるイメージのコレクションへのポインターを返します。

```
static CMFCToolBarImages* __stdcall GetDisabledMenuImages();
```

### <a name="return-value"></a>戻り値

無効なメニュー イメージのコレクションへのポインター。

### <a name="remarks"></a>解説

無効なイメージを読み込むには、[クラス](../../mfc/reference/cmfctoolbareditboxbutton-class.md)メソッドを使用します。

## <a name="cmfctoolbargetdroppeddownmenu"></a><a name="getdroppeddownmenu"></a>メニューメニュー

現在サブメニューを表示しているメニュー ボタン オブジェクトへのポインターを取得します。

```
CMFCToolBarMenuButton* GetDroppedDownMenu(int* pIndex = NULL) const;
```

### <a name="parameters"></a>パラメーター

*インデックス*<br/>
[アウト]ツール バー ボタンのコレクション内のボタンのインデックスを受け取ります。

### <a name="return-value"></a>戻り値

サブメニューを表示しているメニュー ボタン オブジェクトへのポインター。

### <a name="remarks"></a>解説

このメソッドが NULL 以外の値を返し *、pIndex*が NULL でない場合 *、pIndex*が指す値は、ツール バー ボタンのコレクション内のメニュー ボタンのインデックスに設定されます。

## <a name="cmfctoolbargetgraydisabledbuttons"></a><a name="getgraydisabledbuttons"></a>ボタンを押します。

無効なボタンのイメージが通常のボタン イメージの淡色表示バージョンであるか、無効なボタン イメージのコレクションから取得されるかを指定します。

```
BOOL GetGrayDisabledButtons() const;
```

### <a name="return-value"></a>戻り値

無効なボタンのイメージを暗くする場合は TRUE。無効なイメージのコレクションからイメージを取得するには、FALSE を指定します。

### <a name="remarks"></a>解説

[CMFCツールバーを使用::SetGrayDisabledButtons](#setgraydisabledbuttons)は、無効な画像のコレクションから淡色表示された画像と画像を切り替えます。

## <a name="cmfctoolbargethighlightedbutton"></a><a name="gethighlightedbutton"></a>ボタンをクリックします。

現在強調表示されているツール バー ボタンへのポインターを返します。

```
CMFCToolBarButton* GetHighlightedButton() const;
```

### <a name="return-value"></a>戻り値

ツール バー ボタン オブジェクトへのポインター。ボタンが強調表示されていない場合は NULL。

### <a name="remarks"></a>解説

キーボード フォーカスがある場合、ツール バー ボタンが強調表示されます。 ツール バー ボタンがこのアプリケーションでホット トラッキングされている場合も強調表示されます (詳細については[、「CMFCToolBar::GetHotBorder](#gethotborder)と[CMFCToolBar::SetHotBorder」](#sethotborder)を参照してください)。

## <a name="cmfctoolbargethotborder"></a><a name="gethotborder"></a>CMFCツールバー::ゲットホットボーダー

ツール バー ボタンを*ホット トラッキング*するかどうかを指定します。 ホット トラッキングされたボタンは、マウスが上を移動したときに強調表示されます。

```
BOOL GetHotBorder() const;
```

### <a name="return-value"></a>戻り値

ツール バー ボタンがホット トラッキングされている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

既定では、ツール バー ボタンはホット トラッキングされます。

## <a name="cmfctoolbargethottextcolor"></a><a name="gethottextcolor"></a>コントロール バー::テキストの色を取得します。

強調表示されたツール バー ボタンのテキストの色を返します。

```
static COLORREF GetHotTextColor();
```

### <a name="return-value"></a>戻り値

現在の強調表示されたテキストの色を表す[COLORREF](/windows/win32/gdi/colorref)値。

### <a name="remarks"></a>解説

強調表示されたツール バー ボタンの新しいテキストの色を設定するには[、CMFC ツール バーバー:::SetHotTextColor](#sethottextcolor)を呼び出します。

## <a name="cmfctoolbargethwndlastfocus"></a><a name="gethwndlastfocus"></a>CMFCツールバー::ゲットフウェンドラストフォーカス

ツールバーの直前に入力フォーカスが設定されていたウィンドウへのハンドルを返します。

```
HWND GetHwndLastFocus() const;
```

### <a name="return-value"></a>戻り値

以前は入力フォーカスを持っていた[CMFCBaseToolBar クラス](../../mfc/reference/cmfcbasetoolbar-class.md)から派生していないウィンドウへのハンドル。このようなウィンドウがない場合は NULL。

### <a name="remarks"></a>解説

コントロールは`CMFCToolBar`、入力フォーカスを受け取ると、フォーカスを失ったウィンドウへのハンドルを格納し、後でコントロールを復元できるようにします。

## <a name="cmfctoolbargetignoresettext"></a><a name="getignoresettext"></a>テキストを無視します。

ボタン ラベルを設定する呼び出しを無視するかどうかを指定します。

```
BOOL GetIgnoreSetText() const;
```

### <a name="return-value"></a>戻り値

TRUE ボタン ラベルを設定する呼び出しが無視される場合。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

## <a name="cmfctoolbargetimages"></a><a name="getimages"></a>CMFCツールバー::取得イメージ

アプリケーション内の既定のボタン イメージのコレクションへのポインターを返します。

```
static CMFCToolBarImages* GetImages();
```

### <a name="return-value"></a>戻り値

アプリケーション内のすべてのツール バーの既定のイメージのコレクションを格納する[CMFCToolBarImages クラス](../../mfc/reference/cmfctoolbarimages-class.md)オブジェクトへのポインター。

### <a name="remarks"></a>解説

この共有メソッドは、アプリケーションのすべての既定のツール バー イメージのコレクションにアクセスできます。 コレクションにイメージを追加するには[、CMFC ツール バー::LoadBitmap](#loadbitmap)メソッドを呼び出します。

## <a name="cmfctoolbargetimagesize"></a><a name="getimagesize"></a>コントロール バー::イメージサイズ

ツール バー ボタン イメージの現在のサイズを返します。

```
CSize GetImageSize() const;
```

### <a name="return-value"></a>戻り値

ツール バー ボタン イメージの現在のサイズを表す[CSize Class](../../atl-mfc-shared/reference/csize-class.md)オブジェクト。

## <a name="cmfctoolbargetimagesoffset"></a><a name="getimagesoffset"></a>をクリックします。

ツール バー ボタン イメージのグローバル リスト内のこのツール バーのツール バー ボタン イメージを検索するために使用するインデックス オフセットを返します。

```
int GetImagesOffset() const;
```

### <a name="return-value"></a>戻り値

ツール バー イメージのインデックス オフセット。

### <a name="remarks"></a>解説

すべてのツール バーの既定のイメージは、グローバル[CMFCToolBarImages クラス](../../mfc/reference/cmfctoolbarimages-class.md)リストに格納されます。 ツールバーの各ボタンのイメージは、そのリストに連続して保存されます。 イメージのインデックスを計算するには、ツール バーのボタンのインデックスを、そのツール バー ボタンのイメージ リストの先頭のオフセットに追加します。

[CMFCツールバー::ボタンを](#buttontoindex)呼び出して、ボタンへのポインタを与えられたツール バー ボタンのインデックスを取得します。

ツール バー イメージのコレクションへのポインターを取得するには[、CMFCToolBar::GetImages](#getimages)を呼び出します。

## <a name="cmfctoolbargetinvalidateitemrect"></a><a name="getinvalidateitemrect"></a>コントロール バー::取得イン検証アイテムレクト

指定されたインデックスのボタンに対して再描画する必要があるクライアント領域の領域を取得します。

```
virtual void GetInvalidateItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
[in]クライアント領域を取得するボタンのインデックス。

*Lprect*<br/>
[アウト]クライアント領域の領域を受け取る RECT オブジェクトへのポインター。

### <a name="remarks"></a>解説

*lpRect*パラメーターは NULL であってはなりません。 指定されたインデックスにボタンが存在しない場合 *、lpRect*はゼロに初期化された RECT オブジェクトを受け取ります。

## <a name="cmfctoolbargetitemid"></a><a name="getitemid"></a>をクリックします。

指定したインデックス位置にあるツール バー ボタンのコマンド ID を返します。

```
UINT GetItemID(int nIndex) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
[in]ツール バー ボタンのインデックスを指定します。

### <a name="return-value"></a>戻り値

ツール バー ボタンのコマンド ID。指定されたインデックスを持つボタンが存在しない場合は 0。

## <a name="cmfctoolbargetitemrect"></a><a name="getitemrect"></a>コントロール バー::ゲットアイテムレクト

指定したインデックス位置にあるボタンの外接する四角形を返します。

```
virtual void GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
[in]ツール バー ボタンのインデックスを指定します。

*Lprect*<br/>
[アウト]四角形に`CRect`囲まれたイメージの座標を受け取るオブジェクトへのポインター。

### <a name="remarks"></a>解説

指定`CRect`されたインデックス位置にボタンが存在しない場合 *、lpRect*が指すオブジェクトが 0 に設定されます。

### <a name="example"></a>例

クラスのメソッドの使用方法を`GetItemRect`次の例に示します`CMFCToolBar`。 このコード スニペットは、 [IE デモ のサンプル](../../overview/visual-cpp-samples.md)の一部です。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#9](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_4.cpp)]

## <a name="cmfctoolbargetlargecoldimages"></a><a name="getlargecoldimages"></a>CMFCツールバー::ゲットラージコールドイメージ

アプリケーション内の大きなコールド ツール バー ボタン イメージのコレクションへのポインターを返します。

```
static CMFCToolBarImages* GetLargeColdImages();
```

### <a name="return-value"></a>戻り値

大きいコールド イメージのコレクションへのポインター。

### <a name="remarks"></a>解説

コールド イメージは、ユーザーがツール バー ボタンを操作していないときに使用されるイメージです。 大きなコールド イメージを読み込[むために呼](#loadbitmapex)び出します。

## <a name="cmfctoolbargetlargedisabledimages"></a><a name="getlargedisabledimages"></a>コントロール バー::取得ラージイメージ

アプリケーション内のツール バー ボタン イメージの大きな無効なコレクションへのポインターを返します。

```
static CMFCToolBarImages* GetLargeDisabledImages();
```

### <a name="return-value"></a>戻り値

使用できない大きなツール バー ボタン イメージのコレクションへのポインター。

### <a name="remarks"></a>解説

大きなイメージは、通常のツール バー ボタン イメージの大きなバージョンです。 大きなイメージ[を読み込むために、CMFC ツール](#loadbitmapex)[バーを](#loadbitmap)呼び出します。

## <a name="cmfctoolbargetlargeimages"></a><a name="getlargeimages"></a>コントロール バー::取得ラージイメージズ

アプリケーション内の大きなツール バー ボタン イメージのコレクションへのポインターを返します。

```
static CMFCToolBarImages* GetLargeImages();
```

### <a name="return-value"></a>戻り値

ツール バー のボタンの大きいイメージのコレクションへのポインター。

### <a name="remarks"></a>解説

大きなイメージは、通常のツール バー ボタン イメージの大きなバージョンです。 大きなイメージを読み込[むために呼](#loadbitmapex)び出します。

## <a name="cmfctoolbargetlockedcoldimages"></a><a name="getlockedcoldimages"></a>CMFCツールバー::ゲットロックコールドイメージズ

ツール バーのロックされたコールド イメージのコレクションへのポインターを返します。

```
CMFCToolBarImages* GetLockedColdImages();
```

### <a name="return-value"></a>戻り値

ロックされたコールド イメージのコレクションへのポインター。

### <a name="remarks"></a>解説

ロックされたイメージは、ユーザーがツール バーをカスタマイズできないときにフレームワークが使用する通常のツール バー ボタン イメージのバージョンです。 コールド イメージは、ユーザーがツール バー ボタンを操作していないときに使用されるイメージです。

このメソッドは、ツール バーがロックされていない場合は NULL を返します。 このメソッドは、ツール バーがロックされていない場合に、デバッグ ビルドでアサーション エラーも生成します。 ロックされたツール バーの詳細については[、「CMFC ツール バー::IsLocked](#islocked)」を参照してください。

ロックされたコールド イメージを読み込[むには、CMFC ツール バー::LoadBitmapEx](#loadbitmapex)メソッドを呼び出します。

## <a name="cmfctoolbargetlockeddisabledimages"></a><a name="getlockeddisabledimages"></a>CMFCツールバー::取得ロック無効な画像

ツール バーのロックされた無効なイメージのコレクションへのポインターを返します。

```
CMFCToolBarImages* GetLockedDisabledImages();
```

### <a name="return-value"></a>戻り値

ロックされた無効なイメージのコレクションへのポインター。

### <a name="remarks"></a>解説

ロックされたイメージは、ユーザーがツール バーをカスタマイズできないときにフレームワークが使用する通常のツール バー ボタン イメージのバージョンです。 無効なイメージとは、ボタンにTBBS_DISABLEDスタイルが設定されている場合にフレームワークが使用するイメージです。

このメソッドは、ツール バーがロックされていない場合は NULL を返します。 このメソッドは、ツール バーがロックされていない場合に、デバッグ ビルドでアサーション エラーも生成します。 ロックされたツール バーの詳細については[、「CMFC ツール バー::IsLocked](#islocked)」を参照してください。

ロックされた無効なイメージを読み込むには[、CMFCToolBar::LoadBitmapEx](#loadbitmapex)メソッドを呼び出します。

## <a name="cmfctoolbargetlockedimages"></a><a name="getlockedimages"></a>CMFCツールバー::取得ロックされた画像

ツール バーのロックされたボタン イメージのコレクションへのポインターを返します。

```
CMFCToolBarImages* GetLockedImages();
```

### <a name="return-value"></a>戻り値

ロックされたツール バー ボタン イメージのコレクションへのポインター。

### <a name="remarks"></a>解説

ロックされたイメージは、ユーザーがツール バーをカスタマイズできないときにフレームワークが使用する通常のツール バー ボタン イメージのバージョンです。

このメソッドは、ツール バーがロックされていない場合は NULL を返します。 このメソッドは、ツール バーがロックされていない場合に、デバッグ ビルドでアサーション エラーも生成します。 ロックされたツール バーの詳細については[、「CMFC ツール バー::IsLocked](#islocked)」を参照してください。

## <a name="cmfctoolbargetlockedimagesize"></a><a name="getlockedimagesize"></a>コントロール バー:::取得ロックされたイメージのサイズ

ロックされたツール バー イメージの既定のサイズを返します。

```
CSize GetLockedImageSize() const;
```

### <a name="return-value"></a>戻り値

ロック`CSize`されたツール バー イメージのサイズを指定する構造体`CSize`、またはツール バーがロックされていない場合は空の構造。

### <a name="remarks"></a>解説

ロックされたイメージは、ユーザーがツール バーをカスタマイズできないときにフレームワークが使用する通常のツール バー ボタン イメージのバージョンです。

このメソッドは、`CSize`ツール バーがロックされていない場合、幅が 0、高さがゼロの構造体を返します。 このメソッドは、ツール バーがロックされていない場合に、デバッグ ビルドでアサーション エラーも生成します。 ロックされたツール バーの詳細については[、「CMFC ツール バー::IsLocked](#islocked)」を参照してください。

ロックされたイメージ サイズを指定するには[、CMFC ツール バー::SetLockedSizes](#setlockedsizes)メソッドを呼び出します。

## <a name="cmfctoolbargetlockedmenuimages"></a><a name="getlockedmenuimages"></a>メニューバー::メニューの取得

ツール バーのロックされたツール バー メニュー イメージのコレクションへのポインターを返します。

```
CMFCToolBarImages* GetLockedMenuImages();
```

### <a name="return-value"></a>戻り値

ロックされたツール バー メニュー イメージのコレクションへのポインター。

### <a name="remarks"></a>解説

ロックされたイメージは、ユーザーがツール バーをカスタマイズできないときにフレームワークが使用する通常のツール バー メニュー イメージのバージョンです。

このメソッドは、ツール バーがロックされていない場合は NULL を返します。 このメソッドは、ツール バーがロックされていない場合に、デバッグ ビルドでアサーション エラーも生成します。 ロックされたツール バーの詳細については[、「CMFC ツール バー::IsLocked](#islocked)」を参照してください。

ロックされたメニュー イメージを読み込[むには、CMFC ツール バー::LoadBitmapEx](#loadbitmapex)メソッドを呼び出します。

## <a name="cmfctoolbargetmenubuttonsize"></a><a name="getmenubuttonsize"></a>ボタンのサイズを取得します。

アプリケーションのメニュー ボタンのサイズを返します。

```
static CSize GetMenuButtonSize();
```

### <a name="return-value"></a>戻り値

メニュー`CSize`ボタンのサイズをピクセル単位で表すオブジェクト。

### <a name="remarks"></a>解説

ツール バーのメニュー ボタンのサイズはグローバル変数として保持され、この静的メソッドで取得できます。

呼び出し[CMFC ツールバー::このグローバル変数を設定するのにはサイズを設定します](#setmenusizes)。

## <a name="cmfctoolbargetmenuimages"></a><a name="getmenuimages"></a>メニューバー::メニューのイメージ

アプリケーション内のメニュー ボタン イメージのコレクションへのポインターを返します。

```
static CMFCToolBarImages* GetMenuImages();
```

### <a name="return-value"></a>戻り値

メニュー イメージのコレクションへのポインター。

### <a name="remarks"></a>解説

メニュー イメージを読み込むには[、CMFC ツール バー::LoadBitmapEx](#loadbitmapex)メソッドを呼び出します。

ボタンとそのイメージのサイズを設定するには[、](#setmenusizes)メソッドを呼び出します。

## <a name="cmfctoolbargetmenuimagesize"></a><a name="getmenuimagesize"></a>メニューバー::メニューイメージサイズ

アプリケーション内のメニュー ボタン イメージのサイズを返します。

```
static CSize GetMenuImageSize();
```

### <a name="return-value"></a>戻り値

メニュー`CSize`イメージのサイズを表すオブジェクト。

### <a name="remarks"></a>解説

このメソッドは、グローバル変数として保持されているツール バー メニュー ボタンのイメージのサイズを返します。 呼び出し[CMFC ツールバー::このグローバル変数を設定するのにはサイズを設定します](#setmenusizes)。

## <a name="cmfctoolbargetorigbuttons"></a><a name="getorigbuttons"></a>コントロール バー::ゲット折り付きボタン

ツール バーのカスタマイズされていないボタンのコレクションを取得します。

```
const CObList& GetOrigButtons() const;
```

### <a name="return-value"></a>戻り値

ツール バーのカスタマイズされていないボタンの一覧への参照。

### <a name="remarks"></a>解説

フレームワークは、ユーザーがカスタマイズする前に、ツール バー ボタンのコピーを作成します。 [CMFCツール バー::SetButtons](#setbuttons)メソッドは、指定された配列内の各ボタンのコピーを元のボタンのリストに追加します。 [CMFCツールバー::RestoreOriginalState](#restoreoriginalstate)メソッドは、リソースファイルから読み込むことによって、ツールバーの元の状態を復元します。

ツール バーの元のボタンの一覧を設定するには、[メソッド](#setorigbuttons)を呼び出します。

## <a name="cmfctoolbargetorigresetbuttons"></a><a name="getorigresetbuttons"></a>コントロール バー::取得折り込みボタン

ツール バーのカスタマイズされていないリセット ボタンのコレクションを取得します。

```
const CObList& GetOrigResetButtons() const;
```

### <a name="return-value"></a>戻り値

ツール バーのカスタマイズされていないリセット ボタンの一覧への参照。

### <a name="remarks"></a>解説

ユーザーがカスタマイズ モード中に **[リセット**] ボタンをクリックすると、フレームワークはこのメソッドを使用して、ツール バーから削除されたボタンを復元します。

メソッドは[、CMFCToolBar::OnReset](#onreset)メソッドを呼び出した後、元のリセット ボタンの一覧に各ツール バー ボタンのコピーを追加します。 [CMFCToolBar::SetButtons](#setbuttons) [CMFCToolBar::OnReset](#onreset)メソッドをオーバーライドして、ユーザーが **[リセット**] ボタンを押した後にボタンの外観をカスタマイズできます。

## <a name="cmfctoolbargetresourceid"></a><a name="getresourceid"></a>を使用します。

ツール バーのリソース ID を取得します。

```
UINT GetResourceID() const;
```

### <a name="return-value"></a>戻り値

ツール バーのリソース ID。

### <a name="remarks"></a>解説

ツール バーのリソース ID を設定するには[、CMFC ツール バー::読み込みツールバーレックス](#loadtoolbarex)メソッドを呼び出します。

## <a name="cmfctoolbargetroutecommandsviaframe"></a><a name="getroutecommandsviaframe"></a>を使用します。

親フレームまたはオーナーがツールバーにコマンドを送信するオブジェクトを指定します。

```
BOOL GetRouteCommandsViaFrame();
```

### <a name="return-value"></a>戻り値

親フレームがツール バーにコマンドを送信する場合は 0 以外の値を返します。所有者がツールバーにコマンドを送信する場合は 0。

### <a name="remarks"></a>解説

既定では、親フレームはツールバーにコマンドを送信します。 この動作を変更するには[、CMFC ツール バー::この](#setroutecommandsviaframe)動作を変更します。

このメソッドが 0 以外の値を返す場合は、メソッドを使用して親フレーム`CMFCToolBar::GetCommandTarget`オブジェクトへのポインターを取得できます。 このメソッドを使用する例については、VisualStudioDemo サンプルを参照してください。

## <a name="cmfctoolbargetrowheight"></a><a name="getrowheight"></a>CMFCツールバー::ゲットローハイト

ツール バー ボタンの高さを返します。

```
virtual int GetRowHeight() const;
```

### <a name="return-value"></a>戻り値

ツール バー ボタンの高さ (ピクセル単位)。

### <a name="remarks"></a>解説

フレームワークは、ツール バー レイアウトを計算するためにこのメソッドを呼び出します。 ツール バーに異なる高さを指定するには、派生クラスでこのメソッドをオーバーライドします。

## <a name="cmfctoolbargetshowtooltips"></a><a name="getshowtooltips"></a>ツールバー::ヒントツール

ツール バー ボタンにツール ヒントを表示するかどうかを指定します。

```
static BOOL GetShowTooltips();
```

### <a name="return-value"></a>戻り値

ツール バー ボタンにツール ヒントが表示される場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

デフォルトでは、ツールヒントが表示されます。 この静的フラグを変更するには[、CMFC ツール バー:::設定ツールチップを](#setshowtooltips)呼び出します。

## <a name="cmfctoolbargetsiblingtoolbar"></a><a name="getsiblingtoolbar"></a>CMFCツールバー::ゲット兄弟ツールバー

ツール バーの兄弟を取得します。

```
CMFCToolBar* GetSiblingToolBar();
```

### <a name="return-value"></a>戻り値

兄弟ツール バーへのポインター。

### <a name="remarks"></a>解説

**[1 行にボタンを表示**する] ボタンと **[2 行にボタンを表示する]** ボタンを有効にする方法の詳細については[、「CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)」を参照してください。

## <a name="cmfctoolbargetuserimages"></a><a name="getuserimages"></a>をクリックします。

アプリケーション内のユーザー定義のツール バー ボタン イメージのコレクションへのポインターを返します。

```
static CMFCToolBarImages* GetUserImages();
```

### <a name="return-value"></a>戻り値

アプリケーション内のすべてのツール バーのユーザー定義のツール バー ボタン イメージのコレクションへのポインター。

### <a name="remarks"></a>解説

メソッドを呼び出して[、](#setuserimages)アプリケーション内のユーザー定義イメージのコレクションを設定します。

## <a name="cmfctoolbarhittest"></a><a name="hittest"></a>CMFCツールバー::ヒットテスト

指定した位置にあるツール バー ボタンのインデックスを返します。

```
virtual int HitTest(CPoint point);
```

### <a name="parameters"></a>パラメーター

*ポイント*<br/>
[in]クライアント座標でテストするポイント。

### <a name="return-value"></a>戻り値

指定した位置にあるボタンのインデックス。

## <a name="cmfctoolbarinsertbutton"></a><a name="insertbutton"></a>コントロール バー::挿入ボタン

ツール バーにボタンを挿入します。

```
virtual int InsertButton(
    const CMFCToolBarButton& button,
    INT_PTR iInsertAt=-1);

virtual int InsertButton(
    CMFCToolBarButton* pButton,
    int iInsertAt=-1);
```

### <a name="parameters"></a>パラメーター

*ボタン*<br/>
[in]挿入するボタンを指定します。

*挿入*<br/>
[in]ボタンを挿入する位置を 0 から始まる位置に指定します。

### <a name="return-value"></a>戻り値

ボタンが挿入された位置。

### <a name="remarks"></a>解説

*iInsertAt*が -1 の場合、このメソッドは、ツール バー ボタンのリストの末尾にボタンを追加します。

ツール バーに区切り記号を[挿入](#insertseparator)するには、メソッドを呼び出します。

## <a name="cmfctoolbarinsertseparator"></a><a name="insertseparator"></a>コントロール バー::区切り記号を挿入します。

ツール バーに区切り記号を挿入します。

```
virtual int InsertSeparator(INT_PTR iInsertAt=-1);
```

### <a name="parameters"></a>パラメーター

*挿入*<br/>
[in]区切り記号を挿入する位置を 0 から始まる位置に指定します。 このパラメーターは 0 より大きくなければなりません。

### <a name="return-value"></a>戻り値

区切り記号が挿入された位置。

### <a name="remarks"></a>解説

既存の 2 つのボタンの間に区切り記号を挿入します。 *iInsertAt*が -1 の場合、このメソッドは、ツール バー ボタンのリストの末尾に区切り記号を追加します。

このメソッドを使用して、空のツール バーに区切り記号を追加することはできません。

ツール バーにボタンを[挿入するには、CMFC ツール バー::InsertButton](#insertbutton)メソッドを呼び出します。

## <a name="cmfctoolbarinvalidatebutton"></a><a name="invalidatebutton"></a>コントロール バー::無効化ボタン

指定されたインデックスに存在するツール バー ボタンのクライアント領域を無効にします。

```
CMFCToolBarButton* InvalidateButton(int nIndex);
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
[in]ツール バーのボタンの 0 から始まるインデックス。

### <a name="return-value"></a>戻り値

指定された`CMFCToolBarButton`インデックスに存在するオブジェクトへのポインター。

### <a name="remarks"></a>解説

フレームワークは、ツール バー ボタンに関連付けられているクライアント領域を更新するときに、このメソッドを呼び出します。 [CWnd::InvalidateRect](../../mfc/reference/cwnd-class.md#invalidaterect)メソッドを呼び出し、指定された`CMFCToolBarButton`インデックスに存在するオブジェクトのクライアント四角形を使用します。

## <a name="cmfctoolbarisaddremovequickcustomize"></a><a name="isaddremovequickcustomize"></a>CMFC ツールバー::イアド削除クイックカスタマイズ

ユーザーが [**カスタマイズ]** メニュー オプションを使用してツール バー ボタンを追加または削除できるかどうかを指定します。

```
BOOL IsAddRemoveQuickCustomize();
```

### <a name="return-value"></a>戻り値

ユーザーが [**カスタマイズ]** メニュー オプションを使用してツール バーを変更できる場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

## <a name="cmfctoolbarisaltcustomizemode"></a><a name="isaltcustomizemode"></a>コントロール バー::イシュアル・カスタマイズ・モード

*ボタンの*ドラッグにクイック カスタマイズを使用するかどうかを指定します。 クイック カスタマイズが有効になっている場合、ユーザーは Alt キーを押したままボタンを新しい場所にドラッグできます。

```
static BOOL __stdcall IsAltCustomizeMode();
```

### <a name="return-value"></a>戻り値

クイック カスタマイズを使用してボタンをドラッグする場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

## <a name="cmfctoolbarisautograyinactiveimages"></a><a name="isautograyinactiveimages"></a>CMFCツールバー::イストオートグレイ非アクティブ画像

非アクティブな (強調表示されていない) ボタン イメージの自動生成を有効にするかどうかを指定します。

```
static BOOL IsAutoGrayInactiveImages();
```

### <a name="return-value"></a>戻り値

非アクティブなイメージを自動的に暗くするオプションが有効になっている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

非アクティブなイメージの自動調光を有効または無効にするには[、CMFCToolBar:::AutoGrayInactiveImages](#autograyinactiveimages)を呼び出します。

## <a name="cmfctoolbarisbasiccommand"></a><a name="isbasiccommand"></a>コマンドバー::IsBasicコマンド

コマンドが基本コマンドのリストにあるかどうかを判断します。

```
static BOOL IsBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>パラメーター

*Uicmd*<br/>
[in]確認するコマンドを指定します。

### <a name="return-value"></a>戻り値

指定されたコマンドが基本コマンドの一覧に属する場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

この静的メソッドは *、uiCmd*で指定されたコマンドが基本コマンドのグローバル リストに属しているかどうかを判断します。 基本的なコマンドの一覧を変更するには[、CMFC ツール バー:::コマンドまたは](#addbasiccommand) [CMFC コマンドを呼び出します。](#setbasiccommands)

## <a name="cmfctoolbarisbuttonextrasizeavailable"></a><a name="isbuttonextrasizeavailable"></a>CMFCツールバー::イボタンエクストラサイズ利用可能

ツール バーに、拡張枠線を持つボタンを表示できるかどうかを指定します。

```
virtual BOOL IsButtonExtraSizeAvailable() const;
```

### <a name="return-value"></a>戻り値

バーが余分な境界線サイズのボタンを表示できる場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

ツール バー オブジェクトは、拡張枠線を持つボタンを表示できる場合は TRUE を返します。 ツール バー ボタンは[、CMFCToolBarButton::OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#onchangeparentwnd)通知を処理するときにこのメソッドを呼び出し、それに応じて内部の余分な境界線サイズフラグを設定します。 この内部フラグは、[後で呼](../../mfc/reference/cmfctoolbarbutton-class.md#isextrasize)び出すことによって取得できます。

バーが余分な境界線サイズでツール`CMFCToolBar`バー ボタンを表示でき、それ以外の場合は FALSE を返すことができる場合は、派生したクラスでこのメソッドをオーバーライドし、TRUE を返します。 既定の実装では TRUE が返されます。

## <a name="cmfctoolbarisbuttonhighlighted"></a><a name="isbuttonhighlighted"></a>CMFCツールバー::ボタンが強調表示されました

指定したボタンが強調表示されているかどうかを判断します。

```
BOOL IsButtonHighlighted(int iButton) const;
```

### <a name="parameters"></a>パラメーター

*Ibutton*<br/>
[in]ツール バー ボタンのインデックスを指定します。

### <a name="return-value"></a>戻り値

指定したボタンが強調表示されている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

## <a name="cmfctoolbariscommandpermitted"></a><a name="iscommandpermitted"></a>CMFC ツールバー::IsCommand が許可されました。

コマンドを許可するかどうかを決定します。

```
static BOOL IsCommandPermitted(UINT uiCmd);
```

### <a name="parameters"></a>パラメーター

*Uicmd*<br/>
[in]確認するコマンドを指定します。

### <a name="return-value"></a>戻り値

指定されたコマンドが許可されている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

この静的メソッドは *、uiCmd*で指定されたコマンドが許可されていないコマンドのグローバル リストに属しているかどうかを判断します。

許可されていないコマンドのリストを変更するには[、CMFC ツールバー:::SetNon許可コマンドを呼び出します](#setnonpermittedcommands)。

## <a name="cmfctoolbariscommandrarelyused"></a><a name="iscommandrarelyused"></a>CMFCツールバー::Isコマンドめったに使用されません

コマンドがほとんど使用されないかどうかを判断します。

```
static BOOL IsCommandRarelyUsed(UINT uiCmd);
```

### <a name="parameters"></a>パラメーター

*Uicmd*<br/>
[in]確認するコマンドを指定します。

### <a name="return-value"></a>戻り値

指定したコマンドがほとんど使用されない場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

この`IsCommandRarelyUsed`メソッドは、次の条件の 1 つ以上が発生した場合に FALSE を返します。

- 指定されたコマンドは、基本コマンドのリストに属します。

- 指定されたコマンドは標準コマンドの 1 つです。

- フレームワークはカスタマイズ モードです

- 基本コマンドのリストが空です

- コマンド呼び出しの 20% 以上が、指定されたコマンドの呼び出しです。

## <a name="cmfctoolbariscustomizemode"></a><a name="iscustomizemode"></a>コントロール バー::イスカスタマイモード

ツール バー フレームワークがカスタマイズ モードかどうかを指定します。

```
static BOOL IsCustomizeMode();
```

### <a name="return-value"></a>戻り値

フレームワークがカスタマイズ モードの場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

カスタマイズ モードを切り替えるには[、CMFC ツール バー::セットカスタマイズ モード](#setcustomizemode)を呼び出します。

ユーザーがカスタマイズ ダイアログ ボックス[(CMFCToolBarsCustomizeDialog クラス](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)) を呼び出すと、フレームワークによってモードが変更されます。

## <a name="cmfctoolbarisdragbutton"></a><a name="isdragbutton"></a>コントロール バー::イズドラッグボタン

ツール バー ボタンをドラッグするかどうかを指定します。

```
BOOL IsDragButton(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>パラメーター

*ボタン*<br/>
[in]ツール バー ボタンへのポインター。

### <a name="return-value"></a>戻り値

指定したボタンがドラッグされている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

## <a name="cmfctoolbarisexistcustomizebutton"></a><a name="isexistcustomizebutton"></a>ボタンを使用します。

ツールバーに **[カスタマイズ**] ボタンが含まれているかどうかを判断します。

```
BOOL IsExistCustomizeButton();
```

### <a name="return-value"></a>戻り値

ツール バーに **[カスタマイズ**] ボタンが含まれている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドが TRUE を返す場合[、CMFCToolBar::GetCustomizeButton](#getcustomizebutton)メソッドは、ツール バーの最後に表示される **[カスタマイズ**] ボタンへのポインターを返します。

[**カスタマイズ**] ボタンをツール バーに追加するには[、CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton)メソッドを使用します。

## <a name="cmfctoolbarisfloating"></a><a name="isfloating"></a>CMFCツールバー::イズフローティング

ツール バーがフローティング状態かどうかを判断します。

```
virtual BOOL IsFloating() const;
```

### <a name="return-value"></a>戻り値

ツール バーが浮動状態の場合は TRUE。それ以外の場合は FALSE。

## <a name="cmfctoolbarislargeicons"></a><a name="islargeicons"></a>CMFCツールバー::IsLargeアイコン

アプリケーションのツールバーに現在大きいアイコンを表示するかどうかを指定します。

```
static BOOL IsLargeIcons();
```

### <a name="return-value"></a>戻り値

アプリケーションが大きいアイコンを使用している場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

大きいアイコンと通常のアイコンを切り替えるには[、CMFCツールバー::SetLargeIcons](#setlargeicons)を呼び出します。

ユーザーが **[カスタマイズ]** ダイアログ ボックスの **[オプション]** ページで [**大きいアイコン**] チェック ボックスをオンにすると、フレームワークによってモードが自動的に変更されます。

## <a name="cmfctoolbarislastcommandfrombutton"></a><a name="islastcommandfrombutton"></a>ボタンからボタンをクリックします。

最後に実行されたコマンドが、指定したツール バー ボタンから送信されたかどうかを判断します。

```
static BOOL IsLastCommandFromButton(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>パラメーター

*ボタン*<br/>
[in]ボタンへのポインター。

### <a name="return-value"></a>戻り値

最後のコマンドが*pButton*が指定したボタンから送信された場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、 を呼び[MSG Structure](/windows/win32/api/winuser/ns-winuser-msg)出`CWnd::GetCurrentMessage`すことによって MSG 構造体へのポインタを取得します。 次に、ボタンの HWND と`MSG::lParam`および`MSG::hwnd`メンバーを比較して、ボタンがコマンドのソースであったかどうかを判断します。

## <a name="cmfctoolbarislocked"></a><a name="islocked"></a>CMFCツールバー::イズロック

ツール バーがロックされているかどうかを判断します。

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>戻り値

ツール バーがロックされている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、ユーザーがツール バー ボタンの位置変更などのカスタマイズタスクを実行できない場合に TRUE を返します。

ロックされたツールバーは、個別のイメージリストを使用します。 これらのイメージ リストの詳細については[、「CMFC ツール バー::ロードビットマップ」](#loadbitmapex)を参照してください。

## <a name="cmfctoolbarisonerowwithsibling"></a><a name="isonerowwithsibling"></a>兄弟と一緒に

ツールバーとその兄弟ツール バーを同じ行に配置するかどうかを指定します。

```
BOOL IsOneRowWithSibling();
```

### <a name="return-value"></a>戻り値

ツール バーとその兄弟が同じ行に配置されている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

メソッドは[、](internal-classes.md)このメソッドを呼び出して、ポップアップ メニューの**表示**方法を決定します。 このメソッドが TRUE を返す場合、フレームワークは[ボタンを**1 行に表示**] ボタンを表示します。 それ以外の場合、フレームワークは [ボタンを**2 行に表示**] ボタンを表示します。

通常、このメソッドを使用する必要はありません。 **[1 行にボタンを表示**する] ボタンまたは **[2 行にボタンを表示**] ボタンを有効にするには[、CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)を呼び出します。

## <a name="cmfctoolbarisresourcechanged"></a><a name="isresourcechanged"></a>変更されたリソース

```
virtual BOOL IsResourceChanged() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarissibling"></a><a name="issibling"></a>CMFCツールバー::イズ兄弟

```
BOOL IsSibling();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarisuserdefined"></a><a name="isuserdefined"></a>コントロール バー::ユーザー定義

ツール バーがユーザー定義であるかどうかを指定します。

```
BOOL IsUserDefined() const;
```

### <a name="return-value"></a>戻り値

ツール バーがユーザーによって作成された場合は TRUE。それ以外の場合は FALSE。

## <a name="cmfctoolbarloadbitmap"></a><a name="loadbitmap"></a>を使用します。

アプリケーション リソースからツール バー イメージを読み込みます。

```
virtual BOOL LoadBitmap(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>パラメーター

*UIResID*<br/>
[in]ホット ツール バー イメージを参照するビットマップのリソース ID。

*をクリックします。*<br/>
[in]コールド ツール バー イメージを参照するビットマップのリソース ID。

*をクリックします。*<br/>
[in]通常のメニュー イメージを参照するビットマップのリソース ID。

*ブロック*<br/>
[in]ツール バーをロックする場合は TRUE。それ以外の場合は FALSE。

*を無効にします。*<br/>
[in]無効なツール バー イメージを参照するビットマップのリソース ID。

*を無効にします。*<br/>
[in]無効なメニュー イメージを参照するビットマップのリソース ID。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

[CMFCToolBar::LoadToolBarEx](#loadtoolbarex) メソッドはこのメソッドを呼び出して、ツール バーに関連付けられたイメージを読み込みます。 このメソッドをオーバーライドして、イメージ リソースのカスタムの読み込みを実行します。

ツール バーの作成後に、 `LoadBitmapEx` メソッドを呼び出して追加のイメージを読み込みます。

## <a name="cmfctoolbarloadbitmapex"></a><a name="loadbitmapex"></a>を使用します。

```
virtual BOOL LoadBitmapEx(
    CMFCToolBarInfo& params,
    BOOL bLocked = FALSE);
```

### <a name="parameters"></a>パラメーター

[in]*パラム*<br/>
[in]*ブロック*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarloadlargeiconsstate"></a><a name="loadlargeiconsstate"></a>コントロール バー::ロードラージアイコン状態

```
static BOOL __stdcall LoadLargeIconsState(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>パラメーター

[in]*名前を指定します。*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarloadparameters"></a><a name="loadparameters"></a>パラメーターの読み込み

Windows レジストリからグローバル ツール バー オプションを読み込みます。

```
static BOOL LoadParameters(LPCTSTR lpszProfileName=NULL);
```

### <a name="parameters"></a>パラメーター

*名前を指定します。*<br/>
[in]Windows レジストリ キーの相対パスを指定します。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

このメソッドは、メニュー アニメーションの種類、メニューのシャドウ スタイル、Windows レジストリから大きいアイコンを表示するかどうかなどのグローバル パラメータを読み込みます。

[CWinAppEx::LoadState](../../mfc/reference/cwinappex-class.md#loadstate)メソッドは、アプリケーションの初期化プロセスの一部としてこのメソッドを呼び出します。

## <a name="cmfctoolbarloadstate"></a><a name="loadstate"></a>コントロール バー::ロードステート

Windows レジストリからツール バーの状態情報を読み込みます。

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>パラメーター

*名前を指定します。*<br/>
[in]Windows レジストリ キーの相対パスを指定します。

*nIndex*<br/>
[in]ツール バーのコントロール ID を指定します。

*Uiid*<br/>
[in]ツール バーのリソース ID を指定します。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

フレームワークは、アプリケーションの初期化プロセスの一部としてこのメソッドを呼び出します。 詳細については[、「CWinAppEx::ロードステート](../../mfc/reference/cwinappex-class.md#loadstate)」を参照してください。

## <a name="cmfctoolbarloadtoolbar"></a><a name="loadtoolbar"></a>コントロール バーの使用

アプリケーション リソースからツール バーを読み込みます。

```
virtual BOOL LoadToolBar(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0,
    UINT uiHotResID=0);
```

### <a name="parameters"></a>パラメーター

*UIResID*<br/>
[in]ツール バーのリソース ID。

*をクリックします。*<br/>
[in]コールド ツール バー イメージを参照するビットマップのリソース ID。

*をクリックします。*<br/>
[in]通常のメニュー イメージを参照するビットマップのリソース ID。

*ブロック*<br/>
[in]ツール バーがロックされているかどうかを指定するブール値。 このパラメーターが*TRUE*の場合、ツール バーはロックされています。 それ以外の場合、ツールバーはロックされません。

*を無効にします。*<br/>
[in]無効なツール バー イメージを参照するビットマップのリソース ID。

*を無効にします。*<br/>
[in]無効なメニュー イメージを参照するビットマップのリソース ID。

*をクリックします。*<br/>
[in]ホット ツール バー イメージを参照するビットマップのリソース ID。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

フレームワークは、初期化中にこのメソッドを呼び出して、ツール バーに関連付けられているイメージを読み込みます。

### <a name="example"></a>例

クラスでメソッドを使用する方法を`LoadToolBar`次の例に`CMFCToolBar`示します。 このコード スニペットは、 [IE デモ のサンプル](../../overview/visual-cpp-samples.md)の一部です。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

## <a name="cmfctoolbarloadtoolbarex"></a><a name="loadtoolbarex"></a>CMFCツールバー::ロードツールバレックス

ヘルパー クラスを使用してアプリケーション リソース`CMFCToolBarInfo`からツール バーを読み込み、アプリケーションが大きなイメージを使用できるようにします。

```
virtual BOOL LoadToolBarEx(
    UINT uiToolbarResID,
    CMFCToolBarInfo& params,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>パラメーター

*インターフェイスの一次 ID*<br/>
[in]ツール バーのリソース ID。

*params*<br/>
[in]ツール バー`CMFCToolBarInfo`イメージのリソース ID を含むオブジェクトへの参照。

*ブロック*<br/>
[in]ツール バーがロックされているかどうかを指定するブール値。 このパラメーターが TRUE の場合、ツール バーはロックされています。 それ以外の場合、ツールバーはロックされません。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

アプリケーション リソースからツール バー イメージを読み込みます。

## <a name="cmfctoolbarm_dbllargeimageratio"></a><a name="m_dbllargeimageratio"></a>コントロール バー::m_dblLargeImageRatio

大きいイメージの寸法(高さまたは幅)と通常の画像の寸法の比率を指定します。

```
AFX_IMPORT_DATA static double m_dblLargeImageRatio;
```

### <a name="remarks"></a>解説

デフォルトの比率は 2 です。 この値を変更して、大きなツール バー イメージを大きくしたり小さくしたりできます。

大きなイメージのセットを指定しない場合、フレームワークはこのデータ メンバーを使用します。 たとえば、サイズが 16 x 16 の小さいイメージのセットのみを提供し、大きなイメージのサイズを 24 x 24 にする場合は、このデータ メンバーを 1.5 に設定します。

## <a name="cmfctoolbarnextmenu"></a><a name="nextmenu"></a>次のメニュー

```
virtual BOOL NextMenu();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbaronbeforeremovebutton"></a><a name="onbeforeremovebutton"></a>コントロール バー::オン 事前に削除ボタン

```
virtual BOOL OnBeforeRemoveButton(
    CMFCToolBarButton* pButton,
    DROPEFFECT dropEffect);
```

### <a name="parameters"></a>パラメーター

*ボタン*<br/>
[in]未使用。

*ドロップエフェクト*<br/>
[in]未使用。

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbaronchangehot"></a><a name="onchangehot"></a>CMFCツールバー::オンチェンジホット

ユーザーがツール バーのボタンを選択したときに、フレームワークによって呼び出されます。

```
virtual void OnChangeHot(int iHot);
```

### <a name="parameters"></a>パラメーター

*アイホット*<br/>
[in]選択されているツール バー ボタンのインデックスを指定します。ツール バー ボタンが選択されていない場合は -1 を指定します。

### <a name="remarks"></a>解説

ユーザーがツール バーのボタンを選択したことを通知を処理するには、このメソッドをオーバーライドします。

## <a name="cmfctoolbaronchangevisualmanager"></a><a name="onchangevisualmanager"></a>コントロール バー::オンチェンジビジュアルマネージャー

```
virtual void OnChangeVisualManager();
```

### <a name="remarks"></a>解説

## <a name="cmfctoolbaronfillbackground"></a><a name="onfillbackground"></a>CMFCツールバー::オンフィルバックグラウンド

[CBasePane::DoPaint](../../mfc/reference/cbasepane-class.md#dopaint)からフレームワークによって呼び出され、ツール バーの背景を塗りつぶします。

```
virtual void OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
[in]デバイス コンテキストへのポインター。

### <a name="remarks"></a>解説

[CMFCツール バー::DoPaint](#dopaint)は、ツール バーの背景が埋め込まれたときに、このメソッドを呼び出します。 既定の実装では、何も行われません。

派生クラスでカスタム 背景を描画するには、このメソッドをオーバーライドします。

## <a name="cmfctoolbaronglobalfontschanged"></a><a name="onglobalfontschanged"></a>変更されたグローバルフォント

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>解説

## <a name="cmfctoolbaronreset"></a><a name="onreset"></a>CMFCツールバー::オンリセット

ツールバーを元の状態に戻します。

```
virtual void OnReset();
```

### <a name="remarks"></a>解説

ツール バーのリセットに関する通知を処理するには、このメソッドをオーバーライドします。

既定の実装では、何も行われません。 ツール`OnReset`バーが元の`CMFCToolBar`状態に戻ったときに置き換える必要があるダミー ボタンがツール バーに含まれている場合から派生したクラスでオーバーライドします。

## <a name="cmfctoolbaronsetaccdata"></a><a name="onsetaccdata"></a>コントロール バー::オンセットアクデータ

```
virtual BOOL OnSetAccData(long lVal);
```

### <a name="parameters"></a>パラメーター

[in]*lヴァル*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbaronsetdefaultbuttontext"></a><a name="onsetdefaultbuttontext"></a>ボタンバー::既定のボタンテキスト

ツール バー ボタンのテキストを既定の状態に戻します。

```
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>パラメーター

*ボタン*<br/>
[in]テキストが設定されているボタンへのポイント。

### <a name="return-value"></a>戻り値

テキストが正常に復元された場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

ツール バー ボタンのテキストが既定に変更されていることを示す通知を処理するには、このメソッドをオーバーライドします。

既定の実装では、アプリケーション リソースからボタンのテキストを読み込みます。

## <a name="cmfctoolbaronusertooltip"></a><a name="onusertooltip"></a>ツールバー::オンユーザーツールチップ

ボタンのツールヒントが表示されようとしているときに、フレームワークによって呼び出されます。

```
virtual BOOL OnUserToolTip(
    CMFCToolBarButton* pButton,
    CString& strTTText) const;
```

### <a name="parameters"></a>パラメーター

*ボタン*<br/>
[in]ツールヒントを表示するツールバー ボタンへのポイント。

*文字列*<br/>
[アウト]ツールヒントの`CString`テキストを受け取るオブジェクトへの参照。

### <a name="return-value"></a>戻り値

*strTTText に*ツールヒント テキストが設定されている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

ツール バー ボタンのツールヒントが表示されようとしているときに、フレームワークはこのメソッドを呼び出します。 TRUE`OnUserToolTip`を返す場合、フレームワークは*strTTText*`OnUserToolTip`で返されるテキストを含むツールヒントを表示します。 それ以外の場合、ツールヒントにはボタン テキストが含まれます。

ツールバー`OnUserToolTip`ボタンのツール ヒントをカスタマイズする場合は、オーバーライドします。 既定の実装は、ツールヒント テキストを取得するために[CMFC ツール バー::OnUser ツール ヒント](#onusertooltip)を呼び出します。

## <a name="cmfctoolbarprevmenu"></a><a name="prevmenu"></a>メニュー::Pレブメニュー

```
virtual BOOL PrevMenu();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarprocesscommand"></a><a name="processcommand"></a>CMFCツールバー::Pロセスコマンド

ツールバーを所有するウィンドウにWM_COMMANDメッセージを投稿します。

```
BOOL ProcessCommand(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>パラメーター

*ボタン*<br/>
[in]ツール バーのボタンへのポインター。

### <a name="return-value"></a>戻り値

このメソッドは常に TRUE を返す必要があります。 MFC では、内部的に FALSE 値が使用されます。

### <a name="remarks"></a>解説

このメソッドは[、CWnd::PostMessage](../../mfc/reference/cwnd-class.md#postmessage)を呼び出し、指定されたボタンのコマンド ID を*wParam*パラメーターとして渡すことで、ツール バーを所有するウィンドウにWM_COMMAND メッセージをポストします。

[ON_COMMAND](message-map-macros-mfc.md#on_command)マクロを使用して、WM_COMMAND メッセージをメンバー関数にマップします。

## <a name="cmfctoolbarremoveallbuttons"></a><a name="removeallbuttons"></a>ボタンをクリックします。

ツール バーからすべてのボタンと区切り記号を削除します。

```
virtual void RemoveAllButtons();
```

### <a name="remarks"></a>解説

フレームワークは、ツール バーを再作成または破棄するときに、このメソッドを呼び出します。

## <a name="cmfctoolbarremovebutton"></a><a name="removebutton"></a>ボタンの削除

指定したインデックスを持つボタンをツール バーから削除します。

```
virtual BOOL RemoveButton(int iIndex);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
[in]削除するボタンの 0 から始まるインデックスを指定します。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は TRUE、指定されたインデックスが無効な場合、またはインデックスが **[カスタマイズ**] ボタンを参照する場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、ボタンの削除の影響を受ける追加のツール バー属性を更新します。 たとえば、このメソッドは、ツールバーから不要な区切り記号を削除し、ショートカット キーのテーブルを再構築します。

**[カスタマイズ**] ボタンの詳細については[、「CMFC ツール バー::有効化ボタン」を参照してください](#enablecustomizebutton)。

## <a name="cmfctoolbarremovestatefromregistry"></a><a name="removestatefromregistry"></a>レジストリから削除します。

Windows レジストリからツール バーの状態情報を削除します。

```
virtual BOOL RemoveStateFromRegistry(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>パラメーター

*名前を指定します。*<br/>
[in]状態情報が格納されているレジストリ キーを指定します。

*nIndex*<br/>
[in]ツール バーのコントロール ID。

*Uiid*<br/>
[in]ツール バーのリソース ID。 このパラメーターが -1 の場合、このメソッドは[CWnd::GetDlgCtrlID](../../mfc/reference/cwnd-class.md#getdlgctrlid)メソッドを使用してリソース ID を取得します。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

フレームワークは、ユーザー定義のツール バーを削除するときにこのメソッドを呼び出します。

Windows レジストリに追加の状態情報を格納する場合は、このメソッドをオーバーライドします。

## <a name="cmfctoolbarreplacebutton"></a><a name="replacebutton"></a>ボタンを置き換える

ツール バー ボタンを別のツール バー ボタンに置き換えます。

```
int ReplaceButton(
    UINT uiCmd,
    const CMFCToolBarButton& button,
    BOOL bAll=FALSE);
```

### <a name="parameters"></a>パラメーター

*Uicmd*<br/>
[in]置き換えるボタンのコマンド ID。

*ボタン*<br/>
[in]挿入する への`CMFCToolBarButton`参照。

*ボール*<br/>
[in]*uiCmd*で指定されたコマンド ID を持つすべてのボタンを置き換えるかどうかを指定するブール値。 このパラメーターが TRUE の場合、指定されたコマンド ID を持つすべてのボタンが置き換えられます。 それ以外の場合は、最初のボタンが置き換えられます。

### <a name="return-value"></a>戻り値

置き換えられるボタンの数。 指定したコマンド ID のボタンがツール バーに存在しない場合、このメソッドは 0 を返します。

### <a name="remarks"></a>解説

リソースから読み込むことができないツール バー ボタンを追加する場合は、このメソッドを呼び出します。 デザイン時にプレースホルダ ボタンを作成し、ツール バーを初期化するときに、そのボタンをカスタム ボタンに置き換えることができます。 このメソッドを使用する例については、VisualStudioDemo サンプルを参照してください。

### <a name="example"></a>例

クラスでメソッドを使用する方法を`ReplaceButton`次の例に`CMFCToolBar`示します。 このコード スニペットは、 [IE デモ のサンプル](../../overview/visual-cpp-samples.md)の一部です。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#10](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_5.cpp)]

## <a name="cmfctoolbarresetall"></a><a name="resetall"></a>コントロール バー::リセットオール

すべてのツールバーを元の状態に戻します。

```
static void __stdcall ResetAll();
```

### <a name="remarks"></a>解説

このメソッドは、復元できるアプリケーションの各ツール バーで[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)メソッドを呼び出します。 [CMFCツールバー::CanBe復元](#canberestored)メソッドを使用して、ツール バーを復元できるかどうかを判断します。

## <a name="cmfctoolbarresetallimages"></a><a name="resetallimages"></a>コントロール バー::リセットオールイメージ

アプリケーション内のすべてのツール バー イメージ コレクションをクリアします。

```
static void __stdcall ResetAllImages();
```

### <a name="remarks"></a>解説

このメソッドは、[によって](#loadtoolbar)初期化されたイメージ コレクションをクリアします。 [CMFCToolBar::LoadBitmap](#loadbitmap)

## <a name="cmfctoolbarresetimages"></a><a name="resetimages"></a>CMFCツールバー::リセットイメージズ

```
virtual void ResetImages();
```

### <a name="remarks"></a>解説

## <a name="cmfctoolbarrestorefocus"></a><a name="restorefocus"></a>コントロール バー::復元フォーカス

```
virtual void RestoreFocus();
```

### <a name="remarks"></a>解説

## <a name="cmfctoolbarrestoreoriginalstate"></a><a name="restoreoriginalstate"></a>CMFCツールバー::元の状態を復元

ツール バーを元の状態に戻します。

```
virtual BOOL RestoreOriginalState();
```

### <a name="return-value"></a>戻り値

メソッドが成功した場合は TRUE、メソッドが失敗した場合、またはツール バーがユーザー定義の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは[、CMFC ツール バー::読み込みツール バー](#loadtoolbar)メソッドを使用して、リソース ファイルからツール バーを読み込みます。

ユーザーがカスタマイズ ダイアログ ボックスの **[ツール バー** ] ページの **[すべてリセット**] ボタンをクリックすると、フレームワークはこのメソッドを呼び出します。

## <a name="cmfctoolbarsaveparameters"></a><a name="saveparameters"></a>パラメーターの保存

```
static BOOL __stdcall SaveParameters(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>パラメーター

[in]*名前を指定します。*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarsavestate"></a><a name="savestate"></a>CMFCツールバー::セーブステート

Windows レジストリにツール バーの状態情報を保存します。

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>パラメーター

*名前を指定します。*<br/>
[in]Windows レジストリ キーの相対パスを指定します。

*nIndex*<br/>
[in]ツール バーのコントロール ID。

*Uiid*<br/>
[in]ツール バーのリソース ID。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

フレームワークは、アプリケーションの状態をレジストリに保存するときに、このメソッドを呼び出します。 詳細については[、「CWinAppEx::SaveState 」を参照してください。](../../mfc/reference/cwinappex-class.md#savestate)

## <a name="cmfctoolbarsetbasiccommands"></a><a name="setbasiccommands"></a>コマンド バー::コマンドの設定

ユーザーがメニューを開いたときに常に表示されるコマンドのリストを設定します。

```
static void __stdcall SetBasicCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>パラメーター

*コマンド*<br/>
[in]コマンドのコレクションを`CList`含むオブジェクトへの参照。

### <a name="remarks"></a>解説

メニューを開くと、常に基本コマンドが表示されます。 このメソッドは、ユーザーが最近使用したコマンドを表示することを選択した場合に意味があります。

基本的なコマンドの一覧にコマンドを追加するには[、CMFC ツール バー::AddBasicCommand](#addbasiccommand)メソッドを使用します。 CMFC[ツールバー::GetBasicCommands](#getbasiccommands)メソッドを使用して、アプリケーションで使用される基本的なコマンドのリストを取得します。

このメソッドを使用する例については、エクスプローラーのサンプルを参照してください。

## <a name="cmfctoolbarsetbuttoninfo"></a><a name="setbuttoninfo"></a>コントロール バー::ボタンの設定情報

ツール バー ボタンのコマンド ID、スタイル、およびイメージ ID を設定します。

```cpp
void SetButtonInfo(
    int nIndex,
    UINT nID,
    UINT nStyle,
    int iImage);
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
[in]プロパティが設定されているボタンの 0 から始まるインデックス。

*nID*<br/>
[in]ボタンのコマンド ID。

*nStyle*<br/>
[in]ボタンのスタイル。 使用可能なツールバー ボタン スタイルの一覧については、「[ツール バー コントロール](../../mfc/reference/toolbar-control-styles.md)のスタイル」を参照してください。

*iイメージ*<br/>
[in]ボタンの 0 から始まるイメージ インデックス (ツール バー イメージのコレクション内のインデックス)。

### <a name="remarks"></a>解説

ツール バー ボタンのプロパティを設定します。

デバッグ ビルドでは *、nIndex*で指定されたインデックスが無効な場合、このメソッドはアサーション エラーを生成します。

ボタンの[スタイル](#setbuttonstyle)のみを設定するには、メソッドを呼び出します。

## <a name="cmfctoolbarsetbuttons"></a><a name="setbuttons"></a>ボタンを設定します。

ツール バーのボタンを設定します。

```
virtual BOOL SetButtons(
    const UINT* lpIDArray,
    int nIDCount,
    BOOL bRemapImages=TRUE);
```

### <a name="parameters"></a>パラメーター

*を指定します。*<br/>
[in]挿入するボタンのコマンド ID の配列へのポインター。

*NIDカウント*<br/>
[in]*内*の項目の数です。

*ブレマップイメージズ*<br/>
[in]既存のボタン イメージを挿入ボタンに関連付けるかどうかを指定するブール値。 このパラメーターが TRUE の場合、イメージは再マップされます。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

ツール バーから既存のボタンを削除し、新しいボタンのコレクションを挿入します。

このメソッドは、ツール バーに **[Customize]** ボタンを追加し、AFX_WM_RESETTOOLBAR メッセージをツール バーの親ウィンドウに送信します。 **[カスタマイズ**] ボタンの詳細については[、「CMFC ツール バー::有効化ボタン」を参照してください](#enablecustomizebutton)。

## <a name="cmfctoolbarsetbuttonstyle"></a><a name="setbuttonstyle"></a>コントロール バー::セットボタンスタイル

指定したインデックス位置にあるツール バー ボタンのスタイルを設定します。

```
virtual void SetButtonStyle(
    int nIndex,
    UINT nStyle);
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
[in]スタイルを設定するツール バー ボタンの 0 から始まるインデックス。

*nStyle*<br/>
[in]ボタンのスタイル。 使用可能なツールバー ボタン スタイルの一覧については、「[ツール バー コントロール](../../mfc/reference/toolbar-control-styles.md)のスタイル」を参照してください。

### <a name="remarks"></a>解説

このメソッドは、ユーザーが無効なボタンをクリックできないため *、nStyle*がTBBS_DISABLEDされている場合に、TBBS_PRESSED スタイルを削除します。

## <a name="cmfctoolbarsetbuttontext"></a><a name="setbuttontext"></a>コントロール バー::ボタンテキストの設定

ツール バー ボタンのテキスト ラベルを設定します。

```
BOOL SetButtonText(
    int nIndex,
    LPCTSTR lpszText);
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
[in]ツール バー ボタンのインデックス。

*lpszText*<br/>
[in]ツール バー ボタンのテキスト ラベル。 NULL 以外である必要があります。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

指定されたインデックスが有効なツール バー ボタンを参照していない場合、このメソッドは FALSE を返します。

## <a name="cmfctoolbarsetcommandusageoptions"></a><a name="setcommandusageoptions"></a>コマンドの使用オプションを設定します。

めったに使用されないコマンドがアプリケーションのメニューに表示されない場合に指定します。

```
static BOOL SetCommandUsageOptions(
    UINT nStartCount,
    UINT nMinUsagePercentage=5);
```

### <a name="parameters"></a>パラメーター

*カウント*<br/>
[in]フレームワークが基本コマンドと最近使用したコマンドのみを表示するまでに、コマンドを実行する必要がある回数を指定します。

*nMin使用率の割合*<br/>
[in]最近使用したコマンドと見なされるために、コマンドを実行する必要がある回数の割合。

### <a name="return-value"></a>戻り値

100 以上の割合が*nMinUsagePercentage である*場合は FALSE。それ以外の場合は TRUE。

### <a name="remarks"></a>解説

フレームワークが使用するアルゴリズムをカスタマイズして、基本メニュー項目と最近使用したメニュー項目の表示方法を決定します。 基本的なコマンドの詳細については[、「CMFC ツール バー::AddBasicCommand](#addbasiccommand)」を参照してください。

このクラスは、`CMFCCmdUsageCount`このクラスを使用してコマンドの使用カウントを追跡します。 このクラスの詳細については、「[クラスを使用します。](../../mfc/reference/cmfccmdusagecount-class.md)

## <a name="cmfctoolbarsetcustomizemode"></a><a name="setcustomizemode"></a>コントロール バー::設定カスタマイズモード

アプリケーションのすべてのツール バーのカスタマイズ モードを有効または無効にします。

```
static BOOL __stdcall SetCustomizeMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>パラメーター

*bセット*<br/>
[in]カスタマイズ モードを有効にするか無効にするかを指定するブール値。 カスタマイズ モードを有効にするにはこのパラメータを TRUE に設定し、無効にするには FALSE に設定します。

### <a name="return-value"></a>戻り値

このメソッドを呼び出すとカスタマイズ モードが変更される場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、アプリケーションの各ツールバーのレイアウトを調整し、再描画します。 [アプリケーション](#iscustomizemode)がカスタマイズ モードであるかどうかを判断するメソッドを呼び出します。

## <a name="cmfctoolbarsetgraydisabledbuttons"></a><a name="setgraydisabledbuttons"></a>ボタン::設定グレー無効ボタン

ツール バーの使用できないボタンを淡色表示にするか、ボタンを使用できないイメージを使用するかを指定します。

```cpp
void SetGrayDisabledButtons(BOOL bGrayDisabledButtons);
```

### <a name="parameters"></a>パラメーター

*ボタン*<br/>
[in]使用できないボタンの表示方法を指定するブール値。 このパラメーターが TRUE の場合、フレームワークはボタンを暗くします。 それ以外の場合、フレームワークはボタンを使用できないイメージのコレクションを使用します。

### <a name="remarks"></a>解説

既定では、使用できないボタンは淡色表示になっています。

## <a name="cmfctoolbarsetheight"></a><a name="setheight"></a>コントロール バー::セットハイト

ツール バーの高さを設定します。

```cpp
void SetHeight(int cyHeight);
```

### <a name="parameters"></a>パラメーター

*サイハイト*<br/>
[in]ツール バーの高さ (ピクセル単位)。

### <a name="remarks"></a>解説

このメソッドは、高さを設定した後にツール バーを再描画します。

## <a name="cmfctoolbarsethelpmode"></a><a name="sethelpmode"></a>コントロール バー::ヘルプモードを設定します。

```
static void __stdcall SetHelpMode(BOOL bOn = TRUE);
```

### <a name="parameters"></a>パラメーター

[in]*bOn*<br/>

### <a name="remarks"></a>解説

## <a name="cmfctoolbarsethot"></a><a name="sethot"></a>コントロール バー::セットホット

```
BOOL SetHot(CMFCToolBarButton* pMenuButton);
```

### <a name="parameters"></a>パラメーター

[in]*ボタン*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

## <a name="cmfctoolbarsethotborder"></a><a name="sethotborder"></a>CMFCツールバー::セットホットボーダー

ツール バー ボタンをホット トラッキングするかどうかを指定します。

```cpp
void SetHotBorder(BOOL bShowHotBorder);
```

### <a name="parameters"></a>パラメーター

*ブショーショットボーダー*<br/>
[in]ツール バー ボタンをホット トラックするかどうかを指定するブール値。 このパラメーターが TRUE の場合、ツール バーはボタンをホット トラックします。 それ以外の場合、ツールバーはボタンをホット トラッキングしません。

### <a name="remarks"></a>解説

ボタンがホットトラッキングされている場合、マウスがボタンを横切って移動すると、フレームワークによってボタンが強調表示されます。 デフォルトでは、各ツールバーはボタンをホットトラックします。

CMFC[ツールバー::GetHotBorder](#gethotborder)メソッドを呼び出して、ツール バーがそのボタンをホット トラッキングするかどうかを確認します。

## <a name="cmfctoolbarsethottextcolor"></a><a name="sethottextcolor"></a>コントロール バー::セットホットテキストカラー

ホット ツール バー ボタンのテキストの色を設定します。

```
static void SetHotTextColor(COLORREF clrText);
```

### <a name="parameters"></a>パラメーター

*clrText*<br/>
[in]ホット トラッキングされるツール バー ボタンのテキストの色を指定します。

### <a name="remarks"></a>解説

ホット トラッキング ツール バー ボタンの詳細については[、「CMFC ツールバー::GetHotBorder](#gethotborder)および[CMFC ツールバー::セットホットボーダー](#sethotborder)」を参照してください。

## <a name="cmfctoolbarsetignoresettext"></a><a name="setignoresettext"></a>テキストを設定します。

```cpp
void SetIgnoreSetText(BOOL bValue);
```

### <a name="parameters"></a>パラメーター

[in]*b値*<br/>

### <a name="remarks"></a>解説

## <a name="cmfctoolbarsetlargeicons"></a><a name="setlargeicons"></a>コントロール バー::セットラージアイコン

ツール バー ボタンに大きいアイコンを表示するかどうかを指定します。

```
static void SetLargeIcons(BOOL bLargeIcons=TRUE);
```

### <a name="parameters"></a>パラメーター

*大きいアイコン*<br/>
[in]使用するアイコンを指定するブール値。 このパラメーターが TRUE の場合、フレームワークは大きいアイコンを表示します。 それ以外の場合、フレームワークは通常のアイコンを表示します。

### <a name="remarks"></a>解説

ユーザーが [**カスタマイズ**] ダイアログ ボックスの **[オプション**] タブの **[大きいアイコン**] チェック ボックスの状態を変更すると、フレームワークは、このメソッドを呼び出します。 このメソッドは、アプリケーション内のすべてのツール バーのサイズを変更します。

既定では、フレームワークは通常のアイコンを表示します。

**[カスタマイズ**] ダイアログ ボックスの詳細については、「 [CMFCToolBarsCustomizeDialog クラス](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)」を参照してください。

## <a name="cmfctoolbarsetlockedsizes"></a><a name="setlockedsizes"></a>CMFCツールバー::セットロックサイズ

ツール バー上のロックされたボタンとロックされたイメージのサイズを設定します。

```cpp
void SetLockedSizes(
    SIZE sizeButton,
    SIZE sizeImage,
    BOOL bDontScale = FALSE);
```

### <a name="parameters"></a>パラメーター

*サイズボタン*<br/>
[in]ロックされたツール バー ボタンのサイズを指定します。

*サイズイメージ*<br/>
[in]ロックされたツール バー イメージのサイズを指定します。

*bドントスケール*<br/>
高 DPI モードでツール バー イメージを拡大/縮小するかどうかを指定します。

### <a name="remarks"></a>解説

ロックされたボタンのデフォルトサイズは 23x22 ピクセルです。 ロックされたイメージのデフォルトサイズは 16x15 ピクセルです。

[ロック](#getlockedimagesize)されたイメージのサイズを取得するには、メソッドを呼び出します。 ロックされたツール バー ボタンのサイズを取得するには[、CMFCToolBar::GetButtonSize](#getbuttonsize)メソッドを呼び出します。

## <a name="cmfctoolbarsetmaskmode"></a><a name="setmaskmode"></a>コントロール バー::セットマスクモード

```cpp
void SetMaskMode(BOOL bMasked);
```

### <a name="parameters"></a>パラメーター

[in]*マスク*<br/>

### <a name="remarks"></a>解説

## <a name="cmfctoolbarsetmenusizes"></a><a name="setmenusizes"></a>CMFCツールバー::セットメニューサイズ

ツール バー メニュー ボタンとそのイメージのサイズを設定します。

```
static void __stdcall SetMenuSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>パラメーター

*サイズボタン*<br/>
[in]ツール バー ボタンのサイズをピクセル単位で指定します。

*サイズイメージ*<br/>
[in]ツール バー イメージのサイズをピクセル単位で指定します。

### <a name="remarks"></a>解説

既定では、メニュー ボタンとそのイメージのサイズは未定義です。

[メニュー](#getmenubuttonsize)ボタンのサイズを決定するメソッドを呼び出し、[メニュー](#getmenuimagesize)ボタン イメージのサイズを決定します。

このメソッドを使用する例については、IEDemo サンプルと MSMoneyDemo サンプルを参照してください。

## <a name="cmfctoolbarsetnonpermittedcommands"></a><a name="setnonpermittedcommands"></a>コマンド バー::許可されていないコマンド

ユーザーが実行できないコマンドのリストを設定します。

```
static void SetNonPermittedCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>パラメーター

*コマンド*<br/>
[in]ユーザーが実行できない`CList`コマンドを含むオブジェクトへの参照。

### <a name="remarks"></a>解説

ユーザーが特定のコマンドを選択できないようにします。 たとえば、セキュリティ上の理由から、ユーザーが特定のコマンドを選択できないようにする場合があります。 このメソッドを使用する例については、MDITabsDemo および MenuSet のサンプルを参照してください。

このメソッドは、許可されていないコマンドの以前の一覧をクリアします。 既定では、許可されていないコマンドの一覧は空です。

## <a name="cmfctoolbarsetonerowwithsibling"></a><a name="setonerowwithsibling"></a>兄弟と一緒に設定します。

ツールバーとその兄弟を同じ行に配置します。

```cpp
void SetOneRowWithSibling();
```

### <a name="remarks"></a>解説

フレームワークは、ユーザーが **[ボタンを 1 行に表示**] ボタンをクリックすると、このメソッドを呼び出します。

[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)メソッドを呼び出して **、[1 行にボタンを表示**する] ボタンまたは [2 行**にボタンを表示] ボタンを有効に**します。 このツール バーの[CMFC ツール バー::SetSibling ツールバー](#setsiblingtoolbar)を呼び出すと、兄弟ツール バーはこのツール バーの行に移動します。 それ以外の場合、このツールバーは兄弟の行に移動します。

フレームワークは、ユーザーが [ボタンを**2 行に表示**] ボタンをクリックすると[、CMFCToolBar::SetTwoRowsWithSibling](#settworowswithsibling)メソッドを呼び出します。

## <a name="cmfctoolbarsetorigbuttons"></a><a name="setorigbuttons"></a>CMFCツールバー::セットオリッグボタン

```cpp
void SetOrigButtons(const CObList& lstOrigButtons);
```

### <a name="parameters"></a>パラメーター

[in]*ボタン*<br/>

### <a name="remarks"></a>解説

## <a name="cmfctoolbarsetpermament"></a><a name="setpermament"></a>CMFCツールバー::セットパーマメント

ユーザーがツール バーを閉じることができるかどうかを指定します。

```cpp
void SetPermament(BOOL bPermament=TRUE);
```

### <a name="parameters"></a>パラメーター

*bパーマメント*<br/>
[in]ユーザーがツール バーを閉じることができるかどうかを指定するブール値。 このパラメーターが TRUE の場合、ユーザーはツール バーを閉じることができません。 それ以外の場合は、ユーザーはツール バーを閉じることができます。

### <a name="remarks"></a>解説

既定では、ユーザーは各ツール バーを閉じることができます。

[ユーザー](#canbeclosed)がツール バーを閉じることができるかどうかを判断するメソッドを呼び出します。

## <a name="cmfctoolbarsetroutecommandsviaframe"></a><a name="setroutecommandsviaframe"></a>コントロール バー::コマンドを実行するフレーム

親フレームまたはオーナーがツールバーにコマンドを送信するかどうかを指定します。

```cpp
void SetRouteCommandsViaFrame(BOOL bValue);
```

### <a name="parameters"></a>パラメーター

*b値*<br/>
[in]このパラメーターが TRUE の場合、親フレームはツール バーにコマンドを送信します。 それ以外の場合、所有者はコマンドをツール バーに送信します。

### <a name="remarks"></a>解説

既定では、親フレームはツールバーにコマンドを送信します。 親フレームまたは所有者がツール バーにコマンドを送信するかどうかを判断するには[、CMFCToolBar::GetRouteCommandsViaFrame](#getroutecommandsviaframe)メソッドを呼び出します。

## <a name="cmfctoolbarsetshowtooltips"></a><a name="setshowtooltips"></a>ツールバー::セットショーツールチップ

フレームワークにツール ヒントを表示するかどうかを指定します。

```
static void SetShowTooltips(BOOL bValue);
```

### <a name="parameters"></a>パラメーター

*b値*<br/>
[in]このパラメーターが TRUE の場合、フレームワークはツール ヒントを表示します。 それ以外の場合、フレームワークはツール ヒントを非表示にします。

### <a name="remarks"></a>解説

既定では、フレームワークはツール ヒントを示します。

フレームワークにツール ヒントが表示されるかどうかを判断するには[、CMFCToolBar::GetShowTooltips](#getshowtooltips)メソッドを呼び出します。

## <a name="cmfctoolbarsetsiblingtoolbar"></a><a name="setsiblingtoolbar"></a>CMFCツールバー::セット兄弟ツールバー

ツール バーの兄弟を指定します。

```cpp
void SetSiblingToolBar(CMFCToolBar* pBrotherToolbar);
```

### <a name="parameters"></a>パラメーター

*ツールバー*<br/>
[in]兄弟ツール バーへのポインター。

### <a name="remarks"></a>解説

このメソッドは、ユーザーが **[カスタマイズ**] ポップアップメニューを表示したときに表示される **[1 行にボタン**を表示] ボタンまたは **[2 行にボタンを表示**] ボタンを有効にします。 ユーザーが関連するツール バーを同じ行に表示するか、別の行に表示するかを指定できるようにする場合に、このメソッドを呼び出します。

ツール バーに表示される **[カスタマイズ**] ボタンを有効にした後、このメソッドを呼び出します。 **[カスタマイズ**] ボタンを有効にするには、[メソッド](#enablecustomizebutton)を呼び出します。

ツール バーの兄弟を取得するには[、CMFC ツール バー::GetSiblingToolBar](#getsiblingtoolbar)を呼び出します。

## <a name="cmfctoolbarsetsizes"></a><a name="setsizes"></a>コントロール バー::セットサイズ

すべてのツール バーのボタンとイメージのサイズを指定します。

```
static void __stdcall SetSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>パラメーター

*サイズボタン*<br/>
[in]ツール バー ボタンのサイズ (ピクセル単位)。

*サイズイメージ*<br/>
[in]ツール バー ボタン イメージのサイズ (ピクセル単位)。

### <a name="remarks"></a>解説

ツールバーボタンのデフォルトサイズは 23x22 ピクセルです。 ツールバーボタンイメージのデフォルトサイズは 16x15 ピクセルです。

ツール バー[ボタン](#getimagesize)イメージのサイズを取得するには、メソッドを呼び出します。 ツール バー ボタンのサイズを取得するには[、CMFC ツール バー::GetButtonSize](#getbuttonsize)メソッドを呼び出します。

## <a name="cmfctoolbarsettoolbarbtntext"></a><a name="settoolbarbtntext"></a>テキストを作成します。

ツール バーのボタンのプロパティを指定します。

```cpp
void SetToolBarBtnText(
    UINT nBtnIndex,
    LPCTSTR szText=NULL,
    BOOL bShowText=TRUE,
    BOOL bShowImage=TRUE);
```

### <a name="parameters"></a>パラメーター

*インデックスを作成します。*<br/>
[in]ツール バー ボタンの一覧にあるツール バー ボタンの 0 から始まるインデックス。

*のテキスト*<br/>
[in]ツール バー ボタンのテキスト ラベルを指定します。

*テキストを表示する*<br/>
[in]このパラメーターが TRUE の場合、フレームワークはテキスト ラベルを表示します。 それ以外の場合、フレームワークはテキスト ラベルを非表示にします。

*イメージを表示します。*<br/>
[in]このパラメーターが TRUE の場合、フレームワークはツール バー ボタンのイメージを表示します。 それ以外の場合、フレームワークはツール バー ボタンイメージを非表示にします。

### <a name="remarks"></a>解説

既定では、フレームワークはツール バー ボタンのイメージを表示しますが、ツール バー ボタンのテキスト ラベルは表示しません。

デバッグ ビルドでは *、nBtnIndex*が有効なツール バー ボタンを参照していない場合、またはツール バー ボタンが区切り記号である場合、このメソッドはアサーション エラーを生成します。

## <a name="cmfctoolbarsettworowswithsibling"></a><a name="settworowswithsibling"></a>兄弟と一緒に設定します。

ツールバーとその兄弟を別々の行に配置します。

```cpp
void SetTwoRowsWithSibling();
```

### <a name="remarks"></a>解説

フレームワークは、ユーザーが **[ボタン**を 2 行に表示] ボタンをクリックすると、このメソッドを呼び出します。

[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)メソッドを呼び出して **、[1 行にボタンを表示**する] ボタンまたは [2 行**にボタンを表示] ボタンを有効に**します。 このツール バーの[CMFC ツール バー::SetSibling ツールバー](#setsiblingtoolbar)を呼び出すと、兄弟ツール バーは別の行に移動されます。 それ以外の場合、このツールバーは別の行に移動されます。

フレームワークは、ユーザーが [ボタンを**1 行に表示**] ボタンをクリックすると[、CMFCToolBar::SetOneRowWithSibling](#setonerowwithsibling)メソッドを呼び出します。

## <a name="cmfctoolbarsetuserimages"></a><a name="setuserimages"></a>コントロール バー::セットユーザーイメージズ

アプリケーション内のユーザー定義イメージのコレクションを設定します。

```
static BOOL SetUserImages(CMFCToolBarImages* pUserImages);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
[in]ユーザー定義イメージのコレクションへのポインター。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は 0 以外の値を返します。指定した`CMFCToolBarImages`オブジェクトが無効な場合、またはツール バーの既定のイメージ サイズとは異なるイメージ サイズを持つ場合は 0 を返します。

### <a name="remarks"></a>解説

フレームワークは、ユーザーがカスタマイズしたツール バー ボタンを描画するために、ユーザー定義のイメージを使用します。 *pUserImages*で指定されたイメージ リストは、アプリケーション内のすべてのツール バーで共有されます。

このメソッドは、指定された`CMFCToolBarImages`オブジェクトが有効でない場合、またはツール バーの既定のイメージ サイズとは異なるイメージ サイズを持つ場合、デバッグ ビルドでアサーション エラーを生成します。

OutlookDemo、ツールヒントデモ、および VisualStudioDemo のサンプルでは、このメソッドを使用してユーザー定義イメージのグローバル コレクションを設定します。 アプリケーションの作業ディレクトリにある UserImages.bmp という名前のファイルを読み込みます。

メソッドを呼び出して[、](#getuserimages)アプリケーション内のユーザー定義イメージのコレクションを取得します。

## <a name="cmfctoolbarstretchpane"></a><a name="stretchpane"></a>CMFCツールバー::ストレッチペイン

ツールバーを垂直方向または水平方向に伸ばし、必要に応じてボタンを再配置します。

```
virtual CSize StretchPane(
    int nLength,
    BOOL bVert);
```

### <a name="parameters"></a>パラメーター

*nレングス*<br/>
[in]ペインを拡大するピクセル単位の量。

*bVert*<br/>
[in]TRUE の場合、ペインを垂直方向に伸ばします。 FALSE の場合、ペインを水平方向に伸ばします。

### <a name="return-value"></a>戻り値

ツール`CSize`バー クライアント領域のサイズを指定するオブジェクト。

### <a name="remarks"></a>解説

このメソッドは、拡大されたツール バー内のボタンを再配置するために[CMFC ツール バー::WrapToolBar](#wraptoolbar)を呼び出します。

戻り値は、呼び出すことによって決定されます[。](#calcsize)

## <a name="cmfctoolbartranslatechar"></a><a name="translatechar"></a>CMFCツールバー::翻訳文字

指定したキー コードが有効なキーボード ショートカットに対応する場合は、ボタン コマンドを実行します。

```
virtual BOOL TranslateChar(UINT nChar);
```

### <a name="parameters"></a>パラメーター

*Nchar*<br/>
[in]仮想キー コードを指定します。 標準の仮想キー コードの一覧については、Winuser.h を参照してください。

### <a name="return-value"></a>戻り値

指定されたキー コードが印刷できないか、または有効なキーボード ショートカットに対応していない場合は FALSE。指定したキー コードがドロップダウン メニュー オプションに対応する場合は TRUE。それ以外の場合は[、CMFC ツール バーからの](#processcommand)戻り値 :Pです。

### <a name="remarks"></a>解説

フレームワークは、Alt キーとキーが押されたときにこのメソッドを呼び出します。

## <a name="cmfctoolbarupdatebutton"></a><a name="updatebutton"></a>コントロール バー::更新ボタン

指定したボタンの状態を更新します。

```cpp
void UpdateButton(int nIndex);
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
[in]更新するボタンの 0 から始まるインデックスを指定します。

### <a name="remarks"></a>解説

## <a name="cmfctoolbarwraptoolbar"></a><a name="wraptoolbar"></a>コントロール バー::ラップツールバー

指定した寸法内のツールバー ボタンを再配置します。

```
int WrapToolBar(
    int nWidth,
    int nHeight = 32767,
    CDC* pDC = NULL,
    int nColumnWidth = -1,
    int nRowHeight = -1);
```

### <a name="parameters"></a>パラメーター

*n幅*<br/>
[in]ツール バーの最大幅。

*nHeight*<br/>
[in]ツール バーの最大の高さ。 ツールバーが浮動状態の場合は使用されません。

*pDC*<br/>
[in]デバイス コンテキストへのポインター。 NULL の場合、ツール バーのデバイス コンテキストが使用されます。

*列幅*<br/>
[in]ボタンの幅。 1 の場合、現在の幅が使用されます。

[in] m *nRowHeight*ボタンの高さ。 1 の場合、現在の高さが使用されます。

### <a name="return-value"></a>戻り値

ツール バーのボタンの行数。

### <a name="remarks"></a>解説

このメソッドは、ツールバー内のボタンを再配置し、必要に応じてボタンを追加の行に折り返します。

## <a name="cmfctoolbarm_bdontscaleimages"></a><a name="m_bdontscaleimages"></a>CMFCツールバー::m_bDontScaleImages

高 DPI モードでツール バー イメージを拡大できるかどうかを指定します。

```
AFX_IMPORT_DATA static BOOL m_bDontScaleImages;
```

### <a name="remarks"></a>解説

## <a name="see-also"></a>関連項目

[階層グラフ](../../mfc/hierarchy-chart.md)<br/>
[クラス](../../mfc/reference/mfc-classes.md)<br/>
[クラス](../../mfc/reference/cmfcmenubar-class.md)<br/>
[クラス](../../mfc/reference/cmfcpopupmenubar-class.md)<br/>
[クラスをドロップダウンメニューバー](../../mfc/reference/cmfcdropdowntoolbar-class.md)<br/>
[チュートリアル: ツール バーへのコントロールの追加](../../mfc/walkthrough-putting-controls-on-toolbars.md)
