---
title: CFileDialog クラス
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: 247072d815b660fcd2cc6c2a1291b618aa6ce2ab
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753139"
---
# <a name="cfiledialog-class"></a>CFileDialog クラス

ファイルのオープン操作またはファイル保存操作に使用される共通のダイアログ ボックスをカプセル化します。

## <a name="syntax"></a>構文

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|`CFileDialog` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[ファイルダイアログ::チェックボタンの追加](#addcheckbutton)|ダイアログにチェック ボタンを追加します。|
|[ファイルダイアログ::コンボボックスの追加](#addcombobox)|ダイアログにコンボ ボックスを追加します。|
|[コントロールのダイアログ::コントロールアイテムの追加](#addcontrolitem)|ダイアログ内のコンテナー コントロールに項目を追加します。|
|[ファイルダイアログ::編集ボックスの追加](#addeditbox)|ダイアログに編集ボックスを追加します。|
|[ファイルダイアログ::メニューの追加](#addmenu)|ダイアログにメニューを追加します。|
|[ファイルダイアログ::追加場所](#addplace)|オーバーロードされます。 ユーザーがアイテムを開いたり保存したりできる場所の一覧にフォルダーを追加します。|
|[ファイルダイアログ::プッシュボタンの追加](#addpushbutton)|ダイアログにボタンを追加します。|
|[ダイアログ::ラジオボタンリストの追加](#addradiobuttonlist)|ダイアログにオプション ボタン (オプション ボタンとも呼ばれます) グループを追加します。|
|[ファイルダイアログ::追加セパレータ](#addseparator)|ダイアログに区切り記号を追加します。|
|[ファイルダイアログ::テキストの追加](#addtext)|ダイアログにテキストコンテンツを追加します。|
|[ファイルダイアログ::ダイアログ](#applyofntoshelldialog)|メンバー変数に格納されている`CFileDialog`パラメーターとフラグに一致するように、`m_ofn`の状態を更新します。|
|[ファイルダイアログ::Doモーダル](#domodal)|ダイアログ ボックスを表示し、ユーザーが選択できるようにします。|
|[ファイルダイアログ::有効に開くドロップダウン](#enableopendropdown)|ダイアログの [**開く**] ボタンまたは [**保存**] ボタンのドロップダウン リストを有効にします。|
|[ファイルダイアログ::エンドビジュアルグループ](#endvisualgroup)|ダイアログボックスのビジュアルグループへの要素の追加を停止します。|
|[ウィンドウダイアログ::チェックボタン状態](#getcheckbuttonstate)|ダイアログボックスのチェックボタン (チェック ボックス) の現在の状態を取得します。|
|[をクリックします。](#getcontrolitemstate)|ダイアログで見つかったコンテナー コントロール内の項目の現在の状態を取得します。|
|[ファイルダイアログ::コントロール状態を取得します。](#getcontrolstate)|指定されたコントロールの現在の可視性と有効な状態を取得します。|
|[ファイルダイアログ::テキストを取得します。](#geteditboxtext)|エディット ボックス コントロール内の現在のテキストを取得します。|
|[ファイルダイアログ::ゲットファイルエクスタブ](#getfileext)|選択したファイルの拡張子を返します。|
|[ファイルダイアログ::ファイル名を取得します。](#getfilename)|選択したファイルのファイル名を返します。|
|[ファイルダイアログ::ファイルタイトルを取得します](#getfiletitle)|選択したファイルのタイトルを返します。|
|[ファイルダイアログ::ゲットフォルダパス](#getfolderpath)|エクスプローラ形式の **[開く**] または [名前を**付けて保存]** コモン ダイアログ ボックスの現在開いているフォルダまたはディレクトリのパスを取得します。|
|[ファイルダイアログ::GetIFileダイアログをカスタマイズ](#getifiledialogcustomize)|カスタマイズされた`CFileDialog`オブジェクトの内部 COM オブジェクトを取得します。|
|[ファイルダイアログ::GetIFileOpenダイアログ](#getifileopendialog)|[ファイルを**開く**] ダイアログ`CFileDialog`ボックスとして使用されるの内部 COM オブジェクトを取得します。|
|[ファイルダイアログ::取得ファイル保存ダイアログ](#getifilesavedialog)|**[ファイルの保存**] ダイアログ`CFileDialog`ボックスとして使用されるの内部 COM オブジェクトを取得します。|
|[ファイルダイアログ::次のパス名を取得します。](#getnextpathname)|次に選択したファイルの完全パスを返します。|
|[ファイルダイアログ::ゲットフン](#getofn)|オブジェクトの`OPENFILENAME`構造を`CFileDialog`取得します。|
|[ファイルダイアログ::パス名を取得します。](#getpathname)|選択したファイルの完全パスを返します。|
|[ファイルダイアログ::読み取り専用プルーフ](#getreadonlypref)|選択したファイルの読み取り専用ステータスを返します。|
|[ファイルダイアログ::結果を取得します](#getresult)|ユーザーがダイアログで行った選択を取得します。|
|[ファイルダイアログ::結果を取得します](#getresults)|複数の選択を許可するダイアログ内のユーザーの選択を取得します。|
|[を選択しました。](#getselectedcontrolitem)|ダイアログ内の指定されたコンテナー コントロールから特定の項目を取得します。|
|[ファイルダイアログ::取得位置](#getstartposition)|ファイル名リストの最初の要素の位置を返します。|
|[ファイルダイアログ::コントロールを非表示にする](#hidecontrol)|エクスプローラ スタイルの **[開く]** または [**名前を付けて保存]** コモン ダイアログ ボックスで、指定したコントロールを非表示にします。|
|[ファイルダイアログ::イスピックフォルダモード](#ispickfoldersmode)|フォルダーピッカー モードで現在のダイアログを表示するかどうかを決定します。|
|[ファイルダイアログ::メイク・チェンジ・スチュプ](#makeprominent)|他の追加されたコントロールと比較して目立つコントロールをダイアログボックスに配置します。|
|[コントロールアイテムを削除します。](#removecontrolitem)|ダイアログ内のコンテナー コントロールから項目を削除します。|
|[ウィンドウダイアログ::セットチェックボタン状態](#setcheckbuttonstate)|ダイアログボックスのチェックボタン(チェックボックス)の現在の状態を設定します。|
|[をクリックします。](#setcontrolitemstate)|ダイアログボックスで見つかったコンテナー コントロール内の項目の現在の状態を設定します。|
|[ダイアログボックス::コントロールアイテムテキスト](#setcontrolitemtext)|コントロール項目のテキストを設定します。 たとえば、ラジオ ボタンやメニューの項目に付随するテキストです。|
|[ファイルダイアログ::コントロールラベルを設定します。](#setcontrollabel)|ボタン のテキストやエディット ボックスのラベルなど、コントロールに関連付けられたテキストを設定します。|
|[ファイルダイアログ::コントロールステートを設定します。](#setcontrolstate)|特定のコントロールの現在の表示と有効な状態を設定します。|
|[ダイアログボックス::コントロールテキストを設定します。](#setcontroltext)|エクスプローラ スタイルの **[開く]** または [**名前を付けて保存]** コモン ダイアログ ボックスで、指定したコントロールのテキストを設定します。|
|[ファイルダイアログ::セットデフエクスク](#setdefext)|エクスプローラ スタイルの **[開く]** または [名前を**付けて保存]** コモン ダイアログ ボックスの既定のファイル名拡張子を設定します。|
|[ファイルダイアログ::セットエディットボックステキスト](#seteditboxtext)|エディット ボックス コントロールの現在のテキストを設定します。|
|[ファイルダイアログ::プロパティを設定します。](#setproperties)|保存される項目に対して使用される既定値を定義するプロパティ ストアを提供します。|
|[を選択しました。](#setselectedcontrolitem)|ダイアログ ボックス内のオプション ボタン グループまたはコンボ ボックス内の特定の項目の選択状態を設定します。|
|[ファイルダイアログ::テンプレートを設定します。](#settemplate)|オブジェクトのダイアログ ボックス テンプレート`CFileDialog`を設定します。|
|[ファイルダイアログ::開始ビジュアルグループ](#startvisualgroup)|ダイアログでビジュアル グループを宣言します。 以降の "add" メソッドの呼び出しは、これらの要素をこのグループに追加します。|
|[ファイルダイアログ::ダイアログ](#updateofnfromshelldialog)|メンバー変数に格納されているデータ`m_ofn`を更新して、ファイル ダイアログ ボックスの現在の状態に一致させます。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[ダイアログ::ボタンクリック](#onbuttonclicked)|ボタンがクリックされたときに呼び出されます。|
|[ウィンドウダイアログ::オンチェックボタン切り替え](#oncheckbuttontoggled)|チェック ボックスがオン/オフのときに呼び出されます。|
|[ファイルダイアログ::オンコントロールアクティベート](#oncontrolactivating)|コントロールがアクティブな場合に呼び出されます。|
|[ファイルダイアログ::オンファイル名変更](#onfilenamechange)|WM_NOTIFYCDN_SELCHANGEメッセージを処理します。|
|[ファイルダイアログ::オンファイル名OK](#onfilenameok)|ダイアログ ボックスに入力されたファイル名を検証します。|
|[ファイルダイアログ::オンフォルダチェンジ](#onfolderchange)|WM_NOTIFYCDN_FOLDERCHANGEメッセージを処理します。|
|[ファイルダイアログ::オンイニットDone](#oninitdone)|WM_NOTIFYCDN_INITDONE メッセージを処理します。|
|[ファイルダイアログ::オンアイテム選択](#onitemselected)|コンテナー項目が選択されるときに呼び出されます。|
|[ファイルダイアログ::オンルプセル変更通知](#onlbselchangednotify)|ファイル選択が変更されたときにカスタムアクションを実行できます。|
|[ファイルダイアログ::オンシェア違反](#onshareviolation)|共有違反を処理します。|
|[ファイルダイアログ::オンタイプチェンジ](#ontypechange)|WM_NOTIFYCDN_TYPECHANGEメッセージを処理します。|

### <a name="public-data-members"></a>パブリック データ メンバー

|名前|説明|
|----------|-----------------|
|[ファイルダイアログ::m_ofn](#m_ofn)|ウィンドウ`OPENFILENAME`構造。 基本的なファイル ダイアログ ボックス のパラメーターにアクセスできます。|

## <a name="remarks"></a>解説

共通のファイル ダイアログ ボックスを使用すると、ファイル選択ダイアログ ボックス ([**ファイルを開く]** や [**名前を付けて保存]** など) を Windows 標準と一致する方法で実装できます。

提供されたコンストラクタ`CFileDialog`と同じ方法で使用することも、必要に応じて独自のダイアログ ボックス`CFileDialog`クラスを派生させたり、コンストラクタを記述することもできます。 どちらの場合も、これらのダイアログ ボックスは[CCommonDialog クラス](../../mfc/reference/ccommondialog-class.md)から派生しているため、標準の MFC ダイアログ ボックスのように動作します。 `CFileDialog`は、COMMDLG に依存します。WINDOWS に含まれている DLL ファイル。

Windows Vista 以降の外観と`CFileDialog`機能の両方が、以前のバージョンの Windows とは異なります。 既定`CFileDialog`では、プログラムがコンパイルされ、Windows Vista 以降で実行される場合、コードを変更せずに、新しい Windows Vista 以降のスタイルが自動的に使用されます。 この自動更新を手動でオーバーライドするには、コンストラクターで*bVistaStyle*パラメーターを使用します。 自動更新の例外は、カスタマイズされたダイアログ ボックスです。 これらは新しいスタイルに変換されません。 コンストラクターの詳細については[、「CFileDialog::CFileDialog](#cfiledialog)」を参照してください。

> [!NOTE]
> コントロール ID システムは、Windows Vista 以降のバージョンでは、`CFileDialog`を使用する場合は Windows の以前のバージョンとは異なります。 以前のバージョンの Windows`CFileDialog`からプロジェクトを移植する前に、コード内のコントロールへのすべての参照を更新する必要があります。

Windows `CFileDialog` Vista 以降では、一部のメソッドはサポートされていません。 メソッドがサポートされているかどうかについては、個々のメソッドのトピックを確認してください。 さらに、次の継承された関数は、Windows Vista 以降ではサポートされていません。

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [ダイアログ::オンセットフォント](../../mfc/reference/cdialog-class.md#onsetfont)

クラスのウィンドウ メッセージ`CFileDialog`は、使用しているオペレーティング システムによって異なります。 たとえば、Windows XP はクラスの[CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel)と[CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok)を`CFileDialog`サポートしていません。 ただし、Windows Vista 以降のオペレーティング システムでは、これらの機能がサポートされています。 生成されるさまざまなメッセージと受信順序の詳細については、「 [CFileDialog サンプル : イベントの順序の記録](../../overview/visual-cpp-samples.md)」を参照してください。

オブジェクトを`CFileDialog`使用するには、まずコンストラクターを使用してオブジェクトを`CFileDialog`作成します。 ダイアログ ボックスが構築された後[、CFileDialog::m_ofn](#m_ofn)構造体の値を設定または変更して、ダイアログ ボックス コントロールの値または状態を初期化できます。 構造体`m_ofn`の型`OPENFILENAME`は です。 詳細については、Windows SDK の[オープンファイル名](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)の構造体を参照してください。

ダイアログ ボックス コントロールを初期化した後[、CFileDialog::DoModal](#domodal)メソッドを呼び出してダイアログ ボックスを表示し、ユーザーがパスとファイル名を入力できるようにします。 `DoModal`は、ユーザーが OK (IDOK) またはキャンセル (IDCANCEL) ボタンをクリックしたかどうかを返します。 IDOK を返す場合`DoModal`は、`CFileDialog`パブリック メンバー関数の 1 つを使用して、ユーザーが入力した情報を取得できます。

> [!NOTE]
> Windows Vista 以降では[、IFileDialog::SetFileTypes](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes)への複数の呼び出しがエラーを引き起こします。 2 回目の`SetFileTypes`呼び出しの`CFileDialog`任意のインスタンスは、Windows Vista 以降でE_UNEXPECTED返されます。 メソッド`CFileDialog`関数の中`SetFileTypes`には、 を呼び出すものもあります。 たとえば、同じインスタンスに`CFileDialog::DoModal`対する 2 つの`CFileDialog`呼び出しで[ASSERT](diagnostic-services.md#assert)が生成されます。

`CFileDialog`には、共有違反、ファイル名の検証、およびリスト ボックスの変更通知をカスタム処理できる、いくつかのプロテクト メンバーが含まれています。 これらのプロテクト メンバーは、既定の処理が自動的に実行されるため、ほとんどのアプリケーションで使用する必要がないコールバック関数です。 これらの関数のメッセージ マップ エントリは、標準の仮想関数であるため、必須ではありません。

Windows [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror)関数を使用して、ダイアログ ボックスの初期化中にエラーが発生したかどうかを確認し、エラーの詳細を確認できます。

オブジェクトの`CFileDialog`破棄は自動的に処理されます。 呼び出す必要はありません[: :EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

ユーザーが複数のファイルを選択できるようにするには、呼び出す`DoModal`前に OFN_ALLOWMULTISELECT フラグを設定します。 返される複数のファイル名のリストに対応するために、独自のファイル名バッファを指定する必要があります。 これを行うには、 `m_ofn.lpstrFile` `CFileDialog`を作成した後、呼び出す`DoModal`前に、割り当てたバッファーへのポインターに置き換えます。

また、 が指す`m_ofn.nMaxFile`バッファー内の文字数を使用して設定する必要があります`m_ofn.lpstrFile`。 選択するファイルの最大数を`n`に設定した場合、必要なバッファ サイズは`n * (_MAX_PATH + 1) + 1`です。 バッファーに返される最初の項目は、ファイルが選択されたフォルダーへのパスです。 Windows Vista 以降の形式のダイアログ ボックスでは、ディレクトリおよびファイル名の文字列は、最後のファイル名の後に余分な NULL 文字を使用して、NULL で終了します。 この形式では、エクスプローラスタイルのダイアログボックスは、スペースを含む長いファイル名を返すことができます。 古い形式のダイアログ ボックスでは、ディレクトリとファイル名の文字列はスペースで区切られ、関数はスペースを含むファイル名に短いファイル名を使用します。

バッファーを使用して複数のファイル名を取得および一覧表示する方法を次の例に示します。

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

ユーザーが複数のファイル名を選択したときにバッファー サイズを変更するには、新しいクラスを派生`CFileDialog`させ[、CFileDialog::OnFileNameChange](#onfilenamechange)メソッドをオーバーライドする必要があります。

から`CFileDialog`新しいクラスを派生させる場合は、メッセージ マップを使用してメッセージを処理できます。 既定のメッセージ処理を拡張するには、 から`CFileDialog`クラスを派生し、新しいクラスにメッセージ マップを追加し、新しいメッセージのメンバー関数を提供します。 ダイアログ ボックスをカスタマイズするためにフック関数を提供する必要はありません。

ダイアログ ボックスをカスタマイズするには、 から`CFileDialog`クラスを派生させるカスタム ダイアログ ボックス テンプレートを提供し、拡張コントロールからの通知メッセージを処理するメッセージ マップを追加します。 未処理のメッセージを基本クラスに渡します。 フック関数をカスタマイズする必要はありません。

Windows Vista 以降のスタイルを`CFileDialog`使用している場合は、メッセージ マップおよびダイアログ ボックス テンプレートを使用できません。 代わりに、同様の機能を実現するために COM インターフェイスを使用する必要があります。

`CFileDialog`の使用方法の詳細については、「 コモン[ダイアログ クラス](../../mfc/common-dialog-classes.md)」を参照してください。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxdlgs.h

## <a name="cfiledialogaddcheckbutton"></a><a name="addcheckbutton"></a>ファイルダイアログ::チェックボタンの追加

ダイアログにチェック ボタンを追加します。

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
追加するチェック ボタンの ID。

*ストラベル*<br/>
チェック ボタンの名前。

*bチェック*<br/>
チェック ボタンの現在の状態を示すブール値。 チェックされている場合は TRUE。それ以外の場合は FALSE

### <a name="remarks"></a>解説

## <a name="cfiledialogaddcombobox"></a><a name="addcombobox"></a>ファイルダイアログ::コンボボックスの追加

ダイアログにコンボ ボックスを追加します。

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
追加するコンボ ボックスの ID。

### <a name="remarks"></a>解説

## <a name="cfiledialogaddcontrolitem"></a><a name="addcontrolitem"></a>コントロールのダイアログ::コントロールアイテムの追加

ダイアログ内のコンテナー コントロールに項目を追加します。

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
項目を追加するコンテナー コントロールの ID。

*ドウィッドIDアイテム*<br/>
項目の ID。

*ストラベル*<br/>
項目のテキスト。

### <a name="remarks"></a>解説

## <a name="cfiledialogaddeditbox"></a><a name="addeditbox"></a>ファイルダイアログ::編集ボックスの追加

ダイアログに編集ボックスを追加します。

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
追加するエディット ボックスの ID。

*str テキスト*<br/>
エディット ボックスの名前。

### <a name="remarks"></a>解説

## <a name="cfiledialogaddmenu"></a><a name="addmenu"></a>ファイルダイアログ::メニューの追加

ダイアログにメニューを追加します。

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
追加するメニューの ID。

*ストラベル*<br/>
メニュー名。

### <a name="remarks"></a>解説

## <a name="cfiledialogaddplace"></a><a name="addplace"></a>ファイルダイアログ::追加場所

ユーザーがアイテムを開いたり保存したりできる場所の一覧にフォルダーを追加します。

```cpp
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
ユーザーが使用できるようにするフォルダーへのパス。 これはフォルダのみ指定できます。

*fdap*<br/>
フォルダをリスト内のどこに配置するかを指定します。

*psi*<br/>
ユーザーが使用できるようにするフォルダーを表す IShellItem へのポインター。 これはフォルダのみ指定できます。

### <a name="remarks"></a>解説

## <a name="cfiledialogaddpushbutton"></a><a name="addpushbutton"></a>ファイルダイアログ::プッシュボタンの追加

ダイアログにボタンを追加します。

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
追加するボタンの ID。

*ストラベル*<br/>
ボタン名。

### <a name="remarks"></a>解説

## <a name="cfiledialogaddradiobuttonlist"></a><a name="addradiobuttonlist"></a>ダイアログ::ラジオボタンリストの追加

ダイアログにオプション ボタン (オプション ボタンとも呼ばれます) グループを追加します。

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
追加するオプション ボタン グループの ID。

### <a name="remarks"></a>解説

## <a name="cfiledialogaddseparator"></a><a name="addseparator"></a>ファイルダイアログ::追加セパレータ

ダイアログに区切り記号を追加します。

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
区切り記号の追加の ID。

### <a name="remarks"></a>解説

## <a name="cfiledialogaddtext"></a><a name="addtext"></a>ファイルダイアログ::テキストの追加

ダイアログにテキストを追加します。

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
追加するテキストの ID。

*str テキスト*<br/>
テキスト名。

### <a name="remarks"></a>解説

## <a name="cfiledialogapplyofntoshelldialog"></a><a name="applyofntoshelldialog"></a>ファイルダイアログ::ダイアログ

データ構造体に格納されている値に基づいて[、CFileDialog](../../mfc/reference/cfiledialog-class.md)の現在`m_ofn`の状態を更新します。

```cpp
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>解説

Windows Vista より前のバージョンの Windows では、メンバ[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamea)データ構造体が、`CFileDialog`の状態と継続的に同期されていました。 [m_ofn](#m_ofn)メンバー変数に対する変更は、ダイアログ ボックスの状態に直ちに反映されます。 また、ダイアログ ボックスの状態が変更されると、メンバー変数は`m_ofn`直ちに更新されます。

Windows Vista 以降では、`m_ofn`メンバー変数の値との状態`CFileDialog`は同期されません。 この関数は、構造`CFileDialog`に合わせて更新される状態を強制`m_ofn`します。 ウィンドウは[、CFileDialog::DoModal の](#domodal)間に自動的にこの関数を呼び出します。

Windows Vista 以降の下で`CFileDialog`クラスを使用する方法の詳細については[、「CFileDialog クラス](../../mfc/reference/cfiledialog-class.md)」を参照してください。

### <a name="example"></a>例

  の[例を参照](#updateofnfromshelldialog)してください。

## <a name="cfiledialogcfiledialog"></a><a name="cfiledialog"></a>ファイルダイアログ::Cファイルダイアログ

標準の Windows ファイル ダイアログ ボックスを構築します。

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>パラメーター

*ファイルダイアログを開く*<br/>
[in]作成するダイアログ ボックスの種類を指定するパラメーター。 [**ファイルを開く]** ダイアログ ボックスを構築するには、このプロパティを TRUE に設定します。 [**名前を付けてファイルを保存]** ダイアログ ボックスを作成するには、FALSE に設定します。

*を使用します。*<br/>
[in]既定のファイル名拡張子。 ユーザーが [ファイル名] ボックスに既知の拡張子 (ユーザーのコンピュータに関連付けが付いている拡張子) を含まない場合 *、lpszDefExt*で指定された拡張子が自動的にファイル名に追加されます。 このパラメーターが NULL の場合、拡張子は付加されません。

*ファイル名*<br/>
[in][ファイル名] ボックスに表示される最初のファイル名。 NULL の場合、初期ファイル名は表示されません。

*dwFlags*<br/>
[in]ダイアログ ボックスをカスタマイズするために使用できる 1 つまたは複数のフラグの組み合わせ。 これらのフラグの説明については、Windows SDK の[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体を参照してください。 構造体のメンバーを`m_ofn.Flags`変更する場合は、既定の動作をそのまま維持するために、変更にビットごとの OR 演算子を使用します。

*Lpszfilter*<br/>
[in]ファイルに適用できるフィルターを指定する一連の文字列ペア。 ファイル フィルタを指定すると、フィルタ条件に一致するファイルのみが [ファイル] リストに表示されます。 ファイル フィルタの操作方法の詳細については、「解説」を参照してください。

*pParentWnd*<br/>
[in]ファイル ダイアログ ボックスの親ウィンドウまたは所有者ウィンドウへのポインター。

*Dwsize*<br/>
[in]構造体の`OPENFILENAME`サイズ。 この値は、オペレーティング システムのバージョンによって異なります。 MFC はこのパラメータを使用して、作成するダイアログ ボックスの種類を決定しました。 既定のサイズ 0 は、プログラムが実行されるオペレーティング システムのバージョンに基づいて、MFC コードが使用するダイアログ ボックスの正しいサイズを決定することを意味します。

*ビビスタスタイル*<br/>
[in]**注**このパラメーターは Visual Studio 2008 以降で使用でき、新しいスタイルのダイアログは、Windows Vista 以降で実行している場合にのみ使用されます。

ファイル ダイアログのスタイルを指定するパラメーター。 新しい Vista スタイル ファイル ダイアログを使用するには、このプロパティを TRUE に設定します。 それ以外の場合は、ダイアログ ボックスの古いスタイルが使用されます。 Vista の実行の詳細については、「解説」を参照してください。

### <a name="remarks"></a>解説

*bOpenFileDialog*の値に応じて、[**ファイルを開く**] または [**名前を付けてファイルを保存**] ダイアログ ボックスが作成されます。

*lpszDefExt*を使用して既定の拡張子を指定すると、ユーザーのコンピューター上でどの拡張子がファイルの関連付けを持つ可能性がほとんどないので、期待される動作が発生しない場合があります。 既定の拡張機能の追加をより詳細に制御する必要がある場合は、 から`CFileDialog`独自のクラスを派生させ、メソッド`CFileDialog::OnFileNameOK`をオーバーライドして独自の拡張機能処理を実行できます。

ユーザーが複数のファイルを選択できるようにするには[、DoModal](#domodal)を呼び出す前にOFN_ALLOWMULTISELECT フラグを設定します。 返された複数のファイル名のリストを格納するには、独自のファイル名バッファを指定する必要があります。 これは、 [CFileDialog](../../mfc/reference/cfiledialog-class.md)を作成した後、呼び出す前に、割り当てたバッファへのポインタに`DoModal`置き換えることによって`m_ofn.lpstrFile`行います。 また、 が指す`m_ofn.nMaxFile`バッファーの文字数を設定する必要があります`m_ofn.lpstrFile`。 選択するファイルの最大数を*n*に設定した場合、必要なバッファー・サイズ`n`は *(_MAX_PATH + 1) + 1 になります。 次に例を示します。

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

ユーザーがマウスまたはキーボードを使用してエクスプローラ スタイルのダイアログ ボックスのサイズを変更できるようにするには、OFN_ENABLESIZING フラグを設定します。 このフラグを設定する必要があるのは、フックプロシージャまたはカスタム テンプレートを提供する場合だけです。 このフラグは、エクスプローラ スタイルのダイアログ ボックスでのみ有効です。古い形式のダイアログ ボックスのサイズは変更できません。

*lpszFilter*パラメーターは、ファイルの一覧に表示する必要があるファイル名の種類を決定するために使用されます。 文字列ペアの最初の文字列は、フィルターを記述します。2 番目の文字列は、使用するファイル名拡張子を示します。 区切り文字としてセミコロン (';' 文字) を使用して、複数の拡張子を指定できます。 文字列の終わりには 2 つの '&#124;' 文字が続き、その後に NULL 文字が続きます。 このパラメーターには[CString](../../atl-mfc-shared/using-cstring.md)オブジェクトを使用することもできます。

たとえば、Excel では、拡張子が .xlc (グラフ) や .xls (ワークシート) などのファイルを開きます。 Excel のフィルターは次のように記述できます。

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

ただし、この文字列を使用して`OPENFILENAME`構造を直接更新する場合は、文字列を縦棒 ('&#124;' ではなく null 文字 '\0' で区切る必要があります) を指定する必要があります。

*bVistaStyle*パラメーターは、Windows Vista 以降で実行されている場合にのみ適用されます。 以前のバージョンの Windows では、このパラメーターは無視されます。 *bVistaStyle*が TRUE に設定されている場合は、Visual Studio 2008 以降でプログラムをコンパイルするときに、新しい Vista スタイル**のファイル ダイアログ**が使用されます。 それ以外の場合は、前の MFC スタイル**のファイル ダイアログ**が使用されます。

ダイアログ テンプレートは *、bVista スタイル*に基づくダイアログではサポートされていません。

### <a name="example"></a>例

  [:D 次](#domodal)の例を参照してください。

## <a name="cfiledialogdomodal"></a><a name="domodal"></a>ファイルダイアログ::Doモーダル

Windows 共通ファイルダイアログボックスを表示し、ユーザーがファイルやディレクトリを参照してファイル名を入力できるようにします。

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>戻り値

IDOK または ID キャンセル。 IDCANCEL が返された場合は、エラーが発生したかどうかを判断するのには関数[を](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror)呼び出します。

IDOK と IDCANCEL は、ユーザーが [OK] または [キャンセル] ボタンを選択したかどうかを示す定数です。

### <a name="remarks"></a>解説

構造体のメンバを設定してさまざまなファイル ダイアログ ボックス オプションを`m_ofn`初期化する場合は、 を呼び出`DoModal`す前に、ダイアログ オブジェクトを構築した後で行う必要があります。

たとえば、ユーザーが複数のファイルを選択できるようにする場合は、このトピックのコード例に示すように`DoModal`、呼び出しの前に OFN_ALLOWMULTISELECT フラグを設定します。

ユーザーがダイアログ ボックスの [OK] または [キャンセル] ボタンをクリックするか、ダイアログ ボックスのコントロール メニューから [閉じる] オプションを選択すると、コントロールがアプリケーションに返されます。 その後、他のメンバー関数を呼び出して、ユーザーがダイアログ ボックスに入力した設定や情報を取得できます。

`DoModal`はクラスからオーバーライドされた仮想関数です`CDialog`。

### <a name="example"></a>例

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

## <a name="cfiledialogenableopendropdown"></a><a name="enableopendropdown"></a>ファイルダイアログ::有効に開くドロップダウン

ダイアログの [開く] ボタンまたは [保存] ボタンのドロップダウン リストを有効にします。

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
ドロップダウン リストの ID。

### <a name="remarks"></a>解説

## <a name="cfiledialogendvisualgroup"></a><a name="endvisualgroup"></a>ファイルダイアログ::エンドビジュアルグループ

ダイアログボックスのビジュアルグループへの要素の追加を停止します。

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>戻り値

成功した場合はS_OKを返します。それ以外の場合はエラー値です。

### <a name="remarks"></a>解説

## <a name="cfiledialoggetcheckbuttonstate"></a><a name="getcheckbuttonstate"></a>ウィンドウダイアログ::チェックボタン状態

ダイアログボックスのチェックボタン (チェックボックス) の現在の状態を取得します。

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
チェック ボックスの ID。

*bチェック*<br/>
チェック ボックスの状態。 TRUE はチェック済みであることを示します。FALSE はチェックが外になっていることを示します。

### <a name="remarks"></a>解説

## <a name="cfiledialoggetcontrolitemstate"></a><a name="getcontrolitemstate"></a>をクリックします。

ダイアログボックス内のコンテナー コントロール内の項目の現在の状態を取得します。

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コンテナー コントロールの ID。

*ドウィッドIDアイテム*<br/>
項目の ID。

*dwステート*<br/>
コントロールの現在の状態を示す CDCONTROLSTATE 列挙体から、さらに値の 1 つを受け取る変数への参照。

### <a name="remarks"></a>解説

## <a name="cfiledialoggetcontrolstate"></a><a name="getcontrolstate"></a>ファイルダイアログ::コントロール状態を取得します。

特定のコントロールの現在の可視性と有効な状態を取得します。

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コントロールの ID。

*dwステート*<br/>
コントロールの現在の状態を示す CDCONTROLSTATE 列挙体から 1 つ以上の値を受け取る変数への参照。

### <a name="remarks"></a>解説

## <a name="cfiledialoggeteditboxtext"></a><a name="geteditboxtext"></a>ファイルダイアログ::テキストを取得します。

エディット ボックス コントロールの現在のテキストを取得します。

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
エディット ボックスの ID。

*str テキスト*<br/>
テキスト値。

### <a name="remarks"></a>解説

## <a name="cfiledialoggetfileext"></a><a name="getfileext"></a>ファイルダイアログ::ゲットファイルエクスタブ

ダイアログ ボックスに入力されたファイル名の拡張子を取得します。

```
CString GetFileExt() const;
```

### <a name="return-value"></a>戻り値

ファイル名の拡張子。

### <a name="remarks"></a>解説

たとえば、入力したファイルの名前が DATA の場合です。TXT`GetFileExt`は"TXT"を返します。

OFN_ALLOWMULTISELECT`m_ofn.Flags`フラグが設定されている場合、この文字列には一連の null で終わる文字列が含まれます。 ファイル パス名を取得するには、[メンバー](#getstartposition)[関数を使用](#getnextpathname)します。

## <a name="cfiledialoggetfilename"></a><a name="getfilename"></a>ファイルダイアログ::ファイル名を取得します。

ダイアログ ボックスに入力されたファイル名の名前を取得します。

```
CString GetFileName() const;
```

### <a name="return-value"></a>戻り値

ファイルの名前です。

### <a name="remarks"></a>解説

ファイル名には、プレフィックスと拡張子の両方が含まれます。 たとえば、"TEXT. `GetFileName`ファイル C:\FILES\TEXT.DAT の DAT" 。

フラグ`m_ofn.Flags`が設定`OFN_ALLOWMULTISELECT`されている場合は、ファイル パス名を取得する[GetStartPosition](#getstartposition)と[GetNextPathName](#getnextpathname)を呼び出す必要があります。

## <a name="cfiledialoggetfiletitle"></a><a name="getfiletitle"></a>ファイルダイアログ::ファイルタイトルを取得します

ダイアログ ボックスに入力されたファイルのタイトルを取得します。

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>戻り値

ファイルのタイトル。

### <a name="remarks"></a>解説

ファイルのタイトルには、パスや拡張子を含まない接頭辞のみが含まれます。 たとえば、`GetFileTitle`ファイル C:\FILES\TEXT.DAT に対して "TEXT" を返します。

OFN_ALLOWMULTISELECT`m_ofn.Flags`フラグが設定されている場合、この文字列には一連の null で終わる文字列が含まれます。 このため、[メンバー](#getstartposition)関数を使用して、リスト内[GetNextPathName](#getnextpathname)の次のファイル名を取得します。

### <a name="example"></a>例

  [:D 次](#domodal)の例を参照してください。

## <a name="cfiledialoggetfolderpath"></a><a name="getfolderpath"></a>ファイルダイアログ::ゲットフォルダパス

エクスプローラ形式の [開く] または [名前を付けて保存] コモン ダイアログ ボックスの現在開いているフォルダーまたはディレクトリのパスを取得します。

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>戻り値

現在開いているフォルダまたはディレクトリを含む[CString](../../atl-mfc-shared/reference/cstringt-class.md)オブジェクト。

### <a name="remarks"></a>解説

ダイアログ ボックスは、OFN_EXPLORER スタイルで作成されている必要があります。それ以外の場合、メソッドはアサーションで失敗します。

このメソッドは、ダイアログ ボックスが表示されている間のみ呼び出すことができます。 ダイアログ ボックスを閉じると、この関数は機能しなくなり、メソッドはアサーションで失敗します。

## <a name="cfiledialoggetifiledialogcustomize"></a><a name="getifiledialogcustomize"></a>ファイルダイアログ::GetIFileダイアログをカスタマイズ

指定された[CFileDialog](../../mfc/reference/cfiledialog-class.md)の内部 COM オブジェクトへのポインターを取得します。

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>戻り値

の内部 COM オブジェクトへのポインター。 `CFileDialog` このポインタを適切に解放するのは、お客様の責任です。

### <a name="remarks"></a>解説

この関数は *、bVistaStyle*が TRUE に設定されているオブジェクトを持つ Windows Vista 以降でのみ使用します。 *bVistaStyle*が FALSE のときにこの関数を使用する場合、リリース モードでは NULL を返し、デバッグ モードでアサーションをスローします。

インターフェイスの`IFileDialogCustomize`詳細については、「 [IFileDialog カスタマイズ](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)」を参照してください。

### <a name="example"></a>例

この例では、内部 COM オブジェクトを取得します。 このコード例を実行するには、Windows Vista 以降でコンパイルする必要があります。

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

## <a name="cfiledialoggetifileopendialog"></a><a name="getifileopendialog"></a>ファイルダイアログ::GetIFileOpenダイアログ

指定`CFileDialog`された内部 COM オブジェクトへのポインターを取得します。

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>戻り値

の内部 COM オブジェクトへのポインター。 `CFileDialog` このポインタを適切に解放するのは、お客様の責任です。

### <a name="remarks"></a>解説

この関数は *、bVistaStyle*が TRUE に設定されているオブジェクトを持つ Windows Vista 以降でのみ使用します。 この関数は、 が`CFileDialog` **[開く**] ダイアログ ボックスでない場合、または*bVistaStyle*が FALSE に設定されている場合は NULL を返します。 この最後のケースでは、関数はリリース モードでのみ NULL を返します 。

インターフェイスの`IFileOpenDialog`詳細については[、「IFileOpenDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog)」を参照してください。

### <a name="example"></a>例

この例では、内部 COM オブジェクトを取得します。 このコードを実行するには、Windows Vista 以降でコンパイルする必要があります。

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

## <a name="cfiledialoggetifilesavedialog"></a><a name="getifilesavedialog"></a>ファイルダイアログ::取得ファイル保存ダイアログ

指定`CFileDialog`された内部 COM オブジェクトへのポインターを取得します。

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>戻り値

の内部 COM オブジェクトへのポインター。 `CFileDialog` このポインタを適切に解放するのは、お客様の責任です。

### <a name="remarks"></a>解説

この関数は *、bVistaStyle*が TRUE に設定されているオブジェクトを持つ Windows Vista 以降でのみ使用します。 この関数は、`CFileDialog`が **[保存**] ダイアログ ボックスでない場合、または*bVistaStyle*が FALSE に設定されている場合は NULL を返します。 この最後のケースでは、関数はリリース モードでのみ NULL を返します 。

インターフェイスの`IFileSaveDialog`詳細については[、「IFileSaveDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog)」を参照してください。

### <a name="example"></a>例

この例では、内部 COM オブジェクトを取得します。 このコード例を実行するには、Windows Vista 以降でコンパイルする必要があります。

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

## <a name="cfiledialoggetnextpathname"></a><a name="getnextpathname"></a>ファイルダイアログ::次のパス名を取得します。

ダイアログ ボックスで選択したグループから次のファイル名を取得します。

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>パラメーター

*pos*<br/>
前`GetNextPathName`の呼び出しまたは`GetStartPosition`関数呼び出しによって返された POSITION 値への参照。 リストの末尾に達した場合は NULL。

### <a name="return-value"></a>戻り値

ファイルの完全パス名を返します。

### <a name="remarks"></a>解説

ファイル名のパスには、ファイルのタイトルとディレクトリパス全体が含まれます。 たとえば、"C:\FILES\TEXT"`GetNextPathName`を返します。ファイル C:\FILES\TEXT.DAT の DAT" 。 の呼び`GetNextPathName`出しで初期位置を確立する場合は、順方向反復ループ`GetStartPosition`で使用できます。

選択したファイルが 1 つのみの場合、そのファイル名が返されます。

## <a name="cfiledialoggetofn"></a><a name="getofn"></a>ファイルダイアログ::ゲットフン

関連付けられた`OPENFILENAME`構造体を取得します。

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>戻り値

[ファイル名を開く](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体。

### <a name="remarks"></a>解説

この関数の 2 番目のバージョンを使用して、作成後、メンバー関数で表示される前に、[**ファイルを開く]** または`DoModal`**[名前を付けて保存]** ダイアログ ボックスの外観を初期化します。 たとえば、ダイアログ ボックスに`lpstrTitle`設定するキャプション`m_ofn`に対してのメンバーを設定できます。

## <a name="cfiledialoggetpathname"></a><a name="getpathname"></a>ファイルダイアログ::パス名を取得します。

ダイアログ ボックスに入力されたファイルの完全パスを取得します。

```
CString GetPathName() const;
```

### <a name="return-value"></a>戻り値

ファイルの完全パス名を返します。

### <a name="remarks"></a>解説

ファイル名のパスには、ファイルのタイトルとディレクトリパス全体が含まれます。 たとえば、"C:\FILES\TEXT"`GetPathName`を返します。ファイル C:\FILES\TEXT.DAT の DAT" 。

OFN_ALLOWMULTISELECT`m_ofn.Flags`フラグが設定されている場合、この文字列には一連のヌル・テミタイド文字列が含まれます。 このため、[メンバー](#getstartposition)関数を使用して、リスト内[GetNextPathName](#getnextpathname)の次のファイル名を取得します。

### <a name="example"></a>例

  [:D 次](#domodal)の例を参照してください。

## <a name="cfiledialoggetreadonlypref"></a><a name="getreadonlypref"></a>ファイルダイアログ::読み取り専用プルーフ

Windows の標準の [ファイルを開く] ダイアログ ボックスと [名前を付けて保存] ダイアログ ボックスで [読み取り専用] チェック ボックスがオンになっているかどうかを調べます。

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>戻り値

ダイアログ ボックスの [読み取り専用] チェック ボックスがオンの場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="remarks"></a>解説

コンストラクターでOFN_HIDEREADONLYスタイルを設定すると、[読み取り専用]`CFileDialog`チェック ボックスを非表示にすることができます。

> [!NOTE]
> Windows Vista 以降`CFileDialog`のスタイル オブジェクトでは、この機能はサポートされていません。 Windows Vista 以降のスタイル`CFileDialog`でこの関数を使用しようとすると[、CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)がスローされます。

## <a name="cfiledialoggetresult"></a><a name="getresult"></a>ファイルダイアログ::結果を取得します

ダイアログでユーザーが選択した項目を取得します。

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>戻り値

ユーザーの選択を表す IShellItem へのポインター。

### <a name="remarks"></a>解説

## <a name="cfiledialoggetresults"></a><a name="getresults"></a>ファイルダイアログ::結果を取得します

複数の選択を許可するダイアログボックスでユーザーの選択を取得します。

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>戻り値

ダイアログで選択された項目にアクセスできる IShellItemArray へのポインター。

### <a name="remarks"></a>解説

## <a name="cfiledialoggetselectedcontrolitem"></a><a name="getselectedcontrolitem"></a>を選択しました。

ダイアログ内の指定されたコンテナー コントロールから特定の項目を取得します。

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コンテナー コントロールの ID。

*ドウィッドIDアイテム*<br/>
ユーザーがコントロールで選択した項目の ID。

### <a name="remarks"></a>解説

## <a name="cfiledialoggetstartposition"></a><a name="getstartposition"></a>ファイルダイアログ::取得位置

OFN_ALLOWMULTISELECT フラグが設定されている場合`m_ofn.Flags`、リスト内の最初のファイル パス名の位置を取得します。

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>戻り値

反復処理に使用できる POSITION 値。リストが空の場合は NULL。

## <a name="cfiledialoghidecontrol"></a><a name="hidecontrol"></a>ファイルダイアログ::コントロールを非表示にする

エクスプローラ形式の [開く] または [名前を付けて保存] コモン ダイアログ ボックスで、指定したコントロールを非表示にします。

```cpp
void HideControl(int nID);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
非表示にするコントロールの ID。

### <a name="remarks"></a>解説

ダイアログ ボックスは、OFN_EXPLORER スタイルで作成されている必要があります。それ以外の場合、関数はアサーションで失敗します。

## <a name="cfiledialogispickfoldersmode"></a><a name="ispickfoldersmode"></a>ファイルダイアログ::イスピックフォルダモード

現在のダイアログがフォルダ ピッカー モードかどうかを判断します。

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>戻り値

ダイアログがフォルダー ピッカー モードの場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

## <a name="cfiledialogm_ofn"></a><a name="m_ofn"></a>ファイルダイアログ::m_ofn

`m_ofn`型の構造体です`OPENFILENAME`。 この構造体のデータは、 の現在の状態`CFileDialog`を表します。

### <a name="remarks"></a>解説

この構造体を使用して[、DoModal](#domodal)メソッドを使用して表示する前に、構成後に [**ファイルを開く]** または [**名前を付けて保存]** ダイアログ ボックスの外観を初期化します。 たとえば、ダイアログ ボックスに設定するキャプション`m_ofn`に *、lpstrTitle*メンバーを設定できます。

Windows Vista 以降のスタイルの[CFileDialog](../../mfc/reference/cfiledialog-class.md)では`m_ofn`、ダイアログ ボックスの状態と常に一致する保証はありません。 これは、以前のバージョンの Windows のダイアログ ボックスと同期されます。 Windows Vista 以降の`m_ofn`下での構造と`CFileDialog`状態の同期の詳細については[、「CFileDialog::ApplyOFNToShellDialog」](#applyofntoshelldialog)および[「Cファイルダイアログ::UpdateOFNFromShellDialog」](#updateofnfromshelldialog)を参照してください。

Windows Vista 以降のスタイル ファイル ダイアログでは、 の特定の`CFileDialog`メンバとフラグがサポートされていません。 その結果、これらは何の効果もありません。

Windows Vista 以降ではサポートされていないメンバの一覧を次に示します。

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

次のフラグはサポートされていないため、Windows Vista 以降の`CFileDialog`スタイルを使用する場合は効果がありません。

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- Ofn_explorer

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES - Windows Vista 以降で常に有効

- OFN_NOLONGNAMES - Windows Vista 以降では常にオフにする

- OFN_NONETWORKBUTTON - Windows Vista 以降で常に有効

- OFN_READONLY

- OFN_SHOWHELP

この構造体の詳細については、Windows SDK の[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体を参照してください。

## <a name="cfiledialogmakeprominent"></a><a name="makeprominent"></a>ファイルダイアログ::メイク・チェンジ・スチュプ

コントロールをダイアログに配置して、他のコントロールと比較して目立つようにします。

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コントロールの ID。

### <a name="remarks"></a>解説

## <a name="cfiledialogonbuttonclicked"></a><a name="onbuttonclicked"></a>ダイアログ::ボタンクリック

ボタンがクリックされたときに呼び出されます。

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
ボタンの ID。

### <a name="remarks"></a>解説

## <a name="cfiledialogoncheckbuttontoggled"></a><a name="oncheckbuttontoggled"></a>ウィンドウダイアログ::オンチェックボタン切り替え

チェック ボックスがオンまたはオフのときに呼び出されます。

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
チェック ボックスの ID。

*bチェック*<br/>
オンまたはオフ。

### <a name="remarks"></a>解説

## <a name="cfiledialogoncontrolactivating"></a><a name="oncontrolactivating"></a>ファイルダイアログ::オンコントロールアクティベート

コントロールがアクティブになったときに呼び出されます。

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コントロールの ID。

### <a name="remarks"></a>解説

## <a name="cfiledialogonfilenamechange"></a><a name="onfilenamechange"></a>ファイルダイアログ::オンファイル名変更

WM_NOTIFYCDN_SELCHANGE メッセージを処理する場合は、このメソッドをオーバーライドします。

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>解説

[**ファイルを開く**] または [**名前を付けて保存**] ダイアログ ボックスのファイル 一覧で新しいファイルまたはフォルダを選択すると、CDN_SELCHANGE メッセージが送信されます。 このメッセージに応答してアクションを実行する場合は、このメソッドをオーバーライドします。

このメッセージは、ダイアログボックスがOFN_EXPLORERフラグをオンにして作成された場合にのみ送信されます。 通知の詳細については、「 [CDN_SELCHANGE](/windows/win32/dlgbox/cdn-selchange)」 を参照してください。 OFN_EXPLORER フラグの詳細については[、OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体および[[開く] および [名前を付けて保存] ダイアログ ボックス](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)を参照してください。

## <a name="cfiledialogonfilenameok"></a><a name="onfilenameok"></a>ファイルダイアログ::オンファイル名OK

共通ファイルダイアログボックスに入力されたファイル名をカスタム検証する場合にのみ、この関数をオーバーライドします。

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>戻り値

ファイル名が有効なファイル名でない場合は 1。それ以外の場合は 0。

### <a name="remarks"></a>解説

この機能を使用すると、アプリケーション固有の理由でファイル名を拒否できます。 通常、この関数を使用する必要はありません、フレームワークは、ファイル名の既定の検証を提供し、無効なファイル名が入力された場合は、メッセージ ボックスを表示します。

1 が返された場合、ダイアログボックスはユーザーが別のファイル名を入力するために表示されたままになります。 戻り値が 0 の場合、ダイアログ プロシージャはダイアログを閉じます。 他の 0 以外の戻り値は現在予約されているため、使用しないでください。

## <a name="cfiledialogonfolderchange"></a><a name="onfolderchange"></a>ファイルダイアログ::オンフォルダチェンジ

WM_NOTIFYCDN_FOLDERCHANGE メッセージを処理するには、この関数をオーバーライドします。

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>解説

通知メッセージは、[開く] または [名前を付けて保存] ダイアログ ボックスで新しいフォルダを開いたときに送信されます。

通知は、ダイアログ ボックスが OFN_EXPLORER スタイルで作成された場合にのみ送信されます。 通知の詳細については[、「CDN_FOLDERCHANGE」](/windows/win32/dlgbox/cdn-folderchange)を参照してください。 OFN_EXPLORERスタイルの詳細については[、OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体および[「開く」および「名前を付けて保存」ダイアログボックス](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)を参照してください。

## <a name="cfiledialogoninitdone"></a><a name="oninitdone"></a>ファイルダイアログ::オンイニットDone

WM_NOTIFYCDN_INITDONE メッセージを処理するには、この関数をオーバーライドします。

```
virtual void OnInitDone();
```

### <a name="remarks"></a>解説

[**開く**] または [**名前を付けて保存**] ダイアログ ボックスでコントロールの配置が完了すると、システムはこの通知メッセージを送信し、子ダイアログ ボックスのコントロール用の領域を確認します。

ダイアログ ボックスがOFN_EXPLORERスタイルで作成された場合にのみ、このメッセージが送信されます。 通知の詳細については、「 [CDN_INITDONE](/windows/win32/dlgbox/cdn-initdone)」を参照してください。 OFN_EXPLORERスタイルの詳細については[、OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体および[「開く」および「名前を付けて保存」ダイアログボックス](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)を参照してください。

> [!NOTE]
> Windows Vista 以降のスタイル ファイル ダイアログでは、この機能はサポートされていません。 Windows Vista 以降のスタイル ファイル ダイアログでこの関数を使用しようとすると[、CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)がスローされます。

## <a name="cfiledialogonitemselected"></a><a name="onitemselected"></a>ファイルダイアログ::オンアイテム選択

コンテナー項目が選択されたときに呼び出されます。

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コンテナー コントロールの ID。

*ドウィッドIDアイテム*<br/>
項目の ID。

### <a name="remarks"></a>解説

## <a name="cfiledialogonlbselchangednotify"></a><a name="onlbselchangednotify"></a>ファイルダイアログ::オンルプセル変更通知

この関数は、リスト ボックス内の現在の選択項目が変更されようとしているときに呼び出されます。

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>パラメーター

*NIDボックス*<br/>
選択が行われたリスト ボックスまたはコンボ ボックスの ID。

*アイクルセル*<br/>
現在の選択範囲のインデックス。

*nコード*<br/>
コントロール通知コード。 このパラメーターには、次のいずれかの値が必要です。

- CD_LBSELCHANGE *iCurSel*を単一選択リスト ボックス内の選択項目として指定します。

- CD_LBSELSUB *iCurSel*が複数選択リスト ボックスで選択されなくなることを指定します。

- CD_LBSELADD複数選択リスト ボックスで*iCurSel*が選択されていることを指定します。

- CD_LBSELNOITEMS複数選択リスト ボックスに選択が存在しない場合に指定します。

### <a name="remarks"></a>解説

リスト ボックスの選択変更をカスタム処理するには、この関数をオーバーライドします。 たとえば、この関数を使用して、ユーザーが選択した各ファイルのアクセス権または最終更新日を表示できます。

## <a name="cfiledialogonshareviolation"></a><a name="onshareviolation"></a>ファイルダイアログ::オンシェア違反

共有違反のカスタム処理を提供するには、この関数をオーバーライドします。

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>パラメーター

*パス名*<br/>
共有違反が発生したファイルのパス。

### <a name="return-value"></a>戻り値

次のいずれかの値:

- OFN_SHAREFALLTHROUGH ダイアログ ボックスからファイル名が返されます。

- OFN_SHARENOWARN これ以上のアクションを実行する必要はありません。

- OFN_SHAREWARN ユーザーにこのエラーに対する標準の警告メッセージが表示されます。

### <a name="remarks"></a>解説

通常、フレームワークは共有違反の既定のチェックを提供し、共有違反が発生した場合はメッセージ ボックスを表示するため、この関数を使用する必要はありません。

共有違反チェックを無効にする場合は、ビットごとの OR 演算子を使用してフラグ`m_ofn.Flags`OFN_SHAREAWARE を と結合します。

## <a name="cfiledialogontypechange"></a><a name="ontypechange"></a>ファイルダイアログ::オンタイプチェンジ

WM_NOTIFYCDN_TYPECHANGE メッセージを処理するには、この関数をオーバーライドします。

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>解説

通知メッセージは、ユーザーが [開く] または [名前を付けて保存] ダイアログ ボックスのファイルの種類の一覧から新しいファイルの種類を選択すると送信されます。

通知は、ダイアログ ボックスが OFN_EXPLORER スタイルで作成された場合にのみ送信されます。 通知の詳細については[、「CDN_TYPECHANGE」](/windows/win32/dlgbox/cdn-typechange)を参照してください。 OFN_EXPLORERスタイルの詳細については[、OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体および[「開く」および「名前を付けて保存」ダイアログボックス](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)を参照してください。

## <a name="cfiledialogremovecontrolitem"></a><a name="removecontrolitem"></a>コントロールアイテムを削除します。

ダイアログ内のコンテナー コントロールから項目を削除します。

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
項目を削除するコンテナー コントロールの ID。

*ドウィッドIDアイテム*<br/>
項目の ID。

### <a name="remarks"></a>解説

## <a name="cfiledialogsetcheckbuttonstate"></a><a name="setcheckbuttonstate"></a>ウィンドウダイアログ::セットチェックボタン状態

ダイアログボックスのチェックボタン(チェックボックス)の現在の状態を設定します。

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
チェック ボックスの ID。

*bチェック*<br/>
チェック ボックスの状態。 TRUE はチェック済みであることを示します。FALSE はチェックなしを示します。

### <a name="remarks"></a>解説

## <a name="cfiledialogsetcontrolitemstate"></a><a name="setcontrolitemstate"></a>をクリックします。

ダイアログボックスで見つかったコンテナー コントロール内の項目の現在の状態を設定します。

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コンテナー コントロールの ID。

*ドウィッドIDアイテム*<br/>
項目の ID。

*dwステート*<br/>
コントロールの新しい状態を示す CDCONTROLSTATE 列挙体の 1 つ以上の値。

### <a name="remarks"></a>解説

## <a name="cfiledialogsetcontrolitemtext"></a><a name="setcontrolitemtext"></a>ダイアログボックス::コントロールアイテムテキスト

コントロール項目のテキストを設定します。 たとえば、ラジオ ボタンやメニューの項目に付随するテキストです。

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コンテナー コントロールの ID。

*ドウィッドIDアイテム*<br/>
項目の ID。

*ストラベル*<br/>
項目のテキスト。

### <a name="remarks"></a>解説

## <a name="cfiledialogsetcontrollabel"></a><a name="setcontrollabel"></a>ファイルダイアログ::コントロールラベルを設定します。

ボタン のテキストやエディット ボックスのラベルなど、コントロールに関連付けられたテキストを設定します。

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コントロールの ID。

*ストラベル*<br/>
コントロール名。

### <a name="remarks"></a>解説

## <a name="cfiledialogsetcontrolstate"></a><a name="setcontrolstate"></a>ファイルダイアログ::コントロールステートを設定します。

特定のコントロールの現在の表示と有効な状態を設定します。

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コントロールの ID。

*dwステート*<br/>
コントロールの現在の状態を示す CDCONTROLSTATE 列挙体の 1 つ以上の値。

### <a name="remarks"></a>解説

## <a name="cfiledialogsetcontroltext"></a><a name="setcontroltext"></a>ダイアログボックス::コントロールテキストを設定します。

エクスプローラスタイルの **[開く**] または [**名前を付けて保存**] ダイアログ ボックスで、指定したコントロールのテキストを設定します。

```cpp
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
[in]テキストを設定するコントロールの ID。

*lpsz*<br/>
[in]コントロールに設定するテキストを含む文字列へのポインター。

### <a name="remarks"></a>解説

この関数の両方のバージョンは、Unicode を使用するアプリケーションに対して有効です。 ただし、ANSI を使用するアプリケーションでは、LPCSTR 型のバージョンのみが有効です。

この方法を使用するには、OFN_EXPLORER スタイルを使用してダイアログ ボックスを作成する必要があります。 それ以外の場合、関数はアサーションで失敗します。

## <a name="cfiledialogsetdefext"></a><a name="setdefext"></a>ファイルダイアログ::セットデフエクスク

エクスプローラ形式の [開く] または [名前を付けて保存] コモン ダイアログ ボックスの既定のファイル名拡張子を設定します。

```cpp
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>パラメーター

*lpsz*<br/>
ダイアログ ボックス オブジェクトに使用する既定の拡張子を含む文字列へのポインター。 この文字列にはピリオド (.) を含めることはできません。

### <a name="remarks"></a>解説

ダイアログ ボックスは、OFN_EXPLORER スタイルで作成されている必要があります。それ以外の場合、関数はアサーションで失敗します。

## <a name="cfiledialogseteditboxtext"></a><a name="seteditboxtext"></a>ファイルダイアログ::セットエディットボックステキスト

エディット ボックス コントロールの現在のテキストを設定します。

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
エディット ボックスの ID。

*str テキスト*<br/>
テキスト値。

### <a name="remarks"></a>解説

## <a name="cfiledialogsetproperties"></a><a name="setproperties"></a>ファイルダイアログ::プロパティを設定します。

保存される項目に対して使用される既定値を定義するプロパティ ストアを提供します。

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>パラメーター

*一覧*<br/>
";" で区切られた定義済みプロパティのリスト。 フラグのリストについては[、OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)の**フラグ**セクションを参照してください。

### <a name="remarks"></a>解説

## <a name="cfiledialogsetselectedcontrolitem"></a><a name="setselectedcontrolitem"></a>を選択しました。

ダイアログ ボックス内のオプション ボタン グループまたはコンボ ボックス内の特定の項目の選択状態を設定します。

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
コンテナー コントロールの ID。

*ドウィッドIDアイテム*<br/>
ユーザーがコントロールで選択した項目の ID。

### <a name="remarks"></a>解説

## <a name="cfiledialogsettemplate"></a><a name="settemplate"></a>ファイルダイアログ::テンプレートを設定します。

[オブジェクトの](../../mfc/reference/cfiledialog-class.md)ダイアログ ボックス テンプレートを設定します。

```cpp
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>パラメーター

*nWin3ID*<br/>
[in]非エクスプローラ`CFileDialog`オブジェクトのテンプレート リソースの ID 番号を格納します。 このテンプレートは、Windows NT 3.51 で使用されるか、またはOFN_EXPLORER スタイルが存在しない場合にのみ使用されます。

*nWin4ID*<br/>
[in]エクスプローラー`CFileDialog`オブジェクトのテンプレート リソースの ID 番号が含まれます。 このテンプレートは、Windows NT 4.0 以降のバージョン、Windows 95 以降のバージョン、またはOFN_EXPLORERスタイルが存在する場合にのみ使用されます。

*をクリックします。*<br/>
[in]非エクスプローラ`CFileDialog`オブジェクトのテンプレート リソースの名前を格納します。 このテンプレートは、Windows NT 3.51 で使用されるか、またはOFN_EXPLORER スタイルが存在しない場合にのみ使用されます。

*をクリックします。*<br/>
[in]エクスプローラー`CFileDialog`オブジェクトのテンプレート リソースの名前が含まれます。 このテンプレートは、Windows NT 4.0 以降のバージョン、Windows 95 以降のバージョン、またはOFN_EXPLORERスタイルが存在する場合にのみ使用されます。

### <a name="remarks"></a>解説

システムは、指定されたテンプレートの 1 つだけを使用します。 システムは、OFN_EXPLORERスタイルの有無と、アプリケーションが実行されているオペレーティング システムに基づいて、使用するテンプレートを決定します。 エクスプローラ以外のテンプレートとエクスプローラ スタイルのテンプレートの両方を指定することで、Windows NT 3.51、Windows NT 4.0 以降のバージョン、および Windows 95 以降のバージョンを簡単にサポートできます。

> [!NOTE]
> Windows Vista 以降のスタイル ファイルダイアログ ボックスでは、この機能はサポートされていません。 Windows Vista 以降のスタイル ファイルダイアログ ボックスでこの関数を使用しようとすると[、CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)がスローされます。 別の方法として、カスタマイズされたダイアログを使用することもできます。 カスタム`CFileDialog`の使用方法の詳細については、「 [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)」を参照してください。

## <a name="cfiledialogstartvisualgroup"></a><a name="startvisualgroup"></a>ファイルダイアログ::開始ビジュアルグループ

ダイアログでビジュアル グループを宣言します。 以降の "add" メソッドの呼び出しは、これらの要素をこのグループに追加します。

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*をクリックします。*<br/>
ビジュアル グループの ID。

*ストラベル*<br/>
グループ名。

### <a name="remarks"></a>解説

## <a name="cfiledialogupdateofnfromshelldialog"></a><a name="updateofnfromshelldialog"></a>ファイルダイアログ::ダイアログ

内部オブジェクト`m_ofn`の現在の状態に基づいて[、CFileDialog](../../mfc/reference/cfiledialog-class.md)のデータ構造を更新します。

```cpp
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>解説

Windows Vista より前のバージョンの Windows では、メンバ[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamea)データ構造体が、`CFileDialog`の状態と継続的に同期されていました。 [m_ofn](#m_ofn)メンバー変数に対する変更は、ダイアログ ボックスの状態に直接影響を与えました。 また、ダイアログの状態に対する変更により、m_ofn メンバー変数が直ちに更新されます。

Windows Vista 以降では、`m_ofn`データ構造は自動的には更新されません。 メンバー変数のデータの正確性を`m_ofn`保証するには、データにアクセスする前に`UpdateOFNFromShellDialog`関数を呼び出す必要があります。 この関数は[、IFileDialog::OnFileOK](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok)の処理中に自動的に呼び出されます。

Windows Vista 以降の下で`CFileDialog`クラスを使用する方法の詳細については[、「CFileDialog クラス](../../mfc/reference/cfiledialog-class.md)」を参照してください。

### <a name="example"></a>例

この例では、`CFileDialog`表示する前に を更新します。 メンバ変数を更新`m_ofn`する前に、ダイアログ ボックスの現在の状態に同期する必要があります。

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>関連項目

[クラス](../../mfc/reference/ccommondialog-class.md)<br/>
[階層グラフ](../../mfc/hierarchy-chart.md)
