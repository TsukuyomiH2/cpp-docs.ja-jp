---
title: CTreeCtrl Class
ms.date: 11/04/2016
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
ms.openlocfilehash: 6fe7b133fa01285f85dc28dc8d8ca01e027f4a5c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81373307"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

Windows コモン ツリー ビュー コントロールの機能が用意されています。

## <a name="syntax"></a>構文

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[C ツリーCtrl::CツリーCtrl](#ctreectrl)|`CTreeCtrl` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[作成](#create)|ツリー ビュー コントロールを作成し、`CTreeCtrl`オブジェクトにアタッチします。|
|[をクリックします。](#createdragimage)|指定したツリー ビュー アイテムのドラッグ ビットマップを作成します。|
|[C ツリーCtrl::作成Ex](#createex)|指定した Windows 拡張スタイルを使用してツリー コントロールを作成し`CTreeCtrl`、オブジェクトにアタッチします。|
|[アイテム一:D](#deleteallitems)|ツリー ビュー コントロール内のすべての項目を削除します。|
|[:Dエレテアイテム](#deleteitem)|ツリー ビュー コントロールの新しいアイテムを削除します。|
|[をクリックします。](#editlabel)|指定したツリー ビュー アイテムをインプレースで編集します。|
|[今すぐラベルを編集します。](#endeditlabelnow)|現在のツリー ビュー コントロールのツリー ビュー アイテムのラベルに対する編集操作をキャンセルします。|
|[CツリーCtrl::保証Visible](#ensurevisible)|ツリー ビュー アイテムがツリー ビュー コントロールに表示されるようにします。|
|[C ツリーCtrl::展開](#expand)|指定したツリー ビュー アイテムの子アイテムを展開または折りたたみます。|
|[をクリックします。](#getbkcolor)|コントロールの現在の背景色を取得します。|
|[をチェックします。](#getcheck)|ツリー コントロール項目のチェック状態を取得します。|
|[を取得します。](#getchilditem)|指定したツリー ビュー アイテムの子を取得します。|
|[カウントを取得します。](#getcount)|ツリー ビュー コントロールに関連付けられているツリー項目の数を取得します。|
|[をクリックします。](#getdrophilightitem)|ドラッグ アンド ドロップ操作のターゲットを取得します。|
|[コントロールを編集します。](#geteditcontrol)|指定したツリー ビュー アイテムの編集に使用するエディット コントロールのハンドルを取得します。|
|[を使用します。](#getextendedstyle)|現在のツリー ビュー コントロールで使用されている拡張スタイルを取得します。|
|[を見る](#getfirstvisibleitem)|指定したツリー ビュー アイテムの最初の表示項目を取得します。|
|[を使用します。](#getimagelist)|ツリー ビュー コントロールに関連付けられているイメージ リストのハンドルを取得します。|
|[を行います。](#getindent)|ツリー ビューアイテムのオフセット (ピクセル単位) を親から取得します。|
|[をクリックします。](#getinsertmarkcolor)|ツリー ビューの挿入マークの描画に使用する色を取得します。|
|[を取得します。](#getitem)|指定したツリー ビュー アイテムの属性を取得します。|
|[を取得します。](#getitemdata)|項目に関連付けられているアプリケーション固有の値を返します。|
|[イメージインデックスを取得します。](#getitemexpandedimageindex)|現在のツリー ビュー コントロールの指定した項目が展開された状態のときに表示するイメージのインデックスを取得します。|
|[をクリックします。](#getitemheight)|ツリー ビュー項目の現在の高さを取得します。|
|[を使用します。](#getitemimage)|項目に関連付けられているイメージを取得します。|
|[をクリックします。](#getitempartrect)|現在のツリー ビュー コントロールの指定した項目の指定した部分に外接する四角形を取得します。|
|[をクリックします。](#getitemrect)|ツリー ビューアイテムの外接する四角形を取得します。|
|[を使用します。](#getitemstate)|項目の状態を返します。|
|[を使用します。](#getitemstateex)|現在のツリー ビュー コントロール内の指定された項目の拡張状態を取得します。|
|[をクリックします。](#getitemtext)|項目のテキストを返します。|
|[を見る](#getlastvisibleitem)|現在のツリー ビュー コントロール内の最後に展開された項目を取得します。|
|[をクリックします。](#getlinecolor)|ツリー ビュー コントロールの現在の線の色を取得します。|
|[次の項目を取得します。](#getnextitem)|指定したリレーションシップに一致する次のツリー ビュー アイテムを取得します。|
|[次の兄弟アイテムを取得します。](#getnextsiblingitem)|指定したツリー ビューアイテムの次の兄弟を取得します。|
|[次に見えるアイテムを取得します。](#getnextvisibleitem)|指定したツリー ビュー アイテムの次に表示される項目を取得します。|
|[を取得します。](#getparentitem)|指定したツリー ビュー アイテムの親を取得します。|
|[を使用します。](#getprevsiblingitem)|指定したツリー ビューアイテムの前の兄弟を取得します。|
|[を見る](#getprevvisibleitem)|指定したツリー ビュー アイテムの前に表示されている項目を取得します。|
|[を取得します。](#getrootitem)|指定したツリー ビュー アイテムのルートを取得します。|
|[を見る](#getscrolltime)|ツリー ビュー コントロールの最大スクロール時間を取得します。|
|[を選択しました。](#getselectedcount)|現在のツリー ビュー コントロールで選択されている項目の数を取得します。|
|[を選択しました。](#getselecteditem)|現在選択されているツリー ビューアイテムを取得します。|
|[をクリックします。](#gettextcolor)|コントロールの現在のテキストの色を取得します。|
|[ヒントを取得します。](#gettooltips)|ツリー ビュー コントロールで使用される子ツールヒント コントロールのハンドルを取得します。|
|[を見る](#getvisiblecount)|ツリー ビュー コントロールに関連付けられている表示可能なツリー項目の数を取得します。|
|[ヒットテスト](#hittest)|オブジェクトに関連するカーソルの現在位置を`CTreeCtrl`返します。|
|[アイテムを挿入します。](#insertitem)|ツリー ビュー コントロールに新しい項目を挿入します。|
|[子供たちを抱えています。](#itemhaschildren)|指定した項目に子項目がある場合は、0 以外を返します。|
|[をクリックします。](#mapaccidtoitem)|指定されたアクセシビリティ識別子を、現在のツリー ビュー コントロールのツリー ビュー アイテムにハンドルに割り当てます。|
|[をクリックします。](#mapitemtoaccid)|指定されたハンドルを現在のツリー ビュー コントロールのツリー ビュー アイテムに、ユーザー補助識別子に割り当てます。|
|[C ツリーCtrl::選択](#select)|指定したツリー ビューアイテムを選択、スクロールして表示、または再描画します。|
|[を選択します。](#selectdroptarget)|ドラッグ アンド ドロップ操作のターゲットとしてツリー項目を再描画します。|
|[アイテムを選択します。](#selectitem)|指定したツリー ビュー アイテムを選択します。|
|[最初に表示されます。](#selectsetfirstvisible)|最初に表示される項目として、指定したツリー ビュー アイテムを選択します。|
|[を設定します。](#setautoscrollinfo)|現在のツリー ビュー コントロールの自動スクロール速度を設定します。|
|[をクリックします。](#setbkcolor)|コントロールの背景色を設定します。|
|[を設定します。](#setcheck)|ツリー コントロール項目のチェック状態を設定します。|
|[を使用します。](#setextendedstyle)|現在のツリー ビュー コントロールの拡張スタイルを設定します。|
|[を一覧表示します。](#setimagelist)|ツリー ビュー コントロールに関連付けられているイメージ リストのハンドルを設定します。|
|[を設定します。](#setindent)|親からツリー ビュー アイテムのオフセットをピクセル単位で設定します。|
|[を挿入します。](#setinsertmark)|ツリー ビュー コントロールの挿入マークを設定します。|
|[カラーを挿入します。](#setinsertmarkcolor)|ツリー ビューの挿入マークの描画に使用する色を設定します。|
|[を設定します。](#setitem)|指定したツリー ビュー アイテムの属性を設定します。|
|[を使用します。](#setitemdata)|項目に関連付けられたアプリケーション固有の値を設定します。|
|[イメージインデックスを作成します。](#setitemexpandedimageindex)|現在のツリー ビュー コントロールの指定した項目が展開状態のときに表示するイメージのインデックスを設定します。|
|[をクリックします。](#setitemheight)|ツリー ビューアイテムの高さを設定します。|
|[を使用します。](#setitemimage)|イメージを項目に関連付けます。|
|[を使用します。](#setitemstate)|項目の状態を設定します。|
|[を使用します。](#setitemstateex)|現在のツリー ビュー コントロール内の指定された項目の拡張状態を設定します。|
|[をクリックします。](#setitemtext)|項目のテキストを設定します。|
|[をクリックします。](#setlinecolor)|ツリー ビュー コントロールの現在の線の色を設定します。|
|[を設定します。](#setscrolltime)|ツリー ビュー コントロールの最大スクロール時間を設定します。|
|[をクリックします。](#settextcolor)|コントロールのテキストの色を設定します。|
|[ヒントを設定します。](#settooltips)|ツリー ビュー コントロールの子ツールヒント コントロールを設定します。|
|[を見る](#showinfotip)|現在のツリー ビュー コントロール内の指定した項目の情報を表示します。|
|[子供の並べ替え](#sortchildren)|指定した親アイテムの子を並べ替えます。|
|[CツリーCtrl::ソートチルドレンCB](#sortchildrencb)|アプリケーション定義の並べ替え関数を使用して、指定した親アイテムの子を並べ替えます。|

## <a name="remarks"></a>解説

"ツリー ビュー コントロール" は、ドキュメント内の見出し、インデックス内のエントリ、ディスク上のファイルとディレクトリなど、項目の階層リストを表示するウィンドウです。 各項目は、ラベルとオプションのビットマップ イメージで構成され、各項目にはサブ項目のリストを関連付けることができます。 項目をクリックすると、関連付けられているサブ項目のリストを展開したり折りたたんだりできます。

このコントロール (および`CTreeCtrl`クラス) は、Windows 98 および Windows NT バージョン 4 以降で実行されているプログラムでのみ使用できます。

の使用`CTreeCtrl`の詳細については、以下を参照してください。

- [コントロール](../../mfc/controls-mfc.md)

- [CTreeCtrl の使い方](../../mfc/using-ctreectrl.md)

- Windows SDK の[ツリー ビュー コントロールリファレンス](/windows/win32/Controls/tree-view-control-reference)。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxcmn.h

## <a name="ctreectrlcreate"></a><a name="create"></a>作成

ダイアログ ボックス テンプレートでツリー コントロールを指定するか[、CTreeView](../../mfc/reference/ctreeview-class.md)を使用している場合は、ダイアログ ボックスまたはビューの作成時にツリー コントロールが自動的に作成されます。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*Dwstyle*<br/>
ツリー ビュー コントロールのスタイルを指定します。 [「ウィンドウの作成](/windows/win32/api/winuser/nf-winuser-createwindoww)」で説明されているウィンドウ スタイルと、Windows SDK で説明されているように[、ツリー ビュー コントロール スタイル](/windows/win32/Controls/tree-view-control-window-styles)の任意の組み合わせを適用します。

*Rect*<br/>
ツリー ビュー コントロールのサイズと位置を指定します。 [CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは[RECT](/previous-versions/dd162897\(v=vs.85\))構造体を指定できます。

*pParentWnd*<br/>
ツリー ビュー コントロールの親ウィンドウを指定します`CDialog`。 NULL にすることはできません。

*nID*<br/>
ツリー ビュー コントロールの ID を指定します。

### <a name="return-value"></a>戻り値

初期化が成功した場合は 0 以外。それ以外の場合は 0。

### <a name="remarks"></a>解説

ツリー コントロールを他のウィンドウの子ウィンドウとして作成する場合は、メンバー関数を`Create`使用します。 を使用して`Create`ツリー コントロールを作成する場合は、他のツリー ビュー スタイルに加えて、ツリー コントロールをWS_VISIBLE渡す必要があります。

を`CTreeCtrl`2 つの手順で作成します。 まず、コンストラクターを呼び出`Create`し、 を呼び出し、ツリー ビュー`CTreeCtrl`コントロールを作成してオブジェクトにアタッチします。

拡張ウィンドウ スタイルを持つツリー コントロールを作成するには、`Create`の代わりに[CreateEx](#createex)を呼び出します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

## <a name="ctreectrlcreateex"></a><a name="createex"></a>C ツリーCtrl::作成Ex

コントロール (子ウィンドウ) を作成し、`CTreeCtrl`オブジェクトに関連付けます。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*ドウェエクススタイル*<br/>
作成するコントロールの拡張スタイルを指定します。 拡張 Windows スタイルの一覧については、Windows SDK の*DwExStyle*パラメーター[を](/windows/win32/api/winuser/nf-winuser-createwindowexw)参照してください。

*Dwstyle*<br/>
ツリー ビュー コントロールのスタイルを指定します。 [「ウィンドウの作成](/windows/win32/api/winuser/nf-winuser-createwindoww)」で説明されているウィンドウ スタイルと、Windows SDK で説明されているように[、ツリー ビュー コントロール スタイル](/windows/win32/Controls/tree-view-control-window-styles)の任意の組み合わせを適用します。

*Rect*<br/>
作成するウィンドウのサイズと位置を記述する[RECT](/previous-versions/dd162897\(v=vs.85\))構造体への参照を *、 pParentWnd*のクライアント座標で指定します。

*pParentWnd*<br/>
コントロールの親であるウィンドウへのポインター。

*nID*<br/>
コントロールの子ウィンドウ ID。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外の場合は 0 以外の値を返します。

### <a name="remarks"></a>解説

[`CreateEx`[作成]](#create)の代わりに、Windows 拡張スタイルの序文で指定された拡張 Windows スタイル**を適用WS_EX_。**

## <a name="ctreectrlcreatedragimage"></a><a name="createdragimage"></a>をクリックします。

ツリー ビュー コントロール内の指定した項目のドラッグ ビットマップを作成し、ビットマップのイメージ リストを作成し、ビットマップをイメージ リストに追加します。

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ドラッグするツリー項目のハンドル。

### <a name="return-value"></a>戻り値

正常に実行された場合は、ドラッグ ビットマップが追加されたイメージ リストへのポインター。それ以外の場合は NULL。

### <a name="remarks"></a>解説

アプリケーションは、イメージリスト関数を使用して、項目がドラッグされているときにイメージを表示します。

オブジェクト`CImageList`は永続的なオブジェクトであり、終了したら削除する必要があります。 次に例を示します。

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

## <a name="ctreectrlctreectrl"></a><a name="ctreectrl"></a>C ツリーCtrl::CツリーCtrl

`CTreeCtrl` オブジェクトを構築します。

```
CTreeCtrl();
```

## <a name="ctreectrldeleteallitems"></a><a name="deleteallitems"></a>アイテム一:D

ツリー ビュー コントロールからすべての項目を削除します。

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

## <a name="ctreectrldeleteitem"></a><a name="deleteitem"></a>:Dエレテアイテム

ツリー ビュー コントロールから項目を削除します。

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
削除するツリー項目のハンドル。 *hitem*にTVI_ROOT値が設定されている場合、ツリー ビュー コントロールからすべてのアイテムが削除されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

## <a name="ctreectrleditlabel"></a><a name="editlabel"></a>をクリックします。

指定した項目のテキストのインプレース編集を開始します。

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
編集するツリー項目のハンドル。

### <a name="return-value"></a>戻り値

正常に実行された場合は、`CEdit`項目テキストの編集に使用されるオブジェクトへのポインター。それ以外の場合は NULL。

### <a name="remarks"></a>解説

編集は、項目のテキストを、そのテキストを含む単一行のエディット コントロールに置き換えることによって行われます。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

## <a name="ctreectrlendeditlabelnow"></a><a name="endeditlabelnow"></a>今すぐラベルを編集します。

現在のツリー ビュー コントロールのツリー ビュー アイテムのラベルに対する編集操作を終了します。

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*保存しない*|[in]編集操作を終える前にツリー ビュー アイテムへの変更を破棄する場合は TRUE、操作を終える前にツリー ビュー アイテムへの変更を保存するには FALSE を指定します。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK に記載されている[TVM_ENDEDITLABELNOW](/windows/win32/Controls/tvm-endeditlabelnow)メッセージを送信します。

## <a name="ctreectrlensurevisible"></a><a name="ensurevisible"></a>CツリーCtrl::保証Visible

ツリー ビューアイテムが表示されるようにするには、この関数を呼び出します。

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
表示されるツリー項目のハンドル。

### <a name="return-value"></a>戻り値

指定した項目が表示されるようにツリー ビュー コントロールの項目をスクロールした場合は、TRUE を返します。 それ以外の場合、戻り値は FALSE です。

### <a name="remarks"></a>解説

必要に応じて、親アイテムを展開するか、ツリー ビュー コントロールをスクロールして、その項目を表示します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

## <a name="ctreectrlexpand"></a><a name="expand"></a>C ツリーCtrl::展開

指定した親アイテムに関連付けられている子アイテムのリスト (存在する場合) を展開または折りたたみます。

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
展開されるツリー項目のハンドル。

*nコード*<br/>
実行するアクションの種類を示すフラグ。 このフラグには、次のいずれかの値を指定できます。

- TVE_COLLAPSE リストを折りたたみます。

- TVE_COLLAPSERESET リストを折りたたみ、子項目を削除します。 TVIS_EXPANDEDONCE状態フラグがリセットされます。 このフラグは、TVE_COLLAPSE フラグと共に使用する必要があります。

- TVE_EXPAND リストを展開します。

- TVE_TOGGLE リストが現在展開されている場合は折りたたむ、または現在折りたたまれている場合は展開します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>例

  [次](#ensurevisible)の例を参照してください。

## <a name="ctreectrlgetbkcolor"></a><a name="getbkcolor"></a>をクリックします。

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETBKCOLOR](/windows/win32/Controls/tvm-getbkcolor)の動作を実装します。

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>戻り値

コントロールの現在のウィンドウの背景色を表す COLORREF 値。 この値が -1 の場合、コントロールはシステム ウィンドウの色を使用します。 この場合は、コントロールが使用`::GetSysColor(COLOR_WINDOW)`している現在のシステム カラーを取得するために使用できます。

### <a name="example"></a>例

  [の](#settextcolor)例を参照してください。

## <a name="ctreectrlgetcheck"></a><a name="getcheck"></a>をチェックします。

項目のチェック状態を取得します。

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
状態情報を受け取る HTREEITEM。

### <a name="return-value"></a>戻り値

ツリー コントロール項目がチェックされている場合は 0 以外の値を返します。それ以外の場合は 0。

### <a name="example"></a>例

  [の](#setcheck)例を参照してください。

## <a name="ctreectrlgetchilditem"></a><a name="getchilditem"></a>を取得します。

*hItem*で指定された項目の子であるツリー ビュー アイテムを取得します。

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

正常終了した場合は子項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

## <a name="ctreectrlgetcount"></a><a name="getcount"></a>カウントを取得します。

ツリー ビュー コントロール内の項目の数を取得します。

```
UINT GetCount() const;
```

### <a name="return-value"></a>戻り値

ツリー ビュー コントロール内の項目の数。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

## <a name="ctreectrlgetdrophilightitem"></a><a name="getdrophilightitem"></a>をクリックします。

ドラッグ アンド ドロップ操作の対象である項目を取得します。

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>戻り値

正常終了した場合は、項目のハンドルがドロップされます。それ以外の場合は NULL。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlgeteditcontrol"></a><a name="geteditcontrol"></a>コントロールを編集します。

ツリー ビュー アイテムのテキストの編集に使用されているエディット コントロールのハンドルを取得します。

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>戻り値

正常に終了した場合は、アイテム テキストの編集に使用するエディット コントロールへのポインター。それ以外の場合は NULL。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

## <a name="ctreectrlgetextendedstyle"></a><a name="getextendedstyle"></a>を使用します。

現在のツリー ビュー コントロールで使用されている拡張スタイルを取得します。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>戻り値

現在のツリー ビュー コントロールの拡張スタイルのビットごとの組み合わせ (OR) を含む値。 詳細については、「[ツリー ビュー コントロール拡張スタイル](/windows/win32/Controls/tree-view-control-window-extended-styles)」を参照してください。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK で説明されている[TVM_GETEXTENDEDSTYLE](/windows/win32/Controls/tvm-getextendedstyle)メッセージを送信します。

## <a name="ctreectrlgetfirstvisibleitem"></a><a name="getfirstvisibleitem"></a>を見る

ツリー ビュー コントロールの最初の表示項目を取得します。

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>戻り値

最初に表示される項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>例

  [の](#setcheck)例を参照してください。

## <a name="ctreectrlgetimagelist"></a><a name="getimagelist"></a>を使用します。

ツリー ビュー コントロールに関連付けられている通常または状態のイメージ リストのハンドルを取得します。

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>パラメーター

*一覧*<br/>
取得するイメージ リストの種類。 イメージ リストには、次のいずれかの値を指定できます。

- TVSIL_NORMAL ツリー ビュー アイテムの選択イメージと選択されていないイメージを含む通常のイメージ リストを取得します。

- TVSIL_STATEユーザー定義の状態にあるツリー ビューアイテムのイメージを含む状態イメージ リストを取得します。

### <a name="return-value"></a>戻り値

成功した場合はコントロールのイメージ リストへのポインター。それ以外の場合は NULL。

### <a name="remarks"></a>解説

ツリー ビュー コントロールの各項目には、ビットマップ イメージのペアを関連付けることができます。 1 つのイメージは、項目が選択されている場合に表示され、もう一方のイメージは項目が選択されていないときに表示されます。 たとえば、アイテムを選択すると開いているフォルダが表示され、選択されていない場合は閉じたフォルダが表示されることがあります。

イメージ リストの詳細については[、CImageList](../../mfc/reference/cimagelist-class.md)クラスを参照してください。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

## <a name="ctreectrlgetindent"></a><a name="getindent"></a>を行います。

子項目が親項目に対して相対的にインデントされる量 (ピクセル単位) を取得します。

```
UINT GetIndent() const;
```

### <a name="return-value"></a>戻り値

ピクセル単位で測定されるインデントの量。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

## <a name="ctreectrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a>をクリックします。

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETINSERTMARKCOLOR](/windows/win32/Controls/tvm-getinsertmarkcolor)の動作を実装します。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>戻り値

現在の挿入マークの色を含む COLORREF 値。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

## <a name="ctreectrlgetitem"></a><a name="getitem"></a>を取得します。

指定したツリー ビュー アイテムの属性を取得します。

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>パラメーター

*Pitem*<br/>
Windows SDK で説明されているように[、TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>例

  [:D の](#deleteitem)例を参照してください。

## <a name="ctreectrlgetitemdata"></a><a name="getitemdata"></a>を取得します。

指定した項目に関連付けられているアプリケーション固有の値を取得します。

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
データを取得する項目のハンドル。

### <a name="return-value"></a>戻り値

*hItem*で指定された項目に関連付けられているアプリケーション固有のポインターサイズの値。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

## <a name="ctreectrlgetitemexpandedimageindex"></a><a name="getitemexpandedimageindex"></a>イメージインデックスを取得します。

現在のツリー ビュー コントロールの指定した項目が展開された状態のときに表示するイメージのインデックスを取得します。

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*Hitem*|[in]ツリー ビュー コントロール項目へのハンドル。|

### <a name="return-value"></a>戻り値

指定された項目が展開状態のときに表示されるイメージのインデックス。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK で説明されている[TVM_GETITEM](/windows/win32/Controls/tvm-getitem)メッセージを送信します。 このメッセージは、ツリー ビュー コントロール項目を記述する[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体を返し、このメソッド`iExpandedImage`はその構造体からメンバーを取得します。

## <a name="ctreectrlgetitemheight"></a><a name="getitemheight"></a>をクリックします。

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETITEMHEIGHT](/windows/win32/Controls/tvm-getitemheight)の動作を実装します。

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>戻り値

アイテムの高さ (ピクセル単位)。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

## <a name="ctreectrlgetitemimage"></a><a name="getitemimage"></a>を使用します。

ツリー ビュー コントロールの各項目には、ビットマップ イメージのペアを関連付けることができます。

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
イメージを取得する項目のハンドル。

*nイメージ*<br/>
ツリー ビュー コントロールのイメージ リスト内の項目のイメージのインデックスを受け取る整数。

*イメージを選択しました*<br/>
ツリー ビュー コントロールのイメージ リスト内で、項目の選択されたイメージのインデックスを受け取る整数。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

画像は、アイテムのラベルの左側に表示されます。 1 つのイメージは、項目が選択されている場合に表示され、もう一方のイメージは項目が選択されていないときに表示されます。 たとえば、アイテムを選択すると開いているフォルダが表示され、選択されていない場合は閉じたフォルダが表示されることがあります。

ツリー ビュー コントロールのイメージ リスト内で、項目のイメージと選択したイメージのインデックスを取得します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

## <a name="ctreectrlgetitempartrect"></a><a name="getitempartrect"></a>をクリックします。

現在のツリー ビュー コントロールの指定した項目の指定した部分に外接する四角形を取得します。

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*Hitem*|[in]ツリー ビュー コントロール項目へのハンドル。|
|*nパート*|[in]部品の識別子。 TVGIPR_BUTTONに設定する必要があります。|
|*Lprect*|[アウト][RECT](/previous-versions/dd162897\(v=vs.85\))構造体へのポインター。 このメソッドが成功すると、構造体は*hItem*と*nPart*で指定されたパーツの四角形座標を受け取ります。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

各ツリー コントロール項目は、グラフィックス四角形で囲まれます。 その四角形内のポイントがクリックされると、そのアイテムはヒットと言*われます*。 このメソッドは、四角形内のポイントがクリックされたときに *、hItem*パラメーターで識別される項目がヒットする、最大の四角形を返します。

このメソッドは、Windows SDK で説明されているTVM_GETITEMPARTRECT メッセージを送信します。 詳細については[、TreeView_GetItemPartRect](/windows/win32/api/commctrl/nf-commctrl-treeview_getitempartrect)マクロを参照してください。

### <a name="example"></a>例

現在のツリー ビュー コントロールに`m_treeCtrl`アクセスするために使用される変数 を定義するコード例を次に示します。 コード例では、符号なし整数といくつかの HTREEITEM 変数も定義します。 これらの変数は、次の例で使用されます。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>例

次のコード例では、アクセシビリティ識別子と[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)メソッドを使用して、ルート ツリー ビュー項目へのハンドルを取得します。 次に、この例では、ハンドルと[CTreeCtrl::GetItemPartRect](#getitempartrect)メソッドを使用して、そのアイテムの周囲に 3D 四角形を描画します。 コード例の前のセクションでは、米国のルートの国/地域ノード、ペンシルベニア州とワシントン州のサブノード、およびそれらの州の都市のツリー項目で構成されるツリービューを作成しました。 [CTreeCtrl::MapItemToAccID](#mapitemtoaccid)メソッドを使用して、ルート ツリー ビュー項目をアクセシビリティ識別子に関連付けます。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlgetitemrect"></a><a name="getitemrect"></a>をクリックします。

*hItem*の外接する四角形を取得し、それが表示されているかどうかを判断します。

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ツリー ビュー コントロール項目のハンドル。

*Lprect*<br/>
外接する四角形を受け取る[RECT](/previous-versions/dd162897\(v=vs.85\))構造体へのポインター。 座標は、ツリー ビュー コントロールの左上隅を基準にしています。

*テキストのみ*<br/>
このパラメーターが 0 以外の場合、外接する四角形には項目のテキストのみが含まれます。 それ以外の場合は、ツリー ビュー コントロールでアイテムが占有する行全体が含まれます。

### <a name="return-value"></a>戻り値

項目が表示されている場合は 0 以外で *、lpRect*に外接する四角形が含まれています。 それ以外の場合*は、0 (lpRect*が初期化されていない場合)。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

## <a name="ctreectrlgetitemstate"></a><a name="getitemstate"></a>を使用します。

*hItem*で指定された項目の状態を返します。

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
状態を取得する項目のハンドル。

*ステートマスク*<br/>
取得する 1 つ以上の状態を示すマスク。 *nStateMask*の使用可能な値の詳細については、Windows SDK`state`の`stateMask` [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)構造体のメンバーとの説明を参照してください。

### <a name="return-value"></a>戻り値

nStateMask で指定された値のビットごとの OR を保持する UINT。 指定できる値の詳細については[、「CTreeCtrl::GetItem](#getitem)」を参照してください。 特定の状態の値を見つけるには、次の例に示すように、状態値と戻り値のビットごとの AND 演算を実行します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

## <a name="ctreectrlgetitemstateex"></a><a name="getitemstateex"></a>を使用します。

現在のツリー ビュー コントロール内の指定された項目の拡張状態を取得します。

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*Hitem*|[in]ツリー ビュー コントロール項目へのハンドル。|

### <a name="return-value"></a>戻り値

アイテムの拡張状態。 詳しくは`uStateEx`[、TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体のメンバーを参照してください。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK で説明されている[TVM_GETITEM](/windows/win32/Controls/tvm-getitem)メッセージを送信します。 このメッセージは、ツリー ビュー コントロール項目を記述する[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体を返し、この`uStateEx`メソッドはその構造体からメンバーを取得します。

## <a name="ctreectrlgetitemtext"></a><a name="getitemtext"></a>をクリックします。

*hItem*で指定された項目のテキストを返します。

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
取得するテキストを含む項目のハンドル。

### <a name="return-value"></a>戻り値

項目`CString`のテキストを含むオブジェクト。

### <a name="example"></a>例

  [の](#getnextitem)例を参照してください。

## <a name="ctreectrlgetlastvisibleitem"></a><a name="getlastvisibleitem"></a>を見る

現在のツリー ビュー コントロール内の展開されていない最後のノード項目を取得します。

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>戻り値

メソッドが成功した場合は、展開されていない最後のノード項目へのハンドル。それ以外の場合は NULL。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK に記載されている[TVM_GETNEXTITEM](/windows/win32/Controls/tvm-getnextitem)メッセージを送信します。 詳細については、そのメッセージのフラグ パラメーターのTVGN_LASTVISIBLE*フラグ*を参照してください。

### <a name="example"></a>例

現在のツリー ビュー コントロールに`m_treeCtrl`アクセスするために使用される変数 を定義するコード例を次に示します。 コード例では、符号なし整数といくつかの HTREEITEM 変数も定義します。 次の例では、これらの変数の 1 つ以上が使用されています。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>例

次のコード例では、展開されていないツリー ビューの最後のノード項目へのハンドルを取得し、その項目の周囲に 3D 四角形を描画します。 コード例の前のセクションでは、米国のルートの国/地域ノード、ペンシルベニア州とワシントン州のサブノード、およびそれらの州の都市のツリー項目で構成されるツリービューを作成しました。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

## <a name="ctreectrlgetlinecolor"></a><a name="getlinecolor"></a>をクリックします。

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETLINECOLOR](/windows/win32/Controls/tvm-getlinecolor)の動作を実装します。

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>戻り値

現在の線の色。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

## <a name="ctreectrlgetnextitem"></a><a name="getnextitem"></a>次の項目を取得します。

指定した関連付け *(nCode*パラメーターで示される) を持つツリー ビューアイテムを*hItem*に取得します。

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ツリー項目のハンドル。

*nコード*<br/>
*hItem*への関係の種類を示すフラグ。 このフラグは、次のいずれかの値になります。

- TVGN_CARET 現在選択されている項目を取得します。

- TVGN_CHILD *hItem*パラメーターで指定された項目の最初の子項目を取得します。

- TVGN_DROPHILITE ドラッグ アンド ドロップ操作のターゲットである項目を取得します。

- TVGN_FIRSTVISIBLE最初に表示される項目を取得します。

- TVGN_LASTVISIBLE ツリー内の最後に展開された項目を取得します。 ツリー ビュー ウィンドウに表示される最後の項目は取得されません。

- TVGN_NEXT次の兄弟項目を取得します。

- TVGN_NEXTVISIBLE 指定した項目の次に表示される項目を取得します。

- TVGN_PARENT指定した項目の親を取得します。

- TVGN_PREVIOUS前の兄弟項目を取得します。

- TVGN_PREVIOUSVISIBLE 指定した項目の前に表示される最初の項目を取得します。

- TVGN_ROOT 指定した項目が一部であるルート項目の最初の子項目を取得します。

### <a name="return-value"></a>戻り値

正常終了した場合は次の項目のハンドル。それ以外の場合は NULL。

### <a name="remarks"></a>解説

この関数は、取得される項目がツリーのルート ノードである場合は NULL を返します。 たとえば、ツリー ビューのルート ノードの第 1 レベルの子に対して TVGN_PARENT フラグを指定してこのメッセージを使用すると、メッセージは NULL を返します。

### <a name="example"></a>例

ループ内での使用例`GetNextItem`については[、「CTreeCtrl::DeleteItem」](#deleteitem)を参照してください。

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

## <a name="ctreectrlgetnextsiblingitem"></a><a name="getnextsiblingitem"></a>次の兄弟アイテムを取得します。

*hItem*の次の兄弟を取得します。

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

次の兄弟項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

## <a name="ctreectrlgetnextvisibleitem"></a><a name="getnextvisibleitem"></a>次に見えるアイテムを取得します。

*hItem*の次に表示される項目を取得します。

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

次に表示される項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>例

  [の](#setcheck)例を参照してください。

## <a name="ctreectrlgetparentitem"></a><a name="getparentitem"></a>を取得します。

*hItem*の親を取得します。

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

親項目のハンドル。それ以外の場合は NULL。

### <a name="remarks"></a>解説

指定した項目の親がツリーのルート ノードである場合、この関数は NULL を返します。

### <a name="example"></a>例

  [次](#ensurevisible)の例を参照してください。

## <a name="ctreectrlgetprevsiblingitem"></a><a name="getprevsiblingitem"></a>を使用します。

*hItem*の前の兄弟を取得します。

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

前の兄弟のハンドル。それ以外の場合は NULL。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

## <a name="ctreectrlgetprevvisibleitem"></a><a name="getprevvisibleitem"></a>を見る

*hItem*の以前に表示されている項目を取得します。

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

前に表示されている項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

## <a name="ctreectrlgetrootitem"></a><a name="getrootitem"></a>を取得します。

ツリー ビュー コントロールのルート項目を取得します。

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>戻り値

ルート項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>例

  [次](#editlabel)の例を参照してください。

## <a name="ctreectrlgetscrolltime"></a><a name="getscrolltime"></a>を見る

ツリー ビュー コントロールのスクロール時間の最大値を取得します。

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>戻り値

最大スクロール時間 (ミリ秒単位)。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETSCROLLTIME](/windows/win32/Controls/tvm-getscrolltime)の動作を実装します。

## <a name="ctreectrlgetselectedcount"></a><a name="getselectedcount"></a>を選択しました。

現在のツリー ビュー コントロールで選択されている項目の数を取得します。

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>戻り値

選択した項目の数。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK で説明されている[TVM_GETSELECTEDCOUNT](/windows/win32/Controls/tvm-getselectedcount)メッセージを送信します。

## <a name="ctreectrlgetselecteditem"></a><a name="getselecteditem"></a>を選択しました。

ツリー ビュー コントロールの現在選択されている項目を取得します。

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>戻り値

選択した項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

## <a name="ctreectrlgettextcolor"></a><a name="gettextcolor"></a>をクリックします。

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETTEXTCOLOR](/windows/win32/Controls/tvm-gettextcolor)の動作を実装します。

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>戻り値

現在のテキストの色を表す COLORREF 値。 この値が -1 の場合、コントロールはテキストの色にシステム カラーを使用します。

### <a name="example"></a>例

  [の](#settextcolor)例を参照してください。

## <a name="ctreectrlgettooltips"></a><a name="gettooltips"></a>ヒントを取得します。

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETTOOLTIPS](/windows/win32/Controls/tvm-gettooltips)の動作を実装します。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>戻り値

ツリー コントロールで使用される[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)オブジェクトへのポインター。 [Create](#create)メンバー関数がスタイル TVS_NOTOOLTIPSを使用する場合、ツールヒントは使用されず、NULL が返されます。

### <a name="remarks"></a>解説

MFC の`GetToolTips`実装は、`CToolTipCtrl`ツールヒント コントロールへのハンドルではなく、ツリー コントロールで使用されるオブジェクトを返します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

## <a name="ctreectrlgetvisiblecount"></a><a name="getvisiblecount"></a>を見る

ツリー ビュー コントロール内の表示可能な項目の数を取得します。

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>戻り値

ツリー ビュー コントロール内の表示可能なアイテムの数。それ以外の場合 - 1。

### <a name="example"></a>例

  [の](#setcheck)例を参照してください。

## <a name="ctreectrlhittest"></a><a name="hittest"></a>ヒットテスト

ツリー ビュー コントロールのクライアント領域を基準にして、指定したポイントの位置を調べます。

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>パラメーター

*Pt*<br/>
テストするポイントのクライアント座標。

*フラグ*<br/>
ヒット テストの結果に関する情報を受け取る整数へのポインター。 「解説」セクションのメンバーの下にリストされている値`flags`を 1 つ以上指定できます。

*テスト情報*<br/>
ヒット テストの位置を含み、ヒット テストの結果に関する情報を受け取る[TVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo)構造体のアドレス。

### <a name="return-value"></a>戻り値

指定したポイントを占有するツリー ビュー アイテムのハンドル。

### <a name="remarks"></a>解説

この関数が呼び出されると *、pt*パラメーターは、テストする点の座標を指定します。 この関数は、指定したポイントの項目のハンドルを返し、項目がポイントを占める場合は NULL を返します。 さらに *、pFlags*パラメーターには、指定したポイントの位置を示す値が含まれています。 次のいずれかの値になります。

|||
|-|-|
|[値]|意味|
|TVHT_ABOVE|クライアント領域の上。|
|TVHT_BELOW|クライアント領域の下。|
|TVHT_NOWHERE|クライアント領域で、最後の項目の下に表示されます。|
|TVHT_ONITEM|アイテムに関連付けられたビットマップまたはラベル。|
|TVHT_ONITEMBUTTON|項目に関連付けられているボタン。|
|TVHT_ONITEMICON|項目に関連付けられているビットマップ上。|
|TVHT_ONITEMINDENT|項目に関連付けられたインデント。|
|TVHT_ONITEMLABEL|項目に関連付けられたラベル (文字列) に指定します。|
|TVHT_ONITEMRIGHT|アイテムの右側の領域。|
|TVHT_ONITEMSTATEICON|ユーザー定義の状態にあるツリー ビュー アイテムの状態アイコン。|
|TVHT_TOLEFT|クライアント領域の左側。|
|TVHT_TORIGHT|クライアント領域の右側。|
|||

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlinsertitem"></a><a name="insertitem"></a>アイテムを挿入します。

ツリー ビュー コントロールに新しい項目を挿入します。

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>パラメーター

*構造体を挿入します。*<br/>
挿入`TVINSERTSTRUCT`するツリー ビュー アイテムの属性を指定するを指すポインター。

*nマスク*<br/>
設定する属性を指定する整数。 Windows `TVITEM` SDK の構造を参照してください。

*をクリックします。*<br/>
項目のテキストを含む文字列のアドレス。

*nイメージ*<br/>
ツリー ビュー コントロールのイメージ リスト内の項目のイメージのインデックス。

*イメージを選択しました*<br/>
ツリー ビュー コントロールのイメージ リストで選択されている項目のインデックス。

*nステート*<br/>
項目の状態の値を指定します。 適切な状態の一覧については、Windows SDK のツリー ビュー コントロール項目の状態を参照してください。

*ステートマスク*<br/>
設定する状態を指定します。 Windows `TVITEM` SDK の構造を参照してください。

*lParam*<br/>
項目に関連付けられたポインター サイズのアプリケーション固有の値。

*h親*<br/>
挿入された項目の親のハンドル。

*後に挿入*<br/>
新しい項目を挿入する前の項目のハンドル。

### <a name="return-value"></a>戻り値

正常終了した場合は新しい項目のハンドル。それ以外の場合は NULL。

### <a name="remarks"></a>解説

この例では、ツリー コントロール項目を挿入するときに、関数の各バージョンを使用する場合を示します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

## <a name="ctreectrlitemhaschildren"></a><a name="itemhaschildren"></a>子供たちを抱えています。

この関数を使用して *、hItem*で指定されたツリー項目に子項目があるかどうかを調べます。

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

*hItem*で指定されたツリー項目に子項目がある場合は 0 以外。0 でない場合は 0。

### <a name="remarks"></a>解説

その場合は[、CTreeCtrl::GetChildItem](#getchilditem)を使用して、それらの子項目を取得できます。

### <a name="example"></a>例

  の[例を参照](#getselecteditem)してください。

## <a name="ctreectrlmapaccidtoitem"></a><a name="mapaccidtoitem"></a>をクリックします。

指定されたアクセシビリティ識別子を、現在のツリー ビュー コントロールのツリー ビュー アイテムのハンドルに割り当てます。

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*をクリックします。*|[in]ツリー ビューアイテム内の要素のアクセシビリティ識別子。|

### <a name="return-value"></a>戻り値

*uAccId*パラメーターに対応するツリー`HTREEITEM`ビュー項目 ( ) へのハンドル。 詳細については[、TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体の*hItem*メンバーを参照してください。

### <a name="remarks"></a>解説

アクセシビリティ補助は、障害を持つ人々がコンピュータを使用するのを助けるアプリケーションです。 アクセシビリティ識別子は、ウィンドウ内の`IAccessible`要素を一意に指定するためにインターフェイスによって使用されます。 アクセシビリティ識別子の詳細については[、『Microsoft 開発者用ネットワーク](https://go.microsoft.com/fwlink/p/?linkid=56322)』の「ユーザー補助サポートの利用について」を参照してください。

このメソッドは、Windows SDK で説明されている[TVM_MAPACCIDTOHTREEITEM](/windows/win32/Controls/tvm-mapaccidtohtreeitem)メッセージを送信します。

### <a name="example"></a>例

現在のツリー ビュー コントロールに`m_treeCtrl`アクセスするために使用される変数 を定義するコード例を次に示します。 コード例では、符号なし整数といくつかの HTREEITEM 変数も定義します。 これらの変数は、次の例で使用されます。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>例

次のコード例では、アクセシビリティ識別子と[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)メソッドを使用して、ルート ツリー ビュー項目へのハンドルを取得します。 この例では、ハンドルと[CTreeCtrl::GetItemPartRect](#getitempartrect)メソッドを使用して、そのアイテムの周囲に 3D 四角形を描画します。 コード例の前のセクションでは、米国のルートの国/地域ノード、ペンシルベニア州とワシントン州のサブノード、およびそれらの州の都市のツリー項目で構成されるツリービューを作成しました。 [CTreeCtrl::MapItemToAccID](#mapitemtoaccid)メソッドを使用して、ルート ツリー ビュー項目をアクセシビリティ識別子に関連付けます。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlmapitemtoaccid"></a><a name="mapitemtoaccid"></a>をクリックします。

現在のツリー ビュー コントロール内のツリー ビュー アイテムの指定されたハンドルをユーザー補助識別子に割り当てます。

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*Hitem*|[in]コントロール内のツリー ビュー項目のハンドル。 詳細については[、TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体の*hItem*メンバーを参照してください。|

### <a name="return-value"></a>戻り値

*hItem*パラメーターに対応するアクセシビリティ識別子。

### <a name="remarks"></a>解説

アクセシビリティ補助は、障害を持つ人々がコンピュータを使用するのを助けるアプリケーションです。 アクセシビリティ識別子は、ウィンドウ内の`IAccessible`要素を一意に指定するためにインターフェイスによって使用されます。 アクセシビリティ識別子の詳細については[、『Microsoft 開発者用ネットワーク](https://go.microsoft.com/fwlink/p/?linkid=56322)』の「ユーザー補助サポートの利用について」を参照してください。

このメソッドは、Windows SDK に記載されている[TVM_MAPHTREEITEMTOACCID](/windows/win32/Controls/tvm-maphtreeitemtoaccid)メッセージを送信します。

### <a name="example"></a>例

現在のツリー ビュー コントロールに`m_treeCtrl`アクセスするために使用される変数 を定義するコード例を次に示します。 コード例では、符号なし整数といくつかの HTREEITEM 変数も定義します。 これらの変数は、次の例で使用されます。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>例

ツリー ビュー コントロール項目の ID 番号を取得するコード例を次に示します。 コード例の前のセクションでは、米国のルートの国/地域ノード、ペンシルベニア州とワシントン州のサブノード、およびそれらの州の都市のツリー項目で構成されるツリービューを作成しました。 このコード例では、ルートの国/地域ノードの固有の識別番号を取得します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

## <a name="ctreectrlselect"></a><a name="select"></a>C ツリーCtrl::選択

この関数を呼び出して、指定されたツリー ビューアイテムを選択するか、項目をスクロールしてビューに表示するか、ドラッグ アンド ドロップ操作の対象を示すために使用するスタイルでアイテムを再描画します。

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ツリー項目のハンドル。

*nコード*<br/>
実行するアクションの種類。 このパラメーターには、次のいずれかの値を指定できます。

- TVGN_CARET 選択を指定した項目に設定します。

- TVGN_DROPHILITE ドラッグ アンド ドロップ操作の対象を示すために使用するスタイルで、指定された項目を再描画します。

- TVGN_FIRSTVISIBLE ツリー ビューを垂直方向にスクロールして、指定した項目が最初に表示される項目になるようにします。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

*nCode*にTVGN_CARET値が含まれている場合、親ウィンドウはTVN_SELCHANGINGを受け取り、通知メッセージTVN_SELCHANGEDします。 さらに、指定した項目が折りたたまれた親アイテムの子である場合、親の子項目のリストが展開され、指定した項目が表示されます。 この場合、親ウィンドウはTVN_ITEMEXPANDINGを受け取り、通知メッセージTVN_ITEMEXPANDEDします。

### <a name="example"></a>例

  [次](#hittest)の例を参照してください。

## <a name="ctreectrlselectdroptarget"></a><a name="selectdroptarget"></a>を選択します。

ドラッグ アンド ドロップ操作の対象を示すために使用するスタイルの項目を再描画します。

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlselectitem"></a><a name="selectitem"></a>アイテムを選択します。

指定したツリー ビュー アイテムを選択します。

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

*hItem*が NULL の場合、この関数は項目を選択しません。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlselectsetfirstvisible"></a><a name="selectsetfirstvisible"></a>最初に表示されます。

ツリー ビューを垂直にスクロールして、指定した項目が最初に表示される項目になるようにします。

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
最初に表示される項目として設定するツリー項目のハンドル。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

この関数は、メッセージパラメーターをTVM_SELECTITEMしてウィンドウにTVGN_FIRSTVISIBLEメッセージを送信します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

## <a name="ctreectrlsetautoscrollinfo"></a><a name="setautoscrollinfo"></a>を設定します。

現在のツリー ビュー コントロールの自動スクロール速度を設定します。

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*をクリックします。*|[in]スクロールする 1 秒あたりのピクセル数。|
|*時間*|[in]コントロールの更新間隔。|

### <a name="return-value"></a>戻り値

常に TRUE を返します。

### <a name="remarks"></a>解説

自動スクロール パラメータは、現在表示されていない項目を表示するスクロールに使用されます。 ツリー ビュー コントロールは、TVS_EX_AUTOHSCROLL拡張スタイルを持つ必要[があります。](/windows/win32/Controls/tree-view-control-window-extended-styles)

このメソッドは、Windows SDK で説明されている[TVM_SETAUTOSCROLLINFO](/windows/win32/Controls/tvm-setautoscrollinfo)メッセージを送信します。

### <a name="example"></a>例

現在のツリー ビュー コントロールに`m_treeCtrl`アクセスするために使用される変数 を定義するコード例を次に示します。 コード例では、符号なし整数といくつかの HTREEITEM 変数も定義します。 これらの変数は、次の例で使用されます。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>例

現在のツリー ビュー コントロールの自動スクロール動作を設定するコード例を次に示します。 コード例の前のセクションでは、米国のルートの国/地域ノード、ペンシルベニア州とワシントン州のサブノード、およびそれらの州の都市のツリー項目で構成されるツリービューを作成しました。 意図的にツリー ビュー コントロールを狭くし、フォーカスのあるツリー項目を表示するために自動的にスクロールする必要があります。 このコード例では、ツリー ビュー コントロールを、ツリー項目が表示されるまで 5 秒ごとに自動的に 30 ピクセル/秒スクロールするように設定します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

## <a name="ctreectrlsetbkcolor"></a><a name="setbkcolor"></a>をクリックします。

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETBKCOLOR](/windows/win32/Controls/tvm-setbkcolor)の動作を実装します。

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>パラメーター

*Clr*<br/>
新しい背景色を含む COLORREF 値。 この値が -1 の場合、コントロールは背景色にシステム カラーを使用するように戻ります。

### <a name="return-value"></a>戻り値

現在のテキストの色を表す COLORREF 値。 この値が -1 の場合、コントロールはテキストの色にシステム カラーを使用します。

### <a name="example"></a>例

  [の](#settextcolor)例を参照してください。

## <a name="ctreectrlsetcheck"></a><a name="setcheck"></a>を設定します。

ツリー コントロール項目のチェック状態を設定します。

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
チェック状態の変更を受け取る HTREEITEM。

*チェック*<br/>
ツリー コントロール項目をオンにするか、オフにするかを示します。 既定では、`SetCheck`チェックされる項目を設定します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

ツリー コントロール項目がオン *(fCheck が*TRUE に設定) されると、項目は横にチェック マークが付いて表示されます。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>例

チェックボックスを使用するには、ツリーコントロールにデータを設定する前にTVS_CHECKBOXESを設定します。

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

## <a name="ctreectrlsetextendedstyle"></a><a name="setextendedstyle"></a>を使用します。

現在のツリー ビュー コントロールの拡張スタイルを設定します。

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*ドウエックスマスク*|[in]現在のツリー ビュー コントロールのどのスタイルがこのメソッドによって影響を受けるかを指定するビットマスク。 このパラメーターが 0 の場合は無視され *、dwExStyles*パラメーターの値がツリー ビュー コントロールに割り当てられます。<br /><br /> [「ツリー ビュー コントロール](/windows/win32/Controls/tree-view-control-window-extended-styles)拡張スタイル 」で説明しているスタイルの 0 またはビットごとの組み合わせ (OR) を指定します。|
|*ドウェエクススタイル*|[in]現在のツリー ビュー コントロールのどのスタイルを設定またはクリアするかを指定するビットマスク。<br /><br /> スタイルの組み合わせを設定するには、「[ツリー ビュー コントロール拡張](/windows/win32/Controls/tree-view-control-window-extended-styles)スタイル」で説明するスタイルのビットごとの組み合わせ (OR) を指定します。 スタイルのセットをクリアするには、0 を指定します。|

### <a name="return-value"></a>戻り値

以前の拡張コントロール スタイルを含む値。

### <a name="remarks"></a>解説

このメソッドは *、dwExMask*パラメーターで指定されたスタイルをクリアし *、dwExStyles*パラメーターで指定されたスタイルを設定します。 *dwExMask*のビットに対応する拡張スタイルのみが変更されます。

このメソッドは、Windows SDK で説明されている[TVM_SETEXTENDEDSTYLE](/windows/win32/Controls/tvm-setextendedstyle)メッセージを送信します。

### <a name="example"></a>例

現在のツリー ビュー コントロールに`m_treeCtrl`アクセスするために使用される変数 を定義するコード例を次に示します。 コード例では、符号なし整数といくつかの HTREEITEM 変数も定義します。 これらの変数は、次の例で使用されます。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>例

現在のツリー ビュー コントロールにTVS_EX_AUTOHSCROLL拡張スタイルを追加するコード例を次に示します。 コード例の前のセクションでは、米国のルートの国/地域ノード、ペンシルベニア州とワシントン州のサブノード、およびそれらの州の都市のツリー項目で構成されるツリービューを作成しました。 意図的にツリー ビュー コントロールを狭くし、フォーカスのあるツリー項目を表示するために自動的にスクロールする必要があります。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

## <a name="ctreectrlsetimagelist"></a><a name="setimagelist"></a>を一覧表示します。

ツリー ビュー コントロールの標準イメージ リストまたは状態イメージ リストを設定し、新しいイメージを使用してコントロールを再描画します。

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>パラメーター

*一覧*<br/>
割り当てるイメージ リストへのポインター。 *pImageList*が NULL の場合、すべてのイメージがツリー ビュー コントロールから削除されます。

*を使用します。*<br/>
設定するイメージ リストの種類。 イメージ リストには、次のいずれかの値を指定できます。

- TVSIL_NORMAL ツリー ビュー アイテムの選択イメージと選択されていないイメージを含む通常のイメージ リストを設定します。 オーバーレイ イメージには、この状態を使用する必要があります。

- TVSIL_STATEユーザー定義の状態にあるツリー ビュー アイテムのイメージを含む状態イメージ リストを設定します。

### <a name="return-value"></a>戻り値

前のイメージ リストへのポインター (存在する場合)。それ以外の場合は NULL。

### <a name="example"></a>例

  の[例を参照](#getimagelist)してください。

## <a name="ctreectrlsetindent"></a><a name="setindent"></a>を設定します。

ツリー ビュー コントロールのインデント幅を設定し、コントロールを再描画して新しい幅を反映します。

```
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>パラメーター

*nインデント*<br/>
インデントの幅 (ピクセル単位)。 *nIndent*がシステム定義の最小幅より小さい場合、新しい幅はシステム定義の最小値に設定されます。

### <a name="example"></a>例

  [の](#getindent)例を参照してください。

## <a name="ctreectrlsetinsertmark"></a><a name="setinsertmark"></a>を挿入します。

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETINSERTMARK](/windows/win32/Controls/tvm-setinsertmark)の動作を実装します。

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
挿入マークを配置する項目を指定する HTREEITEM。 この引数が NULL の場合、挿入マークは削除されます。

*fアフター*<br/>
指定された項目の前または後に挿入マークを付けたかどうかを指定する BOOL 値。 この引数が 0 以外の場合、挿入マークは項目の後に置かれます。 この引数が 0 の場合、挿入マークは項目の前に置かれます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

## <a name="ctreectrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a>カラーを挿入します。

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETINSERTMARKCOLOR](/windows/win32/Controls/tvm-setinsertmarkcolor)の動作を実装します。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>パラメーター

*clrNew*<br/>
新しい挿入マークの色を含む COLORREF 値。

### <a name="return-value"></a>戻り値

前の挿入マークの色を含む COLORREF 値。

### <a name="example"></a>例

  の[例を参照](#getinsertmarkcolor)してください。

## <a name="ctreectrlsetitem"></a><a name="setitem"></a>を設定します。

指定したツリー ビュー アイテムの属性を設定します。

```
BOOL SetItem(TVITEM* pItem);

BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>パラメーター

*Pitem*<br/>
Windows SDK で説明されているように、新しい項目の属性を含む[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)構造体へのポインター。

*Hitem*<br/>
属性が設定される項目のハンドル。 Windows `hItem` SDK の`TVITEM`構造体のメンバーを参照してください。

*nマスク*<br/>
設定する属性を指定する整数。 構造体の`mask`メンバーを`TVITEM`参照してください。

*をクリックします。*<br/>
項目のテキストを含む文字列のアドレス。

*nイメージ*<br/>
ツリー ビュー コントロールのイメージ リスト内の項目のイメージのインデックス。 構造体の`iImage`メンバーを`TVITEM`参照してください。

*イメージを選択しました*<br/>
ツリー ビュー コントロールのイメージ リストで選択されている項目のインデックス。 構造体の`iSelectedImage`メンバーを`TVITEM`参照してください。

*nステート*<br/>
項目の状態の値を指定します。 構造体の`State`メンバーを`TVITEM`参照してください。

*ステートマスク*<br/>
設定する状態を指定します。 構造体の`stateMask`メンバーを`TVITEM`参照してください。

*lParam*<br/>
項目に関連付けられたポインター サイズのアプリケーション固有の値。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

構造体では`TVITEM`、メンバーが`hItem`項目を識別し、メンバーは`mask`設定する属性を指定します。

メンバーまたは`mask` *nMask*パラメーターがTVIF_TEXT値を指定する場合`pszText`、メンバーまたは*lpszItem*は NULL で終わる文字列のアドレス`cchTextMax`であり、メンバーは無視されます。 (`mask`または*nMask*) がTVIF_STATE値を`stateMask`指定する場合、メンバーまたは*nStateMask*パラメーターは、変更`state`する項目の状態を指定し、メンバーまたは*nState*パラメーターにそれらの状態の値が含まれます。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

## <a name="ctreectrlsetitemdata"></a><a name="setitemdata"></a>を使用します。

指定した項目に関連付けられているアプリケーション固有の値を設定します。

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
データを取得する項目のハンドル。

*dw データ*<br/>
*hItem*で指定された項目に関連付けられているアプリケーション固有のポインターサイズの値。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

## <a name="ctreectrlsetitemexpandedimageindex"></a><a name="setitemexpandedimageindex"></a>イメージインデックスを作成します。

現在のツリー ビュー コントロールの指定した項目が展開状態のときに表示するイメージのインデックスを設定します。

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*Hitem*|[in]ツリー ビュー コントロール項目へのハンドル。|
|*イメージを展開しました*|[in]指定された項目が展開状態のときに表示されるイメージのインデックス。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK で説明されている[TVM_SETITEM](/windows/win32/Controls/tvm-setitem)メッセージを送信します。 このメソッドは[、tvITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体の`iExpandedImage`メンバーに*iExpandedImage*パラメーターを割り当て、メッセージ内でその構造体を使用します。

### <a name="example"></a>例

現在のツリー ビュー コントロールに`m_treeCtrl`アクセスするために使用される変数 を定義するコード例を次に示します。 コード例では、符号なし整数といくつかの HTREEITEM 変数も定義します。 これらの変数は、次の例で使用されます。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>例

次のコード例は、メソッドが[CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)メソッドによって設定された値を返すかどうかを判断するための簡単なテスト[です](#setitemexpandedimageindex)。 コード例の前のセクションでは、米国のルートの国/地域ノード、ペンシルベニア州とワシントン州のサブノード、およびそれらの州の都市のツリー項目で構成されるツリービューを作成しました。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

## <a name="ctreectrlsetitemheight"></a><a name="setitemheight"></a>をクリックします。

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETITEMHEIGHT](/windows/win32/Controls/tvm-setitemheight)の動作を実装します。

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>パラメーター

*サイハイト*<br/>
ツリー ビュー内のすべての項目の新しい高さをピクセル単位で指定します。 この引数がイメージの高さより小さい場合は、イメージの高さに設定されます。 この引数が偶数でない場合は、最も近い偶数値に切り捨てられます。 この引数が -1 の場合、コントロールは既定の項目の高さを使用して戻ります。

### <a name="return-value"></a>戻り値

アイテムの前の高さ (ピクセル単位)。

### <a name="example"></a>例

  [の](#getitemheight)例を参照してください。

## <a name="ctreectrlsetitemimage"></a><a name="setitemimage"></a>を使用します。

イメージを項目に関連付けます。

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
イメージを設定する項目のハンドル。

*nイメージ*<br/>
ツリー ビュー コントロールのイメージ リスト内の項目のイメージのインデックス。

*イメージを選択しました*<br/>
ツリー ビュー コントロールのイメージ リストで選択されている項目のインデックス。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

ツリー ビュー コントロールの各項目には、ビットマップ イメージのペアを関連付けることができます。 画像は、アイテムのラベルの左側に表示されます。 1 つのイメージは、項目が選択されている場合に表示され、もう一方のイメージは項目が選択されていないときに表示されます。 たとえば、アイテムを選択すると開いているフォルダが表示され、選択されていない場合は閉じたフォルダが表示されることがあります。

ツリー ビュー コントロールのイメージ リスト内で、項目のイメージと選択したイメージのインデックスを設定します。

イメージの詳細については、「 [CImageList](../../mfc/reference/cimagelist-class.md)」を参照してください。

### <a name="example"></a>例

  の[例を参照](#getitemimage)してください。

## <a name="ctreectrlsetitemstate"></a><a name="setitemstate"></a>を使用します。

*hItem*で指定された項目の状態を設定します。

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
状態が設定される項目のハンドル。

*nステート*<br/>
項目の新しい状態を指定します。

*ステートマスク*<br/>
変更する状態を指定します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

状態の詳細については[、「CTreeCtrl::GetItem](#getitem)」を参照してください。

### <a name="example"></a>例

  [の](#getitemstate)例を参照してください。

## <a name="ctreectrlsetitemstateex"></a><a name="setitemstateex"></a>を使用します。

現在のツリー ビュー コントロール内の指定された項目の拡張状態を設定します。

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*Hitem*|[in]ツリー ビュー コントロール項目へのハンドル。|
|*州*|[in]アイテムの拡張状態。 詳しくは`uStateEx`[、TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体のメンバーを参照してください。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、Windows SDK で説明されている[TVM_SETITEM](/windows/win32/Controls/tvm-setitem)メッセージを送信します。 このメソッドは[、tvITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体の`uStateEx`メンバーに*uStateEx*パラメーターを割り当て、メッセージ内でその構造体を使用します。

### <a name="example"></a>例

現在のツリー ビュー コントロールに`m_treeCtrl`アクセスするために使用される変数 を定義するコード例を次に示します。 コード例では、符号なし整数といくつかの HTREEITEM 変数も定義します。 これらの変数は、次の例で使用されます。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>例

ツリー ビューアイテムを無効な状態に設定するコード例を次に示します。 コード例の前のセクションでは、米国のルートの国/地域ノード、ペンシルベニア州とワシントン州のサブノード、およびそれらの州の都市のツリー項目で構成されるツリービューを作成しました。 このコード例では、ペンシルバニア ノードを無効状態に設定します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

## <a name="ctreectrlsetitemtext"></a><a name="setitemtext"></a>をクリックします。

*hItem*で指定された項目のテキストを設定します。

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
テキストを設定する項目のハンドル。

*をクリックします。*<br/>
項目の新しいテキストを含む文字列のアドレス

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

## <a name="ctreectrlsetlinecolor"></a><a name="setlinecolor"></a>をクリックします。

ツリー ビュー コントロールの現在の線の色を設定します。

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>パラメーター

*clrNew*<br/>
新しい線の色。

### <a name="return-value"></a>戻り値

前の線の色。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETLINECOLOR](/windows/win32/Controls/tvm-setlinecolor)の動作を実装します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

## <a name="ctreectrlsetscrolltime"></a><a name="setscrolltime"></a>を設定します。

ツリー ビュー コントロールのスクロール時間の最大値を設定します。

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>パラメーター

*を見る*<br/>
新しい最大スクロール時間 (ミリ秒単位)。 この値が 100 未満の場合は、100 に切り上げられます。

### <a name="return-value"></a>戻り値

前の最大スクロール時間 (ミリ秒単位)。

### <a name="remarks"></a>解説

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETSCROLLTIME](/windows/win32/Controls/tvm-setscrolltime)の動作を実装します。

## <a name="ctreectrlsettextcolor"></a><a name="settextcolor"></a>をクリックします。

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETTEXTCOLOR](/windows/win32/Controls/tvm-settextcolor)の動作を実装します。

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>パラメーター

*Clr*<br/>
新しいテキストの色を含む COLORREF 値。 この引数が -1 の場合、コントロールはテキストの色にシステム カラーを使用するように戻ります。

### <a name="return-value"></a>戻り値

前のテキストの色を表す COLORREF 値。 この値が -1 の場合、コントロールはテキストの色にシステム カラーを使用していました。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

## <a name="ctreectrlsettooltips"></a><a name="settooltips"></a>ヒントを設定します。

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETTOOLTIPS](/windows/win32/Controls/tvm-settooltips)の動作を実装します。

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>パラメーター

*プーンドチップ*<br/>
ツリー コントロールが使用する[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)オブジェクトへのポインター。

### <a name="return-value"></a>戻り値

コントロールで以前に使用されていたツールヒントを含む[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)オブジェクトへのポインター。

### <a name="remarks"></a>解説

ツールチップを使用するには、オブジェクトを作成するときにTVS_NOTOOLTIPSスタイルを`CTreeCtrl`指定します。

### <a name="example"></a>例

  [次](#gettooltips)の例を参照してください。

## <a name="ctreectrlshowinfotip"></a><a name="showinfotip"></a>を見る

現在のツリー ビュー コントロール内の指定した項目の情報を表示します。

```
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*Hitem*|[in]コントロール内のツリー ビュー項目へのハンドル。 詳しくは`hItem`[、TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体のメンバーを参照してください。|

### <a name="remarks"></a>解説

ヒントとヒントの違いの詳細については[、Microsoft 開発者ネットワーク](https://go.microsoft.com/fwlink/p/?linkid=56322)のトピック「ヒントとヒント」を検索してください。

このメソッドは、Windows SDK で説明されている[TVM_SHOWINFOTIP](/windows/win32/Controls/tvm-showinfotip)メッセージを送信します。

## <a name="ctreectrlsortchildren"></a><a name="sortchildren"></a>子供の並べ替え

ツリー ビュー コントロール内の指定された親アイテムの子項目をアルファベット順に並べ替えるには、この関数を呼び出します。

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*Hitem*<br/>
子項目を並べ替える親アイテムのハンドル。 *hItem*が NULL の場合、並べ替えはツリーのルートから進みます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

`SortChildren`ツリーを通して再帰しません。*hItem*の直接の子だけが並べ替えられます。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

## <a name="ctreectrlsortchildrencb"></a><a name="sortchildrencb"></a>CツリーCtrl::ソートチルドレンCB

項目を比較するアプリケーション定義のコールバック関数を使用して、ツリー ビューアイテムを並べ替えるには、この関数を呼び出します。

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>パラメーター

*pソート*<br/>
[TVSORTCB](/windows/win32/api/commctrl/ns-commctrl-tvsortcb)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

構造体の比較関数 、は`lpfnCompare`、最初の項目が 2 番目の項目の前にする場合は負の値を返す必要があります。

*lParam1*と*lParam2*のパラメーター`lParam`は、比較される 2 つの項目の[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)構造体のメンバーに対応します。 *lParamSort*パラメーターは、構造体の`lParam`メンバーに`TV_SORTCB`対応します。

### <a name="example"></a>例

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>関連項目

[サンプル CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[CWnd クラス](../../mfc/reference/cwnd-class.md)<br/>
[階層グラフ](../../mfc/hierarchy-chart.md)<br/>
[CImageList クラス](../../mfc/reference/cimagelist-class.md)
