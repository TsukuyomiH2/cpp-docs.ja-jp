---
title: リンカ ツール エラー LNK1104
ms.date: 09/06/2019
f1_keywords:
- LNK1104
helpviewer_keywords:
- LNK1104
ms.assetid: 9ca6f929-0efc-4055-8354-3cf5b4e636dc
ms.openlocfilehash: f3effd9054954a90f69c5b18d8f099e6d705d9a3
ms.sourcegitcommit: 7babce70714242cf498ca811eec3695fad3abd03
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/09/2019
ms.locfileid: "70808835"
---
# <a name="linker-tools-error-lnk1104"></a>リンカ ツール エラー LNK1104

> ファイル '*filename*' を開くことができません

リンカーは、指定されたファイルを開くことができませんでした。 この問題の最も一般的な原因は、ファイルが別のプロセスによって使用またはロックされていることです。 また、ファイルが存在しないか、リンカーが検索するいずれかのディレクトリに見つからない可能性もあります。 または、ファイルにアクセスするための十分なアクセス許可がない可能性があります。 一般的に、ディスク領域が不足しているか、ファイルが大きすぎるか、ファイルへのパスが長すぎる可能性があります。

## <a name="possible-causes-and-solutions"></a>考えられる原因と解決策

このエラーは、リンカーが読み取り用または書き込み用にファイルを開こうとしたときに発生する可能性があります。 考えられる原因を絞り込むには、まずファイルの種類を確認します。 その後、次のセクションを参照して、特定の問題を特定し、修正してください。

### <a name="cant-open-your-app-or-its-pdb-file"></a>アプリまたは .pdb ファイルを開くことができません

ファイル名がプロジェクトでビルドされる実行可能ファイルまたは関連付けられた .pdb ファイルの場合、最も一般的な原因は、アプリケーションをリビルドしようとしたとき、またはデバッガーに読み込まれたときに、アプリケーションが既に実行されていることです。 この問題を解決するには、プログラムを停止してから、再度ビルドする前にデバッガーからアンロードします。 アプリがリソースエディターなどの別のプログラムで開かれている場合は、アプリケーションを閉じます。 極端なケースでは、タスクマネージャーを使用してプロセスを終了するか、Visual Studio を停止して再起動することが必要になる場合があります。

多くの場合、ウイルス対策プログラムは、新しく作成されたファイル (特に .exe および .dll 実行可能ファイル) へのアクセスを一時的にブロックします。 この問題を解決するには、プロジェクトのビルドディレクトリをウイルス対策スキャナーから除外してみてください。

### <a name="cant-open-a-microsoft-library-file"></a>Microsoft ライブラリファイルを開くことができません

開くことができないファイルが、kernel32.dll など、Microsoft によって提供される標準ライブラリファイルの1つである場合は、プロジェクト構成エラーまたはインストールエラーが発生している可能性があります。 Windows SDK がインストールされていることを確認します。また、プロジェクトに MFC などの他の Microsoft ライブラリが必要な場合は、MFC コンポーネントが Visual Studio インストーラーによってもインストールされていることを確認してください。 インストーラーを再実行すると、いつでもオプションのコンポーネントを追加できます。 詳細については、「 [Visual Studio の変更](/visualstudio/install/modify-visual-studio)」を参照してください。 インストーラーの [個々のコンポーネント] タブを使用して、特定のライブラリと Sdk を選択します。

ユニバーサル Windows (UWP) アプリまたはコンポーネント用の Spectre 軽減ライブラリはありません。 エラーレポートに*vccorlib .lib*ファイルが示されている場合は、UWP プロジェクトで[/Qspectre](../../build/reference/qspectre.md)を有効にしている可能性があります。 この問題を解決するには、 **/Qspectre**コンパイラオプションを無効にしてください。 Visual Studio で、[プロジェクト**プロパティページ**] ダイアログボックスの [ **C/C++**  > **コード生成**] ページにある**Spectre 軽減**プロパティを変更します。

以前のバージョンの Visual Studio を使用して作成されたプロジェクトをビルドしている場合、そのバージョンのプラットフォームツールセットとライブラリはインストールされない可能性があります。 Msvcr100.dll など、バージョン管理されたライブラリ名でエラーメッセージが発生した場合は、これが原因である可能性があります。 この問題を解決するには、2つのオプションがあります。インストールした現在のプラットフォームツールセットを使用するようにプロジェクトをアップグレードすることも、古いツールセットをインストールしてプロジェクトを変更せずにビルドすることもできます。 詳細については、「[以前のバージョンのビジュアルC++からプロジェクトをアップグレード](../../porting/upgrading-projects-from-earlier-versions-of-visual-cpp.md)する」および「 [visual Studio でネイティブマルチターゲットを使用する」を](../../porting/use-native-multi-targeting.md)参照してください。

新しいターゲットプラットフォームまたは構成用にビルドするときにこのエラーが表示される場合は、そのプロジェクト構成またはプラットフォームツールセットのライブラリがインストールされていない可能性があります。 プロジェクトの[[全般] プロパティページ](../../build/reference/general-property-page-project.md)で指定した**プラットフォームツールセット**と**Windows SDK バージョン**がインストールされていることを確認し、必要なライブラリがに指定されている**ライブラリディレクトリ**で使用可能であることを確認します。構成設定の [ [VC + + ディレクトリ] プロパティページ](../../build/reference/vcpp-directories-property-page.md)。 デバッグ構成とリテール構成には、32ビット構成と64ビット構成があります。1つのビルドが動作し、別のビルドでエラーが発生する場合は、設定が正しいことと、必要なツールとライブラリがインストールされていることを確認してください。ビルドする構成。

Visual Studio IDE を使用して別のコンピューターからコピーされたプロジェクトをビルドする場合、ライブラリのインストール場所が異なる場合があります。 プロジェクトの [ [VC + + ディレクトリ] プロパティページ](../../build/reference/vcpp-directories-property-page.md)で **[ライブラリディレクトリ]** プロパティを確認し、必要に応じて更新します。 IDE で設定されている現在のライブラリパスを表示および編集するには、 **[ライブラリディレクトリ]** プロパティのドロップダウンコントロールを選択し、 **[編集]** を選択します。 **[ライブラリディレクトリ]** ダイアログボックスの 評価された **[値]** セクションには、ライブラリファイルを検索する現在のパスが表示されます。

このエラーは、Windows SDK へのパスが古い場合にも発生する可能性があります。 お使いのバージョンの Visual Studio より新しいバージョンの Windows SDK がインストールされている場合は、[ [VC + + ディレクトリ] プロパティページ](../../build/reference/vcpp-directories-property-page.md)で指定したパスが新しい SDK と一致するように更新されていることを確認してください。 開発者コマンドプロンプトを使用する場合は、新しい SDK パスに対して、環境変数を初期化するバッチファイルが更新されていることを確認してください。 この問題を回避するには、Visual Studio インストーラーを使用して更新された Sdk をインストールします。

### <a name="cannot-open-a-third-party-library-file"></a>サードパーティ製のライブラリファイルを開くことができません

この問題には、いくつかの一般的な原因があります。

- ライブラリファイルへのパスが正しくないか、リンカーに指定されていない可能性があります。

- 32ビットバージョンのライブラリがインストールされている場合がありますが、64ビットまたはその逆をビルドしている可能性があります。

- ライブラリは、インストールされていない他のライブラリに依存している可能性があります。

パスの問題を修正するには、ビルドするすべての構成について、LIB 環境変数が設定されていて、使用するライブラリのすべてのディレクトリが含まれていることを確認します。 IDE では、LIB 変数は、[ [VC + + ディレクトリ] プロパティページ](../../build/reference/vcpp-directories-property-page.md)の "**ライブラリディレクトリ**" プロパティによって設定されます。 ビルドするすべての構成について、必要なライブラリが含まれているすべてのディレクトリがここに一覧表示されていることを確認します。

標準ライブラリディレクトリを上書きするライブラリディレクトリを指定する必要がある場合は、コマンドラインで[/libpath](../../build/reference/libpath-additional-libpath.md)オプションを使用するか、IDE で 構成プロパティ の **[追加のライブラリディレクトリ]** プロパティを使用できます。 **> リンカー > プロジェクトの [全般** プロパティページ。

ビルドする構成に必要なすべてのバージョンのライブラリがインストールされていることを確認します。 多くの一般的なライブラリのインストールとセットアップを自動化するには、 [vcpkg](../../vcpkg.md) package management utility を使用することを検討してください。 可能な場合は、サードパーティ製のライブラリのコピーを作成することをお勧めします。そのため、ライブラリに必要なすべてのローカルの依存関係があることを確認し、プロジェクトと同じ構成用にビルドします。

### <a name="cannot-open-a-file-built-by-your-project"></a>プロジェクトによってビルドされたファイルを開くことができません

ファイル*名*がソリューションによって作成されていても、リンカーがそれにアクセスしようとしてもまだ存在しない場合は、このエラーが発生することがあります。 これは、あるプロジェクトが別のプロジェクトに依存していても、プロジェクトが正しい順序でビルドされていない場合に発生する可能性があります。 この問題を解決するには、ファイルを使用するプロジェクトでプロジェクト参照が設定されていることを確認します。これにより、不足しているファイルが必要になる前にビルドされます。 詳細については、「 [Visual C++ Studio プロジェクトへの参照の追加](../../build/adding-references-in-visual-cpp-projects.md)」および「[プロジェクト内の参照の管理](/visualstudio/ide/managing-references-in-a-project)」を参照してください。

### <a name="cannot-open-file-cprogramobj"></a>ファイル ' C:\\.obj ' を開くことができません

このエラーが発生した場合、またはドライブのルートにある予期しない .obj ファイルに関連するエラーが発生した場合は、ほとんどの場合、二重引用符で囲まれていないライブラリパスが問題となります。

コマンドラインビルドのこの問題を解決するには、 [/libpath](../../build/reference/libpath-additional-libpath.md)オプションのパラメーター、LIB 環境変数で指定されたパス、およびコマンドラインで指定されたパスを確認し、スペースを含むパスを二重引用符で囲んでください。

IDE でこの問題を解決するには、[構成プロパティ] の [ [> VC + + ディレクトリ](../../build/reference/vcpp-directories-property-page.md)] プロパティページの **[ライブラリディレクトリ]** プロパティを確認し、構成プロパティ > リンカー の **[追加のライブラリディレクトリ]** プロパティを確認します。 **> [全般**] プロパティページ、およびプロジェクトの [**構成プロパティ] > [リンカー > 入力**] プロパティページの **[追加の依存関係]** プロパティを使用します。 必要に応じて、必要なライブラリが含まれているすべてのディレクトリパスが二重引用符で囲まれていることを確認します。

### <a name="other-common-issues"></a>その他の一般的な問題

このエラーは、コマンドラインまたは[#pragma comment (lib, "library_name")](../../preprocessor/comment-c-cpp.md)ディレクティブでリンカーに指定されたライブラリファイル名またはパスが正しくない場合、またはパスに無効なドライブ指定がある場合に発生する可能性があります。 スペルとファイル拡張子を確認し、指定した場所にファイルが存在することを確認します。

別のプログラムのファイルが開かれている可能性があり、リンカーはそのファイルに書き込めません。 多くの場合、ウイルス対策プログラムは、新しく作成されたファイルへのアクセスを一時的にブロックします。 この問題を解決するには、プロジェクトのビルドディレクトリをウイルス対策スキャナーから除外してみてください。

並行ビルドオプションを使用している場合は、Visual Studio によって別のスレッドでファイルがロックされている可能性があります。 この問題を解決するには、複数のプロジェクトで同じコードオブジェクトまたはライブラリをビルドしないようにし、ビルド依存関係またはプロジェクト参照を使用してプロジェクトのビルド済みバイナリを取得することを確認します。

**[追加の依存関係]** プロパティで個別のライブラリを指定する場合は、コンマまたはセミコロンではなく、スペースを使用してライブラリ名を区切ります。 **[編集]** メニュー項目を使用して **[追加の依存関係]** ダイアログボックスを開く場合は、コンマ、セミコロン、スペースではなく、改行を使用して名前を区切ります。 **[ライブラリディレクトリ]** ダイアログボックスおよび **[追加のライブラリディレクトリ]** ダイアログボックスでライブラリパスを指定するときにも、改行を使用します。

*ファイル名*のパスが260文字を超えて拡張された場合に、このエラーが表示されることがあります。 必要に応じて名前を変更するか、ディレクトリ構造を再配置して、必要なファイルへのパスを短くします。

このエラーは、ファイルが大きすぎることが原因で発生する可能性があります。 ライブラリまたはオブジェクトファイルのサイズが gb を超えると、32ビットのリンカーで問題が発生する可能性があります。 この問題を解決するには、64ビットツールセットを使用します。 これをコマンドラインで実行する方法の詳細については[、次を参照してください。コマンドライン](../../build/how-to-enable-a-64-bit-visual-cpp-toolset-on-the-command-line.md)で64ビットビジュアルC++ツールセットを有効にします。 IDE でこれを行う方法の詳細については、次を参照してください。、 [MSBuild を使用して、64ビットのコンパイラとツールを使用](../../build/walkthrough-using-msbuild-to-create-a-visual-cpp-project.md#using-msbuild-to-build-your-project)して、Stack Overflow post します。[Visual Studio でネイティブの amd64 ツールチェーンを使用する方法について説明](https://stackoverflow.com/questions/19820718/how-to-make-visual-studio-use-the-native-amd64-toolchain/23793055)します。

このエラーは、ファイル*名*にアクセスするための十分なファイルアクセス許可がない場合に発生する可能性があります。 これは、通常のユーザーアカウントを使用し、保護されたシステムディレクトリ内のライブラリファイルにアクセスしようとした場合、または元のアクセス許可が設定されている他のユーザーからコピーしたファイルを使用した場合に発生する可能性があります。 この問題を解決するには、ファイルを書き込み可能なプロジェクトディレクトリに移動します。 書き込み可能なディレクトリにファイルがあり、アクセス許可がない場合は、管理者のコマンドプロンプトを使用して、msiexec.exe コマンドを実行してファイルの所有権を取得できます。

このエラーは、十分なディスク領域がない場合に発生する可能性があります。 リンカーが一時ファイルを使用するケースはいくつかあります。 十分なディスク領域がある場合でも、非常に大きなリンクによって使用可能なディスク領域が消費されたり、断片化されたりする可能性があります。 [/Opt (最適化)](../../build/reference/opt-optimizations.md)オプションの使用を検討してください。推移的な COMDAT 削除を実行すると、すべてのオブジェクトファイルが複数回読み込まれます。

*ファイル名*が、リンカーによって一時ファイルに対して生成されたファイル名である LNK*nnn*という名前の場合、tmp 環境変数で指定されたディレクトリが存在しないか、tmp 環境変数に複数のディレクトリを指定できます。 TMP 環境変数には、1つのディレクトリパスのみを指定する必要があります。
