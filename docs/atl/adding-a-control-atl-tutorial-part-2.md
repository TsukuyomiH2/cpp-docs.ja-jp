---
description: '詳細情報: コントロールの追加 (ATL チュートリアル、パート 2)'
title: コントロールの追加 (ATL チュートリアル、パート 2)
ms.custom: get-started-article
ms.date: 08/19/2019
ms.assetid: c9575a75-1064-41f1-9697-7aada560c669
ms.openlocfilehash: 91e0f6ba4b091b6ca213495fb81727714755c635
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/11/2020
ms.locfileid: "97166305"
---
# <a name="adding-a-control-atl-tutorial-part-2"></a>コントロールの追加 (ATL チュートリアル、パート 2)

この手順では、コントロールをプロジェクトに追加し、ビルドして、Web ページでテストします。

## <a name="procedures"></a>手順

### <a name="to-add-an-object-to-an-atl-project"></a>オブジェクトを ATL プロジェクトに追加するには

1. **ソリューションエクスプローラー** で、プロジェクトを右クリックし `Polygon` ます。

1. ショートカットメニューの [ **追加** ] をポイントし、サブメニューの [ **新しい項目** ] をクリックします。

    **[新しい項目の追加]** ダイアログ ボックスが表示されます。 さまざまなオブジェクトのカテゴリが、左側にツリー構造で表示されます。

1. [ **ATL** ] フォルダーをクリックします。

1. 右側のテンプレートの一覧から [ **ATL コントロール**] を選択します。 **[追加]** をクリックします。 **ATL コントロール** ウィザードが開き、コントロールを構成できます。

1. `PolyCtl`短い名前として「」と入力すると、他のフィールドは自動的に完了します。 さらに変更を加える必要があるため、[ **完了** ] をクリックしないでください。

**ATL コントロール** ウィザードの [**名前**] ページには、次のフィールドがあります。

|フィールド|内容|
|-----------|--------------|
|**短い名前**|コントロール用に入力した名前。|
|**クラス**|コントロールを実装するために作成された C++ クラス名。|
|**.h ファイル**|C++ クラスの定義を格納するために作成されたファイル。|
|**.cpp ファイル**|C++ クラスの実装を格納するために作成されたファイル。|
|**コクラス**|このコントロールのコンポーネント クラスの名前。|
|**Interface**|コントロールがカスタム プロパティとメソッドを実装するインターフェイスの名前。|
|**Type**|コントロールの説明。|
|**ProgID**|コントロールの CLSID を検索するために使用できる、判読可能な名前。|

**ATL コントロール** ウィザードでは、いくつかの追加設定を変更する必要があることがわかります。

### <a name="to-enable-support-for-rich-error-information-and-connection-points"></a>詳細なエラー情報と接続ポイントのサポートを有効にするには

1. [ **オプション** ] をクリックして、[ **オプション** ] ページを開きます。

1. [ **接続ポイント** ] チェックボックスをオンにします。 このオプションでは、IDL ファイルに送信インターフェイスのサポートが作成されます。

また、インターフェイスを追加して、コントロールの機能を拡張することもできます。

### <a name="to-extend-the-controls-functionality"></a>コントロールの機能を拡張するには

1. [ **インターフェイス** ] をクリックして、[ **インターフェイス** ] ページを開きます。

1. `IProvideClassInfo2`**上** 矢印を選択してクリックすると、**サポートされている** 一覧に移動します。

1. `ISpecifyPropertyPages`**上** 矢印を選択してクリックすると、**サポートされている** 一覧に移動します。

また、コントロールを *挿入* できるようにすることもできます。つまり、Excel や Word などの埋め込みオブジェクトをサポートするアプリケーションに埋め込むことができます。

### <a name="to-make-the-control-insertable"></a>コントロールを挿入可能にするには

1. [ **外観** ] をクリックして、[ **外観** ] ページを開きます。

1. [ **挿入** 可能] チェックボックスをオンにします。

このオブジェクトによって表示される多角形には、単色による塗りつぶしを適用するため、"`Fill Color`" ストック プロパティを追加する必要があります。

### <a name="to-add-a-fill-color-stock-property-and-create-the-control"></a>"塗りつぶしの色" ストック プロパティを追加するには、コントロールを作成します。

1. [ **ストックプロパティ** ] をクリックして、[ **ストックプロパティ** ] ページを開きます。

1. [ **サポートされていません**] で、使用可能なストックプロパティの一覧を下にスクロールします。 `Fill Color`**上** 矢印を選択してクリックすると、**サポートされている** 一覧に移動します。

1. **[完了]** を選択します。

ウィザードによってコントロールが作成されると、いくつかのコード変更やファイルの追加が行われます。 次のファイルが作成されます。

|ファイル|説明|
|----------|-----------------|
|PolyCtl.h|C++ クラス `CPolyCtl` のほとんどの実装が格納されています。|
|PolyCtl.cpp|`CPolyCtl` の残りの部分が格納されています。|
|PolyCtl.rgs|コントロールの登録に使用するレジストリ スクリプトが格納されたテキスト ファイル。|
|PolyCtl.htm|新しく作成されたコントロールへの参照が含まれた Web ページ。|

このウィザードでは、次のコード変更も行われます。

- ステートメントを `#include` プリコンパイル済みヘッダーファイルに追加して、コントロールをサポートするために必要な ATL ファイルを含めます。

- Polygon を変更して、新しいコントロールの詳細を含めます。

- 新しいコントロールを Polygon のオブジェクトマップに追加します。

これで、コントロールをビルドして動作を確認できます。

## <a name="building-and-testing-the-control"></a>コントロールのビルドとテスト

### <a name="to-build-and-test-the-control"></a>コントロールをビルドおよびテストするには

1. [ **ビルド** ] メニューの [ **多角形のビルド**] をクリックします。

    コントロールのビルドが完了したら、 **ソリューションエクスプローラー** で PolyCtl.htm を右クリックし、[ **ブラウザーで表示**] を選択します。 コントロールを含む HTML Web ページが表示されます。 "ATL 8.0 test page for object Polyctl.htm" というタイトルのページと、コントロール (テキスト Polyctl.htm) が表示されます。

> [!NOTE]
> コントロールが表示されていない場合は、一部のブラウザーで ActiveX コントロールを実行するための設定の調整が必要であることを確認します。 ActiveX コントロールを有効にする方法については、ブラウザーのドキュメントを参照してください。

> [!NOTE]
> このチュートリアルを完了すると、DLL ファイルを作成できないというエラーメッセージが表示された場合は、PolyCtl.htm ファイルと ActiveX コントロールテストコンテナーを閉じ、ソリューションをもう一度ビルドします。 それでも DLL を作成できない場合は、コンピューターを再起動するか、ターミナルサービスを使用している場合はログオフしてください。

次に、カスタムプロパティをコントロールに追加します。

手順[1 に戻り](../atl/creating-the-project-atl-tutorial-part-1.md) [、手順3に](../atl/adding-a-property-to-the-control-atl-tutorial-part-3.md)&#124; ます。

## <a name="see-also"></a>関連項目

[チュートリアル](../atl/active-template-library-atl-tutorial.md)
