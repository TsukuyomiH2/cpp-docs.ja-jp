---
title: ATL シンプル オブジェクト ウィザード
ms.date: 11/04/2016
f1_keywords:
- vc.codewiz.class.atl.simple.overview
helpviewer_keywords:
- ATL projects, adding objects
- ATL Simple Object Wizard
ms.assetid: f7f85741-9aad-4543-a917-a29b996364da
ms.openlocfilehash: 8bc611442e98e467a174ebd52ea3c540cf72975f
ms.sourcegitcommit: d9c94dcabd94537e304be0261b3263c2071b437b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/25/2020
ms.locfileid: "91352688"
---
# <a name="atl-simple-object-wizard"></a>ATL シンプル オブジェクト ウィザード

このウィザードでは、プロジェクトに最小 COM オブジェクトが挿入されます。 ウィザードのこのページを使用して、オブジェクトとその COM 機能の C++ クラスとファイルを識別する名前を指定します。

このウィザードの [ [オプション](../../atl/reference/options-atl-simple-object-wizard.md) ] ページを使用すると、オブジェクトのスレッドモデル、その集計サポート、およびデュアルインターフェイスとオートメーションをサポートするかどうかを指定できます。 また、エラー情報インターフェイス、接続ポイント、Internet Explorer のサポート、およびフリースレッドマーシャリングのサポートを指定することもできます。

## <a name="remarks"></a>解説

Visual Studio 2008 以降、このウィザードによって生成された登録スクリプトでは、その COM コンポーネントが **HKEY_LOCAL_MACHINE** ではなく **HKEY_CURRENT_USER** 下に登録されます。 この動作を変更するには、ATL ウィザードの **[すべてのユーザーについてコンポーネントを登録]** オプションを設定します。

## <a name="names"></a>名前

プロジェクトに追加するオブジェクト、インターフェイス、およびクラスの名前を指定します。 **[短い名前]** 以外のすべてのボックスは、他とは独立して編集できます。 **[短い名前]** のテキストを変更すると、このページ内にある他のすべてのボックスの名前に変更が反映されます。 COM セクションで **[コクラス]** の名前を変更すると、その変更は **[種類]** と **[ProgID]** のボックスに反映されますが、**[インターフェイス]** の名前は変更されません。 名前付けに関するこの動作は、コントロールを開発するときに、すべての名前を識別しやすくするために設計されています。

> [!NOTE]
> **[コクラス]** は属性なしプロジェクトでのみ編集可能です。 プロジェクトが属性付きである場合は、**[コクラス]** を編集できません。

## <a name="c"></a>C++

オブジェクト用に作成される C++ クラスの情報を指定します。

- **短い名前**

   オブジェクトの省略名を設定します。 指定する名前によって、`Class` と `Coclass` の名前、**.cpp ファイル**と **.h ファイル**の名前、**インターフェイス**の名前、**種類**の名前、および **ProgID** が決まります (各フィールドを個別に変更しない限り)。

- **.h ファイル**

   新しいオブジェクトのクラスにヘッダー ファイルの名前を設定します。 既定では、この名前は **[短い名前]** で指定した名前に基づきます。 選択した場所にファイル名を保存するには、あるいはクラス宣言を既存のファイルに追加するには、省略記号ボタンをクリックします。 既存のファイルを選択した場合、ウィザードで **[完了]** をクリックするまで、ファイルはウィザードによって選択した場所に保存されません。

   ウィザードではファイルは上書きされません。 既存のファイルの名前を選択する場合、**[完了]** をクリックすると、ウィザードからクラス宣言をファイルのコンテンツに追加するかどうかを指定するように求められます。 ファイルを追加するには、**[はい]** をクリックします。ウィザードに戻り、別のファイル名を指定するには、**[いいえ]** をクリックします。

- **クラス**

   作成するクラスの名前を設定します。 この名前は **[短い名前]** で指定した名前に基づき、クラス名の一般的なプレフィックスである 'C' が先頭に付きます。

- **.cpp ファイル**

   新しいオブジェクトのクラスに実装ファイルの名前を設定します。 既定では、この名前は **[短い名前]** で指定した名前に基づきます。 ファイル名を選択した場所に保存するには、省略記号ボタンをクリックします。 ファイルは、ウィザードで **[完了]** をクリックするまで選択した場所に保存されません。

   ウィザードではファイルは上書きされません。 既存のファイルの名前を選択する場合、**[完了]** をクリックすると、ウィザードからクラスの実装をファイルのコンテンツに追加するかどうかを指定するように求められます。 ファイルを追加するには、**[はい]** をクリックします。ウィザードに戻り、別のファイル名を指定するには、**[いいえ]** をクリックします。

- **属性付き**

   オブジェクトで属性を使用するかどうかを指示します。 属性付き ATL プロジェクトにオブジェクトを追加する場合はこのオプションが選択され、変更はできません。 つまり、属性のサポートと共に作成されたプロジェクトに追加できるのは、属性付きオブジェクトのみです。

   属性付きオブジェクトは、属性を使う ATL プロジェクトにのみ追加できます。 属性をサポートしていない ATL プロジェクトに対してこのオプションを選択した場合、ウィザードによって、プロジェクトに属性のサポートを追加するかどうかを指定するように求められます。

   既定では、このオプションを設定した後に追加するすべてのオブジェクトは、属性付きとして指定されます (チェック ボックスが選択されます)。 このボックスをオフにして、属性を使わないオブジェクトを追加することができます。

   詳細については [、「アプリケーションの設定」、「ATL プロジェクトウィザード](../../atl/reference/application-settings-atl-project-wizard.md) 」、および「 [属性の基本的な機構](../../windows/attributes/cpp-attributes-com-net.md#basic-mechanics-of-attributes) 」を参照してください。

## <a name="com"></a>COM (COM)

オブジェクトの COM 機能に関する情報を指定します。

- **コクラス**

   オブジェクトでサポートされるインターフェイスの一覧を含むコンポーネント クラスの名前を設定します。

   > [!NOTE]
   > 属性を使用してプロジェクトを作成する場合、またはこのウィザードのページで、オブジェクトが属性を使用することを指定した場合、ATL には属性が含まれないため、このオプションを変更することはできません `coclass` 。

- **Type**

   レジストリに表示されるオブジェクトの説明を設定します。

- **Interface**

   オブジェクト用に作成するインターフェイスを設定します。 このインターフェイスには、カスタム メソッドが含まれます。

- **ProgID**

   オブジェクトの CLSID の代わりにコンテナーで使用できる名前を設定します。

## <a name="see-also"></a>関連項目

[ATL シンプル オブジェクト](../../atl/reference/adding-an-atl-simple-object.md)
