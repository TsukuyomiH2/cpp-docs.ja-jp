---
title: ATL コントロール ウィザード
ms.date: 11/04/2016
f1_keywords:
- vc.codewiz.class.atl.control.overview
helpviewer_keywords:
- ATL projects, adding controls
- controls [ATL], adding to projects
- ATL Control Wizard
ms.assetid: 991f8e72-ffbc-4382-a4ce-e255acfba5b6
ms.openlocfilehash: a10c5c358901122dda37b395c1f0fa5cdc30ce30
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81321695"
---
# <a name="atl-control-wizard"></a>ATL コントロール ウィザード

ATL プロジェクト (または ATL をサポートする MFC プロジェクト) に ATL コントロールを挿入します。 このウィザードを使用して、次の 3 種類のコントロールのいずれかを挿入できます。

- 標準制御

- 複合制御

- DHTML コントロール

また、ほとんどのコンテナでコントロールを開くために既定として用意されているインターフェイスリストから[インターフェイス](../../atl/reference/interfaces-atl-control-wizard.md)を削除する、最小限のコントロールを指定できます。 ウィザードの「インターフェース」ページで、コントロールに対してサポートする**インターフェース**を設定できます。

## <a name="remarks"></a>解説

このウィザードによって生成された登録スクリプトは、HKEY_LOCAL_MACHINEではなく、HKEY_CURRENT_USERの下に COM コンポーネントを登録します。 この動作を変更するには、ATL ウィザードの **[すべてのユーザーについてコンポーネントを登録]** オプションを設定します。

## <a name="names"></a>名前

プロジェクトに追加するオブジェクト、インターフェイス、およびクラスの名前を指定します。 **短い名前**を除き、他のすべてのボックスは個別に変更できます。 **[短い名前]** のテキストを変更すると、このページ内にある他のすべてのボックスの名前に変更が反映されます。 COM セクションで**コクラス**名を変更すると、変更は **[タイプ**] ボックスに反映されますが、**インターフェイス**名と**ProgID**は変更されません。 名前付けに関するこの動作は、コントロールを開発するときに、すべての名前を識別しやすくするために設計されています。

> [!NOTE]
> **コクラス**は、属性のないコントロールでのみ編集可能です。 プロジェクトが属性付きである場合は、**[コクラス]** を編集できません。

### <a name="c"></a>C++

オブジェクトを実装するために作成される C++ クラスの情報を指定します。

- **短い名前**

   オブジェクトの省略名を設定します。 指定する名前によって、クラス名と**コクラス**名、ファイル(.CPP と .H) フィールドを個別に変更しない限り、名前、インターフェイス名、**およびタイプ**名。

- **クラス**

   このオブジェクトを実装するクラスの名前を設定します。 この名前は **[短い名前]** で指定した名前に基づき、クラス名の一般的なプレフィックスである 'C' が先頭に付きます。

- **.h ファイル**

   新しいオブジェクトのクラスにヘッダー ファイルの名前を設定します。 既定では、この名前は **[短い名前]** で指定した名前に基づきます。 選択した場所にファイル名を保存するには、あるいはクラス宣言を既存のファイルに追加するには、省略記号ボタンをクリックします。 既存のファイルを選択した場合は、[**完了**] をクリックするまで、選択した場所に保存されません。

   ウィザードではファイルは上書きされません。 既存のファイルの名前を選択する場合、**[完了]** をクリックすると、ウィザードからクラス宣言をファイルのコンテンツに追加するかどうかを指定するように求められます。 ファイルを追加するには、**[はい]** をクリックします。ウィザードに戻り、別のファイル名を指定するには、**[いいえ]** をクリックします。

- **.cpp ファイル**

   新しいオブジェクトのクラスに実装ファイルの名前を設定します。 既定では、この名前は **[短い名前]** で指定した名前に基づきます。 ファイル名を選択した場所に保存するには、省略記号ボタンをクリックします。 ファイルは、ウィザードで **[完了]** をクリックするまで選択した場所に保存されません。

   ウィザードではファイルは上書きされません。 既存のファイルの名前を選択する場合、**[完了]** をクリックすると、ウィザードからクラスの実装をファイルのコンテンツに追加するかどうかを指定するように求められます。 ファイルを追加するには、**[はい]** をクリックします。ウィザードに戻り、別のファイル名を指定するには、**[いいえ]** をクリックします。

- **属性付き**

   オブジェクトで属性を使用するかどうかを指示します。 属性付き ATL プロジェクトにオブジェクトを追加する場合はこのオプションが選択され、変更はできません。 つまり、属性のサポートと共に作成されたプロジェクトに追加できるのは、属性付きオブジェクトのみです。

   属性付きオブジェクトは、属性を使う ATL プロジェクトにのみ追加できます。 属性をサポートしていない ATL プロジェクトに対してこのオプションを選択した場合、ウィザードによって、プロジェクトに属性のサポートを追加するかどうかを指定するように求められます。

   既定では、このオプションを設定した後に追加するすべてのオブジェクトは、属性付きとして指定されます (チェック ボックスが選択されます)。 このボックスをオフにして、属性を使わないオブジェクトを追加することができます。

   詳細については、「[アプリケーションの設定、ATL プロジェクト ウィザード](../../atl/reference/application-settings-atl-project-wizard.md)」と「[属性の基本的なしくみ](../../windows/basic-mechanics-of-attributes.md)」を参照してください。

### <a name="com"></a>COM (COM)

オブジェクトの COM 機能に関する情報を指定します。

- **コクラス**

   オブジェクトでサポートされるインターフェイスの一覧を含むコンポーネント クラスの名前を設定します。

   > [!NOTE]
   > 属性を使用してプロジェクトを作成する場合、またはこのウィザード ページでコントロールが属性を使用することを指定した場合、ATL には**コクラス**属性が含まれないため、このオプションを変更できません。

- **インターフェイス**

   オブジェクトのインターフェイスの名前を設定します。 デフォルトでは、インターフェイス名の先頭に「I」が付きます。

- **Type**

   レジストリに表示されるオブジェクトの説明を設定します。

- **Progid**

   オブジェクトの CLSID の代わりにコンテナーで使用できる名前を設定します。 このフィールドは自動的には設定されません。 このフィールドを手動で設定しないと、コントロールが他のツールで使用できない場合があります。 たとえば、 を`ProgID`使用せずに生成された**ActiveX コントロールは、[ActiveX コントロールの挿入**] ダイアログ ボックスでは使用できません。 このダイアログ ボックスについて詳しくは、「[[ActiveX コントロールの挿入] ダイアログ ボックス](../../windows/insert-activex-control-dialog-box.md)」をご覧ください。

## <a name="see-also"></a>関連項目

[ATL コントロール](../../atl/reference/adding-an-atl-control.md)<br/>
[複合コントロールへの機能の追加](../../atl/adding-functionality-to-the-composite-control.md)<br/>
[ATL COM オブジェクトの基礎](../../atl/fundamentals-of-atl-com-objects.md)
