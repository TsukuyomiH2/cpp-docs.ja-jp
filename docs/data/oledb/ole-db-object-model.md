---
title: OLE DB オブジェクト モデル
ms.date: 10/22/2018
helpviewer_keywords:
- rowsets, OLE DB object model
- OLE DB, object model
ms.assetid: 1a274a25-c310-4430-a1ec-bd2bd8120eff
ms.openlocfilehash: b37205eb91317c602010a4b568057845b2345ef0
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81369795"
---
# <a name="ole-db-object-model"></a>OLE DB オブジェクト モデル

OLE DB オブジェクト モデルは、次のオブジェクトまたはコンポーネントで構成されています。 最初の 4 つのオブジェクトまたはコンポーネント (データ ソース、セッション、コマンド、および行セット) を使用すると、データ ソースに接続して表示できます。 アクセサーから始まる残りは、データが表示されるときの操作に関連しています。

## <a name="data-sources"></a>ソリューション エクスプローラー

データ ソース オブジェクトを使用すると、ファイルや DBMS などのデータ ソースに接続できます。 データ ソース オブジェクトは、接続を作成および管理し、アクセス許可と認証情報 (ログイン名やパスワードなど) を含みます。 データ ソース オブジェクトは、1 つ以上のセッションを作成できます。

## <a name="sessions"></a>セッション

セッションは、データ ソースとの特定の対話を管理して、データのクエリと取得を行います。 各セッションは 1 つのトランザクションです。 トランザクションは、ACID テストによって定義される不可分の作業単位です。 ACID の定義については、「[トランザクション](#vcconoledbcomponents_transactions)」を参照してください。

セッションは、行セットを開いたり、行セットを作成したデータ ソース オブジェクトを返すなどの重要なタスクを実行します。 セッションは、メタデータやデータ ソース自体に関する情報 (テーブル情報など) を返すこともできます。

セッションは、1 つ以上のコマンドを作成できます。

## <a name="commands"></a>コマンド

コマンドは、SQL ステートメントなどのテキスト コマンドを実行します。 テキスト コマンドで SQL **SELECT**ステートメントなどの行セットを指定すると、コマンドによって行セットが作成されます。

コマンドは、単にテキスト コマンドのコンテナーであり、プロバイダーの基になるデータ ストアによって実行するために、コンシューマーからデータ ソース オブジェクトに渡される文字列 (SQL ステートメントなど) です。 通常、テキスト コマンドは SQL **SELECT**ステートメントです (この場合、SQL **SELECT**は行セットを指定するため、コマンドは自動的に行セットを作成します)。

## <a name="rowsets"></a>行セット

行セットは、データを表形式で表示します。 インデックスは、行セットの特殊なケースです。 セッションまたはコマンドから行セットを作成できます。

### <a name="schema-rowsets"></a>スキーマ行セット

スキーマには、データベースに関するメタデータ (構造情報) があります。 スキーマ行セットは、スキーマ情報を持つ行セットです。 DBMS の OLE DB プロバイダの中には、スキーマ行セット オブジェクトをサポートするものもあります。 スキーマ行セットの詳細については、「[スキーマ行セットとスキーマ行セット](../../data/oledb/obtaining-metadata-with-schema-rowsets.md)クラスおよび[Typedef クラス](../../data/oledb/schema-rowset-classes-and-typedef-classes.md)を使用したメタデータの取得 」を参照してください。

### <a name="view-objects"></a>オブジェクトの表示

ビュー オブジェクトは、行セットの行と列のサブセットを定義します。 それはそれ自身のデータを持っていません。 ビュー オブジェクトは、複数の行セットのデータを結合できません。

## <a name="accessors"></a>アクセサー

アクセサーの概念を使用するのは OLE DB だけです。 アクセサーは、コンシューマーにデータを格納する方法を記述します。 このクラスには、コンシューマーで宣言した行セット フィールド (列) とデータ メンバーの間の一連のバインド (列マップと呼ばれます) があります。

## <a name="transactions"></a><a name="vcconoledbcomponents_transactions"></a>トランザクション

トランザクション オブジェクトは、最下位レベル以外のネストされたトランザクションをコミットまたは中止するときに使用されます。 トランザクションは、ACID テストによって定義される不可分の作業単位です。 ACID は次の意味を表します。

- 原子性、より小さな作業単位に分割することはできません

- 同時実行、複数のトランザクションが同時に発生する可能性がある

- 分離、あるトランザクションが別のトランザクションによって行われた変更に関する知識が限られている

- 持続性、トランザクションは永続的な変更を行います

## <a name="enumerators"></a>列挙子

列挙子は、使用可能なデータ ソースとその他の列挙子を検索します。 特定のデータ ソース用にカスタマイズされていないコンシューマーは、列挙子を使用して、使用するデータ ソースを検索します。

Microsoft データ アクセス SDK に付属しているルート列挙子は、データ ソースやその他の列挙子を検索してレジストリを走査します。 他の列挙子は、レジストリを走査するか、プロバイダー固有の方法で検索します。

## <a name="errors"></a>エラー

OLE DB オブジェクト上の任意のインターフェイスでエラーが発生する可能性があります。 エラーには、オプションのカスタム エラー オブジェクトなど、エラーに関する追加情報が含まれています。 この情報は HRESULT に格納されます。

## <a name="notifications"></a>通知

通知は、行セットを共有する協力コンシューマーのグループによって使用されます (共有とは、コンシューマーが同じトランザクション内で動作していると見なされることを意味します)。 通知を使用すると、行セットを共有する協力コンシューマーに、ピアが実行した行セットのアクションに関する情報を得ることができます。

## <a name="see-also"></a>関連項目

[OLE DB プログラミング](../../data/oledb/ole-db-programming.md)<br/>
[OLE DB プログラミングの概要](../../data/oledb/ole-db-programming-overview.md)
