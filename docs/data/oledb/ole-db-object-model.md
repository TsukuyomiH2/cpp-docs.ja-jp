---
title: OLE DB オブジェクト モデル
ms.date: 10/22/2018
helpviewer_keywords:
- rowsets, OLE DB object model
- OLE DB, object model
ms.assetid: 1a274a25-c310-4430-a1ec-bd2bd8120eff
ms.openlocfilehash: 192195d02b034546e50b1cb860b1f11c47dc2b65
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/24/2020
ms.locfileid: "80210120"
---
# <a name="ole-db-object-model"></a>OLE DB オブジェクト モデル

OLE DB オブジェクトモデルは、次のオブジェクトまたはコンポーネントで構成されています。 最初の4つのオブジェクトまたはコンポーネント (データソース、セッション、コマンド、および行セット) を使用して、データソースに接続して表示することができます。 残りの部分は、アクセサーで始まり、表示されるときのデータの操作に関連しています。

## <a name="data-sources"></a>ソリューション エクスプローラー

データソースオブジェクトを使用すると、ファイルや DBMS などのデータソースに接続できます。 データソースオブジェクトは、接続を作成して管理し、アクセス許可と認証情報 (ログイン名やパスワードなど) を格納します。 データソースオブジェクトは、1つまたは複数のセッションを作成できます。

## <a name="sessions"></a>セッション

セッションでは、データソースとの特定の相互作用を管理して、データのクエリと取得を行います。 各セッションは1つのトランザクションです。 トランザクションは、ACID テストで定義された分割不可能な作業単位です。 ACID の定義については、「[トランザクション](#vcconoledbcomponents_transactions)」を参照してください。

セッションは、行セットを開き、それを作成したデータソースオブジェクトを返すなどの重要なタスクを実行します。 また、セッションでは、メタデータや、データソース自体に関する情報 (テーブル情報など) を返すこともできます。

セッションでは、1つまたは複数のコマンドを作成できます。

## <a name="commands"></a>コマンド

コマンドは、SQL ステートメントなどのテキストコマンドを実行します。 Text コマンドで SQL **SELECT**ステートメントなどの行セットを指定すると、コマンドによって行セットが作成されます。

コマンドは、プロバイダーの基になるデータストアによって実行されるデータソースオブジェクトにコンシューマーから渡される文字列 (SQL ステートメントなど) であるテキストコマンドのコンテナーです。 通常、text コマンドは SQL **select**ステートメントです (この場合、sql **select**では行セットが指定されるため、行セットが自動的に作成されます)。

## <a name="rowsets"></a>行セット

行セットは、データを表形式で表示します。 インデックスは、行セットの特殊なケースです。 セッションまたはコマンドから行セットを作成できます。

### <a name="schema-rowsets"></a>スキーマ行セット

スキーマには、データベースに関するメタデータ (構造情報) があります。 スキーマ行セットは、スキーマ情報を含む行セットです。 DBMS の一部の OLE DB プロバイダーは、スキーマ行セットオブジェクトをサポートしています。 スキーマ行セットの詳細については、「スキーマ行セットと[スキーマ行セットクラスおよび Typedef クラス](../../data/oledb/schema-rowset-classes-and-typedef-classes.md)[を使用したメタデータの取得](../../data/oledb/obtaining-metadata-with-schema-rowsets.md)」を参照してください。

### <a name="view-objects"></a>オブジェクトの表示

ビューオブジェクトは、行セットの行と列のサブセットを定義します。 独自のデータはありません。 ビューオブジェクトでは、複数の行セットのデータを組み合わせることはできません。

## <a name="accessors"></a>アクセス

アクセサーの概念を使用するのは OLE DB だけです。 アクセサーは、コンシューマーにおけるデータの格納方法を記述します。 コンシューマーで宣言する行セットフィールド (列) とデータメンバーの間に、一連のバインド (列マップと呼ばれます) が含まれています。

##  <a name="transactions"></a><a name="vcconoledbcomponents_transactions"></a> トランザクション

トランザクションオブジェクトは、最下位レベル以外の入れ子になったトランザクションをコミットまたは中止するときに使用されます。 トランザクションは、ACID テストで定義された分割不可能な作業単位です。 ACID は次のことを意味します。

- 原子性は、小さな作業単位に分割することはできません

- 同時実行、複数のトランザクションが同時に発生する可能性がある

- 分離。一方のトランザクションは、別のトランザクションによって行われた変更に関する知識が限られています。

- 持続性。トランザクションによって永続的な変更が行われます。

## <a name="enumerators"></a>列挙子

列挙子使用可能なデータソースとその他の列挙子を検索します。 特定のデータソース用にカスタマイズされていないコンシューマーは、列挙子を使用して、使用するデータソースを検索します。

Microsoft Data Access SDK に同梱されているルート列挙子は、レジストリを走査してデータソースやその他の列挙子を探します。 他の列挙子は、レジストリをスキャンするか、プロバイダー固有の方法で検索します。

## <a name="errors"></a>エラー

任意の OLE DB オブジェクトのインターフェイスでは、エラーが発生する可能性があります。 エラーには、エラーに関する追加情報 (オプションのカスタムエラーオブジェクトなど) が含まれます。 この情報は HRESULT に格納されます。

## <a name="notifications"></a>通知

通知は、行セットを共有する協調コンシューマーのグループによって使用されます (共有の場合、コンシューマーは同じトランザクション内で動作していると見なされます)。 通知によって、行セットを共有する協調コンシューマーは、そのピアによって実行される行セットに対するアクションに関する情報を得ることができます。

## <a name="see-also"></a>参照

[OLE DB プログラミング](../../data/oledb/ole-db-programming.md)<br/>
[OLE DB プログラミングの概要](../../data/oledb/ole-db-programming-overview.md)
