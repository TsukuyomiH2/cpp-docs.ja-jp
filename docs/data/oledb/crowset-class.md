---
title: CRowset クラス
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: 2be4cb1936536b68aed1f8ea937f6f72904c766d
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/27/2020
ms.locfileid: "87221524"
---
# <a name="crowset-class"></a>CRowset クラス

OLE DB 行セットオブジェクトといくつかの関連インターフェイスをカプセル化し、行セットデータの操作メソッドを提供します。

## <a name="syntax"></a>構文

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>パラメーター

*TAccessor*<br/>
アクセサークラス。 既定値は、`CAccessorBase` です。

## <a name="requirements"></a>必要条件

**ヘッダー:** atldbcli.h

## <a name="members"></a>メンバー

### <a name="methods"></a>メソッド

|||
|-|-|
|[AddRefRows](#addrefrows)|現在の行に関連付けられている参照カウントをインクリメントします。|
|[[閉じる]](#close)|行と現在のインターフェイスを解放し `IRowset` ます。|
|[比較](#compare)|[IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85))を使用して2つのブックマークを比較します。|
|[CRowset](#crowset)|新しいオブジェクトを作成 `CRowset` し、必要に応じて、 `IRowset` パラメーターとして指定されたインターフェイスに関連付けます。|
|[削除](#delete)|[IRowsetChange: DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85))を使用して行セットから行を削除します。|
|[FindNextRow](#findnextrow)|指定されたブックマークの後に一致する次の行を検索します。|
|[GetApproximatePosition](#getapproximateposition)|ブックマークに対応する行のおおよその位置を返します。|
|[GetData](#getdata)|行セットの行のコピーからデータを取得します。|
|[GetDataHere](#getdatahere)|指定されたバッファーからデータを取得します。|
|[GetOriginalData](#getoriginaldata)|データソースから最後にフェッチまたは転送されたデータを取得します。保留中の変更は無視されます。|
|[GetRowStatus](#getrowstatus)|すべての行の状態を返します。|
|[挿入](#insert)|[IRowsetChange: InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85))を使用して新しい行を作成して挿入します。|
|[IsSameRow](#issamerow)|指定した行と現在の行を比較します。|
|[MoveFirst](#movefirst)|次のフェッチ位置を初期位置に再配置します。|
|[MoveLast](#movelast)|最後のレコードに移動します。|
|[MoveNext](#movenext)|次の行を超えて、次の行から指定された位置数だけデータをフェッチします。|
|[MovePrev](#moveprev)|前のレコードに移動します。|
|[MoveToBookmark](#movetobookmark)|ブックマークによってマークされた行、またはそのブックマークの指定したオフセット位置にある行をフェッチします。|
|[MoveToRatio](#movetoratio)|行セット内の小数位置から始まる行をフェッチします。|
|[ReleaseRows](#releaserows)|[IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85))を呼び出して、現在の行ハンドルを解放します。|
|[SetData](#setdata)|[IRowsetChange: SetData](/previous-versions/windows/desktop/ms721232(v=vs.85))を使用して、行の1つ以上の列にデータ値を設定します。|
|[元に戻す](#undo)|前回のフェッチまたは[更新](../../data/oledb/crowset-update.md)以降に行に加えられたすべての変更を元に戻します。|
|[アップデート](#update)|前回のフェッチまたは更新以降に現在の行に加えられた保留中の変更を転送します。|
|[UpdateAll](#updateall)|前回のフェッチまたは更新以降に行われたすべての行に対する保留中の変更を転送します。|

## <a name="remarks"></a>解説

OLE DB では、行セットは、プログラムがデータを設定および取得するために使用するオブジェクトです。

このクラスはインスタンス化されるものではなく、テンプレートパラメーターとしてまたはに渡され `CTable` `CCommand` `CRowset` ます (は既定値です)。

## <a name="crowsetaddrefrows"></a><a name="addrefrows"></a>CRowset:: AddRefRows

[IRowset:: AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85))を呼び出して、現在の行ハンドルに関連付けられている参照カウントを1ずつインクリメントします。

### <a name="syntax"></a>構文

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

このメソッドは、現在の行ハンドルの参照カウントをインクリメントします。 [ReleaseRows](../../data/oledb/crowset-releaserows.md)を呼び出して、カウントをデクリメントします。 Move メソッドによって返される行には、参照カウントが1つあります。

## <a name="crowsetclose"></a><a name="close"></a>CRowset:: Close

行と現在の[IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85))インターフェイスを解放します。

### <a name="syntax"></a>構文

```cpp
void Close() throw();
```

### <a name="remarks"></a>解説

このメソッドは、行セット内の現在のすべての行を解放します。

## <a name="crowsetcompare"></a><a name="compare"></a>CRowset:: Compare

[IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85))を使用して2つのブックマークを比較します。

### <a name="syntax"></a>構文

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>パラメーター

*Bookmark1*<br/>
から比較する最初のブックマーク。

*Bookmark2*<br/>
から比較する2番目のブックマーク。

*pComparison*<br/>
入出力比較の結果へのポインター。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

このメソッドには、省略可能なインターフェイスが必要です。これ `IRowsetLocate` は、すべてのプロバイダーでサポートされていない場合があります。この場合、メソッドは E_NOINTERFACE を返します。 また、 `DBPROP_IRowsetLocate` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に、を VARIANT_TRUE に設定する必要があります。

コンシューマーでのブックマークの使用の詳細については、「[ブックマークの使用](../../data/oledb/using-bookmarks.md)」を参照してください。

## <a name="crowsetcrowset"></a><a name="crowset"></a>CRowset:: CRowset

新しいオブジェクトを作成 `CRowset` し、必要に応じて、パラメーターとして指定された[IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85))インターフェイスに関連付けます。

### <a name="syntax"></a>構文

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>パラメーター

*pRowset*<br/>
から`IRowset`このクラスに関連付けられているインターフェイスへのポインター。

## <a name="crowsetdelete"></a><a name="delete"></a>CRowset::D e)

[IRowsetChange::D eleterows](/previous-versions/windows/desktop/ms724362(v=vs.85))を呼び出して、行セットから現在の行を削除します。

### <a name="syntax"></a>構文

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>戻り値

標準の HRESULT です。

## <a name="crowsetfindnextrow"></a><a name="findnextrow"></a>CRowset:: FindNextRow

指定されたブックマークの後に一致する次の行を検索します。

### <a name="syntax"></a>構文

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>パラメーター

*ファンド*<br/>
から行の値を比較するときに使用する操作。 値については、「 [IRowsetFind:: FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85))」を参照してください。

*pData*<br/>
から照合する値へのポインター。

*wType*<br/>
からバッファーの値部分のデータ型を示します。 型インジケーターの詳細については、Windows SDK の*OLE DB プログラマーリファレンス*の「[データ型](/previous-versions/windows/desktop/ms723969(v=vs.85))」を参照してください。

*nLength*<br/>
からデータ値に割り当てられたコンシューマーデータ構造体のバイト単位の長さ。 詳細については、 `cbMaxLen` *OLE DB プログラマーリファレンス*の[DBBINDING 構造体](/previous-versions/windows/desktop/ms716845(v=vs.85))のの説明を参照してください。

*bPrecision*<br/>
からデータを取得するときに使用される最大有効桁数。 *Wtype*が DBTYPE_NUMERIC 場合にのみ使用されます。 詳細については、 *OLE DB プログラマーのリファレンス*で[DBTYPE_NUMERIC または DBTYPE_DECIMAL に関連する変換](/previous-versions/windows/desktop/ms719714(v=vs.85))に関する説明を参照してください。

*bScale*<br/>
からデータを取得するときに使用するスケール。 *Wtype*が DBTYPE_NUMERIC または DBTYPE_DECIMAL の場合にのみ使用されます。 詳細については、 *OLE DB プログラマーのリファレンス*で[DBTYPE_NUMERIC または DBTYPE_DECIMAL に関連する変換](/previous-versions/windows/desktop/ms719714(v=vs.85))に関する説明を参照してください。

*bSkipCurrent*<br/>
から検索を開始するブックマークの行の数。

*pBookmark*<br/>
から検索を開始する位置のブックマーク。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

このメソッドには、省略可能なインターフェイスが必要です。これ `IRowsetFind` は、すべてのプロバイダーでサポートされていない場合があります。この場合、メソッドは E_NOINTERFACE を返します。 また、 `DBPROP_IRowsetFind` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に、を VARIANT_TRUE に設定する必要があります。

コンシューマーでのブックマークの使用の詳細については、「[ブックマークの使用](../../data/oledb/using-bookmarks.md)」を参照してください。

## <a name="crowsetgetapproximateposition"></a><a name="getapproximateposition"></a>CRowset:: GetApproximatePosition

ブックマークに対応する行のおおよその位置を返します。

### <a name="syntax"></a>構文

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>パラメーター

*pBookmark*<br/>
から位置が検索される行を識別するブックマークへのポインター。 行数のみが必要な場合は NULL です。

*pPosition*<br/>
入出力が行の位置を返す位置へのポインター `GetApproximatePosition` 。 位置が必要でない場合は NULL。

*pcRows*<br/>
入出力が `GetApproximatePosition` 行の合計数を返す場所へのポインター。 行数が必要でない場合は NULL です。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

このメソッドには、省略可能なインターフェイスが必要です。これ `IRowsetScroll` は、すべてのプロバイダーでサポートされていない場合があります。この場合、メソッドは E_NOINTERFACE を返します。 また、 `DBPROP_IRowsetScroll` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に、を VARIANT_TRUE に設定する必要があります。

コンシューマーでのブックマークの使用の詳細については、「[ブックマークの使用](../../data/oledb/using-bookmarks.md)」を参照してください。

## <a name="crowsetgetdata"></a><a name="getdata"></a>CRowset:: GetData

行セットの行のコピーからデータを取得します。

### <a name="syntax"></a>構文

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>パラメーター

*nAccessor*<br/>
からデータへのアクセスに使用するアクセサーのインデックス番号 (0 オフセット)。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

[BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md)の autoaccessor ではないアクセサーを指定する場合は、このメソッドを使用して、アクセサー番号を渡してデータを明示的に取得します。

## <a name="crowsetgetdatahere"></a><a name="getdatahere"></a>CRowset:: GetDataHere

現在の行からデータを取得し、指定したバッファーに格納します。

### <a name="syntax"></a>構文

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>パラメーター

*nAccessor*<br/>
からデータへのアクセスに使用するアクセサーのインデックス番号。

*pBuffer*<br/>
入出力現在のレコードのデータを格納するバッファー。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

この関数の使用方法の例については、 [MultiRead サンプル](../../overview/visual-cpp-samples.md)を参照してください。

## <a name="crowsetgetoriginaldata"></a><a name="getoriginaldata"></a>CRowset:: GetOriginalData

を呼び出して、 `IRowsetUpdate::GetOriginalData` データソースから最後にフェッチまたは転送されたデータを取得します。

### <a name="syntax"></a>構文

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

このメソッドは、データソースから最後にフェッチまたは転送されたデータを取得します。保留中の変更に基づいて値が取得されることはありません。

このメソッドには、省略可能なインターフェイスが必要です。これ `IRowsetUpdate` は、すべてのプロバイダーでサポートされていない場合があります。この場合、メソッドは E_NOINTERFACE を返します。 また、 `DBPROP_IRowsetUpdate` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に、を VARIANT_TRUE に設定する必要があります。

## <a name="crowsetgetrowstatus"></a><a name="getrowstatus"></a>CRowset:: GetRowStatus

すべての行の状態を返します。

### <a name="syntax"></a>構文

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>パラメーター

*pStatus*<br/>
入出力が状態値を返す場所へのポインター `GetRowStatus` 。 OLE DB プログラマーリファレンスの DBPENDINGSTATUS を参照してください。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

このメソッドには、省略可能なインターフェイスが必要です。これ `IRowsetUpdate` は、すべてのプロバイダーでサポートされていない場合があります。この場合、メソッドは E_NOINTERFACE を返します。 また、 `DBPROP_IRowsetUpdate` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に、を VARIANT_TRUE に設定する必要があります。

## <a name="crowsetinsert"></a><a name="insert"></a>CRowset:: Insert

アクセサーのデータを使用して新しい行を作成し、初期化します。

### <a name="syntax"></a>構文

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>パラメーター

*nAccessor*<br/>
からデータの挿入に使用するアクセサーの番号。

*bGetHRow*<br/>
から挿入された行のハンドルを取得するかどうかを示します。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

このメソッドには、省略可能なインターフェイスが必要です。これ `IRowsetChange` は、すべてのプロバイダーでサポートされていない場合があります。この場合、メソッドは E_NOINTERFACE を返します。 また、 `DBPROP_IRowsetChange` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に、を VARIANT_TRUE に設定する必要があります。

1つ以上の列が書き込み可能でない場合、Insert は失敗する可能性があります。 これを修正するにはカーソル マップを変更します。

### <a name="example"></a>例

次の例では、行セットを使用してデータソースにアクセスし、その行セット内のテーブルを使用して文字列を挿入する方法を示します。

まず、新しい ATL オブジェクトをプロジェクトに挿入して、テーブルクラスを作成します。 たとえば、ワークスペースペインでプロジェクトを右クリックし、[**新しい ATL オブジェクト**] を選択します。 [**データアクセス**] カテゴリで、[**コンシューマー**] を選択します。 **Table**型のコンシューマーオブジェクトを作成します。 ([**テーブル**] を選択すると、テーブルから直接行セットが作成されます。 [**コマンド]** を選択すると、SQL コマンドを使用して行セットが作成されます)。データソースを選択し、そのデータソースへのアクセスに使用するテーブルを指定します。 コンシューマーオブジェクトの**cb2c テーブル**を呼び出す場合は、次のように挿入コードを実装します。

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="crowsetissamerow"></a><a name="issamerow"></a>CRowset:: IsSameRow

指定した行と現在の行を比較します。

### <a name="syntax"></a>構文

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>パラメーター

*hRow*<br/>
から現在の行と比較する行を処理するハンドル。

### <a name="return-value"></a>戻り値

標準の HRESULT です。 S_OK は、行が同じであることを示します。 その他の値については、Windows SDK の*OLE DB プログラマーリファレンス*の「 [IRowsetIndentity:: IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) 」を参照してください。

## <a name="crowsetmovefirst"></a><a name="movefirst"></a>CRowset:: MoveFirst

カーソルを初期位置に移動し、最初の行を取得します。

### <a name="syntax"></a>構文

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

[IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85))を呼び出して、次のフェッチ位置を初期位置 (行セットが作成されたときの次のフェッチ位置) に再配置し、初期行を取得します。

## <a name="crowsetmovelast"></a><a name="movelast"></a>CRowset:: MoveLast

カーソルを最後の行に移動します。

### <a name="syntax"></a>構文

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

[IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85))を呼び出して、次のフェッチ位置を最後の位置に移動し、最後の行を取得します。

このメソッド `DBPROP_CANSCROLLBACKWARDS` `Open` では、行セットを含むテーブルまたはコマンドでを呼び出す前に、を VARIANT_TRUE に設定する必要があります。 (パフォーマンス向上のために、を VARIANT_TRUE に設定することもでき `DBPROP_QUICKRESTART` ます)。

## <a name="crowsetmovenext"></a><a name="movenext"></a>CRowset:: MoveNext

カーソルを次のレコードに移動します。

### <a name="syntax"></a>構文

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>パラメーター

*lSkip*<br/>
からフェッチする前にスキップする行の数。

*bForward*<br/>
から**`true`** 後方に移動するには、次のレコードに進むためにを渡し **`false`** ます。

### <a name="return-value"></a>戻り値

標準の HRESULT です。 行セットの末尾に到達すると、DB_S_ENDOFROWSET を返します。

### <a name="remarks"></a>解説

前の位置を記憶して、オブジェクトから次の行をフェッチし `CRowset` ます。 必要に応じて、 *lSkip*行をスキップするか、後方に移動するかを選択できます。

このメソッドでは、 `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に、次のプロパティを設定する必要があります。

- `DBPROP_CANSCROLLBACKWARDS`*lSkip* < 0 の場合は VARIANT_TRUE である必要があります

- `DBPROP_CANFETCHBACKWARDS`*Bforward* = false の場合は VARIANT_TRUE する必要があります。

それ以外 ( *lSkip* >= 0 および*bforward* = true) の場合は、追加のプロパティを設定する必要はありません。

## <a name="crowsetmoveprev"></a><a name="moveprev"></a>CRowset:: MovePrev

カーソルを前のレコードに移動します。

### <a name="syntax"></a>構文

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

このメソッドを使用するに `DBPROP_CANFETCHBACKWARDS` は、 `DBPROP_CANSCROLLBACKWARDS` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に VARIANT_TRUE にまたはを設定する必要があります。

## <a name="crowsetmovetobookmark"></a><a name="movetobookmark"></a>CRowset:: MoveToBookmark

ブックマークまたは指定されたオフセット (*lSkip*) にある行を、そのブックマークからフェッチします。

### <a name="syntax"></a>構文

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>パラメーター

*bookmark*<br/>
からデータをフェッチする場所を示すブックマーク。

*lSkip*<br/>
からブックマークから対象の行までの行数。 *LSkip*が0の場合、最初にフェッチされた行がブックマークが付けられた行になります。 *LSkip*が1の場合、最初にフェッチされる行は、ブックマークが付けられた行の後の行になります。 *LSkip*が-1 の場合、最初にフェッチされる行は、ブックマークが付けられた行の前の行になります。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

このメソッドには、省略可能なインターフェイスが必要です。これ `IRowsetLocate` は、すべてのプロバイダーでサポートされていない場合があります。この場合、メソッドは E_NOINTERFACE を返します。 また、 `DBPROP_IRowsetLocate` を VARIANT_TRUE に設定し、 `DBPROP_CANFETCHBACKWARDS` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に VARIANT_TRUE に設定する必要があります。

コンシューマーでのブックマークの使用の詳細については、「[ブックマークの使用](../../data/oledb/using-bookmarks.md)」を参照してください。

## <a name="crowsetmovetoratio"></a><a name="movetoratio"></a>CRowset:: MoveToRatio

行セット内の小数位置から始まる行をフェッチします。

### <a name="syntax"></a>構文

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>パラメーター

*nNumerator*<br/>
からデータのフェッチ元の位置を示す小数部を決定するために使用される分子。

*nDenominator*<br/>
からデータのフェッチ元の位置を示す小数点以下の桁数を決定するために使用する分母。

*bForward*<br/>
から前方または後方に移動するかどうかを示します。 既定値は forward です。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

`MoveToRatio`は、次の式に従って行をフェッチします。

`(nNumerator *  RowsetSize ) / nDenominator`

ここで `RowsetSize` 、は行セットのサイズです (行単位)。 この数式の精度は、特定のプロバイダーによって異なります。 詳細については、「 [IRowsetScroll:: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85))」を参照してください。

このメソッドには、省略可能なインターフェイスが必要です。これ `IRowsetScroll` は、すべてのプロバイダーでサポートされていない場合があります。この場合、メソッドは E_NOINTERFACE を返します。 また、 `DBPROP_IRowsetScroll` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に、を VARIANT_TRUE に設定する必要があります。

## <a name="crowsetreleaserows"></a><a name="releaserows"></a>CRowset:: ReleaseRows

[IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85))を呼び出して、現在の行ハンドルを解放します。

### <a name="syntax"></a>構文

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>戻り値

標準の HRESULT です。

## <a name="crowsetsetdata"></a><a name="setdata"></a>CRowset:: SetData

行の1つ以上の列にデータ値を設定します。

### <a name="syntax"></a>構文

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>パラメーター

*nAccessor*<br/>
からデータへのアクセスに使用するアクセサーの番号。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

引数を `SetData` 受け取らない形式では、すべてのアクセサーが更新に使用されます。 通常は、を呼び出して、 `SetData` 行の列にデータ値を設定し、 [Update](../../data/oledb/crowset-update.md)を呼び出してこれらの変更を転送します。

このメソッドには、省略可能なインターフェイスが必要です。これ `IRowsetChange` は、すべてのプロバイダーでサポートされていない場合があります。この場合、メソッドは E_NOINTERFACE を返します。 また、 `DBPROP_IRowsetChange` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に、を VARIANT_TRUE に設定する必要があります。

1つ以上の列が書き込み可能でない場合、設定操作は失敗する可能性があります。 これを修正するにはカーソル マップを変更します。

## <a name="crowsetundo"></a><a name="undo"></a>CRowset:: Undo

前回のフェッチまたは[更新](../../data/oledb/crowset-update.md)以降に行に加えられたすべての変更を元に戻します。

### <a name="syntax"></a>構文

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>パラメーター

*pcRows*<br/>
入出力が `Undo` 必要な場合に、元に戻すことが試行された行の数を返す場所へのポインター。

*phRow*<br/>
入出力が `Undo` 必要に応じて、元に戻す処理を実行しようとしたすべての行へのハンドルの配列を返す場所へのポインター。

*pStatus*<br/>
入出力が `Undo` 行の状態の値を返す場所へのポインター。 *Pstatus*が null の場合、状態は返されません。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

このメソッドには、省略可能なインターフェイスが必要です。これ `IRowsetUpdate` は、すべてのプロバイダーでサポートされていない場合があります。この場合、メソッドは E_NOINTERFACE を返します。 また、 `DBPROP_IRowsetUpdate` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に、を VARIANT_TRUE に設定する必要があります。

## <a name="crowsetupdate"></a><a name="update"></a>CRowset:: Update

前回のフェッチまたは呼び出し以降に行われた保留中の変更を現在の行に送信 `Update` します。

### <a name="syntax"></a>構文

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>パラメーター

*pcRows*<br/>
入出力必要に応じて、 `Update` 更新しようとした行の数をが返す位置へのポインター。

*phRow*<br/>
入出力を `Update` 更新しようとした行のハンドルをが返す位置へのポインター。 *Phrow*が null の場合、ハンドルは返されません。

*pStatus*<br/>
入出力が `Update` 行の状態の値を返す場所へのポインター。 *Pstatus*が null の場合、状態は返されません。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

### <a name="remarks"></a>解説

行が最後にフェッチまたは更新された後に、現在の行に加えられた保留中の変更を転送 `Update` します (または[updateall](../../data/oledb/crowset-updateall.md)を使用します)。 通常、 [SetData](../../data/oledb/crowset-setdata.md)を呼び出して、行の列にデータ値を設定し、 `Update` を呼び出してこれらの変更を転送します。

このメソッドには、省略可能なインターフェイスが必要です。これ `IRowsetUpdate` は、すべてのプロバイダーでサポートされていない場合があります。この場合、メソッドは E_NOINTERFACE を返します。 また、 `DBPROP_IRowsetUpdate` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に、を VARIANT_TRUE に設定する必要があります。

## <a name="crowsetupdateall"></a><a name="updateall"></a>CRowset:: UpdateAll

前回のフェッチまたは呼び出し以降に行われたすべての行に対する保留中の変更を転送 `Update` します。

### <a name="syntax"></a>構文

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>パラメーター

*pcRows*<br/>
入出力必要に応じて、 `UpdateAll` 更新しようとした行の数をが返す位置へのポインター。

*pphRow*<br/>
入出力を `UpdateAll` 更新しようとした行のハンドルを返すメモリへのポインター。 *Pphrow*が null の場合、ハンドルは返されません。

*ppStatus*<br/>
入出力が `Update` 行の状態の値を返す場所へのポインター。 *Ppstatus*が null の場合、状態は返されません。

### <a name="remarks"></a>解説

[Update](../../data/oledb/crowset-update.md)またはを使用して行が最後にフェッチまたは更新された後に、すべての行に対して行われた保留中の変更を転送し `UpdateAll` ます。 `UpdateAll`は、変更されたすべての行を更新します。ただし、それらのハンドルがあるかどうかは関係ありません (「 *Pphrow*」を参照してください)。

たとえば、行セットに5つの行を挿入するためにを使用した場合は、を `Insert` 5 回呼び出すか、 `Update` `UpdateAll` を1回呼び出してすべてを更新することができます。

このメソッドには、省略可能なインターフェイスが必要です。これ `IRowsetUpdate` は、すべてのプロバイダーでサポートされていない場合があります。この場合、メソッドは E_NOINTERFACE を返します。 また、 `DBPROP_IRowsetUpdate` `Open` 行セットを含むテーブルまたはコマンドでを呼び出す前に、を VARIANT_TRUE に設定する必要があります。

### <a name="return-value"></a>戻り値

標準の HRESULT です。

## <a name="see-also"></a>関連項目

[DBViewer サンプル](../../overview/visual-cpp-samples.md)<br/>
[MultiRead サンプル](../../overview/visual-cpp-samples.md)<br/>
[MultiRead Attributes サンプル](../../overview/visual-cpp-samples.md)<br/>
[OLE DB コンシューマー テンプレート](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[OLE DB コンシューマーテンプレートリファレンス](../../data/oledb/ole-db-consumer-templates-reference.md)
