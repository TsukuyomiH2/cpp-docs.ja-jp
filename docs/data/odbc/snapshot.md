---
title: スナップショット
ms.date: 11/04/2016
helpviewer_keywords:
- ODBC cursor library [ODBC], snapshots
- cursors [ODBC], static
- recordsets, snapshots
- snapshots, support in ODBC
- static cursors
- ODBC recordsets, snapshots
- cursor library [ODBC], snapshots
- snapshots
ms.assetid: b5293a52-0657-43e9-bd71-fe3785b21c7e
ms.openlocfilehash: e487b5abcc5eee4e3f4b1941100980eac4a040c8
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81366909"
---
# <a name="snapshot"></a>スナップショット

スナップショットは、スナップショットの作成時に存在していたデータの静的ビューを反映するレコードセットです。 スナップショットを開いてすべてのレコードに移動すると、そのスナップショットに含まれるレコードのセットとその値は、 を呼び出`Requery`してスナップショットを再構築するまで変更されません。

> [!NOTE]
> このトピックの内容は、MFC ODBC クラスに該当します。 MFC ODBC クラスの代わりに MFC DAO クラスを使用している場合は、スナップショット タイプのレコードセットの説明については[、「CDaoRecordset::Open」](../../mfc/reference/cdaorecordset-class.md#open)を参照してください。

データベース クラスを使用して更新可能スナップショットまたは読み取り専用スナップショットを作成できます。 ダイナセットとは異なり、更新可能なスナップショットは他のユーザーによるレコード値の変更を反映しませんが、プログラムによって行われた更新と削除を反映しています。 スナップショットに追加されたレコードは、 を呼び出`Requery`すまでスナップショットに表示されません。

> [!TIP]
> スナップショットは ODBC 静的カーソルです。 静的カーソルは、そのレコードにスクロールするまで、実際にはデータの行を取得しません。 すべてのレコードがすぐに取得されるようにするには、レコードセットの末尾までスクロールし、最初に表示するレコードまでスクロールします。 ただし、最後までスクロールすると余分なオーバーヘッドが発生し、パフォーマンスが低下する可能性があることに注意してください。

スナップショットは、レポートを生成するときや計算を実行するときのように、操作中にデータを固定しておく必要がある場合に最も役立ちます。 それでも、データ ソースはスナップショットから大幅に異なるので、時々再構築する必要があります。

スナップショットのサポートは、任意のレベル 1 ドライバーの静的カーソルと位置付け更新 (更新可能性に必要) を提供する ODBC カーソル ライブラリに基づいています。 このサポートを行うには、カーソル ライブラリ DLL をメモリに読み込む必要があります。 オブジェクトを構築し`CDatabase`、そのメンバー関数`OpenEx`を呼び出すときは`CDatabase::useCursorLib`*、dwOptions*パラメーターのオプションを指定する必要があります。 メンバー関数を呼`Open`び出すと、カーソル ライブラリは既定で読み込まれます。 スナップショットの代わりにダイナセットを使用している場合は、カーソルライブラリをロードしないようにします。

スナップショットは、`CDatabase`オブジェクトの構築時に ODBC カーソル ライブラリが読み込まれた場合、または使用している ODBC ドライバが静的カーソルをサポートしている場合にのみ使用できます。

> [!NOTE]
> 一部の ODBC ドライバーでは、スナップショット (静的カーソル) は更新できない場合があります。 サポートされているカーソルの種類と、サポートされている同時実行の種類については、ドライバーのドキュメントを確認してください。 更新可能なスナップショットを保証するには、オブジェクトを作成するときに、必ずカーソル ライブラリを`CDatabase`メモリに読み込みます。 詳細については[、「ODBC: ODBC カーソル ライブラリ](../../data/odbc/odbc-the-odbc-cursor-library.md)」を参照してください。

> [!NOTE]
> スナップショットとダイナセットの両方を使用する場合は、2 つの異なるオブジェクト`CDatabase`(2 つの異なる接続) に基づいて作成する必要があります。

すべてのレコードセットで共有されるプロパティの詳細については、「[レコードセット (ODBC)](../../data/odbc/recordset-odbc.md)」を参照してください。 ODBC カーソル ライブラリを含む ODBC およびスナップショットの詳細については[、「ODBC](../../data/odbc/odbc-basics.md)」を参照してください。

## <a name="see-also"></a>関連項目

[データベース接続を開く (ODBC)](../../data/odbc/open-database-connectivity-odbc.md)
