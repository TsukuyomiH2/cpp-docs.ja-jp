---
title: スナップショット
ms.date: 11/04/2016
helpviewer_keywords:
- ODBC cursor library [ODBC], snapshots
- cursors [ODBC], static
- recordsets, snapshots
- snapshots, support in ODBC
- static cursors
- ODBC recordsets, snapshots
- cursor library [ODBC], snapshots
- snapshots
ms.assetid: b5293a52-0657-43e9-bd71-fe3785b21c7e
ms.openlocfilehash: 62b5952f3052a3248175ce7892b1cf4615f1dd17
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/24/2020
ms.locfileid: "80212694"
---
# <a name="snapshot"></a>スナップショット

スナップショットは、スナップショットの作成時に存在していたデータの静的なビューを反映したレコードセットです。 スナップショットを開いてすべてのレコードに移動すると、そのスナップショットに含まれるレコードのセットとその値は、`Requery`を呼び出してスナップショットを再構築するまで変更されません。

> [!NOTE]
>  このトピックの内容は、MFC ODBC クラスに該当します。 Mfc ODBC クラスではなく MFC DAO クラスを使用している場合は、「 [CDaoRecordset:: Open](../../mfc/reference/cdaorecordset-class.md#open) 」でスナップショット型のレコードセットの説明を参照してください。

データベースクラスを使用して、更新可能または読み取り専用のスナップショットを作成できます。 ダイナセットとは異なり、更新可能なスナップショットには、他のユーザーが行ったレコード値の変更は反映されませんが、プログラムによって行われた更新と削除は反映されます。 スナップショットに追加されたレコードは、`Requery`を呼び出すまでスナップショットに表示されません。

> [!TIP]
>  スナップショットは、ODBC の静的カーソルです。 静的カーソルは、そのレコードまでスクロールするまで、実際にはデータの行を取得しません。 すべてのレコードが即座に取得されるようにするには、レコードセットの末尾までスクロールして、表示する最初のレコードまでスクロールします。 ただし、最後にスクロールするとオーバーヘッドが増加し、パフォーマンスが低下することに注意してください。

スナップショットは、操作中にデータが固定されている必要がある場合に、レポートを生成したり計算を実行したりするときに最も役立ちます。 それでも、データソースはスナップショットから大きくなることがあります。そのため、データソースを随時再構築することができます。

スナップショットのサポートは、ODBC カーソルライブラリに基づいています。 ODBC カーソルライブラリは、任意のレベル1のドライバーについて、静的カーソルと位置指定更新 (更新可能に必要) を提供します。 このサポートのために、カーソルライブラリ DLL をメモリに読み込む必要があります。 `CDatabase` オブジェクトを構築し、その `OpenEx` メンバー関数を呼び出す場合は、 *dwOptions*パラメーターの `CDatabase::useCursorLib` オプションを指定する必要があります。 `Open` メンバー関数を呼び出すと、既定でカーソルライブラリが読み込まれます。 スナップショットではなく、ダイナセットを使用する場合は、カーソルライブラリを読み込まないようにする必要があります。

スナップショットは、`CDatabase` オブジェクトの構築時に ODBC カーソルライブラリが読み込まれた場合、または使用している ODBC ドライバーが静的カーソルをサポートしている場合にのみ使用できます。

> [!NOTE]
>  ODBC ドライバーによっては、スナップショット (静的カーソル) が更新できないことがあります。 サポートされているカーソルの種類と、サポートする同時実行の種類については、ドライバーのドキュメントを参照してください。 更新可能なスナップショットを保証するには、`CDatabase` オブジェクトを作成するときに、カーソルライブラリをメモリに読み込むようにします。 詳細については、「 [odbc: Odbc カーソルライブラリ](../../data/odbc/odbc-the-odbc-cursor-library.md)」を参照してください。

> [!NOTE]
>  スナップショットとダイナセットの両方を使用する場合は、2つの異なる `CDatabase` オブジェクト (2 つの異なる接続) に基づいて作成する必要があります。

すべてのレコードセットとスナップショットを共有するプロパティの詳細については、「[レコードセット (ODBC)](../../data/odbc/recordset-odbc.md)」を参照してください。 Odbc カーソルライブラリを含む ODBC およびスナップショットの詳細については、「 [odbc](../../data/odbc/odbc-basics.md)」を参照してください。

## <a name="see-also"></a>参照

[ODBC (Open Database Connectivity)](../../data/odbc/open-database-connectivity-odbc.md)
