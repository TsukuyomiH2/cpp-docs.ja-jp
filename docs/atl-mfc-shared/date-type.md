---
title: 日付型
ms.date: 11/04/2016
f1_keywords:
- DATE
helpviewer_keywords:
- Date data type, implementing
- Date data type
- DATE type
- Date data type, about Date data type
- MFC, date and time
- hour values representation
ms.assetid: 695853ed-b614-4575-b793-b8c287372038
ms.openlocfilehash: 5a6c1e1cca5b2cb978d6af4208377db1a2926357
ms.sourcegitcommit: a1676bf6caae05ecd698f26ed80c08828722b237
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/29/2020
ms.locfileid: "91502184"
---
# <a name="date-type"></a>日付型

日付型は、8バイトの浮動小数点数を使用して実装されます。 Days は、30年12月1899、午前0時 (時) の0から始まる整数値で表されます。 時間の値は、数値の小数部分の絶対値で表されます。 次の表は、いくつかの日付と、その日付型に相当する数値を示しています。

|日付と時刻|[表記]|
|-------------------|--------------------|
|1899年12月30日午前0時|0.00|
|1年1月1900日午前0時|2.00|
|1900年1月4日午前0時|5.00|
|1900年1月4日、午前6時|5.25|
|4月1900日 (正午)|5.50|
|4月1900日、午後9時|5.875|

DATE date 型およびクラスは、日付 `COleDateTime` と時刻を従来の番号行として表します。 `COleDateTime`クラスには、他の一般的な日付形式との間の変換など、日付値を操作するためのメソッドがいくつか含まれています。

オートメーションでこれらの日付と時刻の書式を使用する場合は、次の点に注意する必要があります。

- 日付はローカル時刻で指定します。異なるタイムゾーンの日付を操作する場合は、同期を手動で実行する必要があります。

- 日付の種類では、夏時間は考慮されません。

- 日付タイムラインは、0未満の日付値 (1899 年12月30日より前) に対して不連続になります。 これは、日付値の整数部分は符号付きとして扱われ、小数部分は符号なしとして扱われるためです。 つまり、日付値の整数部分は正または負のどちらかになりますが、日付値の小数部は常に論理日付全体に追加されます。 次の表は、いくつかの例を示しています。

|日付と時刻|[表記]|
|-------------------|--------------------|
|27 1899 年12月27日午前0時|-3.00|
|午後12時1899、正午|-2.50|
|28 1899 年12月28日午前0時|-2.00|
|1899年12月29日午前0時|-1.00|
|1899年12月30日、午後6時|-0.75|
|午後30時1899、正午|-0.50|
|1899年12月30日午前6時|-0.25|
|1899年12月30日午前0時|0.00|
|1899年12月30日午前6時|0.25|
|午後30時1899、正午|0.50|
|1899年12月30日、午後6時|0.75|
|1899年12月31日午前0時|1.00|
|1年1月1900日午前0時|2.00|
|1年1月1900、正午|2.50|
|2月1900日午前0時|3.00|

> [!CAUTION]
> 6:00 AM は、日を表す整数が正 (12 月 1899 30 日以降) または負 (1899 30 年12月30日より前) であるかどうかに関係なく、常に小数値0.25 で表されるため、単純な浮動小数点の比較では、同じ日の 6:00 AM を表す *日付よりも、12/30/1899 より* も前の日付に対して、

日付と型に関連する問題の詳細については、 `COleDateTime` 「 [COleDateTime クラス](../atl-mfc-shared/reference/coledatetime-class.md) 」と「 [日付と時刻: オートメーションサポート](./date-and-time.md)」を参照してください。

## <a name="see-also"></a>関連項目

[日時](../atl-mfc-shared/date-and-time.md)<br/>
[COleDateTime クラス](../atl-mfc-shared/reference/coledatetime-class.md)
