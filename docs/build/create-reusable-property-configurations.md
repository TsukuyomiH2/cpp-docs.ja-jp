---
title: Visual Studio プロジェクト設定を共有または再利用する - C++
ms.date: 07/17/2019
helpviewer_keywords:
- project properties [C++], reusable
ms.openlocfilehash: bcf54be0531c7150c1506eb6f5dda2b5bc95161f
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81328701"
---
# <a name="share-or-reuse-visual-studio-project-settings"></a>Visual Studio プロジェクトの設定を共有または再利用する

他のユーザーと共有したり、複数のプロジェクトで再利用したりできる設定のカスタム グループを作成するには **、Property Manager**を使用して*プロパティ シート*(.props ファイル) を作成し、再利用または共有を行うプロジェクトの種類ごとに設定を保存します。 プロパティ シートを使用すると、"グローバル" 設定を作成する他の方法よりもはるかにエラーが発生しにくい可能性があります。

> [!IMPORTANT]
> **.user ファイルとそれが問題になる理由**
>
> Visual Studio の過去のバージョンでは、.user ファイル名拡張子を持ち、\<userprofile>\AppData\Local\Microsoft\MSBuild\v4.0\ フォルダーにある、グローバル プロパティ シートを使っていました。 これらのファイルは、ユーザー単位、コンピューター単位でプロジェクト構成のプロパティを設定するため、現在はお勧めしていません。 このような "global" 設定は、特にビルド コンピューター上で複数のプラットフォームを対象とする場合にビルドに影響する可能性があります。 たとえば、MFC プロジェクトと Windows Phone プロジェクトの両方を持つ場合は、.user プロパティはいずれか 1 つに対して無効となります。 再利用可能なプロパティ シートは、より柔軟で堅牢です。
>
> 現在も .user ファイルは Visual Studio によってインストールされ、プロパティ継承に参加しますが、既定では空です。 ベスト プラクティスは、**プロパティ マネージャー**でそれらの参照を削除して、プロジェクトがユーザー単位のコンピューターごとの設定とは独立して動作することを確認する必要があります。

プロパティ**マネージャ**を表示するには、メニュー バーで、設定に応じて [**プロパティ マネージャ**を**表示** > ] または [**その他の Windows** > **プロパティ マネージャ**を**表示** > ] を選択します。

複数のプロジェクトに適用する一般的で頻繁に使用されるプロパティのセットがある場合は、プロパティ**マネージャ**を使用して、プロパティ シート ファイルを再利用可能な*プロパティ シート*ファイルにキャプチャできます。 プロパティを最初から設定しなくても済むように、そのシートを新しいプロジェクトに適用できます。

![プロパティ マネージャー ショートカット メニュー](media/sharingnew.png "共有新しい")

各構成ノードの下には、その構成に適用される各プロパティ シートのノードが表示されます。 ユーザーがプロジェクトを作成すると、システムはアプリ ウィザードでユーザーが選んだオプションに基づいて値を設定するプロパティ シートを追加します。 任意のノードを右クリックして [プロパティ] を選ぶと、そのノードに適用されるプロパティが表示されます。 すべてのプロパティ シートは、プロジェクトの "マスター" プロパティ シート (ms.cpp.props) に自動的にインポートされ、プロパティ マネージャーに表示される順序で評価されます。 プロパティ マネージャーで移動することにより、評価順序を変更することができます。 後で評価されるプロパティ シートにより、前に評価されたシートの値はオーバーライドされます。 vcxproj ファイル、.props ファイルと .targets ファイル、環境変数、およびコマンド ラインの評価の順序については、「プロジェクトプロパティの[継承](project-property-inheritance.md)」を参照してください。

**[新しいプロジェクト プロパティ シートの追加]** を選択し、[MyProps.props] プロパティ シートなどを選択すると、プロパティ ページのダイアログ ボックスが表示されます。 これは MyProps プロパティ シートに適用されることに注意してください。行った変更は、プロジェクト ファイル (.vcxproj) ではなくシートに書き込まれます。

.vcxproj ファイルで同じプロパティが直接設定されている場合、プロパティ シートのプロパティはオーバーライドされます。

必要に応じて何度でもプロパティ シートをインポートできます。 ソリューション内の複数のプロジェクトが同じプロパティ シートから設定を継承することができ、プロジェクトは複数のシートを持つことができます。 プロパティ シート自体は別のプロパティ シートから設定を継承できます。

また、複数の構成に対して 1 つのプロパティ シートを作成できます。 これを行うには、各構成のプロパティ シートを作成し、いずれかのショートカット メニューを開き、[**既存のプロパティ シートの追加**] をクリックして、他のシートを追加します。 ただし、1 つの共通プロパティ シートを使用する場合は、プロパティを設定すると、そのシートが適用されるすべてのコンフィギュレーションに設定され、指定されたプロパティ シートから継承しているプロジェクトやその他のプロパティ シートが表示されない点に注意してください。

多くのプロジェクトを持つ大規模なソリューションでは、ソリューション レベルでプロパティ シートを作成すると便利な場合があります。 プロジェクトをソリューションに追加する場合は、**プロパティ マネージャー**を使用して、そのプロパティ シートをプロジェクトに追加します。 プロジェクト レベルでの必要に応じて、新規プロパティ シートを追加してプロジェクト固有の値を設定できます。

> [!IMPORTANT]
> 既定では、.props ファイルはプロジェクト項目として作成されないため、ソース管理に参加しません。 ソース管理に含める場合は、ソリューション項目として手動でファイルを追加できます。

#### <a name="to-create-a-property-sheet"></a>プロパティ シートを作成するには

1. メニュー バーで、[**プロパティ マネージャ**の**表示** > ] または [**その他の Windows** > **プロパティ マネージャを****表示** > ] を選択します。 **プロパティ マネージャ**が開きます。

2. プロパティ シートのスコープを定義するには、適用する項目を選択します。 これは、特定の構成または別のプロパティ シートです。 この項目のショートカット メニューを開き、[**新しいプロジェクト プロパティ シートの追加**] をクリックします。 名前と場所を指定します。

3. **プロパティ マネージャ**で、新しいプロパティ シートを開き、含めるプロパティを設定します。
