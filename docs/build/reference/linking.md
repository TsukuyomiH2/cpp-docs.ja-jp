---
title: MSVC リンカーのリファレンス
ms.date: 12/10/2018
ms.assetid: bb736587-d13b-4f3c-8982-3cc2c015c59c
ms.openlocfilehash: 2503e212e7325fc97f9057861cb85d5cf0571094
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81336500"
---
# <a name="linking"></a>リンク

C++ プロジェクトでは、コンパイラがソース コードをオブジェクト ファイル (*.obj) にコンパイルした後に*リンク*手順が実行されます。 リンカー (link.exe) は、オブジェクト ファイルを 1 つの実行可能ファイルに結合します。

リンカー オプションは、Visual Studio の内部または外部に設定できます。 Visual Studio では、リンカー オプションにアクセスするには、**ソリューション エクスプローラー**でプロジェクト ノードを右クリックし、[**プロパティ]** を選択してプロパティ ページを表示します。 左ペインで [**リンカ**] を選択してノードを展開し、すべてのオプションを表示します。

## <a name="linker-command-line-syntax"></a>リンカー コマンドライン構文

Visual Studio の外部で LINK を実行する場合、1 つまたは複数の方法で入力を指定できます。

- コマンド ライン

- コマンド・ファイルの使用

- 環境変数で

LINK は、まず LINK 環境変数で指定されたオプションを処理し、その後にコマンド行およびコマンド・ファイルで指定された順序でオプションを処理します。 異なる引数を指定してオプションを繰り返すと、最後に処理されたオプションが優先されます。

オプションはビルド全体に適用されます。特定の入力ファイルにオプションを適用することはできません。

リンクを実行します。EXE を実行するには、次のコマンド構文を使用します。

```
LINK arguments
```

インクルード`arguments`オプションとファイル名は任意の順序で指定できます。 オプションは最初に処理され、次にファイルが処理されます。 引数を区切るためには、1 つ以上のスペースまたはタブを使用します。

> [!NOTE]
> このツールは、Visual Studio コマンド プロンプトからのみ開始できます。 システム コマンド プロンプトやエクスプローラーからは開始できません。

## <a name="command-line"></a>コマンド ライン

コマンド行では、オプションは、オプション指定子 (ダッシュ (-) またはスラッシュ (/) のいずれか、その後にオプションの名前が続きます。 オプション名の省略形は使用できません。 一部のオプションは、コロンの後に指定された引数を取ります (:)。 オプション指定の中で、/COMMENT オプションの引用符で囲まれた文字列の中を除き、スペースやタブは使用できません。 数値引数は、10 進数または C 言語表記で指定します。 オプション名とそのキーワードまたはファイル名引数は大文字と小文字は区別されませんが、引数としての識別子では大文字と小文字が区別されます。

リンカーにファイルを渡す場合は、LINK コマンドの後のコマンドラインでファイル名を指定します。 ファイル名に絶対パスまたは相対パスを指定し、ファイル名にワイルドカードを使用できます。 ドット (.) とファイル名拡張子を省略すると、ファイルを検索する目的で .obj と見なされます。 LINK はファイル名の拡張子を使用せず、ファイルの内容を前提としてファイルの拡張子が存在しない場合は使用しません。ファイルの種類を調べて、それに応じて処理します。

リンク.exe は成功した場合に 0 を返します (エラーはありません)。  それ以外の場合、リンカーはリンクを停止したエラー番号を返します。  たとえば、リンカーが LNK1104 を生成すると、リンカーは 1104 を返します。  したがって、リンカーがエラーで返す最も低いエラー番号は 1000 です。  戻り値 128 は、オペレーティング システムまたは .config ファイルの構成の問題を表します。ローダーは、link.exe または c2.dll を読み込めませんでした。

## <a name="link-command-files"></a>LINK コマンド ファイル

LINK にコマンド ライン引数をコマンド ファイルの形式で渡すことができます。 リンカーにコマンド ファイルを指定するには、次の構文を使用します。

> **LINK \@ **<em>コマンド ファイル</em>

*コマンド ファイル*はテキスト ファイルの名前です。 アット 記号 (**\@**) とファイル名の間にスペースやタブを使用することはできません。 既定の拡張子はありません。拡張子を含む完全なファイル名を指定する必要があります。 ワイルドカードは使用できません。 絶対パスまたは相対パスをファイル名とともに指定できます。 LINK は、ファイルの検索に環境変数を使用しません。

コマンド ファイルでは、引数は、スペースまたはタブ (コマンド ラインのように) および改行文字で区切ることができます。

コマンド・ファイル内で、コマンド・ラインのすべてまたは一部を指定できます。 LINK コマンドでは、複数のコマンド・ファイルを使用できます。 LINK は、コマンド・ライン上のその場所で指定された場合と同様に、コマンド・ファイル入力を受け入れます。 コマンド ファイルはネストできません。 LINK は[、/NOLOGO](nologo-suppress-startup-banner-linker.md)オプションが指定されていない限り、コマンド ファイルの内容をエコーします。

## <a name="example"></a>例

次のコマンドを使用して DLL をビルドすると、オブジェクト ファイルとライブラリの名前が別々のコマンド ファイルに渡され、/EXPORTS オプションを指定するために 3 番目のコマンド ファイルが使用されます。

```cmd
link /dll @objlist.txt @liblist.txt @exports.txt
```

## <a name="link-environment-variables"></a>環境変数 LINK

LINK ツールでは、次の環境変数を使用します。

- リンクおよび\_リンク\_(定義されている場合)。 LINK ツールは、LINK 環境変数で定義されているオプションと引数の前に\_、LINK\_環境変数で定義されたオプションと引数をコマンド ライン引数に追加してから処理します。

- LIB。定義されている場合。 LINK ツールは、コマンド ラインまたは[/BASE](base-base-address.md)オプションで指定されたオブジェクト、ライブラリ、またはその他のファイルを検索するときに LIB パスを使用します。 また、オブジェクトで指定された .pdb ファイルを検索するときにも LIB パスを使用します。 LIB 変数では、複数のパスをセミコロンで区切って指定できます。 1 つのパスは Visual C++ インストールの \lib サブディレクトリを示す必要があります。

- PATH。ツールが CVTRES を実行する必要があり、LINK 自身と同じディレクトリ内にこのファイルが見つからない場合  (リンクには.resファイルをリンクするためにCVTRESが必要です。PATH は、Visual C++ インストールの \bin サブディレクトリをポイントする必要があります。

- TMP。OMF ファイルまたは .res ファイルをリンクするときのディレクトリを指定します。

## <a name="see-also"></a>関連項目

[C/C++ ビルド リファレンス](c-cpp-building-reference.md)
[MSVC リンカー オプション](linker-options.md)
[モジュール定義 (.def) ファイル リン](module-definition-dot-def-files.md)
[カー サポート遅延読み込み DLL](linker-support-for-delay-loaded-dlls.md)
