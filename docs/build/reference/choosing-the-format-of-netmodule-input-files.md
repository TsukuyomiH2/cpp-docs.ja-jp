---
description: 詳細については、「.netmodule 入力ファイルの形式の選択」を参照してください。
title: .netmodule 入力ファイルの形式の選択
ms.date: 11/04/2016
ms.assetid: 4653d1bd-300f-4083-86f5-d1a06f44e61c
ms.openlocfilehash: ed7e448879e983ace7d96cdc7585bf0303378114
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/11/2020
ms.locfileid: "97179205"
---
# <a name="choosing-the-format-of-netmodule-input-files"></a>.netmodule 入力ファイルの形式の選択

( [/Clr](clr-common-language-runtime-compilation.md)を使用してコンパイルされた) MSIL .obj ファイルは、.netmodule ファイルとしても使用できます。  .obj ファイルには、メタデータとネイティブシンボルが含まれます。  netmodule にはメタデータのみが含まれます。

他の Visual Studio コンパイラには、/addmodule コンパイラオプションを使用して MSIL .obj ファイルを渡すことができます (ただし、.obj ファイルは、結果のアセンブリの一部になり、アセンブリに同梱されている必要があることに注意してください)。  たとえば、Visual C# と Visual Basic には、/addmodule コンパイラオプションがあります。

> [!NOTE]
> ほとんどの場合、.net モジュールを作成したコンパイルからリンカーに .obj ファイルを渡す必要があります。  .Dll または .netmodule MSIL モジュールファイルをリンカーに渡すと、LNK1107 が発生する可能性があります。

.obj ファイルとそれに関連付けられている .h ファイル (ソース内の #include を通じて参照) を使用して、C++ アプリケーションでモジュール内のネイティブ型を使用できるようにします。一方、.netmodule ファイルでは、C++ アプリケーションで使用できるのはマネージ型だけです。  #Using に .obj ファイルを渡そうとすると、ネイティブ型に関する情報は使用できなくなります。.obj ファイルの .h ファイルを #include します。

その他の Visual Studio コンパイラは、モジュールからマネージ型のみを使用できます。

次を使用して、MSVC リンカーへのモジュール入力として .netmodule ファイルまたは .obj ファイルを使用する必要があるかどうかを判断します。

- Visual C++ 以外の Visual Studio コンパイラを使用してビルドする場合は、.netmodule を生成し、リンカーへの入力として .netmodule を使用します。

- MSVC コンパイラを使用してモジュールを生成するときに、モジュールを使用してライブラリ以外のものをビルドする場合は、コンパイラによって生成された .obj ファイルをリンカーへのモジュール入力として使用します。入力として .netmodule ファイルを使用しないでください。

- モジュールを使用してネイティブ (管理されていない) ライブラリをビルドする場合は、リンカーへのモジュール入力として .obj ファイルを使用し、.lib ライブラリファイルを生成します。

- モジュールを使用してマネージライブラリをビルドし、リンカーへのすべてのモジュール入力を検証可能 (/clr: safe を使用して生成) する場合は、リンカーへのモジュール入力として .obj ファイルを使用し、.dll (アセンブリ) または .netmodule (モジュール) ライブラリファイルを生成します。

- モジュールを使用してマネージライブラリをビルドし、リンカーへの1つ以上のモジュール入力を/clr だけで生成する場合は、リンカーへのモジュール入力として .obj ファイルを使用し、.dll (アセンブリ) を生成します。  ライブラリからマネージ型を公開する場合、また、C++ アプリケーションでライブラリのネイティブ型を使用する必要がある場合は、ライブラリがライブラリコンポーネントモジュールの .obj ファイルで構成されます (各モジュールの .h ファイルも配布するため、ソースコードから #include で参照できます)。

## <a name="see-also"></a>関連項目

[リンカー入力としての .netmodule ファイル](netmodule-files-as-linker-input.md)
