---
title: Visual Studio で C++ コンパイラとビルド プロパティを設定する
description: Visual Studio IDE を使用して、C++ コンパイラ オプション、リンカー オプション、およびその他のビルド設定を変更します。
ms.date: 07/17/2019
helpviewer_keywords:
- project properties [C++], modifying
- properties [C++]
- Visual C++ projects, properties
- projects [C++], properties
ms.assetid: 9b0d6f8b-7d4e-4e61-aa75-7d14944816cd
ms.openlocfilehash: 6c05dd00324113819dd145e46bf10dfeb96a66a3
ms.sourcegitcommit: 8e285a766523e653aeeb34d412dc6f615ef7b17b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/21/2020
ms.locfileid: "80078230"
---
# <a name="set-compiler-and-build-properties"></a>コンパイラとビルドのプロパティを設定する

IDE では、プロジェクトをビルドするために必要なすべての情報は "*プロパティ*" として公開されます。 この情報には、アプリケーションの名前、拡張子 (DLL、LIB、EXE)、コンパイラ オプション、リンカー オプション、デバッガーの設定、カスタム ビルド ステップ、その他多くの情報が含まれます。 通常、これらのプロパティを表示および変更するには、"*プロパティ ページ*" を使用します。 プロパティ ページにアクセスするには、メイン メニューで **[プロジェクト]**  > [ **_projectname_ のプロパティ]** を選択するか、**ソリューション エクスプローラー**でプロジェクト ノードを右クリックし、 **[プロパティ]** を選択します。

## <a name="default-properties"></a>既定のプロパティ

プロジェクトを作成すると、システムによってさまざまなプロパティの値が割り当てられます。 プロジェクトの種類およびアプリ ウィザードで選んだオプションにより、既定値は若干異なります。 たとえば、ATL プロジェクトには MIDL ファイルに関するプロパティがありますが、基本的なコンソール アプリケーションにはありません。 既定のプロパティは、プロパティ ページの [全般] ウィンドウに表示されます。

![Visual C&#43;&#43; プロジェクトの既定値](media/visual-c---project-defaults.png "Visual C++ プロジェクトの既定値")

## <a name="applying-properties-to-build-configurations-and-target-platforms"></a>ビルド構成とターゲット プラットフォームへのプロパティの適用

アプリケーション名などの一部のプロパティは、ターゲット プラットフォームが何か、またはデバッグ ビルドかリリース ビルドかに関係なく、ビルドのすべてのバリエーションに適用されます。 ただし、ほとんどのプロパティは構成に依存します。 これは、コンパイラは、プログラムが実行される特定のプラットフォームと、正しいコードを生成するために使う特定のコンパイラ オプションを、知る必要があるためです。 そのため、プロパティを設定するときは、新しい値を適用する必要がある構成とプラットフォームに注意を払う必要があります。 "デバッグ Win32" ビルドだけに適用する必要がありますか、それとも "デバッグ ARM" と "デバッグ x64" にも適用する必要がありますか。 たとえば、既定の **[最適化]** プロパティは、リリース構成では **[実行速度 (/O2)]** に設定されますが、デバッグ構成では無効になっています。

プロパティ ページは、常に見ることができ、必要に応じて、プロパティ値を適用する必要がある構成とプラットフォームを変更できるように設計されています。 次の図のプロパティ ページでは、上部のリスト ボックスに構成とプラットフォームの情報が示されています。 ここで **[最適化]** プロパティを設定すると、設定は "デバッグ Win32" ビルドだけに適用されます。赤い矢印で示されているように、それはアクティブな構成です。

![アクティブな構成を示している Visual C&#43;&#43; のプロパティ ページ](media/visual-c---property-pages-showing-active-configuration.png "アクティブな構成を示している Visual C++ のプロパティ ページ")

次の図も同じプロジェクトのプロパティ ページですが、構成がリリースに変更されています。 [最適化] プロパティの値が異なることに注意してください。 また、アクティブな構成はまだデバッグであることにも注意してください。 ここでは、任意の構成のプロパティを設定することができます。アクティブである必要はありません。

![リリース構成を示している Visual C&#43;&#43; のプロパティ ページ](media/visual-c---property-pages-showing-release-config.png "リリース構成を示している Visual C++ のプロパティ ページ")

## <a name="target-platforms"></a>ターゲット プラットフォーム

"*ターゲット プラットフォーム*" とは、実行可能ファイルが実行されるデバイスとオペレーティング システムの種類のことです。 複数のプラットフォームを対象としてプロジェクトをビルドすることができます。 C++ プロジェクトで使用可能なターゲット プラットフォームは、プロジェクトの種類によって異なります。Win32、x64、ARM、Android、iOS などが含まれますが、これらだけではありません。     **構成マネージャー**で表示される **x86** ターゲット プラットフォームは、ネイティブ C++ プロジェクトの **Win32** と同じです。 Win32 とは 32 ビットの Windows を意味し、**x64** は 64 ビットの Windows を意味します。 これら 2 つのプラットフォームについて詳しくは、「[32 ビット アプリケーションの実行](/windows/win32/WinProg64/running-32-bit-applications)」をご覧ください。

**構成マネージャー**に表示されるターゲット プラットフォームの値 **[任意の CPU]** は、ネイティブ C++ プロジェクトには影響を与えません。これは、C++/CLI および他の .NET プロジェクトの種類に関係がある値です。 詳細については、「[/CLRIMAGETYPE (CLR イメージのタイプの指定)](reference/clrimagetype-specify-type-of-clr-image.md)」を参照してください。

デバッグ ビルド用のプロパティの設定の詳細については、以下を参照してください。

- [C++ デバッグ構成のプロジェクト設定](/visualstudio/debugger/project-settings-for-a-cpp-debug-configuration)
- [デバッガーの設定と準備](/visualstudio/debugger/debugger-settings-and-preparation)
- [デバッグの準備: Visual C++ のプロジェクトの種類](/visualstudio/debugger/debugging-preparation-visual-cpp-project-types)
- [Visual Studio デバッガーでのシンボル (.pdb) ファイルとソース ファイルの指定](/visualstudio/debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger)

## <a name="c-compiler-and-linker-options"></a>C++ のコンパイラとリンカーのオプション

C++ のコンパイラ オプションとリンカー オプションは、左側のウィンドウの **[構成プロパティ]** の下にある **[C/C++]** ノードと **[リンカー]** ノードの下に配置されています。 これらは、コンパイラに渡されるコマンドライン オプションに直接変換されます。 特定のオプションに関するドキュメントを参照するには、中央のウィンドウでオプションを選択し、**F1** を押します。 または、[MSVC コンパイラ オプション](reference/compiler-options.md)と [MSVC リンカー オプション](reference/linker-options.md)で、すべてのオプションのドキュメントを参照できます。

**[プロパティ ページ]** ダイアログ ボックスには、現在のプロジェクトに適用するプロパティ ページのみが表示されます。 たとえば、プロジェクトに .idl ファイルが含まれていない場合、MIDL プロパティ ページは表示されません。 各プロパティ ページの設定の詳細については、「[プロパティ ページ (C++)](reference/property-pages-visual-cpp.md)」を参照してください。

## <a name="directory-and-path-values"></a>ディレクトリとパスの値

MSBuild では、特定の文字列値 (ディレクトリやパスなど) に対して "マクロ" と呼ばれるコンパイル時定数の使用がサポートされています。 これらはプロパティ ページに表示され、[プロパティ エディター](#property_editor)を使用して参照したり変更したりできます。

次の図は、Visual Studio C++ プロジェクトのプロパティ ページを示しています。 左側のウィンドウでは **[VC++ ディレクトリ]** "*ルール*" が選択され、右側のウィンドウには、そのルールに関連付けられているプロパティの一覧が表示されています。 `$(...)` 値が "*マクロ*" と呼ばれます。 "*マクロ*" とは、Visual Studio や MSBuild システムによって定義されている値またはユーザー定義の値を参照できるコンパイル時定数です。 ディレクトリ パスなどのハードコーディングされた値の代わりにマクロを使用することで、コンピューター間や Visual Studio のバージョン間でより簡単にプロパティ設定を共有でき、プロジェクト設定が[プロパティ継承](project-property-inheritance.md)に適切に参加できるようにします。

![プロジェクトのプロパティ ページ](media/project_property_pages_vc.png "Project_Property_Pages_VC")

プロパティ エディターを使って、すべての使用可能なマクロの値を見ることができます。

### <a name="predefined-macros"></a>定義済みマクロ

*グローバル マクロ*<br/>
プロジェクト構成のすべての項目に適用されます。 `$(name)` の構文を持ちます。 Visual Studio インストールのルート ディレクトリを格納するグローバル マクロの例は `$(VCInstallDir)` です。 グローバル マクロは、MSBuild の `PropertyGroup` に対応します。

*項目マクロ*<br/>
`%(name)` の構文を持ちます。 ファイルの場合、項目マクロはそのファイルのみに適用されます。たとえば、`%(AdditionalIncludeDirectories)` を使用して、特定のファイルだけに適用するインクルード ディレクトリを指定します。 この種類の項目マクロは、MSBuild の `ItemGroup` のメタデータに対応します。 プロジェクト構成のコンテキストで使用される場合、項目マクロは、特定の種類のすべてのファイルに適用されます。 たとえば、C/C++ の **[プリプロセッサの定義]** 構成プロパティは、プロジェクトのすべての .cpp ファイルに適用する `%(PreprocessorDefinitions)` 項目マクロを使用できます。 この種類の項目マクロは、MSBuild の `ItemDefinitionGroup` のメタデータに対応します。 詳細については、「[項目定義](/visualstudio/msbuild/item-definitions)」を参照してください。

### <a name="user-defined-macros"></a>ユーザー定義マクロ

プロジェクトのビルドで変数として使う "*ユーザー定義マクロ*" を作成できます。 たとえば、ユーザー定義のマクロを作成して、カスタム ビルド ステップまたはカスタム ビルド ツールに値を渡すことができます。 ユーザー定義マクロは、名前と値のペアです。 プロジェクト ファイル内では、 **$(** <em>name</em> **)** という表記を使って、その値にアクセスします。

ユーザー定義マクロは、プロパティ シートに格納されます。 プロジェクトにプロパティ シートが含まれていない場合は、「[Visual Studio プロジェクトの設定を共有または再利用する](create-reusable-property-configurations.md)」の手順に従って作成できます。

#### <a name="to-create-a-user-defined-macro"></a>ユーザー定義マクロを作成するには

1. **プロパティ マネージャー** ウィンドウを開きます (メニュー バーで、 **[表示]**  >  **[プロパティ マネージャー]** または **[表示]**  >  **[その他のウィンドウ]**  >  **[プロパティ マネージャー]** を選択します)。プロパティ シート (名前の末尾が. user) のショートカット メニューを開き、 **[プロパティ]** をクリックします。 そのプロパティ シートの **[プロパティ ページ]** ダイアログ ボックスが開きます。

1. ダイアログ ボックスの左ウィンドウで、 **[ユーザー マクロ]** を選びます。 右ウィンドウで **[マクロの追加]** ボタンを選んで、 **[ユーザー マクロの追加]** ダイアログ ボックスを開きます。

1. ダイアログ ボックスで、マクロの名前と値を指定します。 必要に応じて、 **[ビルド環境でこのマクロを環境変数として設定します]** チェック ボックスをオンにします。

## <a name=""></a><a name="property_editor">プロパティ エディター</a>

プロパティ エディターを使用して、特定の文字列プロパティを変更し、値としてマクロを選択できます。 プロパティ エディターにアクセスするには、プロパティ ページのプロパティを選択し、右側のドロップダウン矢印をクリックします。 ドロップダウン リストに **[\<編集>]** が含まれている場合、それを選ぶと、そのプロパティのプロパティ エディターを表示できます。

![プロパティ&#95;エディター&#95;のドロップダウン](media/property_editor_dropdown.png "Property_Editor_Dropdown")

プロパティ エディターで **[マクロ]** を選んで、使用できるマクロとその現在の値を見ることができます。 次の図は、 **[マクロ]** を選んだ後の **[追加のインクルード ディレクトリ]** プロパティのプロパティ エディターを示したものです。 **[親またはプロジェクトの既定値から継承]** チェック ボックスをオンにして新しい値を追加すると、現在継承されているすべての値に追加されます。 チェック ボックスをオフにすると、継承された値が新しい値に置き換えられます。 ほとんどの場合、チェック ボックスはオンのままにします。

![プロパティ エディター、Visual C&#43;&#43;](media/propertyeditorvc.png "PropertyEditorVC")

## <a name="add-an-include-directory-to-the-set-of-default-directories"></a>既定のディレクトリ セットにインクルード ディレクトリを追加する

プロジェクトにインクルード ディレクトリを追加する場合、すべての既定のディレクトリをオーバーライドしないことが重要です。 ディレクトリを追加するための正しい方法は、"C:\MyNewIncludeDir\" のような新しいパスを追加し、プロパティ値に **$(IncludePath)** マクロを追加することです。

## <a name="quickly-browse-and-search-all-properties"></a>すべてのプロパティをすばやく参照および検索するには

**[すべてのオプション]** プロパティ ページ ( **[プロパティ ページ]** ダイアログ ボックスの **[構成プロパティ] > [C/C++]** ノードの下) には、現在のコンテキストで使用できるプロパティを簡単に参照および検索する方法が用意されています。 これには特別な検索ボックスと単純な構文が用意されており、結果をフィルター処理できます。

プレフィックスなし:<br/>
プロパティ名のみで検索 (大文字と小文字を区別しない部分文字列)。

'/' または '-' :<br/>
コンパイラ スイッチのみで検索 (大文字と小文字を区別しないプレフィックス)。

v:<br/>
値のみで検索 (大文字と小文字を区別しない部分文字列)。

## <a name="set-environment-variables-for-a-build"></a>ビルドの環境変数を設定する

MSVC コンパイラ (cl.exe) では、特定の環境変数 (具体的には LIB、LIBPATH、PATH、および INCLUDE) が認識されます。 IDE でビルドすると、[VC++ ディレクトリのプロパティ ページ](reference/vcpp-directories-property-page.md)で設定されたプロパティを使用して環境変数が設定されます。 LIB、LIBPATH、および INCLUDE の値が既に設定されている場合 (たとえば、開発者コマンド プロンプトによって)、それらは対応する MSBuild プロパティの値に置き換えられます。 その後、ビルドによって、VC++ ディレクトリの実行ファイル ディレクトリのプロパティの値が PATH に追加されます。 ユーザー定義マクロを作成して **[ビルド環境でこのマクロを環境変数として設定します]** チェック ボックスをオンにすると、ユーザー定義の環境変数を設定できます。

## <a name="set-environment-variables-for-a-debugging-session"></a>デバッグ セッションの環境変数を設定する

プロジェクトの **[プロパティ ページ]** ダイアログ ボックスの左ウィンドウで **[構成プロパティ]** を展開し、 **[デバッグ]** を選びます。

右ウィンドウで **[環境]** または **[マージ環境]** のプロジェクト設定を変更して、 **[OK]** をクリックします。

## <a name="in-this-section"></a>このセクションの内容

[Visual Studio プロジェクトの設定を共有または再利用する](create-reusable-property-configurations.md)<br/>
共有または再利用が可能なカスタム ビルド設定を使用する .props ファイルの作成方法。

[プロジェクト プロパティの継承](project-property-inheritance.md)<br/>
ビルド プロセスでの .props ファイル、.targets ファイル、.vcxproj ファイル、および環境変数の評価順序について説明します。

[プロジェクト ファイルを変更しないでプロパティとターゲットを変更する](modify-project-properties-without-changing-project-file.md)<br/>
プロジェクト ファイルを変更せずに一時的なビルド設定を作成する方法。

## <a name="see-also"></a>関連項目

[Visual Studio プロジェクト - C++](creating-and-managing-visual-cpp-projects.md)<br/>
[.vcxproj と .props のファイル構造](reference/vcxproj-file-structure.md)<br/>
[プロパティ ページの XML ファイル](reference/property-page-xml-files.md)<br/>
